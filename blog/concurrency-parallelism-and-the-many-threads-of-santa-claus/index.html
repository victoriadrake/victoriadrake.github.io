<!doctype html><html lang=en-us><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="chrome=1"><meta name=HandheldFriendly content="True"><meta name=MobileOptimized content="320"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=referrer content="no-referrer"><meta name=description content="Victoria Drake is a senior software developer. She writes about software engineering, information security, and cybersecurity through education."><title>Concurrency, parallelism, and the many threads of Santa Claus ğŸ… | victoria.dev</title><meta name=monetization content="$twitter.xrptipbot.com/victoriadotdev"><meta property="og:title" content="Concurrency, parallelism, and the many threads of Santa Claus ğŸ… - victoria.dev"><meta property="og:type" content="website"><meta property="og:description" content="A seasonal exploration of the difference between concurrent, parallel, and multithreaded processes."><meta property="og:url" content="https://victoria.dev/blog/concurrency-parallelism-and-the-many-threads-of-santa-claus/"><meta property="og:site_name" content="victoria.dev"><meta property="og:image" content="https://victoria.dev/blog/concurrency-parallelism-and-the-many-threads-of-santa-claus/cover.png"><meta name=twitter:card content="summary_large_image"><meta name=twitter:title content="Concurrency, parallelism, and the many threads of Santa Claus ğŸ…"><meta name=twitter:image content="https://victoria.dev/blog/concurrency-parallelism-and-the-many-threads-of-santa-claus/cover.png"><meta name=twitter:description content="A seasonal exploration of the difference between concurrent, parallel, and multithreaded processes."><link rel="shortcut icon" href=/img/logo.ico><link rel=stylesheet href=/css/main.min.0b87a409f53cbfbdb4ec5068e3e24320e7f7f690331bd1b4d0b4a058c421dbad.css integrity="sha256-C4ekCfU8v7207FBo4+JDIOf39pAzG9G00LSgWMQh260=" media=screen></head><body><section id=main><div class=header><div class=toggle><input type=checkbox>
<span class=bar></span><span class=bar></span><span class=bar></span><div id=mobile-menu><span class=menu-item><a href=/>ğŸ‘©ğŸ»â€ğŸ’» hi</a></span>
<span class=menu-item><a href=/blog/>ğŸ“° blog</a></span>
<span class=menu-item><a href=/about/>ğŸ“– readme</a></span>
<span class=menu-item><a href=/coffee/><img src=/coffee/cup.png alt="coffee icon" height=16px> contribute</a></span></div></div><div id=menu><span class=menu-item><a href=/>ğŸ‘©ğŸ»â€ğŸ’» hi</a></span>
<span class=menu-item><a href=/blog/>ğŸ“° blog</a></span>
<span class=menu-item><a href=/about/>ğŸ“– readme</a></span>
<span class=menu-item><a href=/coffee/><img src=/coffee/cup.png alt="coffee icon" height=16px> contribute</a></span></div><div id=logo><img id=up alt="site logo" src=/img/logo.png></div></div><div class=container><div id=images><img src=https://victoria.dev/blog/concurrency-parallelism-and-the-many-threads-of-santa-claus/cover.png alt="cover image"></div><div class=markdown><h1>Concurrency, parallelism, and the many threads of Santa Claus ğŸ…</h1><p class=subtitle>A seasonal exploration of the difference between concurrent, parallel, and multithreaded processes.</p><p class=metadata id=date>December 23, 2019
â˜•ï¸â˜•ï¸&nbsp;
7 min read
&nbsp;
<a class=li-tag href=/tags/computing/>computing
</a>&nbsp;</p></div><div class=page-separator><hr></div><div class=markdown><p>Consider the following: Santa brings toys to all the good girls and boys.</p><p>There are <a href=https://en.wikipedia.org/wiki/Demographics_of_the_world#Current_population_distribution>7,713,468,100 people</a> in the world in 2019, <a href=https://en.wikipedia.org/wiki/Demographics_of_the_world#Age_structure>around 26.3%</a> of which are under 15 years old. This works out to 2,028,642,110 children (persons under 15 years of age) in the world this year.</p><p>Santa doesn&rsquo;t seem to visit children of every religion, so we&rsquo;ll generalize and only include Christians and non-religious folks. Collectively that makes up <a href=https://en.wikipedia.org/wiki/List_of_religious_populations#Adherent_estimates_in_2019>approximately 44.72%</a> of the population. If we assume that all kids take after their parents, then 907,208,751.6 children would appear to be Santa-eligible.</p><p>What percentage of those children are good? It&rsquo;s impossible to know; however, we can work on a few assumptions. One is that Santa Claus functions more on optimism than economics and would likely have prepared for the possibility that every child is a good child in any given year. Thus, he would be prepared to give a toy to every child. Let&rsquo;s assume it&rsquo;s been a great year and that all 907,208,751.6 children are getting toys.</p><p>That&rsquo;s a lot of presents, and, as we know, they&rsquo;re all made by Santa&rsquo;s elves at his North <del>China</del> Pole workshop. Given that there are 365 days in a year and one of them is Christmas, let&rsquo;s assume that Santa&rsquo;s elves collectively have 364 days to create and gift wrap 907,208,752 (rounded up) presents. That works out to 2,492,331.74 presents per day.</p><p>Almost two-and-a-half million presents per day is a heavy workload for any workshop. Let&rsquo;s look at two paradigms that Santa might employ to hit this goal: concurrency, and parallelism.</p><h2 id=a-sequential-process>A sequential process</h2><p>Suppose that Santa&rsquo;s workshop is staffed by exactly one, very hard working, very tired elf. The production of one present involves four steps:</p><ol><li>Cutting wood</li><li>Assembly and glueing</li><li>Painting</li><li>Gift-wrapping</li></ol><p>With a single elf, only one step for one present can be happening at any instance in time. If the elf were to produce one present at a time from beginning to end, that process would be executed <em>sequentially</em>. It&rsquo;s not the most efficient method for producing two-and-a-half million presents per day; for instance, the elf would have to wait around doing nothing while the glue on the present was drying before moving on to the next step.</p><p><img src=sequence.png alt="Illustration of sequence"></p><h2 id=concurrency>Concurrency</h2><p>In order to be more efficient, the elf works on all presents <em>concurrently</em>.</p><p>Instead of completing one present at a time, the elf first cuts all the wood for all the toys, one by one. When everything is cut, the elf assembles and glues the toys together, one after the other. This <a href=https://en.wikipedia.org/wiki/Concurrent_computing>concurrent processing</a> means that the glue from the first toy has time to dry (without needing more attention from the elf) while the remaining toys are glued together. The same goes for painting, one toy at a time, and finally wrapping.</p><p><img src=concurrency.png alt="Illustration of concurrency"></p><p>Since one elf can only do one task at a time, a single elf is using the day as efficiently as possible by concurrently producing presents.</p><h2 id=parallelism>Parallelism</h2><p>Hopefully, Santa&rsquo;s workshop has more than just one elf. With more elves, more toys can be built simultaneously over the course of a day. This simultaneous work means that the presents are being produced in <em>parallel</em>. <a href=https://en.wikipedia.org/wiki/Parallel_computing>Parallel processing</a> carried out by multiple elves means more work happens at the same time.</p><p><img src=parallel.png alt="Illustration of parallel processes"></p><p>Elves working in parallel can also employ concurrency. One elf can still tackle only one task at a time, so it&rsquo;s most efficient to have multiple elves concurrently producing presents.</p><p>Of course, if Santa&rsquo;s workshop has, say, two-and-a-half million elves, each elf would only need to finish a maximum of one present per day. In this case, working sequentially doesn&rsquo;t detract from the workshop&rsquo;s efficiency. There would still be 7,668.26 elves left over to fetch coffee and lunch.</p><h2 id=santa-claus-and-threading>Santa Claus, and threading</h2><p>After all the elves&rsquo; hard work is done, it&rsquo;s up to Santa Claus to deliver the presents &ndash; all 907,208,752 of them.</p><p>Santa doesn&rsquo;t need to make a visit to every kid; just to the one household tree. So how many trees does Santa need to visit? Again with broad generalization, we&rsquo;ll say that the average number of children per household worldwide is <a href=https://en.wikipedia.org/wiki/Demographics_of_the_world#Total_fertility_rate>2.45, based on the year&rsquo;s predicted fertility rates</a>. That makes 370,289,286.4 houses to visit. Let&rsquo;s round that up to 370,289,287.</p><p>How long does Santa have? The lore says one night, which means one earthly rotation, and thus 24 hours. <a href=https://www.noradsanta.org/>NORAD confirms</a>.</p><p>This means Santa must visit 370,289,287 households in 24 hours (86,400 seconds), at a rate of 4,285.75 households per second, nevermind the time it takes to put presents under the tree and grab a cookie.</p><p>Clearly, Santa doesn&rsquo;t exist in our dimension. This is especially likely given that despite being chubby and plump, he fits down a chimney (with a lit fire, while remaining unhurt) carrying a sack of toys containing presents for all the household&rsquo;s children. We haven&rsquo;t even considered the fact that his sleigh carries enough toys for every believing boy and girl around the world, and flies.</p><p>Does Santa exist outside our rules of physics? How could one entity manage to travel around the world, delivering packages, in under 24 hours at a rate of 4,285.75 households per second, and still have time for milk and cookies and kissing mommy?</p><p>One thing is certain: Santa uses the Internet. No other technology has yet enabled packages to travel quite so far and quite so quickly. Even so, attempting to reach upwards of four thousand households per second is no small task, even with even the best gigabit Internet hookup the North Pole has to offer. How might Santa increase his efficiency?</p><p>There&rsquo;s clearly only one logical conclusion to this mystery: Santa Claus is a multithreaded process.</p><h2 id=a-single-thread>A single thread</h2><p>Let&rsquo;s work outward. Think of a <a href=https://en.wikipedia.org/wiki/Thread_(computing)>thread</a> as one particular task, or the most granular sequence of instructions that Santa might execute. One thread might execute the task, <code>put present under tree</code>. A thread is a component of a process, in this case, Santa&rsquo;s process of delivering presents.</p><p>If Santa Claus is <a href=https://en.wikipedia.org/wiki/Thread_(computing)#Single_threading>single-threaded</a>, he, as a process, would only be able to accomplish one task at a time. Since he&rsquo;s old and a bit forgetful, he probably has a set of instructions for delivering presents, as well as a schedule to abide by. These two things guide Santa&rsquo;s thread until his process is complete.</p><p><img src=single.png alt="A single Santa Claus emoji"></p><p>Single-threaded Santa Claus might work something like this:</p><ol><li>Land sleigh at Timmy&rsquo;s house</li><li>Get Timmy&rsquo;s present from sleigh</li><li>Enter house via chimney</li><li>Locate Christmas tree</li><li>Place Timmy&rsquo;s present under Christmas tree</li><li>Exit house via chimney</li><li>Take off in sleigh</li></ol><p>Rinse and repeat&mldr; another 370,289,286 times.</p><h2 id=multithreading>Multithreading</h2><p><a href=https://en.wikipedia.org/wiki/Thread_(computing)#Multithreading>Multithreaded</a> Santa Claus, by contrast, is the <a href=https://dc.fandom.com/wiki/Jonathan_Osterman_(Watchmen)>Doctor Manhattan</a> of the North Pole. There&rsquo;s still only one Santa Claus in the world; however, he has the amazing ability to multiply his consciousness and accomplish multiple instruction sets of tasks simultaneously. These additional task workers, or worker threads, are created and controlled by the main process of Santa delivering presents.</p><p><img src=cover.png alt="Multiple Santa threads"></p><p>Each worker thread acts independently to complete its instructions. Since they all belong to Santa&rsquo;s consciousness, they share Santa&rsquo;s memory and know everything that Santa knows, including what planet they&rsquo;re running around on, and where to get the presents from.</p><p>With this shared knowledge, each thread is able to execute its set of instructions in parallel with the other threads. This multithreaded parallelism makes the one and only Santa Claus as efficient as possible.</p><p>If an average present delivery run takes an hour, Santa need only spawn 4,286 worker threads. With each making one delivery trip per hour, Santa will have completed all 370,289,287 trips by the end of the night.</p><p>Of course, in theory, Santa could even spawn 370,289,287 worker threads, each flying to one household to deliver presents for all the children in it! That would make Santa&rsquo;s process extremely efficient, and also explain how he manages to consume all those milk-dunked cookies without getting full. ğŸ¥›ğŸªğŸªğŸª</p><h2 id=an-efficient-and-merry-multithreaded-christmas>An efficient and merry multithreaded Christmas</h2><p>Thanks to modern computing, we now finally understand how Santa Claus manages the seemingly-impossible task of delivering toys to good girls and boys the world-over. From my family to yours, I hope you have a wonderful Christmas. Don&rsquo;t forget to hang up your stockings on the router shelf.</p><p>Of course, none of this explains how reindeer manage to fly.</p></div><div class=page-separator><hr></div><div class=related><div class="markdown highlight"><pre class=chroma><code class=language-sql data-lang=sql>SELECT TOP 3 * FROM related;</code></pre></div><ul id=list-items><li><a class=li-link href=https://victoria.dev/blog/sqlite-in-production-with-wal/>SQLite in production with WAL ğŸ”¥</a><p class=li-brief>An underappreciated candidate for light and fast database transactions.</p><p class=metadata><a class=li-tag href=/tags/data/>data</a>
â˜•ï¸&nbsp;
4 min read</p></li><li><a class=li-link href=https://victoria.dev/blog/multithreaded-python-slithering-through-an-i/o-bottleneck/>Multithreaded Python: slithering through an I/O bottleneck</a><p class=li-brief>How taking advantage of parallelism in Python can make your software orders of magnitude faster.</p><p class=metadata><a class=li-tag href=/tags/python/>python</a>
â˜•ï¸&nbsp;
5 min read</p></li><li><a class=li-link href=https://victoria.dev/blog/breaking-bottlenecks/>Breaking bottlenecks ğŸ¾</a><p class=li-brief>A talk on the benefits of non-blocking functions for programs, developers, and organizations.</p><p class=metadata><a class=li-tag href=/tags/computing/>computing</a>
â˜•ï¸â˜•ï¸â˜•ï¸&nbsp;
12 min read</p></li></ul><div class=page-separator><p class=back-link><a href=/blog>&lt;&lt; Back to blog</a></p></div></div></div><div class=container><footer><div class=markdown><figure class=profile><img src=/img/victoria_headshot.jpg alt="Victoria's headshot"></figure><p>Victoria Drake is a senior software developer in Washington, DC. She is a twice-awarded annual Top Contributor to the freeCodeCamp non-profit, and a recognized Distinguished Author on the DEV.to developer platform. She currently contributes to the Open Web Application Security Project as a core maintainer and co-author for the Web Security Testing Guide. She writes about software development, cybersecurity, and information security awareness.</p><p><a href=/about>about</a> - <a href=mailto:hello@victoria.dev>email</a> - <a href=https://github.com/victoriadrake>github</a> - <a href=https://twitter.com/victoriadotdev>twitter</a> - <a href=https://www.linkedin.com/in/victoriadotdev/>linkedin</a></p></div></footer></div></section><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;ga('create','UA-98623582-1','auto');ga('send','pageview');}</script><script async src=https://www.google-analytics.com/analytics.js></script><script>scrollTo=(element)=>{window.scroll({behavior:'smooth',left:0,top:element.offsetTop});}
document.getElementById("up").addEventListener('click',()=>{scrollTo(document.getElementById("main"));});</script></body></html>