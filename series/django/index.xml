<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom" xmlns:content="http://purl.org/rss/1.0/modules/content/"><channel><title>django on victoria.dev</title><link>https://victoria.dev/series/django/</link><description>Recent content in django on victoria.dev</description><generator>Hugo -- gohugo.io</generator><language>en-us</language><managingEditor>hello@victoria.dev (Victoria Drake)</managingEditor><webMaster>hello@victoria.dev (Victoria Drake)</webMaster><lastBuildDate>Thu, 01 Oct 2020 05:50:37 -0400</lastBuildDate><atom:link href="https://victoria.dev/series/django/index.xml" rel="self" type="application/rss+xml"/><item><title>Your cybersecurity starter pack</title><link>https://victoria.dev/blog/your-cybersecurity-starter-pack/</link><pubDate>Sun, 04 Oct 2020 04:30:12 -0400</pubDate><author>hello@victoria.dev (Victoria Drake)</author><guid>https://victoria.dev/blog/your-cybersecurity-starter-pack/</guid><description>Basic security best practices to share with your non-technical friend.</description><content:encoded>
&lt;img src="https://victoria.dev/blog/your-cybersecurity-starter-pack/cover_hu39fddecd001ff587b3408c08bb5d36a7_808619_640x0_resize_box_2.png" width="640" height="320"/>
&lt;p>Readers of my blog typically know more about technology and cybersecurity than most people. This article is for most people. If someone you know could benefit from a simple and straightforward cybersecurity starter pack, please share this article with them &amp;ndash; it benefits everyone!&lt;/p>
&lt;p>If you&amp;rsquo;ve ever said to yourself:&lt;/p>
&lt;p>&lt;em>&amp;ldquo;There&amp;rsquo;s no one targeting lil ol' me.&amp;quot;&lt;/em>&lt;br>
&lt;em>&amp;ldquo;I have nothing to hide, anyway.&amp;quot;&lt;/em>&lt;br>
&lt;em>&amp;ldquo;I&amp;rsquo;m too busy to learn all this stuff. Why can&amp;rsquo;t someone just give me a simple summary of best practices that I can skim in approximately seven minutes?&amp;quot;&lt;/em>&lt;/p>
&lt;p>First of all, you might want to stop talking to yourself in public. Secondly, here is a simple summary of best practices that you can skim in approximately seven minutes.&lt;/p>
&lt;h2 id="introducing-your-three-step-starter-pack" class="anchor-link">&lt;a href="#introducing-your-three-step-starter-pack">Introducing your three-step starter pack&lt;/a>&lt;/h2>
&lt;p>While there are many different degrees of security, privacy, and anonymity, these three basics are accessible to all:&lt;/p>
&lt;ol>
&lt;li>Use a VPN&lt;/li>
&lt;li>Use multifactor authentication&lt;/li>
&lt;li>Develop a healthy sense of skepticism&lt;/li>
&lt;/ol>
&lt;p>I&amp;rsquo;ll discuss each of these and help you get started with your security upgrade. But first&amp;hellip;&lt;/p>
&lt;h2 id="why-is-cybersecurity-important" class="anchor-link">&lt;a href="#why-is-cybersecurity-important">Why is cybersecurity important?&lt;/a>&lt;/h2>
&lt;p>Would you let just anyone walk into your house, or even look through your open doorway from across the street? If not, you might appreciate that the cybersecurity practices we&amp;rsquo;ll discuss today are not that different from locking your front door.&lt;/p>
&lt;p>Cybersecurity isn&amp;rsquo;t about finding some magic spell that completely secures your online activities &amp;ndash; that would be nice, but it&amp;rsquo;s unrealistic. Good security practices are about employing some thoughtful habits that make your online activities more secure than the next guy, in much the same way as you learned to lock your front door.&lt;/p>
&lt;p>Security breaches and incidents happen every day. Most of them occur because an automated scanner cast a wide net and found a person or company with lax security that a hacker could then exploit. Don&amp;rsquo;t be that guy.&lt;/p>
&lt;h2 id="1-use-a-vpn" class="anchor-link">&lt;a href="#1-use-a-vpn">1. Use a VPN&lt;/a>&lt;/h2>
&lt;p>Let&amp;rsquo;s say you send a lot of mail, but never bother to put your letters in envelopes or even fold them in half. Anyone who bothers to look can read all your dirty secrets (not that you have any).&lt;/p>
&lt;p>When you use a Virtual Private Network, or VPN, especially if you often connect to public WiFi, it&amp;rsquo;s like putting your letters into cryptographically-sealed envelopes and sending them via a special invisible courier service. No one but the intended recipient can read your letters, and no one but you and the courier know to whom the letters are sent.&lt;/p>
&lt;figure>
&lt;img src="vpnmail.png"
alt="An illustration of a locked envelope"/> &lt;figcaption>
&lt;p>Encrypted mail still won&amp;rsquo;t stop you from the accidental &lt;em>reply all&lt;/em>, unfortunately.&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;p>VPNs prevent others from reading your communications. This may include opportunistic attackers who scan open WiFi, and even your own Internet Service Provider (ISP) who may sell your usage data for advertising dollars.&lt;/p>
&lt;h3 id="choosing-a-vpn" class="anchor-link">&lt;a href="#choosing-a-vpn">Choosing a VPN&lt;/a>&lt;/h3>
&lt;p>A few important differentiating factors can help you choose a VPN provider.&lt;/p>
&lt;ol>
&lt;li>
&lt;p>&lt;strong>Is it free?&lt;/strong> VPNs cost money to operate; if one is offered for free, consider what they might be doing in order to cover their costs. Generally, I recommend avoiding free VPN apps and services; they&amp;rsquo;ll typically cost you much more than you&amp;rsquo;ll know. Expect to pay between $5-$10 USD monthly for the service.&lt;/p>
&lt;/li>
&lt;li>
&lt;p>&lt;strong>Where is it based?&lt;/strong> Understand where your VPN provider is based, and what that country&amp;rsquo;s laws allow them to do with your data.&lt;/p>
&lt;/li>
&lt;li>
&lt;p>&lt;strong>Do they keep logs?&lt;/strong> Part of the philosophy of using a VPN is that no one has any business getting into your business when it comes to online activities. When a VPN provider keeps logs of your usage, that defeats the purpose. Instead of your ISP knowing just what you&amp;rsquo;re up to online, that knowledge is simply transferred to the logging VPN. Look for VPN providers with a strict no-logging policy.&lt;/p>
&lt;/li>
&lt;/ol>
&lt;p>Here are two options that meet these criteria, as far as I know:&lt;/p>
&lt;ul>
&lt;li>&lt;a href="https://www.expressvpn.com/">ExpressVPN&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://protonvpn.com/">ProtonVPN&lt;/a>&lt;/li>
&lt;/ul>
&lt;h2 id="2-use-multifactor-authentication" class="anchor-link">&lt;a href="#2-use-multifactor-authentication">2. Use multifactor authentication&lt;/a>&lt;/h2>
&lt;p>Passwords are dead. Computationally, they are a solved problem. Cracking your password is just &lt;a href="https://howsecureismypassword.net/">a matter of time&lt;/a>.&lt;/p>
&lt;p>Unfortunately, many people still help to speed up the process by using the same &lt;a href="https://haveibeenpwned.com/Passwords">compromised passwords&lt;/a> for multiple accounts, putting themselves at further risk.&lt;/p>
&lt;p>The answer, at least for now, is &lt;a href="https://en.wikipedia.org/wiki/Multi-factor_authentication">multifactor authentication&lt;/a> (MFA). MFA is made up of three kinds of authentication factors:&lt;/p>
&lt;ol>
&lt;li>Something you know, like a pass phrase;&lt;/li>
&lt;li>Something you have, like a chip pin card or phone; and&lt;/li>
&lt;li>Something that you are, like your face or fingerprint.&lt;/li>
&lt;/ol>
&lt;figure>
&lt;img src="mfa.png"
alt="An illustration of the letters MFA"/> &lt;figcaption>
&lt;p>Also the name of my next beatboxing team.&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;p>Two or more of these factors are infinitely better than a password alone, especially if &lt;a href="https://en.wikipedia.org/wiki/List_of_the_most_common_passwords">your password is on this list&lt;/a>.&lt;/p>
&lt;p>Multiple authentication factors are now widely supported by account providers and social media sites. If you have the choice, avoid using text messages, or SMS, as a way of receiving authentication codes. SMS authentication leaves you vulnerable to the &lt;a href="https://en.wikipedia.org/wiki/SIM_swap_scam">SIM swap attack&lt;/a> - please direct further questions to &lt;a href="https://www.nytimes.com/2019/09/05/technology/sim-swap-jack-dorsey-hack.html">Jack Dorsey&lt;/a>.&lt;/p>
&lt;p>Instead, use a One Time Password (OTP) app such as &lt;a href="https://authy.com/">Authy&lt;/a> to generate codes on your device. This ensures that you alone, using that particular device, will have the correct authentication code.&lt;/p>
&lt;p>You can also use hardware authentication keys such as the &lt;a href="https://www.yubico.com/">YubiKey&lt;/a>, but these aren&amp;rsquo;t yet as widely supported as OTP apps.&lt;/p>
&lt;h2 id="3-develop-a-healthy-sense-of-skepticism" class="anchor-link">&lt;a href="#3-develop-a-healthy-sense-of-skepticism">3. Develop a healthy sense of skepticism&lt;/a>&lt;/h2>
&lt;p>Social engineering, sometimes SE, is the use of psychological persuasion to get an unwitting target to give up access or information. This can take the form of phishing emails, letters, or phone calls (vishing) as well as far more sophisticated spear-phishing attacks of high-value targets, like company executives.&lt;/p>
&lt;p>While some attacks are easier to spot, others &lt;a href="https://www.youtube.com/watch?v=8bAuA1isCz0">use cognitive biases very effectively&lt;/a> and are difficult even for security professionals to avoid. No human is immune.&lt;/p>
&lt;p>Ultimately, the weakest link in your cybersecurity defense is you. All the VPNs and MFA on the Internet won&amp;rsquo;t protect you if a scam can trick you into opening the front gates. Always look a Trojan gift horse in the mouth.&lt;/p>
&lt;figure>
&lt;img src="horse.png"
alt="An illustration of a Trojan horse"/> &lt;figcaption>
&lt;p>Yes, I know it&amp;rsquo;s a very nice looking wooden horse. Also free. Did you order it? No? Then it can stay outside.&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;p>Develop the habit of second-guessing things delivered to your virtual doorstep. Email, phone, and messaging scams range in sophistication. Even security professionals can fall for a good scam.&lt;/p>
&lt;p>One way to protect yourself is to practice a healthy sense of skepticism. Question communications that ask you to click on links or visit a website, even if they come from someone you know or a company you use.&lt;/p>
&lt;p>If you&amp;rsquo;re not certain that your bank or mother sent this email, pick up the phone and call them. Even if you think you are certain, pick up the phone and double check. You don&amp;rsquo;t call your mother enough, anyway.&lt;/p>
&lt;p>Oh, and if the person on the phone is from your local tax office or the IRS or the CRA and they&amp;rsquo;re about to freeze your accounts because a case of mistaken identity has resulted in you being criminally charged for not repaying a loan on a 600-foot yacht in Malibu, just hang up. You know better than that. Tax agencies don&amp;rsquo;t have phones.&lt;/p>
&lt;h2 id="a-safer-internet" class="anchor-link">&lt;a href="#a-safer-internet">A safer Internet&lt;/a>&lt;/h2>
&lt;p>Congratulations! You now have three tools to make your personal cybersecurity better than the next guy&amp;rsquo;s. If enough people do that, the whole neighborhood (or in this case, the Internet) will benefit as a result.&lt;/p>
&lt;p>If this article piqued your interest, you can go further and &lt;a href="https://victoria.dev/blog/outsourcing-security-with-1password-authy-and-privacy.com/">outsource your security with a password manager and temporary virtual credit cards&lt;/a>.&lt;/p>
&lt;h3 id="cheat-sheets-and-other-resources" class="anchor-link">&lt;a href="#cheat-sheets-and-other-resources">Cheat sheets and other resources&lt;/a>&lt;/h3>
&lt;p>I&amp;rsquo;ll leave you with a few resources that I&amp;rsquo;ve enjoyed:&lt;/p>
&lt;ul>
&lt;li>The Electronic Frontier Foundation website &lt;a href="https://ssd.eff.org/">Surveillance Self Defense&lt;/a> offers many great guides and how-to&amp;rsquo;s, such as setting up the encrypted messaging app &lt;a href="https://www.signal.org/">Signal&lt;/a> on your mobile device, and protecting yourself on social media.&lt;/li>
&lt;li>The Cybersecurity and Infrastructure Security Agency (CISA) offers many &lt;a href="https://www.cisa.gov/cisa-cybersecurity-resources">shareable starter resources&lt;/a>.&lt;/li>
&lt;li>Working from home? The National Security Agency Central Security Service has &lt;a href="https://www.nsa.gov/What-We-Do/Cybersecurity/Telework-and-Mobile-Security-Guidance/">Telework and Mobile Security Guides&lt;/a> that discuss best practices for an unprecedented era of remote work.&lt;/li>
&lt;/ul></content:encoded><enclosure url="https://victoria.dev/blog/your-cybersecurity-starter-pack/cover_hu39fddecd001ff587b3408c08bb5d36a7_808619_640x0_resize_box_2.png" type="image/jpg"/></item><item><title>Increase developer confidence with a great Django test suite</title><link>https://victoria.dev/blog/increase-developer-confidence-with-a-great-django-test-suite/</link><pubDate>Thu, 01 Oct 2020 05:50:37 -0400</pubDate><author>hello@victoria.dev (Victoria Drake)</author><guid>https://victoria.dev/blog/increase-developer-confidence-with-a-great-django-test-suite/</guid><description>How to write tests for your Django applications that boost your team, and are actually useful.</description><content:encoded>
&lt;img src="https://victoria.dev/blog/increase-developer-confidence-with-a-great-django-test-suite/cover_hu9adcaffd30c4a555a26c2259090a851f_467188_640x0_resize_box_2.png" width="640" height="320"/>
&lt;p>If you regard writing tests as a lame checkbox task, nothing could be farther from the truth. Done correctly, tests are one of your application&amp;rsquo;s most valuable assets.&lt;/p>
&lt;p>The Django framework in particular offers your team the opportunity to create an efficient testing practice, based on the Python standard library &lt;code>unittest&lt;/code>. Proper tests in Django are fast to write, faster to run, and can offer you a seamless continuous integration solution for taking the pulse of your developing application.&lt;/p>
&lt;p>With comprehensive tests, developers have higher confidence when pushing changes. I&amp;rsquo;ve seen firsthand in my own teams that good tests can boost development velocity as a direct result of a better developer experience.&lt;/p>
&lt;p>In this article, I&amp;rsquo;ll share my own experiences in building useful tests for Django applications, from the basics to the best possible execution. If you&amp;rsquo;re using Django or building with it in your organization, you might like to read the rest of my &lt;a href="https://victoria.dev/series/django/">Django series&lt;/a>.&lt;/p>
&lt;h2 id="what-to-test" class="anchor-link">&lt;a href="#what-to-test">What to test&lt;/a>&lt;/h2>
&lt;p>Tests are extremely important. Far beyond simply letting you know if a function works, tests can form the basis of your team&amp;rsquo;s understanding of how your application is &lt;em>intended&lt;/em> to work.&lt;/p>
&lt;p>Here&amp;rsquo;s the main goal: if you hit your head and forgot everything about how your application works tomorrow, you should be able to regain most of your understanding by reading and running the tests you write today.&lt;/p>
&lt;p>Here are some questions that may be helpful to ask as you decide what to test:&lt;/p>
&lt;ul>
&lt;li>What is our customer supposed to be able to do?&lt;/li>
&lt;li>What is our customer &lt;em>not&lt;/em> supposed to be able to do?&lt;/li>
&lt;li>What should this method, view, or logical flow achieve?&lt;/li>
&lt;li>When, how, or where is this feature supposed to execute?&lt;/li>
&lt;/ul>
&lt;p>Tests that make sense for your application can help build developer confidence. With these sensible safeguards in place, developers make improvements more readily, and feel confident introducing innovative solutions to product needs. The result is an application that comes together faster, and features that are shipped often and with confidence.&lt;/p>
&lt;p>
&lt;img src="https://victoria.dev/blog/increase-developer-confidence-with-a-great-django-test-suite/pbj-tests.png" alt="A cartoon for peanut butter and jelly sandwich tests" />
&lt;/p>
&lt;h2 id="where-to-put-tests" class="anchor-link">&lt;a href="#where-to-put-tests">Where to put tests&lt;/a>&lt;/h2>
&lt;p>If you only have a few tests, you may organize your test files similarly to &lt;a href="https://docs.djangoproject.com/en/3.1/ref/django-admin/#startapp">Django&amp;rsquo;s default app template&lt;/a> by putting them all in a file called &lt;code>tests.py&lt;/code>. This straightforward approach is best for smaller applications.&lt;/p>
&lt;p>As your application grows, you may like to split your tests into different files, or test modules. One method is to use a directory to organize your files, such as &lt;code>projectroot/app/tests/&lt;/code>. The name of each test file within that directory should begin with &lt;code>test&lt;/code>, for example, &lt;code>test_models.py&lt;/code>.&lt;/p>
&lt;p>Besides being aptly named, Django will find these files using &lt;a href="https://docs.python.org/3/library/unittest.html#unittest-test-discovery">built-in test discovery&lt;/a> based on the &lt;code>unittest&lt;/code> module. All files in your application with names that begin with &lt;code>test&lt;/code> will be collected into a test suite.&lt;/p>
&lt;p>This convenient test discovery allows you to place test files anywhere that makes sense for your application. As long as they&amp;rsquo;re correctly named, Django&amp;rsquo;s test utility can find and run them.&lt;/p>
&lt;h2 id="how-to-document-a-test" class="anchor-link">&lt;a href="#how-to-document-a-test">How to document a test&lt;/a>&lt;/h2>
&lt;p>Use &lt;a href="https://www.python.org/dev/peps/pep-0257/">docstrings&lt;/a> to explain what a test is intended to verify at a high level. For example:&lt;/p>
&lt;div class="highlight">&lt;pre class="chroma">&lt;code class="language-python" data-lang="python">&lt;span class="k">def&lt;/span> &lt;span class="nf">test_create_user&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="bp">self&lt;/span>&lt;span class="p">):&lt;/span>
&lt;span class="s2">&amp;#34;&amp;#34;&amp;#34;Creating a new user object should also create an associated profile object&amp;#34;&amp;#34;&amp;#34;&lt;/span>
&lt;span class="c1"># ...&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>These docstrings help you quickly understand what a test is supposed to be doing. Besides navigating the codebase, this helps to make it obvious when a test doesn&amp;rsquo;t verify what the docstring says it should.&lt;/p>
&lt;p>Docstrings are also shown when the tests are being run, which can be helpful for logging and debugging.&lt;/p>
&lt;h2 id="what-a-test-needs-to-work" class="anchor-link">&lt;a href="#what-a-test-needs-to-work">What a test needs to work&lt;/a>&lt;/h2>
&lt;p>Django tests can be quickly set up using data created in the &lt;a href="https://docs.djangoproject.com/en/3.1/topics/testing/tools/#django.test.TestCase.setUpTestData">&lt;code>setUpTestData()&lt;/code> method&lt;/a>. You can use various approaches to create your test data, such as utilizing external files, or even hard-coding silly phrases or the names of your staff. Personally, I much prefer to use a fake-data-generation library, such as &lt;a href="https://github.com/joke2k/faker/">&lt;code>faker&lt;/code>&lt;/a>.&lt;/p>
&lt;p>The proper set up of arbitrary testing data can help you ensure that you&amp;rsquo;re testing your application functionality instead of accidentally testing test data. Because generators like &lt;code>faker&lt;/code> add some degree of unexpectedness to your inputs, it can be more representative of real-world use.&lt;/p>
&lt;p>Here is an example set up for a test:&lt;/p>
&lt;div class="highlight">&lt;pre class="chroma">&lt;code class="language-python" data-lang="python">&lt;span class="kn">from&lt;/span> &lt;span class="nn">django.test&lt;/span> &lt;span class="kn">import&lt;/span> &lt;span class="n">TestCase&lt;/span>
&lt;span class="kn">from&lt;/span> &lt;span class="nn">faker&lt;/span> &lt;span class="kn">import&lt;/span> &lt;span class="n">Faker&lt;/span>
&lt;span class="kn">from&lt;/span> &lt;span class="nn">app.models&lt;/span> &lt;span class="kn">import&lt;/span> &lt;span class="n">MyModel&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">AnotherModel&lt;/span>
&lt;span class="n">fake&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">Faker&lt;/span>&lt;span class="p">()&lt;/span>
&lt;span class="k">class&lt;/span> &lt;span class="nc">MyModelTest&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">TestCase&lt;/span>&lt;span class="p">):&lt;/span>
&lt;span class="k">def&lt;/span> &lt;span class="nf">setUpTestData&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="bp">cls&lt;/span>&lt;span class="p">):&lt;/span>
&lt;span class="s2">&amp;#34;&amp;#34;&amp;#34;Quickly set up data for the whole TestCase&amp;#34;&amp;#34;&amp;#34;&lt;/span>
&lt;span class="bp">cls&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">user_first&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">fake&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">first_name&lt;/span>&lt;span class="p">()&lt;/span>
&lt;span class="bp">cls&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">user_last&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">fake&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">last_name&lt;/span>&lt;span class="p">()&lt;/span>
&lt;span class="k">def&lt;/span> &lt;span class="nf">test_create_models&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="bp">self&lt;/span>&lt;span class="p">):&lt;/span>
&lt;span class="s2">&amp;#34;&amp;#34;&amp;#34;Creating a MyModel object should also create AnotherModel object&amp;#34;&amp;#34;&amp;#34;&lt;/span>
&lt;span class="c1"># In test methods, use the variables created above&lt;/span>
&lt;span class="n">test_object&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">MyModel&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">objects&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">create&lt;/span>&lt;span class="p">(&lt;/span>
&lt;span class="n">first_name&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="bp">self&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">user_first&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="n">last_name&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="bp">self&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">user_last&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="c1"># ...&lt;/span>
&lt;span class="p">)&lt;/span>
&lt;span class="n">another_model&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">AnotherModel&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">objects&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">get&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">my_model&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">test_object&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="bp">self&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">assertEqual&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">another_model&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">first_name&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="bp">self&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">user_first&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="c1"># ...&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>Tests pass or fail based on the outcome of the assertion methods. You can use &lt;a href="https://docs.python.org/3/library/unittest.html#assert-methods">Python&amp;rsquo;s &lt;code>unittest&lt;/code> methods&lt;/a>, and &lt;a href="https://docs.djangoproject.com/en/3.1/topics/testing/tools/#assertions">Django&amp;rsquo;s assertion methods&lt;/a>.&lt;/p>
&lt;p>For further guidance on writing tests, see &lt;a href="https://docs.djangoproject.com/en/3.1/topics/testing/">Testing in Django&lt;/a>.&lt;/p>
&lt;h2 id="best-possible-execution-for-running-your-tests" class="anchor-link">&lt;a href="#best-possible-execution-for-running-your-tests">Best possible execution for running your tests&lt;/a>&lt;/h2>
&lt;p>Django&amp;rsquo;s test suite is manually run with:&lt;/p>
&lt;div class="highlight">&lt;pre class="chroma">&lt;code class="language-shell" data-lang="shell">./manage.py &lt;span class="nb">test&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>I rarely run my Django tests this way.&lt;/p>
&lt;p>The best, or most efficient, testing practice is one that occurs without you or your developers ever thinking, &amp;ldquo;I need to run the tests first.&amp;rdquo; The beauty of Django&amp;rsquo;s near-effortless test suite set up is that it can be seamlessly run as a part of regular developer activities. This could be in a pre-commit hook, or in a continuous integration or deployment workflow.&lt;/p>
&lt;p>I&amp;rsquo;ve previously written about how to use pre-commit hooks to &lt;a href="https://victoria.dev/blog/technical-ergonomics-for-the-efficient-developer/">improve your developer ergonomics&lt;/a> and save your team some brainpower. Django&amp;rsquo;s speedy tests can be run this way, and they become especially efficient if you can &lt;a href="https://docs.djangoproject.com/en/3.1/ref/django-admin/#cmdoption-test-parallel">run tests in parallel&lt;/a>.&lt;/p>
&lt;p>Tests that run as part of a CI/CD workflow, for example, &lt;a href="https://victoria.dev/blog/django-project-best-practices-to-keep-your-developers-happy/#continuous-testing-with-github-actions">on pull requests with GitHub Actions&lt;/a>, require no regular effort from your developers to remember to run tests at all. I&amp;rsquo;m not sure how plainly I can put it &amp;ndash; this one&amp;rsquo;s literally a no-brainer.&lt;/p>
&lt;h2 id="testing-your-way-to-a-great-django-application" class="anchor-link">&lt;a href="#testing-your-way-to-a-great-django-application">Testing your way to a great Django application&lt;/a>&lt;/h2>
&lt;p>Tests are extremely important, and underappreciated. They can catch logical errors in your application. They can help explain and validate how concepts and features of your product actually function. Best of all, tests can boost developer confidence and development velocity as a result.&lt;/p>
&lt;p>The best tests are ones that are relevant, help to explain and define your application, and are run continuously without a second thought. I hope I&amp;rsquo;ve now shown you how testing in Django can help you to achieve these goals for your team!&lt;/p></content:encoded><enclosure url="https://victoria.dev/blog/increase-developer-confidence-with-a-great-django-test-suite/cover_hu9adcaffd30c4a555a26c2259090a851f_467188_640x0_resize_box_2.png" type="image/jpg"/></item><item><title>Django project best practices to keep your developers happy</title><link>https://victoria.dev/blog/django-project-best-practices-to-keep-your-developers-happy/</link><pubDate>Tue, 22 Sep 2020 04:55:19 -0400</pubDate><author>hello@victoria.dev (Victoria Drake)</author><guid>https://victoria.dev/blog/django-project-best-practices-to-keep-your-developers-happy/</guid><description>Using Makefiles, pre-commit, and GitHub Actions to help create a happy development team.</description><content:encoded>
&lt;img src="https://victoria.dev/blog/django-project-best-practices-to-keep-your-developers-happy/cover_hucf6d66bfa051c0e7be28ef48b4d9b6bd_395008_640x0_resize_box_2.png" width="640" height="320"/>
&lt;p>Do you want your team to &lt;em>enjoy&lt;/em> your development workflow? Do you think building software should be &lt;em>fun and existentially fulfilling?&lt;/em> If so, &lt;em>this is the post&lt;/em> for you!&lt;/p>
&lt;p>I&amp;rsquo;ve been developing with Django for years, and I&amp;rsquo;ve never been happier with my Django project set up than I am right now. Here&amp;rsquo;s how I&amp;rsquo;m making a day of developing with Django the most relaxing and enjoyable development experience possible for myself and my engineering team.&lt;/p>
&lt;h2 id="a-custom-cli-tool-for-your-django-project" class="anchor-link">&lt;a href="#a-custom-cli-tool-for-your-django-project">A custom CLI tool for your Django project&lt;/a>&lt;/h2>
&lt;p>Instead of typing:&lt;/p>
&lt;div class="highlight">&lt;pre class="chroma">&lt;code class="language-sh" data-lang="sh">python3 -m venv env
&lt;span class="nb">source&lt;/span> env/bin/activate
pip install -r requirements.txt
python3 manage.py makemigrations
python3 manage.py migrate
python3 manage.py collectstatic
python3 manage.py runserver
&lt;/code>&lt;/pre>&lt;/div>&lt;p>Wouldn&amp;rsquo;t it be much nicer to type:&lt;/p>
&lt;div class="highlight">&lt;pre class="chroma">&lt;code class="language-sh" data-lang="sh">make start
&lt;/code>&lt;/pre>&lt;/div>&lt;p>&amp;hellip;and have all that happen for you? I think so!&lt;/p>
&lt;p>We can do that with a self-documenting Makefile! Here&amp;rsquo;s one I frequently use when developing my Django applications, like &lt;a href="https://applybyapi.com/">ApplyByAPI.com&lt;/a>:&lt;/p>
&lt;div class="highlight">&lt;pre class="chroma">&lt;code class="language-Makefile" data-lang="Makefile">&lt;span class="nv">SHELL&lt;/span> &lt;span class="o">:=&lt;/span> /bin/bash
&lt;span class="err">include&lt;/span> &lt;span class="err">.env&lt;/span>
&lt;span class="nf">.PHONY&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="n">help&lt;/span>
&lt;span class="nf">help&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="c">## Show this help
&lt;/span>&lt;span class="c">&lt;/span> @egrep -h &lt;span class="s1">&amp;#39;\s##\s&amp;#39;&lt;/span> &lt;span class="k">$(&lt;/span>MAKEFILE_LIST&lt;span class="k">)&lt;/span> &lt;span class="p">|&lt;/span> awk &lt;span class="s1">&amp;#39;BEGIN {FS = &amp;#34;:.*?## &amp;#34;}; {printf &amp;#34;\033[36m%-20s\033[0m %s\n&amp;#34;, $$1, $$2}&amp;#39;&lt;/span>
&lt;span class="nf">.PHONY&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="n">venv&lt;/span>
&lt;span class="nf">venv&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="c">## Make a new virtual environment
&lt;/span>&lt;span class="c">&lt;/span> python3 -m venv &lt;span class="k">$(&lt;/span>VENV&lt;span class="k">)&lt;/span> &lt;span class="o">&amp;amp;&amp;amp;&lt;/span> &lt;span class="nb">source&lt;/span> &lt;span class="k">$(&lt;/span>BIN&lt;span class="k">)&lt;/span>/activate
&lt;span class="nf">.PHONY&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="n">install&lt;/span>
&lt;span class="nf">install&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="n">venv&lt;/span> &lt;span class="c">## Make venv and install requirements
&lt;/span>&lt;span class="c">&lt;/span> &lt;span class="k">$(&lt;/span>BIN&lt;span class="k">)&lt;/span>/pip install -r requirements.txt
&lt;span class="nf">migrate&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="c">## Make and run migrations
&lt;/span>&lt;span class="c">&lt;/span> &lt;span class="k">$(&lt;/span>PYTHON&lt;span class="k">)&lt;/span> manage.py makemigrations
&lt;span class="k">$(&lt;/span>PYTHON&lt;span class="k">)&lt;/span> manage.py migrate
&lt;span class="nf">db-up&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="c">## Pull and start the Docker Postgres container in the background
&lt;/span>&lt;span class="c">&lt;/span> docker pull postgres
docker-compose up -d
&lt;span class="nf">db-shell&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="c">## Access the Postgres Docker database interactively with psql
&lt;/span>&lt;span class="c">&lt;/span> docker &lt;span class="nb">exec&lt;/span> -it container_name psql -d &lt;span class="k">$(&lt;/span>DBNAME&lt;span class="k">)&lt;/span>
&lt;span class="nf">.PHONY&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="n">test&lt;/span>
&lt;span class="nf">test&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="c">## Run tests
&lt;/span>&lt;span class="c">&lt;/span> &lt;span class="k">$(&lt;/span>PYTHON&lt;span class="k">)&lt;/span> &lt;span class="k">$(&lt;/span>APP_DIR&lt;span class="k">)&lt;/span>/manage.py &lt;span class="nb">test&lt;/span> application --verbosity&lt;span class="o">=&lt;/span>&lt;span class="m">0&lt;/span> --parallel --failfast
&lt;span class="nf">.PHONY&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="n">run&lt;/span>
&lt;span class="nf">run&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="c">## Run the Django server
&lt;/span>&lt;span class="c">&lt;/span> &lt;span class="k">$(&lt;/span>PYTHON&lt;span class="k">)&lt;/span> &lt;span class="k">$(&lt;/span>APP_DIR&lt;span class="k">)&lt;/span>/manage.py runserver
&lt;span class="nf">start&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="n">install&lt;/span> &lt;span class="n">migrate&lt;/span> &lt;span class="n">run&lt;/span> &lt;span class="c">## Install requirements, apply migrations, then start development server
&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>You&amp;rsquo;ll notice the presence of the line &lt;code>include .env&lt;/code> above. This ensures &lt;code>make&lt;/code> has access to environment variables stored in a file called &lt;code>.env&lt;/code>. This allows Make to utilize these variables in its commands, for example, the name of my virtual environment, or to pass in &lt;code>$(DBNAME)&lt;/code> to &lt;code>psql&lt;/code>.&lt;/p>
&lt;p>What&amp;rsquo;s with that weird &amp;ldquo;&lt;code>##&lt;/code>&amp;rdquo; comment syntax? A Makefile like this gives you a handy suite of command-line aliases you can check in to your Django project. It&amp;rsquo;s very useful so long as you&amp;rsquo;re able to remember what all those aliases are.&lt;/p>
&lt;p>The &lt;code>help&lt;/code> command above, which runs by default, prints a helpful list of available commands when you run &lt;code>make&lt;/code> or &lt;code>make help&lt;/code>:&lt;/p>
&lt;div class="highlight">&lt;pre class="chroma">&lt;code class="language-text" data-lang="text">help Show this help
venv Make a new virtual environment
install Make venv and install requirements
migrate Make and run migrations
db-up Pull and start the Docker Postgres container in the background
db-shell Access the Postgres Docker database interactively with psql
test Run tests
run Run the Django server
start Install requirements, apply migrations, then start development server
&lt;/code>&lt;/pre>&lt;/div>&lt;p>All the usual Django commands are covered, and we&amp;rsquo;ve got a &lt;code>test&lt;/code> command that runs our tests with the options we prefer. Brilliant.&lt;/p>
&lt;p>You can read my full &lt;a href="https://victoria.dev/blog/how-to-create-a-self-documenting-makefile/">post about self-documenting Makefiles here&lt;/a>, which also includes an example Makefile using &lt;code>pipenv&lt;/code>.&lt;/p>
&lt;h2 id="save-your-brainpower-with-pre-commit-hooks" class="anchor-link">&lt;a href="#save-your-brainpower-with-pre-commit-hooks">Save your brainpower with pre-commit hooks&lt;/a>&lt;/h2>
&lt;p>I previously wrote about some &lt;a href="https://victoria.dev/blog/technical-ergonomics-for-the-efficient-developer/">technical ergonomics&lt;/a> that can make it a lot easier for teams to develop great software.&lt;/p>
&lt;p>One area that&amp;rsquo;s a no-brainer is using pre-commit hooks to lint code prior to checking it in. This helps to ensure the quality of the code your developers check in, but most importantly, ensures that no one on your team is spending time trying to remember if it should be single or double quotes or where to put a line break.&lt;/p>
&lt;p>The confusingly-named &lt;a href="https://pre-commit.com/">pre-commit framework&lt;/a> is an otherwise fantastic way to keep hooks (which are not included in cloned repositories) consistent across local environments.&lt;/p>
&lt;p>Here is my configuration file, &lt;code>.pre-commit-config.yaml&lt;/code>, for my Django projects:&lt;/p>
&lt;div class="highlight">&lt;pre class="chroma">&lt;code class="language-yaml" data-lang="yaml">&lt;span class="nt">fail_fast&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="kc">true&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w">&lt;/span>&lt;span class="nt">repos&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>- &lt;span class="nt">repo&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">https://github.com/pre-commit/pre-commit-hooks&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nt">rev&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">v3.1.0&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nt">hooks&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>- &lt;span class="nt">id&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">detect-aws-credentials&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>- &lt;span class="nt">repo&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">https://github.com/psf/black&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nt">rev&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="m">19.&lt;/span>&lt;span class="l">3b0&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nt">hooks&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>- &lt;span class="nt">id&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">black&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>- &lt;span class="nt">repo&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">https://github.com/asottile/blacken-docs&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nt">rev&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">v1.7.0&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nt">hooks&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>- &lt;span class="nt">id&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">blacken-docs&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nt">additional_dependencies&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="l">black==19.3b0]&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>- &lt;span class="nt">repo&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">local&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nt">hooks&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>- &lt;span class="nt">id&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">markdownlint&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nt">name&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">markdownlint&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nt">description&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="s2">&amp;#34;Lint Markdown files&amp;#34;&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nt">entry&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">markdownlint &amp;#39;**/*.md&amp;#39; --fix --ignore node_modules --config &amp;#34;./.markdownlint.json&amp;#34;&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nt">language&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">node&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nt">types&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="l">markdown]&lt;/span>&lt;span class="w">
&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>These hooks check for accidental secret commits, format Python files using &lt;a href="https://github.com/psf/black">Black&lt;/a>, format Python snippets in Markdown files using &lt;a href="https://github.com/asottile/blacken-docs">&lt;code>blacken-docs&lt;/code>&lt;/a>, and &lt;a href="https://github.com/igorshubovych/markdownlint-cli">lint Markdown files&lt;/a> as well.&lt;/p>
&lt;p>There are likely even more useful hooks available for your particular use case: see &lt;a href="https://pre-commit.com/hooks.html">supported hooks&lt;/a> to explore.&lt;/p>
&lt;h2 id="useful-gitignores" class="anchor-link">&lt;a href="#useful-gitignores">Useful gitignores&lt;/a>&lt;/h2>
&lt;p>An underappreciated way to improve your team&amp;rsquo;s daily development experience is to make sure your project uses a well-rounded &lt;code>.gitignore&lt;/code> file. It can help prevent files containing secrets from being committed, and can additionally save developers hours of tedium by ensuring you&amp;rsquo;re never sifting through a &lt;code>git diff&lt;/code> of generated files.&lt;/p>
&lt;p>To efficiently create a &lt;a href="https://www.toptal.com/developers/gitignore/api/python,django">gitignore for Python and Django projects&lt;/a>, Toptal&amp;rsquo;s &lt;a href="https://gitignore.io">gitignore.io&lt;/a> can be a nice resource for generating a robust &lt;code>.gitignore&lt;/code> file.&lt;/p>
&lt;p>I still recommend examining the generated results yourself to ensure that ignored files suit your use case, and that nothing you want ignored is commented out.&lt;/p>
&lt;h2 id="continuous-testing-with-github-actions" class="anchor-link">&lt;a href="#continuous-testing-with-github-actions">Continuous testing with GitHub Actions&lt;/a>&lt;/h2>
&lt;p>If your team works on GitHub, setting up a testing process with Actions is low-hanging fruit.&lt;/p>
&lt;p>Tests that run in a consistent environment on every pull request can help eliminate &amp;ldquo;works on my machine&amp;rdquo; conundrums, as well as ensure no one&amp;rsquo;s sitting around waiting for a test to run locally.&lt;/p>
&lt;p>A hosted CI environment like GitHub Actions can also help when running integration tests that require using managed services resources. You can use &lt;a href="https://docs.github.com/en/actions/configuring-and-managing-workflows/creating-and-storing-encrypted-secrets">encrypted secrets in a repository&lt;/a> to grant the Actions runner access to resources in a testing environment, without worrying about creating testing resources and access keys for each of your developers to use.&lt;/p>
&lt;p>I&amp;rsquo;ve written on many occasions about setting up Actions workflows, including &lt;a href="https://victoria.dev/blog/a-lightweight-tool-agnostic-ci/cd-flow-with-github-actions/">using one to run your Makefile&lt;/a>, and &lt;a href="https://victoria.dev/blog/publishing-github-event-data-with-github-actions-and-pages/">how to integrate GitHub event data&lt;/a>. GitHub even &lt;a href="https://github.blog/2020-06-26-github-action-hero-victoria-drake/">interviewed me about Actions&lt;/a> once.&lt;/p>
&lt;p>For Django projects, here&amp;rsquo;s a GitHub Actions workflow that runs tests with a consistent Python version whenever someone opens a pull request in the repository.&lt;/p>
&lt;div class="highlight">&lt;pre class="chroma">&lt;code class="language-yaml" data-lang="yaml">&lt;span class="nt">name&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">Run Django tests&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w">&lt;/span>&lt;span class="nt">on&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">pull_request&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w">&lt;/span>&lt;span class="nt">jobs&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nt">test&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nt">runs-on&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">ubuntu-latest&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nt">steps&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>- &lt;span class="nt">uses&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">actions/checkout@v2&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>- &lt;span class="nt">name&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">Set up Python&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nt">uses&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">actions/setup-python@v2&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nt">with&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nt">python-version&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="s1">&amp;#39;3.8&amp;#39;&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>- &lt;span class="nt">name&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">Install dependencies&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nt">run&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">make install&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>- &lt;span class="nt">name&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">Run tests&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nt">run&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">make test&lt;/span>&lt;span class="w">
&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>For the installation and test commands, I&amp;rsquo;ve simply utilized the &lt;a href="#a-custom-cli-tool-for-your-django-project">Makefile&lt;/a> that&amp;rsquo;s been checked in to the repository. A benefit of using your Makefile commands in your CI test workflows is that you only need to keep them updated in one place &amp;ndash; your Makefile! No more &amp;ldquo;why is this working locally but not in CI??!?&amp;rdquo; headaches.&lt;/p>
&lt;p>If you want to step up your security game, you can add &lt;a href="https://github.com/victoriadrake/django-security-check">Django Security Check&lt;/a> as an Action too.&lt;/p>
&lt;h2 id="set-up-your-django-project-for-success" class="anchor-link">&lt;a href="#set-up-your-django-project-for-success">Set up your Django project for success&lt;/a>&lt;/h2>
&lt;p>Want to help keep your development team happy? Set them up for success with these best practices for Django development. Remember, an ounce of brainpower is worth a pound of software!&lt;/p></content:encoded><enclosure url="https://victoria.dev/blog/django-project-best-practices-to-keep-your-developers-happy/cover_hucf6d66bfa051c0e7be28ef48b4d9b6bd_395008_640x0_resize_box_2.png" type="image/jpg"/></item><item><title>Manipulating data with Django migrations</title><link>https://victoria.dev/blog/manipulating-data-with-django-migrations/</link><pubDate>Mon, 14 Sep 2020 02:12:57 -0400</pubDate><author>hello@victoria.dev (Victoria Drake)</author><guid>https://victoria.dev/blog/manipulating-data-with-django-migrations/</guid><description>How to update Django models and manipulate existing data using migrations.</description><content:encoded>
&lt;img src="https://victoria.dev/blog/manipulating-data-with-django-migrations/cover_hu0fb1319bf722fb9b3f3bf5ca6dac0f16_467744_640x0_resize_box_2.png" width="640" height="320"/>
&lt;p>Growing, successful applications are a lovely problem to have. As a product develops, it tends to accumulate complication the way your weekend cake project accumulates layers of frosting. Thankfully, Django, my favorite batteries-included framework, handles complexity pretty well.&lt;/p>
&lt;p>Django &lt;a href="https://victoria.dev/blog/writing-efficient-django/#django-models">models help humans work with data in a way that makes sense to our brains&lt;/a>, and the framework offers plenty of classes you can inherit to help you rapidly develop a robust application from scratch. As for developing on existing Django applications, there&amp;rsquo;s a feature for that, too. In this article, we&amp;rsquo;ll cover how to use Django migrations to update your existing models and database.&lt;/p>
&lt;h2 id="whats-under-the-hood" class="anchor-link">&lt;a href="#whats-under-the-hood">What&amp;rsquo;s under the hood&lt;/a>&lt;/h2>
&lt;p>Django migrations are Python files that help you add and change things in your database tables to reflect changes in your Django models. To understand how Django migrations help you work with data, it may be helpful to understand the underlying structures we&amp;rsquo;re working with.&lt;/p>
&lt;h3 id="whats-a-database-table" class="anchor-link">&lt;a href="#whats-a-database-table">What&amp;rsquo;s a database table&lt;/a>&lt;/h3>
&lt;p>If you&amp;rsquo;ve laid eyes on a spreadsheet before, you&amp;rsquo;re already most of the way to understanding a database table. In a relational database, for example, a PostgreSQL database, you can expect to see data organized into columns and rows. A relational database table may have a set number of columns and any number of rows.&lt;/p>
&lt;p>In Django, each model is its own table. For example, here&amp;rsquo;s a Django model:&lt;/p>
&lt;div class="highlight">&lt;pre class="chroma">&lt;code class="language-python" data-lang="python">&lt;span class="kn">from&lt;/span> &lt;span class="nn">django.db&lt;/span> &lt;span class="kn">import&lt;/span> &lt;span class="n">models&lt;/span>
&lt;span class="k">class&lt;/span> &lt;span class="nc">Lunch&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">models&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">Model&lt;/span>&lt;span class="p">):&lt;/span>
&lt;span class="n">left_side&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">models&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">CharField&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">max_length&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="mi">100&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">null&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="bp">True&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="n">center&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">models&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">CharField&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">max_length&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="mi">100&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">null&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="bp">True&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="n">right_side&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">models&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">CharField&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">max_length&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="mi">100&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">null&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="bp">True&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>Each field is a column, and each row is a Django object instance of that model. Here&amp;rsquo;s a representation of a database table for the Django model &amp;ldquo;Lunch&amp;rdquo; above. In the database, its name would be &lt;code>lunch_table&lt;/code>.&lt;/p>
&lt;table>
&lt;thead>
&lt;tr>
&lt;th>id&lt;/th>
&lt;th>left_side&lt;/th>
&lt;th>center&lt;/th>
&lt;th>right_side&lt;/th>
&lt;/tr>
&lt;/thead>
&lt;tbody>
&lt;tr>
&lt;td>1&lt;/td>
&lt;td>Fork&lt;/td>
&lt;td>Plate&lt;/td>
&lt;td>Spoon&lt;/td>
&lt;/tr>
&lt;/tbody>
&lt;/table>
&lt;p>The model &lt;code>Lunch&lt;/code> has three fields: &lt;code>left_side&lt;/code>, &lt;code>center&lt;/code>, and &lt;code>right-side&lt;/code>. One instance of a &lt;code>Lunch&lt;/code> object would have &amp;ldquo;Fork&amp;rdquo; for the &lt;code>left_side&lt;/code>, a &amp;ldquo;Plate&amp;rdquo; for the &lt;code>center&lt;/code>, and &amp;ldquo;Spoon&amp;rdquo; for the &lt;code>right_side&lt;/code>. Django &lt;a href="https://docs.djangoproject.com/en/3.1/topics/db/models/#automatic-primary-key-fields">automatically adds an &lt;code>id&lt;/code> field&lt;/a> if you don&amp;rsquo;t specify a primary key.&lt;/p>
&lt;p>If you wanted to change the name of your Lunch model, you would do so in your &lt;code>models.py&lt;/code> code. For example, change &amp;ldquo;Lunch&amp;rdquo; to &amp;ldquo;Dinner,&amp;rdquo; then &lt;a href="https://docs.djangoproject.com/en/3.1/ref/django-admin/#makemigrations">run &lt;code>python manage.py makemigrations&lt;/code>&lt;/a>. You&amp;rsquo;ll see:&lt;/p>
&lt;div class="highlight">&lt;pre class="chroma">&lt;code class="language-text" data-lang="text">python manage.py makemigrations
Did you rename the backend.Lunch model to Dinner? [y/N] y
Migrations for &amp;#39;backend&amp;#39;:
backend/migrations/0003_auto_20200922_2331.py
- Rename model Lunch to Dinner
&lt;/code>&lt;/pre>&lt;/div>&lt;p>Django automatically generates the appropriate migration files. The relevant line of the generated migrations file in this case would look like:&lt;/p>
&lt;div class="highlight">&lt;pre class="chroma">&lt;code class="language-python" data-lang="python">&lt;span class="n">migrations&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">RenameModel&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">old_name&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s2">&amp;#34;Lunch&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">new_name&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s2">&amp;#34;Dinner&amp;#34;&lt;/span>&lt;span class="p">),&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>This operation would rename our &amp;ldquo;Lunch&amp;rdquo; model to &amp;ldquo;Dinner&amp;rdquo; while keeping everything else the same. But what if you also wanted to change the structure of the database table itself, its schema, as well as make sure that existing data ends up in the right place on your Dinner table?&lt;/p>
&lt;p>Let&amp;rsquo;s explore how to turn our Lunch model into a Dinner model that looks like this:&lt;/p>
&lt;div class="highlight">&lt;pre class="chroma">&lt;code class="language-python" data-lang="python">&lt;span class="kn">from&lt;/span> &lt;span class="nn">django.db&lt;/span> &lt;span class="kn">import&lt;/span> &lt;span class="n">models&lt;/span>
&lt;span class="k">class&lt;/span> &lt;span class="nc">Dinner&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">models&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">Model&lt;/span>&lt;span class="p">):&lt;/span>
&lt;span class="n">top_left&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">models&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">CharField&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">max_length&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="mi">100&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">null&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="bp">True&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="n">top_center&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">models&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">CharField&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">max_length&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="mi">100&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">null&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="bp">True&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="n">top_right&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">models&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">CharField&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">max_length&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="mi">100&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">null&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="bp">True&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="n">bottom_left&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">models&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">CharField&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">max_length&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="mi">100&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">null&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="bp">True&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="n">bottom_center&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">models&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">CharField&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">max_length&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="mi">100&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">null&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="bp">True&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="n">bottom_right&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">models&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">CharField&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">max_length&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="mi">100&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">null&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="bp">True&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>&amp;hellip;with a database table that would look like this:&lt;/p>
&lt;table>
&lt;thead>
&lt;tr>
&lt;th>id&lt;/th>
&lt;th>top_left&lt;/th>
&lt;th>top_center&lt;/th>
&lt;th>top_right&lt;/th>
&lt;th>bottom_left&lt;/th>
&lt;th>bottom_center&lt;/th>
&lt;th>bottom_right&lt;/th>
&lt;/tr>
&lt;/thead>
&lt;tbody>
&lt;tr>
&lt;td>1&lt;/td>
&lt;td>Bread plate&lt;/td>
&lt;td>Spoon&lt;/td>
&lt;td>Glass&lt;/td>
&lt;td>Fork&lt;/td>
&lt;td>Plate&lt;/td>
&lt;td>Knife&lt;/td>
&lt;/tr>
&lt;/tbody>
&lt;/table>
&lt;h2 id="manipulating-data-with-django-migrations" class="anchor-link">&lt;a href="#manipulating-data-with-django-migrations">Manipulating data with Django migrations&lt;/a>&lt;/h2>
&lt;p>Before you begin to manipulate your data, it&amp;rsquo;s always a good idea to create a backup of your database that you can restore in case something goes wrong. There are various ways to do this depending on the database you&amp;rsquo;re using. You can typically find instructions by searching for &lt;code>&amp;lt;your database name&amp;gt;&lt;/code> and keywords like &lt;code>backup&lt;/code>, &lt;code>recovery&lt;/code>, or &lt;code>snapshot&lt;/code>.&lt;/p>
&lt;p>In order to design your migration, it&amp;rsquo;s helpful to become familiar with the available &lt;a href="https://docs.djangoproject.com/en/3.1/ref/migration-operations/">migration operations&lt;/a>. Migrations are run step-by-step, and each operation is some flavor of adding, removing, or altering data. Like a strategic puzzle, it&amp;rsquo;s important to make model changes one step at a time so that the generated migrations have the correct result.&lt;/p>
&lt;p>We&amp;rsquo;ve already renamed our model successfully. Now, we&amp;rsquo;ll rename the fields that hold the data we want to retain:&lt;/p>
&lt;div class="highlight">&lt;pre class="chroma">&lt;code class="language-python" data-lang="python">&lt;span class="k">class&lt;/span> &lt;span class="nc">Dinner&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">models&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">Model&lt;/span>&lt;span class="p">):&lt;/span>
&lt;span class="n">bottom_left&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">models&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">CharField&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">max_length&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="mi">100&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">null&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="bp">True&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="n">bottom_center&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">models&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">CharField&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">max_length&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="mi">100&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">null&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="bp">True&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="n">top_center&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">models&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">CharField&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">max_length&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="mi">100&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">null&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="bp">True&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>Django is sometimes smart enough to determine the old and new field names correctly. You&amp;rsquo;ll be asked for confirmation:&lt;/p>
&lt;div class="highlight">&lt;pre class="chroma">&lt;code class="language-text" data-lang="text">python manage.py makemigrations
Did you rename dinner.center to dinner.bottom_center (a CharField)? [y/N] y
Did you rename dinner.left_side to dinner.bottom_left (a CharField)? [y/N] y
Did you rename dinner.right_side to dinner.top_center (a CharField)? [y/N] y
Migrations for &amp;#39;backend&amp;#39;:
backend/migrations/0004_auto_20200914_2345.py
- Rename field center on dinner to bottom_center
- Rename field left_side on dinner to bottom_left
- Rename field right_side on dinner to top_center
&lt;/code>&lt;/pre>&lt;/div>&lt;p>In some cases, you&amp;rsquo;ll want to try renaming the field and running &lt;code>makemigrations&lt;/code> one at a time.&lt;/p>
&lt;p>Now that the existing fields have been migrated to their new names, add the remaining fields to the model:&lt;/p>
&lt;div class="highlight">&lt;pre class="chroma">&lt;code class="language-python" data-lang="python">&lt;span class="k">class&lt;/span> &lt;span class="nc">Dinner&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">models&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">Model&lt;/span>&lt;span class="p">):&lt;/span>
&lt;span class="n">top_left&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">models&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">CharField&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">max_length&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="mi">100&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">null&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="bp">True&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="n">top_center&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">models&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">CharField&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">max_length&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="mi">100&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">null&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="bp">True&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="n">top_right&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">models&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">CharField&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">max_length&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="mi">100&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">null&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="bp">True&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="n">bottom_left&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">models&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">CharField&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">max_length&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="mi">100&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">null&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="bp">True&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="n">bottom_center&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">models&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">CharField&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">max_length&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="mi">100&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">null&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="bp">True&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="n">bottom_right&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">models&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">CharField&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">max_length&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="mi">100&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">null&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="bp">True&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>Running &lt;code>makemigrations&lt;/code> again now gives us:&lt;/p>
&lt;div class="highlight">&lt;pre class="chroma">&lt;code class="language-text" data-lang="text">python manage.py makemigrations
Migrations for &amp;#39;backend&amp;#39;:
backend/migrations/0005_auto_20200914_2351.py
- Add field bottom_right to dinner
- Add field top_left to dinner
- Add field top_right to dinner
&lt;/code>&lt;/pre>&lt;/div>&lt;p>You&amp;rsquo;re done! By generating Django migrations, you&amp;rsquo;ve successfully set up your &lt;code>dinner_table&lt;/code> and moved existing data to its new spot.&lt;/p>
&lt;h2 id="additional-complexity" class="anchor-link">&lt;a href="#additional-complexity">Additional complexity&lt;/a>&lt;/h2>
&lt;p>You&amp;rsquo;ll notice that our Lunch and Dinner models are not very complex. Out of Django&amp;rsquo;s many &lt;a href="https://docs.djangoproject.com/en/3.1/ref/models/fields/#field-types">model field options&lt;/a>, we&amp;rsquo;re just using &lt;code>CharField&lt;/code>. We also set &lt;code>null=True&lt;/code> to let Django store empty values as &lt;code>NULL&lt;/code> in the database.&lt;/p>
&lt;p>Django migrations can handle additional complexity, such as changing field types, and whether a blank or null value is permitted. I keep Django&amp;rsquo;s &lt;a href="https://docs.djangoproject.com/en/3.1/ref/models/fields/#">model field reference&lt;/a> handy as I work with varying types of data and different use cases.&lt;/p>
&lt;h2 id="de-mystified-migrations" class="anchor-link">&lt;a href="#de-mystified-migrations">De-mystified migrations&lt;/a>&lt;/h2>
&lt;p>I hope this article has helped you better understand Django migrations and how they work!&lt;/p>
&lt;p>Now that you can change models and manipulate existing data in your Django application, be sure to use your powers wisely! Backup your database, research and plan your migrations, and always run tests before working with customer data. By doing so, you have the potential to enable your application to grow &amp;ndash; with manageable levels of complexity.&lt;/p></content:encoded><enclosure url="https://victoria.dev/blog/manipulating-data-with-django-migrations/cover_hu0fb1319bf722fb9b3f3bf5ca6dac0f16_467744_640x0_resize_box_2.png" type="image/jpg"/></item><item><title>What is TLS? Transport Layer Security encryption explained in plain english</title><link>https://victoria.dev/blog/what-is-tls-transport-layer-security-encryption-explained-in-plain-english/</link><pubDate>Sat, 05 Sep 2020 04:48:39 -0600</pubDate><author>hello@victoria.dev (Victoria Drake)</author><guid>https://victoria.dev/blog/what-is-tls-transport-layer-security-encryption-explained-in-plain-english/</guid><description>How TLS, digital certificates, and sessions help keep communications secure.</description><content:encoded>
&lt;img src="https://victoria.dev/blog/what-is-tls-transport-layer-security-encryption-explained-in-plain-english/cover_hu894d41c5ce9f3ab36a8b926bfa4bc68c_671316_640x0_resize_box_2.png" width="640" height="320"/>
&lt;p>If you want to have a confidential conversation with someone you know, you might meet up in person and find a private place to talk. If you want to send data confidentially over the Internet, you might have a few more considerations to cover.&lt;/p>
&lt;p>TLS, or Transport Layer Security, refers to a protocol. &amp;ldquo;Protocol&amp;rdquo; is a word that means, &amp;ldquo;the way we&amp;rsquo;ve agreed to do things around here,&amp;rdquo; more or less. The &amp;ldquo;transport layer&amp;rdquo; part of TLS simply refers to host-to-host communication, such as how a client and a server interact, in the &lt;a href="https://en.wikipedia.org/wiki/Internet_protocol_suite">Internet protocol suite model&lt;/a>.&lt;/p>
&lt;p>The TLS protocol attempts to solve these fundamental problems:&lt;/p>
&lt;ul>
&lt;li>How do I know you are who you say you are?&lt;/li>
&lt;li>How do I know this message from you hasn&amp;rsquo;t been tampered with?&lt;/li>
&lt;li>How can we communicate securely?&lt;/li>
&lt;/ul>
&lt;p>Here&amp;rsquo;s how TLS works, explained in plain English. As with many successful interactions, it begins with a handshake.&lt;/p>
&lt;h2 id="getting-to-know-you" class="anchor-link">&lt;a href="#getting-to-know-you">Getting to know you&lt;/a>&lt;/h2>
&lt;p>The basic process of a &lt;a href="https://en.wikipedia.org/wiki/Transport_Layer_Security#TLS_handshake">TLS handshake&lt;/a> involves a client, such as your web browser, and a server, such as one hosting a website, establishing some ground rules for communication. It begins with the client saying hello. Literally. It&amp;rsquo;s called a &lt;em>ClientHello&lt;/em> message.&lt;/p>
&lt;p>The &lt;em>ClientHello&lt;/em> message tells the server which TLS protocol version and &lt;em>cipher suites&lt;/em> it supports. While &amp;ldquo;cipher suite&amp;rdquo; sounds like a fancy hotel upgrade, it just refers to a set of algorithms that can be used to secure communications. The server, in a similarly named &lt;em>ServerHello&lt;/em> message, chooses the protocol version and cipher suite to use from the choices offered. Other data may also be sent, for example, a &lt;em>session ID&lt;/em> if the server supports resuming a previous handshake.&lt;/p>
&lt;p>
&lt;img src="https://victoria.dev/blog/what-is-tls-transport-layer-security-encryption-explained-in-plain-english/hello-hello.png" alt="A cartoon of a client and server saying hello" />
&lt;/p>
&lt;p>Depending on the cipher suite chosen, the client and server exchange further information in order to establish a shared secret. Often, this process moves the exchange from &lt;a href="https://en.wikipedia.org/wiki/Public-key_cryptography">asymmetric cryptography&lt;/a> to &lt;a href="https://en.wikipedia.org/wiki/Symmetric-key_algorithm">symmetric cryptography&lt;/a> with varying levels of complexity. Let&amp;rsquo;s explore these concepts at a general level and see why they matter to TLS.&lt;/p>
&lt;h2 id="asymmetric-beginnings" class="anchor-link">&lt;a href="#asymmetric-beginnings">Asymmetric beginnings&lt;/a>&lt;/h2>
&lt;p>This is asymmetry:&lt;/p>
&lt;figure>
&lt;img src="asymmetry-eggs.jpeg"
alt="A small egg and a big egg"/> &lt;figcaption>
&lt;p>Small egg, big egg.&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;p>Asymmetric cryptography is one method by which you can perform &lt;em>authentication&lt;/em>. When you authenticate yourself, you answer the fundamental question, &amp;ldquo;How do I know you are who you say you are?&amp;rdquo;&lt;/p>
&lt;p>In an asymmetric cryptographic system, you use a pair of keys in order to achieve authentication. These keys are asymmetric. One key is your public key, which, as you would guess, is public. The other is your private key, which &amp;ndash; well, you know.&lt;/p>
&lt;p>Typically, during the TLS handshake, the server will provide its public key via its digital certificate, sometimes still called its &lt;em>SSL certificate&lt;/em>, though TLS replaces the deprecated Secure Sockets Layer (SSL) protocol. Digital certificates are provided and verified by trusted third parties known as &lt;a href="https://en.wikipedia.org/wiki/Certificate_authority">Certificate Authorities (CA)&lt;/a>, which are a whole other article in themselves.&lt;/p>
&lt;p>While anyone may encrypt a message using your public key, only your private key can then decrypt that message. The security of asymmetric cryptography relies only on your private key staying private, hence the asymmetry. It&amp;rsquo;s also asymmetric in the sense that it&amp;rsquo;s a one-way trip. Alice can send messages encrypted with your public key to you, but neither of your keys will help you send an encrypted message to Alice.&lt;/p>
&lt;h2 id="symmetric-secrets" class="anchor-link">&lt;a href="#symmetric-secrets">Symmetric secrets&lt;/a>&lt;/h2>
&lt;p>Asymmetric cryptography also requires more computational resources than symmetric cryptography. Thus when a TLS handshake begins with an asymmetric exchange, the client and server will use this initial communication to establish a shared secret, sometimes called a &lt;em>session key&lt;/em>. This key is symmetric, meaning that both parties use the same shared secret and must maintain that secrecy for the encryption to be secure.&lt;/p>
&lt;figure>
&lt;img src="asym-vs-sym.png"
alt="A cartoon of public-key cryptography vs. shared-key cryptography"/> &lt;figcaption>
&lt;p>Wise man say: share your public key, but keep your shared keys private.&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;p>By using the initial asymmetric communication to establish a session key, the client and server can rely on the session key being known only to them. For the rest of the session, they&amp;rsquo;ll both use this same shared key to encrypt and decrypt messages, which speeds up communication.&lt;/p>
&lt;h2 id="secure-sessions" class="anchor-link">&lt;a href="#secure-sessions">Secure sessions&lt;/a>&lt;/h2>
&lt;p>A TLS handshake may use asymmetric cryptography or other cipher suites to establish the shared session key. Once the session key is established, the handshaking portion is complete and the session begins.&lt;/p>
&lt;p>The &lt;em>session&lt;/em> is the duration of encrypted communication between the client and server. During this time, messages are encrypted and decrypted using the session key that only the client and server have. This ensures that communication is secure.&lt;/p>
&lt;p>The integrity of exchanged information is maintained by using a checksum. Messages exchanged using session keys have a &lt;a href="https://en.wikipedia.org/wiki/Message_authentication_code">message authentication code (MAC)&lt;/a> attached. This is not the same thing as your device&amp;rsquo;s &lt;a href="https://en.wikipedia.org/wiki/MAC_address">MAC address&lt;/a>. The MAC is generated and verified using the session key. Because of this, either party can detect if a message has been changed before being received. This solves the fundamental question, &amp;ldquo;How do I know this message from you hasn&amp;rsquo;t been tampered with?&amp;rdquo;&lt;/p>
&lt;p>Sessions can end deliberately, due to network disconnection, or from the client staying idle for too long. Once a session ends, it must be re-established via a new handshake or through previously established secrets called &lt;em>session IDs&lt;/em> that allow resuming a session.&lt;/p>
&lt;h2 id="tls-and-you" class="anchor-link">&lt;a href="#tls-and-you">TLS and you&lt;/a>&lt;/h2>
&lt;p>Let&amp;rsquo;s recap:&lt;/p>
&lt;ul>
&lt;li>TLS is a cryptographic protocol for providing secure communication.&lt;/li>
&lt;li>The process of creating a secure connection begins with a handshake.&lt;/li>
&lt;li>The handshake establishes a shared session key that is then used to secure messages and provide message integrity.&lt;/li>
&lt;li>Sessions are temporary, and once ended, must be re-established or resumed.&lt;/li>
&lt;/ul>
&lt;p>This is just a surface-level skim of the very complex cryptographic systems that help to keep your communications secure. For more depth on the topic, I recommend exploring cipher suites and the various &lt;a href="https://en.wikipedia.org/wiki/Cipher_suite#Supported_algorithms">supported algorithms&lt;/a>.&lt;/p>
&lt;p>The TLS protocol serves a very important purpose in your everyday life. It helps to secure your emails to family, your online banking activities, and the connection by which you&amp;rsquo;re reading this article. The &lt;a href="https://en.wikipedia.org/wiki/HTTPS">HTTPS communication protocol&lt;/a> is encrypted using TLS. Every time you see that little lock icon in your URL bar, you&amp;rsquo;re experiencing firsthand all the concepts you&amp;rsquo;ve just read about in this article. Now you know the answer to the last question: &amp;ldquo;How can we communicate securely?&amp;rdquo;&lt;/p></content:encoded><enclosure url="https://victoria.dev/blog/what-is-tls-transport-layer-security-encryption-explained-in-plain-english/cover_hu894d41c5ce9f3ab36a8b926bfa4bc68c_671316_640x0_resize_box_2.png" type="image/jpg"/></item><item><title>Deceptively simple search-and-replace across multiple files</title><link>https://victoria.dev/blog/deceptively-simple-search-and-replace-across-multiple-files/</link><pubDate>Tue, 25 Aug 2020 04:48:39 -0600</pubDate><author>hello@victoria.dev (Victoria Drake)</author><guid>https://victoria.dev/blog/deceptively-simple-search-and-replace-across-multiple-files/</guid><description>How to interactively search-and-replace across many files with just two commands, thanks to Vim.</description><content:encoded>
&lt;img src="https://victoria.dev/blog/deceptively-simple-search-and-replace-across-multiple-files/cover_hu2763223a9424750a0554d09a461c1c86_349870_640x0_resize_box_2.png" width="640" height="256"/>
&lt;p>While a multitude of methods exist to search for and replace words in a single file, what do you do when you&amp;rsquo;ve got a string to update across multiple unrelated files, all with different names? You harness the power of command line tools, of course!&lt;/p>
&lt;p>First, you&amp;rsquo;ll need to &lt;code>find&lt;/code> all the files you want to change. Stringing together what are effectively search queries for &lt;code>find&lt;/code> is really only limited by your imagination. Here&amp;rsquo;s a simple example that finds Python files:&lt;/p>
&lt;div class="highlight">&lt;pre class="chroma">&lt;code class="language-sh" data-lang="sh">find . -name &lt;span class="s1">&amp;#39;*.py&amp;#39;&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>The &lt;code>-name&lt;/code> test searches for a pattern, such as all files ending in &lt;code>.py&lt;/code>, but &lt;code>find&lt;/code> can do a lot more with other test conditions, including &lt;code>-regex&lt;/code> tests. Run &lt;code>find --help&lt;/code> to see the multitude of options.&lt;/p>
&lt;p>Further tune your search by using &lt;code>grep&lt;/code> to get only the files that contain the string you want to change, such as by adding:&lt;/p>
&lt;div class="highlight">&lt;pre class="chroma">&lt;code class="language-sh" data-lang="sh">grep -le &lt;span class="s1">&amp;#39;\&amp;lt;a whale\&amp;gt;&amp;#39;&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>The &lt;code>-l&lt;/code> option gives you just the file names for all files containing a pattern (denoted with &lt;code>-e&lt;/code>) that match &amp;ldquo;a whale&amp;rdquo;.&lt;/p>
&lt;p>Using Vim&amp;rsquo;s impressive &lt;code>:bufdo&lt;/code> lets you run the same command across multiple buffers, interactively working with all of these files without the tedium of opening, saving, and closing each file, one at a time.&lt;/p>
&lt;p>Let&amp;rsquo;s plug your powerful &lt;code>find&lt;/code>+&lt;code>grep&lt;/code> results into Vim with:&lt;/p>
&lt;div class="highlight">&lt;pre class="chroma">&lt;code class="language-sh" data-lang="sh">vim &lt;span class="sb">`&lt;/span>find . -name &lt;span class="s1">&amp;#39;*.py&amp;#39;&lt;/span> &lt;span class="se">\
&lt;/span>&lt;span class="se">&lt;/span>-exec grep -le &lt;span class="s1">&amp;#39;\&amp;lt;a whale\&amp;gt;&amp;#39;&lt;/span> &lt;span class="o">{}&lt;/span> &lt;span class="se">\;&lt;/span>&lt;span class="sb">`&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>Using backtick-expansion to pass our search to Vim opens up multiple buffers ready to go. (Do &lt;code>:h backtick-expansion&lt;/code> in Vim for more.) Now you can apply the Vim command &lt;code>:bufdo&lt;/code> to all of these files and perform actions such as interactive search-and-replace:&lt;/p>
&lt;div class="highlight">&lt;pre class="chroma">&lt;code class="language-vim" data-lang="vim">&lt;span class="p">:&lt;/span>&lt;span class="nx">bufdo&lt;/span> %&lt;span class="nx">s&lt;/span>&lt;span class="sr">/a whale/&lt;/span>&lt;span class="nx">a&lt;/span> &lt;span class="nx">bowl&lt;/span> &lt;span class="nx">of&lt;/span> &lt;span class="nx">petunias&lt;/span>/&lt;span class="nx">gce&lt;/span>&lt;span class="err">
&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>The &lt;code>g&lt;/code> for &amp;ldquo;global&amp;rdquo; will change occurrences of the pattern on all lines. The &lt;code>e&lt;/code> will omit errors if the pattern is not found. The &lt;code>c&lt;/code> option makes this interactive; if you&amp;rsquo;re feeling confident, you can omit it to make the changes without reviewing each one.&lt;/p>
&lt;p>If one of the patterns contains a &lt;code>/&lt;/code> character, you can substitute the separator in the above command to make it more readable. Vim will assume the character following the &lt;code>%s&lt;/code> is the separator, so for example:&lt;/p>
&lt;div class="highlight">&lt;pre class="chroma">&lt;code class="language-vim" data-lang="vim">&lt;span class="p">:&lt;/span>&lt;span class="nx">bufdo&lt;/span> %&lt;span class="nx">s_a&lt;/span> &lt;span class="nx">whale_a&lt;/span> &lt;span class="nx">bowl&lt;/span> &lt;span class="nx">of&lt;/span> &lt;span class="nx">peonies&lt;/span>/&lt;span class="nx">petunias_gce&lt;/span>&lt;span class="err">
&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>When you&amp;rsquo;ve finished going through all the buffers, save all the work you&amp;rsquo;ve completed with:&lt;/p>
&lt;div class="highlight">&lt;pre class="chroma">&lt;code class="language-vim" data-lang="vim">&lt;span class="p">:&lt;/span>&lt;span class="nx">bufdo&lt;/span> &lt;span class="nx">wq&lt;/span>&lt;span class="p">!&lt;/span>&lt;span class="err">
&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>Then bask in the glory of your saved time and effort.&lt;/p></content:encoded><enclosure url="https://victoria.dev/blog/deceptively-simple-search-and-replace-across-multiple-files/cover_hu2763223a9424750a0554d09a461c1c86_349870_640x0_resize_box_2.png" type="image/jpg"/></item><item><title>How GitHub Codespaces increase productivity and lower barriers</title><link>https://victoria.dev/blog/how-github-codespaces-increase-productivity-and-lower-barriers/</link><pubDate>Sat, 15 Aug 2020 16:08:08 -0400</pubDate><author>hello@victoria.dev (Victoria Drake)</author><guid>https://victoria.dev/blog/how-github-codespaces-increase-productivity-and-lower-barriers/</guid><description>A look at how GitHub Codespaces can increase productivity and help new teammates and contributors start developing fast.</description><content:encoded>
&lt;img src="https://victoria.dev/blog/how-github-codespaces-increase-productivity-and-lower-barriers/cover_huc41ef5458caeabc0abbd2e9f70ab0970_112785_640x0_resize_box_2.png" width="640" height="246"/>
&lt;p>The most recent integration between Visual Studio Code and GitHub can help make development accessible and welcoming: Codespaces in GitHub!&lt;/p>
&lt;p>Now in beta, &lt;a href="https://docs.github.com/en/github/developing-online-with-codespaces/about-codespaces">GitHub Codespaces&lt;/a> provide an online, in-the-browser IDE powered by Visual Studio Code. This lets you use this full-featured IDE, complete with extensions, terminal, Git commands, and all the settings you&amp;rsquo;re accustomed to, on any machine. You can now bring your development workflow anywhere using a tablet or other browser-based device.&lt;/p>
&lt;p>Codespaces is great news for open source contributors, too. &lt;a href="https://docs.github.com/en/github/developing-online-with-codespaces/configuring-codespaces-for-your-project">Adding a codespace configuration&lt;/a> to your project is a great way to invite new folks to easily start contributing.&lt;/p>
&lt;p>A new open source contributor or new hire at your organization can quickly fire up a codespace and get hacking on a &lt;code>good first issue&lt;/code> with no local environment set up or installations necessary!&lt;/p>
&lt;p>
&lt;img src="https://victoria.dev/blog/how-github-codespaces-increase-productivity-and-lower-barriers/open-with-codespaces-button.png" alt="Starting a new codespace" />
&lt;/p>
&lt;p>We&amp;rsquo;ve added codespace configuration settings over at the &lt;a href="https://github.com/OWASP/wstg">OWASP Web Security Testing Guide (WSTG)&lt;/a>. Want to take it for a spin? See our &lt;a href="https://github.com/OWASP/wstg/issues">open issues&lt;/a>.&lt;/p>
&lt;h2 id="configuring-codespaces" class="anchor-link">&lt;a href="#configuring-codespaces">Configuring Codespaces&lt;/a>&lt;/h2>
&lt;p>You can use Visual Studio Code&amp;rsquo;s &lt;code>.devcontainer&lt;/code> folder to configure a development container for your repository as well.&lt;/p>
&lt;p>Many &lt;a href="https://github.com/microsoft/vscode-dev-containers/tree/master/containers">pre-built containers are available&lt;/a> &amp;ndash; just copy the &lt;code>.devcontainer&lt;/code> you need to your repository root. If your repository doesn&amp;rsquo;t have one, a &lt;a href="https://github.com/microsoft/vscode-dev-containers/tree/master/containers/codespaces-linux">default base Linux image&lt;/a> will be used.&lt;/p>
&lt;p>Here&amp;rsquo;s a reason to remove &lt;code>.vscode&lt;/code> from your &lt;code>.gitignore&lt;/code> file. Any new codespaces created in your repository will now respect settings found at &lt;code>.vscode/settings.json&lt;/code>. This means that your online IDE can have the same Workspace configuration as you have on your local machine. Isn&amp;rsquo;t that useful!&lt;/p>
&lt;h2 id="making-codespaces-personal" class="anchor-link">&lt;a href="#making-codespaces-personal">Making Codespaces personal&lt;/a>&lt;/h2>
&lt;p>For next-level &lt;a href="https://docs.github.com/en/github/developing-online-with-codespaces/personalizing-codespaces-for-your-account">dotfiles personalization&lt;/a>, consider committing relevant files from your local &lt;code>dotfiles&lt;/code> folder as a public GitHub repository at &lt;code>yourusername/dotfiles&lt;/code>.&lt;/p>
&lt;p>When you create a new codespace, this brings in your configurations, such as shell aliases and preferences, by creating symlinks to dotfiles in your codespace &lt;code>$HOME&lt;/code>. This personalizes all the codespaces you create in your account.&lt;/p>
&lt;p>Need some inspiration? Browse &lt;a href="https://github.com/victoriadrake/dotfiles">my dotfiles repository on GitHub&lt;/a>.&lt;/p>
&lt;p>&lt;a href="https://docs.github.com/en/github/developing-online-with-codespaces/developing-in-a-codespace">Developing in a codespace&lt;/a> is a familiar experience for Visual Studio Code users, right down to running an application locally.&lt;/p>
&lt;p>Thanks to &lt;a href="https://docs.github.com/en/github/developing-online-with-codespaces/developing-in-a-codespace">port forwarding&lt;/a>, when I run an application in a codespace terminal, clicking on the resulting &lt;code>localhost&lt;/code> URL takes me to the appropriate port as output from my codespace.&lt;/p>
&lt;p>When I&amp;rsquo;m working on this website in my codespace, for example, I run &lt;code>hugo serve&lt;/code> then click the provided &lt;code>localhost:1313&lt;/code> link to see a preview of my changes in another browser tab.&lt;/p>
&lt;p>Want to stay in sync between devices? There&amp;rsquo;s an extension for that. You can &lt;a href="https://docs.github.com/en/github/developing-online-with-codespaces/connecting-to-your-codespace-from-visual-studio-code">connect to your codespace from Visual Studio Code&lt;/a> on your local machine so you can always pick up right where you left off.&lt;/p>
&lt;h2 id="develop-anywhere" class="anchor-link">&lt;a href="#develop-anywhere">Develop anywhere&lt;/a>&lt;/h2>
&lt;p>Codespaces is a super exciting addition to my GitHub workflow. It allows me to access my full development process pretty much anywhere, using devices like my iPad.&lt;/p>
&lt;p>It&amp;rsquo;ll also make it easier for new open source contributors or new hires at your organization to hit the ground running with a set-up IDE. If you have access to the limited beta, I invite you to spin up a codespace and try &lt;a href="https://github.com/OWASP/wstg/issues">contributing to the WSTG&lt;/a>, or to &lt;a href="https://github.com/users/victoriadrake/projects/1">an issue on one of my open source projects&lt;/a>.&lt;/p>
&lt;p>I&amp;rsquo;m looking forward to general availability and seeing what the open source community will dream up for GitHub Codespaces next!&lt;/p>
&lt;p>And yes &amp;ndash; codespaces support &lt;a href="https://github.com/victoriadrake/kabukicho-vscode">your favorite Visual Studio Code theme&lt;/a>. &lt;/p>
&lt;figure class="screenshot">
&lt;img src="codespace.png"
alt="A screenshot of my codespace"/> &lt;figcaption>
&lt;p>Screenshot of a codespace with the Kabukich theme for Visual Studio Code&lt;/p>
&lt;/figcaption>
&lt;/figure></content:encoded><enclosure url="https://victoria.dev/blog/how-github-codespaces-increase-productivity-and-lower-barriers/cover_huc41ef5458caeabc0abbd2e9f70ab0970_112785_640x0_resize_box_2.png" type="image/jpg"/></item><item><title>How to create a self-documenting Makefile</title><link>https://victoria.dev/blog/how-to-create-a-self-documenting-makefile/</link><pubDate>Wed, 05 Aug 2020 08:55:19 -0400</pubDate><author>hello@victoria.dev (Victoria Drake)</author><guid>https://victoria.dev/blog/how-to-create-a-self-documenting-makefile/</guid><description>Accelerate your workflow and DevOps with command-line aliases you can check in</description><content:encoded>
&lt;img src="https://victoria.dev/blog/how-to-create-a-self-documenting-makefile/cover_hu5b5f7817443ceb3a2651ffd8837c3ef8_243813_640x0_resize_box_2.png" width="640" height="256"/>
&lt;p>My new favorite way to completely underuse a Makefile? Creating personalized, per-project repository workflow command aliases that you can check in.&lt;/p>
&lt;p>Can a Makefile improve your DevOps and keep developers happy? How awesome would it be if a new developer working on your project didn&amp;rsquo;t start out by copying and pasting commands from your README? What if instead of:&lt;/p>
&lt;div class="highlight">&lt;pre class="chroma">&lt;code class="language-sh" data-lang="sh">pip3 install pipenv
pipenv shell --python 3.8
pipenv install --dev
npm install
pre-commit install --install-hooks
&lt;span class="c1"># look up how to install Framework X...&lt;/span>
&lt;span class="c1"># copy and paste from README...&lt;/span>
npm run serve
&lt;/code>&lt;/pre>&lt;/div>&lt;p>&amp;hellip; you could just type:&lt;/p>
&lt;div class="highlight">&lt;pre class="chroma">&lt;code class="language-sh" data-lang="sh">make start
&lt;/code>&lt;/pre>&lt;/div>&lt;p>&amp;hellip;and then start working?&lt;/p>
&lt;h2 id="making-a-difference" class="anchor-link">&lt;a href="#making-a-difference">Making a difference&lt;/a>&lt;/h2>
&lt;p>I use &lt;code>make&lt;/code> every day to take the tedium out of common development activities like updating programs, installing dependencies, and testing. To do all this with a Makefile (GNU make), we use &lt;a href="https://www.gnu.org/software/make/manual/make.html#Rules">Makefile rules&lt;/a> and &lt;a href="https://www.gnu.org/software/make/manual/make.html#Recipes">recipes&lt;/a>. Similar parallels exist for POSIX flavor make, like &lt;a href="https://pubs.opengroup.org/onlinepubs/9699919799/utilities/make.html#tag_20_76_13_04">Target Rules&lt;/a>; here&amp;rsquo;s a &lt;a href="https://nullprogram.com/blog/2017/08/20/">great article&lt;/a> on POSIX-compatible Makefiles.&lt;/p>
&lt;p>Here&amp;rsquo;s some examples of things we can &lt;code>make&lt;/code> easier (sorry):&lt;/p>
&lt;div class="highlight">&lt;pre class="chroma">&lt;code class="language-Makefile" data-lang="Makefile">&lt;span class="nf">update&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="c">## Do apt upgrade and autoremove
&lt;/span>&lt;span class="c">&lt;/span> sudo apt update &lt;span class="o">&amp;amp;&amp;amp;&lt;/span> sudo apt upgrade -y
sudo apt autoremove -y
&lt;span class="nf">env&lt;/span>&lt;span class="o">:&lt;/span>
pip3 install pipenv
pipenv shell --python 3.8
&lt;span class="nf">install&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="c">## Install or update dependencies
&lt;/span>&lt;span class="c">&lt;/span> pipenv install --dev
npm install
pre-commit install --install-hooks
&lt;span class="nf">serve&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="c">## Run the local development server
&lt;/span>&lt;span class="c">&lt;/span> hugo serve --enableGitInfo --disableFastRender --environment development
&lt;span class="nf">initial&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="n">update&lt;/span> &lt;span class="n">env&lt;/span> &lt;span class="n">install&lt;/span> &lt;span class="n">serve&lt;/span> &lt;span class="c">## Install tools and start development server
&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>Now we have some command-line aliases that you can check in! Great idea! If you&amp;rsquo;re wondering what&amp;rsquo;s up with that weird &lt;code>##&lt;/code> comment syntax, it gets better.&lt;/p>
&lt;h2 id="a-self-documenting-makefile" class="anchor-link">&lt;a href="#a-self-documenting-makefile">A self-documenting Makefile&lt;/a>&lt;/h2>
&lt;p>Aliases are great, if you remember what they all are and what they do without constantly typing &lt;code>cat Makefile&lt;/code>. Naturally, you need a &lt;code>help&lt;/code> command:&lt;/p>
&lt;div class="highlight">&lt;pre class="chroma">&lt;code class="language-Makefile" data-lang="Makefile">&lt;span class="nf">.PHONY&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="n">help&lt;/span>
&lt;span class="nf">help&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="c">## Show this help
&lt;/span>&lt;span class="c">&lt;/span> @egrep -h &lt;span class="s1">&amp;#39;\s##\s&amp;#39;&lt;/span> &lt;span class="k">$(&lt;/span>MAKEFILE_LIST&lt;span class="k">)&lt;/span> &lt;span class="p">|&lt;/span> sort &lt;span class="p">|&lt;/span> awk &lt;span class="s1">&amp;#39;BEGIN {FS = &amp;#34;:.*?## &amp;#34;}; {printf &amp;#34;\033[36m%-20s\033[0m %s\n&amp;#34;, $$1, $$2}&amp;#39;&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>With a little command-line magic, this &lt;code>egrep&lt;/code> command takes the output of &lt;code>MAKEFILE_LIST&lt;/code>, sorts it, and uses &lt;code>awk&lt;/code> to find strings that follow the &lt;code>##&lt;/code> pattern. It then prints a helpful formatted version of the comments.&lt;/p>
&lt;p>We&amp;rsquo;ll put it at the top of the file so it&amp;rsquo;s the default target. Now to see all our handy shortcuts and what they do, we just run &lt;code>make&lt;/code>, or &lt;code>make help&lt;/code>:&lt;/p>
&lt;div class="highlight">&lt;pre class="chroma">&lt;code class="language-text" data-lang="text">help Show this help
initial Install tools and start development server
install Install or update dependencies
serve Run the local development server
update Do apt upgrade and autoremove
&lt;/code>&lt;/pre>&lt;/div>&lt;p>Now we have our very own personalized and project-specific CLI tool!&lt;/p>
&lt;p>The possibilities for improving your DevOps flow with a self-documenting Makefile are almost endless. You can use one to simplify any workflow and produce some very happy developers.&lt;/p>
&lt;p>Please enjoy the (live!) Makefile I use to manage and develop this Hugo site. I hope it inspires you!&lt;/p>
&lt;details>
&lt;summary>My Hugo site Makefile&lt;/summary>
&lt;div class="highlight">&lt;pre class="chroma">&lt;code class="language-Makefile" data-lang="Makefile">
&lt;span class="nv">SHELL&lt;/span> &lt;span class="o">:=&lt;/span> /bin/bash
&lt;span class="nf">.POSIX&lt;/span>&lt;span class="o">:&lt;/span>
&lt;span class="nf">.PHONY&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="n">help&lt;/span> &lt;span class="n">env&lt;/span> &lt;span class="n">install&lt;/span> &lt;span class="n">upgrade&lt;/span>-&lt;span class="n">hugo&lt;/span> &lt;span class="n">lint&lt;/span> &lt;span class="n">serve&lt;/span> &lt;span class="n">build&lt;/span> &lt;span class="n">start&lt;/span> &lt;span class="n">initial&lt;/span>
&lt;span class="nf">help&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="c">## Show this help
&lt;/span>&lt;span class="c">&lt;/span> @egrep -h &lt;span class="s1">&amp;#39;&amp;amp;&amp;amp; \s##&amp;amp;&amp;amp; \s&amp;#39;&lt;/span> &lt;span class="k">$(&lt;/span>MAKEFILE_LIST&lt;span class="k">)&lt;/span> &lt;span class="p">|&lt;/span> sort &lt;span class="p">|&lt;/span> awk &lt;span class="s1">&amp;#39;BEGIN {FS = &amp;#34;:.*?## &amp;#34;}; {printf &amp;#34;&amp;amp;&amp;amp; \033[36m%-20s&amp;amp;&amp;amp; \033[0m %s&amp;amp;&amp;amp; \n&amp;#34;, $$1, $$2}&amp;#39;&lt;/span>
&lt;span class="nf">env&lt;/span>&lt;span class="o">:&lt;/span>
pip3 install pipenv
&lt;span class="nf">shell&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="c">## Enter the virtual environment
&lt;/span>&lt;span class="c">&lt;/span> pipenv shell
&lt;span class="nf">install&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="c">## Install or update dependencies
&lt;/span>&lt;span class="c">&lt;/span> pipenv install --dev
npm install
npm install -g markdownlint-cli
pre-commit install --install-hooks
&lt;span class="nv">HUGO_VERSION&lt;/span>&lt;span class="o">:=&lt;/span>&lt;span class="k">$(&lt;/span>shell curl -s https://api.github.com/repos/gohugoio/hugo/releases/latest &lt;span class="p">|&lt;/span> grep &lt;span class="s1">&amp;#39;tag_name&amp;#39;&lt;/span> &lt;span class="p">|&lt;/span> cut -d &lt;span class="s1">&amp;#39;&amp;#34;&amp;#39;&lt;/span> -f &lt;span class="m">4&lt;/span> &lt;span class="p">|&lt;/span> cut -c 2-&lt;span class="k">)&lt;/span>
&lt;span class="nf">upgrade-hugo&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="c">## Get the latest Hugo
&lt;/span>&lt;span class="c">&lt;/span> mkdir tmp/ &lt;span class="o">&amp;amp;&amp;amp;&lt;/span> &lt;span class="se">\
&lt;/span>&lt;span class="se">&lt;/span> &lt;span class="nb">cd&lt;/span> tmp/ &lt;span class="o">&amp;amp;&amp;amp;&lt;/span> &lt;span class="se">\
&lt;/span>&lt;span class="se">&lt;/span> curl -sSL https://github.com/gohugoio/hugo/releases/download/v&lt;span class="k">$(&lt;/span>HUGO_VERSION&lt;span class="k">)&lt;/span>/hugo_extended_&lt;span class="k">$(&lt;/span>HUGO_VERSION&lt;span class="k">)&lt;/span>_Linux-64bit.tar.gz &lt;span class="p">|&lt;/span> tar -xvzf- &lt;span class="o">&amp;amp;&amp;amp;&lt;/span> &lt;span class="se">\
&lt;/span>&lt;span class="se">&lt;/span> sudo mv hugo /usr/local/bin/ &lt;span class="o">&amp;amp;&amp;amp;&lt;/span> &lt;span class="se">\
&lt;/span>&lt;span class="se">&lt;/span> &lt;span class="nb">cd&lt;/span> .. &lt;span class="o">&amp;amp;&amp;amp;&lt;/span> &lt;span class="se">\
&lt;/span>&lt;span class="se">&lt;/span> rm -rf tmp/
hugo version
&lt;span class="nf">lint&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="c">## Lint files
&lt;/span>&lt;span class="c">&lt;/span> pre-commit run --all-files
&lt;span class="nf">serve&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="c">## Run the local development server
&lt;/span>&lt;span class="c">&lt;/span> hugo serve --enableGitInfo --disableFastRender --environment development
&lt;span class="nf">future&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="c">## Run the local development server in the future
&lt;/span>&lt;span class="c">&lt;/span> hugo serve --enableGitInfo --buildFuture --disableFastRender --environment development
&lt;span class="nf">build&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="c">## Lock dependencies and build site
&lt;/span>&lt;span class="c">&lt;/span> pipenv lock
hugo --minify --cleanDestination
&lt;span class="nf">start&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="n">upgrade&lt;/span>-&lt;span class="n">hugo&lt;/span> &lt;span class="n">serve&lt;/span> &lt;span class="c">## Update Hugo and start development server
&lt;/span>&lt;span class="c">&lt;/span>
&lt;span class="nf">initial&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="n">env&lt;/span> &lt;span class="n">install&lt;/span> &lt;span class="n">upgrade&lt;/span>-&lt;span class="n">hugo&lt;/span> &lt;span class="n">serve&lt;/span> &lt;span class="c">## Install tools and start development server
&lt;/span>&lt;span class="c">&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;/details></content:encoded><enclosure url="https://victoria.dev/blog/how-to-create-a-self-documenting-makefile/cover_hu5b5f7817443ceb3a2651ffd8837c3ef8_243813_640x0_resize_box_2.png" type="image/jpg"/></item><item><title>Go automate your GitHub profile README</title><link>https://victoria.dev/blog/go-automate-your-github-profile-readme/</link><pubDate>Sat, 25 Jul 2020 10:51:15 -0400</pubDate><author>hello@victoria.dev (Victoria Drake)</author><guid>https://victoria.dev/blog/go-automate-your-github-profile-readme/</guid><description>Create a dynamic Markdown file with Go and GitHub Actions</description><content:encoded>
&lt;img src="https://victoria.dev/blog/go-automate-your-github-profile-readme/cover_huc867d29da9f2038bb1b7e753b00cef8e_329273_640x0_resize_box_2.png" width="640" height="256"/>
&lt;p>GitHub&amp;rsquo;s new profile page README feature is having the wonderful effect of bringing some personality to the Myspace pages of the developer Internet. Though Markdown lends itself best to standard static text content, that&amp;rsquo;s not stopping creative folks from working to create a next-level README. You can include GIFs and images to add some motion and pizazz (they&amp;rsquo;re covered in &lt;a href="https://github.github.com/gfm/">GitHub Flavor Markdown&lt;/a>), but I&amp;rsquo;m thinking of something a little more dynamic.&lt;/p>
&lt;p>At front-and-center on your GitHub profile, your README is a great opportunity to let folks know what you&amp;rsquo;re about, what you find important, and to showcase some highlights of your work. You might like to show off your latest repositories, tweet, or blog post. Keeping it up to date doesn&amp;rsquo;t have to be a pain either, thanks to continuous delivery tools like GitHub Actions.&lt;/p>
&lt;p>My current README refreshes itself daily with a link to my latest blog post. Here&amp;rsquo;s how I&amp;rsquo;m creating a self-updating &lt;code>README.md&lt;/code> with Go and GitHub actions.&lt;/p>
&lt;h2 id="reading-and-writing-files-with-go" class="anchor-link">&lt;a href="#reading-and-writing-files-with-go">Reading and writing files with Go&lt;/a>&lt;/h2>
&lt;p>I&amp;rsquo;ve been writing a lot of Python lately, but for some things I really like using Go. You could say it&amp;rsquo;s my go-to language for just-for-&lt;code>func&lt;/code> projects. Sorry. Couldn&amp;rsquo;t stop myself.&lt;/p>
&lt;p>To create my README.md, I&amp;rsquo;m going to get some static content from an existing file, mash it together with some new dynamic content that we&amp;rsquo;ll generate with Go, then bake the whole thing at 400 degrees until something awesome comes out.&lt;/p>
&lt;p>Here&amp;rsquo;s how we read in a file called &lt;code>static.md&lt;/code> and put it in &lt;code>string&lt;/code> form:&lt;/p>
&lt;div class="highlight">&lt;pre class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="c1">// Unwrap Markdown content
&lt;/span>&lt;span class="c1">&lt;/span>&lt;span class="nx">content&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">err&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="nx">ioutil&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">ReadFile&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;static.md&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="k">if&lt;/span> &lt;span class="nx">err&lt;/span> &lt;span class="o">!=&lt;/span> &lt;span class="kc">nil&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="nx">log&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Fatalf&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;cannot read file: %v&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">err&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="k">return&lt;/span> &lt;span class="nx">err&lt;/span>
&lt;span class="p">}&lt;/span>
&lt;span class="c1">// Make it a string
&lt;/span>&lt;span class="c1">&lt;/span>&lt;span class="nx">stringyContent&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="nb">string&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">content&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>The possibilities for your dynamic content are only limited by your imagination! Here, I&amp;rsquo;ll use the &lt;a href="https://github.com/mmcdole/gofeed">&lt;code>github.com/mmcdole/gofeed&lt;/code> package&lt;/a> to read the RSS feed from my blog and get the newest post.&lt;/p>
&lt;div class="highlight">&lt;pre class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="nx">fp&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="nx">gofeed&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">NewParser&lt;/span>&lt;span class="p">()&lt;/span>
&lt;span class="nx">feed&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">err&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="nx">fp&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">ParseURL&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;https://victoria.dev/index.xml&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="k">if&lt;/span> &lt;span class="nx">err&lt;/span> &lt;span class="o">!=&lt;/span> &lt;span class="kc">nil&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="nx">log&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Fatalf&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;error getting feed: %v&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">err&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="p">}&lt;/span>
&lt;span class="c1">// Get the freshest item
&lt;/span>&lt;span class="c1">&lt;/span>&lt;span class="nx">rssItem&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="nx">feed&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">Items&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="mi">0&lt;/span>&lt;span class="p">]&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>To join these bits together and produce stringy goodness, we use &lt;a href="https://golang.org/pkg/fmt/#Sprintf">&lt;code>fmt.Sprintf()&lt;/code>&lt;/a> to create a formatted string.&lt;/p>
&lt;div class="highlight">&lt;pre class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="c1">// Whisk together static and dynamic content until stiff peaks form
&lt;/span>&lt;span class="c1">&lt;/span>&lt;span class="nx">blog&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="s">&amp;#34;Read my latest blog post: **[&amp;#34;&lt;/span> &lt;span class="o">+&lt;/span> &lt;span class="nx">rssItem&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">Title&lt;/span> &lt;span class="o">+&lt;/span> &lt;span class="s">&amp;#34;](&amp;#34;&lt;/span> &lt;span class="o">+&lt;/span> &lt;span class="nx">rssItem&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">Link&lt;/span> &lt;span class="o">+&lt;/span> &lt;span class="s">&amp;#34;)**&amp;#34;&lt;/span>
&lt;span class="nx">data&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="nx">fmt&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Sprintf&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;%s\n%s\n&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">stringyContent&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">blog&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>Then to create a new file from this mix, we use &lt;a href="https://golang.org/pkg/os/#Create">&lt;code>os.Create()&lt;/code>&lt;/a>. There are &lt;a href="https://www.joeshaw.org/dont-defer-close-on-writable-files/">more things to know about deferring &lt;code>file.Close()&lt;/code>&lt;/a>, but we don&amp;rsquo;t need to get into those details here. We&amp;rsquo;ll add &lt;code>file.Sync()&lt;/code> to ensure our README gets written.&lt;/p>
&lt;div class="highlight">&lt;pre class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="c1">// Prepare file with a light coating of os
&lt;/span>&lt;span class="c1">&lt;/span>&lt;span class="nx">file&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">err&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="nx">os&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Create&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;README.md&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="k">if&lt;/span> &lt;span class="nx">err&lt;/span> &lt;span class="o">!=&lt;/span> &lt;span class="kc">nil&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="k">return&lt;/span> &lt;span class="nx">err&lt;/span>
&lt;span class="p">}&lt;/span>
&lt;span class="k">defer&lt;/span> &lt;span class="nx">file&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Close&lt;/span>&lt;span class="p">()&lt;/span>
&lt;span class="c1">// Bake at n bytes per second until golden brown
&lt;/span>&lt;span class="c1">&lt;/span>&lt;span class="nx">_&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">err&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="nx">io&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">WriteString&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">file&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">data&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="k">if&lt;/span> &lt;span class="nx">err&lt;/span> &lt;span class="o">!=&lt;/span> &lt;span class="kc">nil&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="k">return&lt;/span> &lt;span class="nx">err&lt;/span>
&lt;span class="p">}&lt;/span>
&lt;span class="k">return&lt;/span> &lt;span class="nx">file&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Sync&lt;/span>&lt;span class="p">()&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>View the full code &lt;a href="https://github.com/victoriadrake/victoriadrake/blob/535da81efd291e40374307609a9fa66e08f4985c/update/main.go">here in my README repository&lt;/a>.&lt;/p>
&lt;p>Mmmm, doesn&amp;rsquo;t that smell good?  Let&amp;rsquo;s make this happen on the daily with a GitHub Action.&lt;/p>
&lt;h2 id="running-your-go-program-on-a-schedule-with-actions" class="anchor-link">&lt;a href="#running-your-go-program-on-a-schedule-with-actions">Running your Go program on a schedule with Actions&lt;/a>&lt;/h2>
&lt;p>You can create a GitHub Action workflow that &lt;a href="https://docs.github.com/en/actions/reference/events-that-trigger-workflows">triggers&lt;/a> both on a push to your &lt;code>master&lt;/code> branch as well as on a daily schedule. Here&amp;rsquo;s a slice of the &lt;code>.github/workflows/update.yaml&lt;/code> that defines this:&lt;/p>
&lt;div class="highlight">&lt;pre class="chroma">&lt;code class="language-yaml" data-lang="yaml">&lt;span class="nt">on&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nt">push&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nt">branches&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>- &lt;span class="l">master&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nt">schedule&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>- &lt;span class="nt">cron&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="s1">&amp;#39;0 11 * * *&amp;#39;&lt;/span>&lt;span class="w">
&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>To run the Go program that rebuilds our README, we first need a copy of our files. We use &lt;code>actions/checkout&lt;/code> for that:&lt;/p>
&lt;div class="highlight">&lt;pre class="chroma">&lt;code class="language-yaml" data-lang="yaml">&lt;span class="nt">steps&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>- &lt;span class="nt">name&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l"> Get working copy&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nt">uses&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">actions/checkout@master&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nt">with&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nt">fetch-depth&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="m">1&lt;/span>&lt;span class="w">
&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>This step runs our Go program:&lt;/p>
&lt;div class="highlight">&lt;pre class="chroma">&lt;code class="language-yaml" data-lang="yaml">- &lt;span class="nt">name&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l"> Shake &amp;amp; bake README&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nt">run&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">|&lt;/span>&lt;span class="sd">
&lt;/span>&lt;span class="sd"> cd ${GITHUB_WORKSPACE}/update/
&lt;/span>&lt;span class="sd"> go run main.go&lt;/span>&lt;span class="w">
&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>Finally, we push the updated files back to our repository. Learn more about the variables shown at &lt;a href="https://docs.github.com/en/actions/configuring-and-managing-workflows/using-variables-and-secrets-in-a-workflow">Using variables and secrets in a workflow&lt;/a>.&lt;/p>
&lt;div class="highlight">&lt;pre class="chroma">&lt;code class="language-yaml" data-lang="yaml">- &lt;span class="nt">name&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l"> Deploy&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nt">run&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">|&lt;/span>&lt;span class="sd">
&lt;/span>&lt;span class="sd"> git config user.name &amp;#34;${GITHUB_ACTOR}&amp;#34;
&lt;/span>&lt;span class="sd"> git config user.email &amp;#34;${GITHUB_ACTOR}@users.noreply.github.com&amp;#34;
&lt;/span>&lt;span class="sd"> git add .
&lt;/span>&lt;span class="sd"> git commit -am &amp;#34;Update dynamic content&amp;#34;
&lt;/span>&lt;span class="sd"> git push --all -f https://${{ secrets.GITHUB_TOKEN }}@github.com/${GITHUB_REPOSITORY}.git&lt;/span>&lt;span class="w">
&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>View the full code for this Action workflow &lt;a href="https://github.com/victoriadrake/victoriadrake/blob/535da81efd291e40374307609a9fa66e08f4985c/.github/workflows/update.yaml">here in my README repository&lt;/a>.&lt;/p>
&lt;h2 id="go-forth-and-auto-update-your-readme" class="anchor-link">&lt;a href="#go-forth-and-auto-update-your-readme">Go forth and auto-update your README&lt;/a>&lt;/h2>
&lt;p>Congratulations and welcome to the cool kids' club! You now know how to build an auto-updating GitHub profile README. You may now go forth and add all sorts of neat dynamic elements to your page &amp;ndash; just go easy on the GIFs, okay?&lt;/p></content:encoded><enclosure url="https://victoria.dev/blog/go-automate-your-github-profile-readme/cover_huc867d29da9f2038bb1b7e753b00cef8e_329273_640x0_resize_box_2.png" type="image/jpg"/></item><item><title>Writing efficient Django</title><link>https://victoria.dev/blog/writing-efficient-django/</link><pubDate>Thu, 09 Jul 2020 04:02:47 -0500</pubDate><author>hello@victoria.dev (Victoria Drake)</author><guid>https://victoria.dev/blog/writing-efficient-django/</guid><description>How to use Django's views, models, and queries to build a better application.</description><content:encoded>
&lt;img src="https://victoria.dev/blog/writing-efficient-django/cover_hu17c23657d5071320ac32463f59b7c34e_26457_640x0_resize_box_2.png" width="640" height="271"/>
&lt;p>I like Django. It&amp;rsquo;s a well-considered and intuitive framework with a name I can pronounce out loud. You can use it to to quickly spin up a &lt;a href="https://github.com/victoriadrake/react-in-django">weekend-sized project&lt;/a>, and you can still use it to run &lt;a href="https://applybyapi.com">full-blown production applications&lt;/a> at scale. I&amp;rsquo;ve done both these things, and over the years I&amp;rsquo;ve discovered how to use some of Django&amp;rsquo;s features for maximum efficiency. These are:&lt;/p>
&lt;ul>
&lt;li>&lt;a href="#class-based-versus-function-based-views">Class-based versus function-based views&lt;/a>&lt;/li>
&lt;li>&lt;a href="#django-models">Django models&lt;/a>&lt;/li>
&lt;li>&lt;a href="#retrieving-objects-with-queries">Retrieving objects with queries&lt;/a>&lt;/li>
&lt;/ul>
&lt;p>Let&amp;rsquo;s look at how these tools let you create a performant Django application that&amp;rsquo;s pleasant to build and maintain.&lt;/p>
&lt;h2 id="class-based-versus-function-based-views" class="anchor-link">&lt;a href="#class-based-versus-function-based-views">Class-based versus function-based views&lt;/a>&lt;/h2>
&lt;p>Remember that Django is all Python under the hood. When it comes to views, you&amp;rsquo;ve got two choices: &lt;a href="https://docs.djangoproject.com/en/3.0/topics/http/views/">view functions&lt;/a> (sometimes called &amp;ldquo;function-based views&amp;rdquo;), or &lt;a href="https://docs.djangoproject.com/en/3.0/topics/class-based-views/">class-based views&lt;/a>.&lt;/p>
&lt;p>Years ago when I first built &lt;a href="https://applybyapi.com">ApplyByAPI&lt;/a>, it was initially composed entirely of function-based views. These offer granular control, and are good for implementing complex logic; just as in a Python function, you have complete control (for better or worse) over what the view does. With great control comes great responsibility, and function-based views can be a little tedious to use. You&amp;rsquo;re responsible for writing all the necessary methods for the view to work - this is what allows you to completely tailor your application.&lt;/p>
&lt;p>In the case of ApplyByAPI, there were only a sparse few places where that level of tailored functionality was really necessary. Everywhere else, function-based views began making my life harder. Writing what is essentially a custom view for run-of-the-mill operations like displaying data on a list page became tedious, repetitive, and error-prone.&lt;/p>
&lt;p>With function-based views, you&amp;rsquo;ll need figure out which Django methods to implement in order to handle requests and pass data to views. Unit testing can take some work to write. In short, the granular control that function-based views offer also requires some granular tedium to properly implement.&lt;/p>
&lt;p>I ended up holding back ApplyByAPI while I refactored the majority of the views into class-based views. This was not a small amount of work and refactoring, but when it was done, I had a bunch of tiny views that made a huge difference. I mean, just look at this one:&lt;/p>
&lt;div class="highlight">&lt;pre class="chroma">&lt;code class="language-python" data-lang="python">&lt;span class="k">class&lt;/span> &lt;span class="nc">ApplicationsList&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">ListView&lt;/span>&lt;span class="p">):&lt;/span>
&lt;span class="n">model&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">Application&lt;/span>
&lt;span class="n">template_name&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="s2">&amp;#34;applications.html&amp;#34;&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>It&amp;rsquo;s three lines. My developer ergonomics, and my life, got a lot easier.&lt;/p>
&lt;p>You may think of class-based views as templates that cover most of the functionality any app needs. There are views for displaying lists of things, for viewing a thing in detail, and &lt;a href="https://docs.djangoproject.com/en/3.0/ref/class-based-views/generic-editing/">editing views&lt;/a> for performing CRUD (Create, Read, Update, Delete) operations. Because implementing one of these generic views takes only a few lines of code, my application logic became dramatically succinct. This gave me less repeated code, fewer places for something to go wrong, and a more manageable application in general.&lt;/p>
&lt;p>Class-based views are fast to implement and use. The built-in class-based generic views may require less work to test, since you don&amp;rsquo;t need to write tests for the base view Django provides. (Django does its own tests for that; no need for your app to double-check.) To tweak a generic view to your needs, you can &lt;a href="https://docs.djangoproject.com/en/3.0/topics/class-based-views/#subclassing-generic-views">subclass a generic view&lt;/a> and override attributes or methods. In my case, since I only needed to write tests for any customizations I added, my test files became dramatically shorter, as did the time and resources it took to run them.&lt;/p>
&lt;p>When you&amp;rsquo;re weighing the choice between function-based or class-based views, consider the amount of customization the view needs, and the future work that will be necessary to test and maintain it. If the logic is common, you may be able to hit the ground running with a generic class-based view. If you need sufficient granularity that re-writing a base view&amp;rsquo;s methods would make it overly complicated, consider a function-based view instead.&lt;/p>
&lt;h2 id="django-models" class="anchor-link">&lt;a href="#django-models">Django models&lt;/a>&lt;/h2>
&lt;p>&lt;a href="https://docs.djangoproject.com/en/3.0/topics/db/models/">Models&lt;/a> organize your Django application&amp;rsquo;s central concepts to help make them flexible, robust, and easy to work with. If used wisely, models are a powerful way to collate your data into a definitive source of truth.&lt;/p>
&lt;p>Like views, Django provides some built-in model types for the convenience of implementing basic authentication, including the &lt;a href="https://docs.djangoproject.com/en/3.0/ref/contrib/auth/">User&lt;/a> and &lt;a href="https://docs.djangoproject.com/en/3.0/ref/contrib/auth/">Permission&lt;/a> models. For everything else, you can create a model that reflects your concept by &lt;a href="https://docs.djangoproject.com/en/3.0/topics/db/models/#model-inheritance">inheriting from a parent Model class&lt;/a>.&lt;/p>
&lt;div class="highlight">&lt;pre class="chroma">&lt;code class="language-python" data-lang="python">&lt;span class="k">class&lt;/span> &lt;span class="nc">StaffMember&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">models&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">Model&lt;/span>&lt;span class="p">):&lt;/span>
&lt;span class="n">user&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">models&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">OneToOneField&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">User&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">on_delete&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">models&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">CASCADE&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="n">company&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">models&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">OneToOneField&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">Company&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">on_delete&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="n">models&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">CASCADE&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="k">def&lt;/span> &lt;span class="fm">__str__&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="bp">self&lt;/span>&lt;span class="p">):&lt;/span>
&lt;span class="k">return&lt;/span> &lt;span class="bp">self&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">company&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">name&lt;/span> &lt;span class="o">+&lt;/span> &lt;span class="s2">&amp;#34; - &amp;#34;&lt;/span> &lt;span class="o">+&lt;/span> &lt;span class="bp">self&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">user&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">email&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>When you create a custom model in Django, you subclass &lt;a href="https://github.com/django/django/blob/master/django/db/models/base.py">Django&amp;rsquo;s Model class&lt;/a> and take advantage of all its power. Each model you create generally maps to a database table. Each attribute is a database field. This gives you the ability to create objects to work with that humans can better understand.&lt;/p>
&lt;p>You can make a model useful to you by defining its fields. Many &lt;a href="https://docs.djangoproject.com/en/3.0/ref/models/fields/#model-field-types">built-in field types&lt;/a> are conveniently provided. These help Django figure out the data type, the HTML &lt;a href="https://docs.djangoproject.com/en/3.0/ref/forms/widgets/">widget&lt;/a> to use when rendering a form, and even &lt;a href="https://docs.djangoproject.com/en/3.0/ref/forms/validation/">form validation&lt;/a> requirements. If you need to, you can &lt;a href="https://docs.djangoproject.com/en/3.0/howto/custom-model-fields/">write custom model fields&lt;/a>.&lt;/p>
&lt;p>Database &lt;a href="https://docs.djangoproject.com/en/3.0/topics/db/models/#relationships">relationships&lt;/a> can be defined using a &lt;a href="https://docs.djangoproject.com/en/3.0/ref/models/fields/#django.db.models.ForeignKey">ForeignKey&lt;/a> field (many-to-one), or a &lt;a href="https://docs.djangoproject.com/en/3.0/ref/models/fields/#django.db.models.ManyToManyField">ManyToManyField&lt;/a> (give you three guesses). If those don&amp;rsquo;t suffice, there&amp;rsquo;s also a &lt;a href="https://docs.djangoproject.com/en/3.0/ref/models/fields/#django.db.models.OneToOneField">OneToOneField&lt;/a>. Together, these allow you to define relations between your models with levels of complexity limited only by your imagination. (Depending on the imagination you have, this may or may not be an advantage.)&lt;/p>
&lt;h2 id="retrieving-objects-with-queries" class="anchor-link">&lt;a href="#retrieving-objects-with-queries">Retrieving objects with queries&lt;/a>&lt;/h2>
&lt;p>Use your model&amp;rsquo;s Manager (&lt;code>objects&lt;/code> by default) to &lt;a href="https://docs.djangoproject.com/en/3.0/topics/db/queries/#retrieving-objects">construct a QuerySet&lt;/a>. This is a representation of objects in your database that you can refine, using methods, to retrieve specific subsets. All available methods are in the &lt;a href="https://docs.djangoproject.com/en/3.0/ref/models/querysets/#django.db.models.query.QuerySet">QuerySet API&lt;/a> and can be chained together for even more fun.&lt;/p>
&lt;div class="highlight">&lt;pre class="chroma">&lt;code class="language-py" data-lang="py">&lt;span class="n">Post&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">objects&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">filter&lt;/span>&lt;span class="p">(&lt;/span>
&lt;span class="nb">type&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s2">&amp;#34;new&amp;#34;&lt;/span>
&lt;span class="p">)&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">exclude&lt;/span>&lt;span class="p">(&lt;/span>
&lt;span class="n">title__startswith&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s2">&amp;#34;Blockchain&amp;#34;&lt;/span>
&lt;span class="p">)&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>Some methods return new QuerySets, such as &lt;a href="https://docs.djangoproject.com/en/3.0/ref/models/querysets/#filter">&lt;code>filter()&lt;/code>&lt;/a>, or &lt;a href="https://docs.djangoproject.com/en/3.0/ref/models/querysets/#exclude">&lt;code>exclude()&lt;/code>&lt;/a>. Chaining these can give you powerful queries without affecting performance, as QuerySets aren&amp;rsquo;t fetched from the database &lt;a href="https://docs.djangoproject.com/en/3.0/ref/models/querysets/#when-querysets-are-evaluated">until they are evaluated&lt;/a>. Methods that evaluate a QuerySet include &lt;code>get()&lt;/code>, &lt;a href="https://docs.djangoproject.com/en/3.0/ref/models/querysets/#count">&lt;code>count()&lt;/code>&lt;/a>, &lt;code>len()&lt;/code>, &lt;code>list()&lt;/code>, or &lt;code>bool()&lt;/code>.&lt;/p>
&lt;p>Iterating over a QuerySet also evaluates it, so avoid doing so where possible to improve query performance. For instance, if you just want to know if an object is present, you can use &lt;code>exists()&lt;/code> to avoid iterating over database objects.&lt;/p>
&lt;p>Use &lt;a href="https://docs.djangoproject.com/en/3.0/ref/models/querysets/#django.db.models.query.QuerySet.get">&lt;code>get()&lt;/code>&lt;/a> in cases where you want to retrieve a specific object. This method raises &lt;a href="https://docs.djangoproject.com/en/3.0/ref/exceptions/#django.core.exceptions.MultipleObjectsReturned">&lt;code>MultipleObjectsReturned&lt;/code>&lt;/a> if something unexpected happens, as well as the &lt;code>DoesNotExist&lt;/code> exception, if, take a guess.&lt;/p>
&lt;p>If you&amp;rsquo;d like to get an object that may not exist in the context of a user&amp;rsquo;s request, use the convenient &lt;a href="https://docs.djangoproject.com/en/3.0/topics/http/shortcuts/#get-object-or-404">&lt;code>get_object_or_404()&lt;/code>&lt;/a> or &lt;a href="https://docs.djangoproject.com/en/3.0/topics/http/shortcuts/#get-list-or-404">&lt;code>get_list_or_404()&lt;/code>&lt;/a> which raises &lt;a href="https://docs.djangoproject.com/en/3.0/topics/http/views/#django.http.Http404">&lt;code>Http404&lt;/code>&lt;/a> instead of &lt;a href="https://docs.djangoproject.com/en/3.0/ref/models/instances/#django.db.models.Model.DoesNotExist">&lt;code>DoesNotExist&lt;/code>&lt;/a>. These helpful &lt;a href="https://docs.djangoproject.com/en/3.0/topics/http/shortcuts/">shortcuts&lt;/a> are suited to just this purpose. To create an object that doesn&amp;rsquo;t exist, there&amp;rsquo;s also the convenient &lt;a href="https://docs.djangoproject.com/en/3.0/ref/models/querysets/#get-or-create">&lt;code>get_or_create()&lt;/code>&lt;/a>.&lt;/p>
&lt;!-- omit in toc -->
&lt;h2 id="efficient-essentials" class="anchor-link">&lt;a href="#efficient-essentials">Efficient essentials&lt;/a>&lt;/h2>
&lt;p>You&amp;rsquo;ve now got a handle on these three essential tools for building your efficient Django application &amp;ndash; congratulations! There&amp;rsquo;s a lot more that Django can do for you, so stay tuned for future articles. If you&amp;rsquo;re going to build on GitHub, you may like to set up my &lt;a href="https://github.com/victoriadrake/django-security-check">django-security-check GitHub Action&lt;/a>. In the meantime, you&amp;rsquo;re well on your way to building a beautiful software project.&lt;/p></content:encoded><enclosure url="https://victoria.dev/blog/writing-efficient-django/cover_hu17c23657d5071320ac32463f59b7c34e_26457_640x0_resize_box_2.png" type="image/jpg"/></item><item><title>Look mom, I'm a GitHub Action Hero</title><link>https://victoria.dev/blog/look-mom-im-a-github-action-hero/</link><pubDate>Sat, 27 Jun 2020 09:06:33 -0400</pubDate><author>hello@victoria.dev (Victoria Drake)</author><guid>https://victoria.dev/blog/look-mom-im-a-github-action-hero/</guid><description>The GitHub blog interviews me for their GitHub Action Hero series.</description><content:encoded>
&lt;img src="https://victoria.dev/blog/look-mom-im-a-github-action-hero/cover_hu32161be828bfd8bd18b75263073388c1_248508_640x0_resize_box_2.PNG" width="640" height="336"/>
&lt;p>GitHub recently interviewed me for their blog editorial entitled &lt;a href="https://github.blog/2020-06-26-github-action-hero-victoria-drake/">GitHub Action Hero: Victoria Drake&lt;/a>. Here&amp;rsquo;s a behind-the-scenes peek at the original interview questions and my answers.&lt;/p>
&lt;h2 id="what-is-the-name-of-your-action-please-include-a-link-too" class="anchor-link">&lt;a href="#what-is-the-name-of-your-action-please-include-a-link-too">What is the name of your Action? Please include a link too.&lt;/a>&lt;/h2>
&lt;p>Among the several Actions I&amp;rsquo;ve built, I have two current favorites. One is &lt;a href="https://github.com/victoriadrake/hugo-remote">hugo-remote&lt;/a>, which lets you continuously deploy a Hugo static site from a private source repository to a public GitHub Pages repository. This keeps the contents of the source repository private, such as your unreleased drafts, while still allowing you to have a public open source site using GitHub Pages.&lt;/p>
&lt;p>The second is &lt;a href="https://github.com/victoriadrake/django-security-check">django-security-check&lt;/a>. It&amp;rsquo;s an effortless way to continuously check that your production Django application is free from a variety of security misconfigurations. You can think of it as your little CI/CD helper for busy projects &amp;ndash; a security linter!&lt;/p>
&lt;h2 id="tell-us-a-little-bit-more-about-yourselfhow-did-you-get-started-in-software-tools" class="anchor-link">&lt;a href="#tell-us-a-little-bit-more-about-yourselfhow-did-you-get-started-in-software-tools">Tell us a little bit more about yourselfhow did you get started in software tools?&lt;/a>&lt;/h2>
&lt;p>When I was a kid, I spent several summer vacations coding a huge medieval fantasy world MUD (Multi-User Dungeon, like a multiplayer role-playing game) written in LPC, with friends. It was entirely text-based, and built and played via Telnet. I fell in love with the terminal and learned a lot about object-oriented programming and prototype-based programming early on.&lt;/p>
&lt;p>I became a freelance developer and had the privilege of working on a wide variety of client projects. Realizing the difficulty that companies have with hiring experienced developers, I built &lt;a href="https://ApplyByAPI.com">ApplyByAPI.com&lt;/a> to help. As you might imagine, it allows candidates to apply for jobs via API, instead of emailing a resume. It&amp;rsquo;s based on the Django framework, so in the process, I learned even more about building reusable units of software.&lt;/p>
&lt;p>When I became a co-author and a core maintainer for the &lt;a href="https://github.com/OWASP/wstg">Open Web Application Security Project (OWASP) Web Security Testing Guide (WSTG)&lt;/a>, I gained an even broader appreciation for how a prototype-based, repeatable approach can help build secure web applications. Organizations worldwide consider the WSTG the foremost open source resource for testing the security of web applications. We&amp;rsquo;ve applied this thinking via the use of GitHub Actions in our repository &amp;ndash; I&amp;rsquo;ll tell you more about that later.&lt;/p>
&lt;p>Whether I&amp;rsquo;m creating an open source tool or leading a development team, my childhood experience still informs how I think about programming today. I strive to create repeatable units of software like GitHub Actions &amp;ndash; only now, I make them for large enterprises in the real world!&lt;/p>
&lt;h2 id="what-is-the-story-behind-your-built-github-action-why-did-you-build-this" class="anchor-link">&lt;a href="#what-is-the-story-behind-your-built-github-action-why-did-you-build-this">What is the story behind your built GitHub Action? (Why did you build this?)&lt;/a>&lt;/h2>
&lt;p>Developers take on a lot of responsibility when it comes to building secure applications these days. I&amp;rsquo;m a full-time senior software developer at a cybersecurity company. I&amp;rsquo;ve found that I&amp;rsquo;m maximally productive when I create systems and processes that help myself and my team make desired outcomes inevitable. So I spend my free time building tools that make it easy for other developers to build secure software as well. My Actions help to automate contained, repeatable units of work that can make a big difference in a developer&amp;rsquo;s day.&lt;/p>
&lt;h2 id="do-you-have-future-plans-for-this-or-other-actions" class="anchor-link">&lt;a href="#do-you-have-future-plans-for-this-or-other-actions">Do you have future plans for this or other Actions?&lt;/a>&lt;/h2>
&lt;p>Yes! I&amp;rsquo;m always finding ways for tools like GitHub Actions to boost the velocity of technical teams, whether at work or in my open source projects. Remember the Open Web Application Security Project? In the work I&amp;rsquo;ve lead with OWASP, I&amp;rsquo;ve championed the effort to increase automation using GitHub Actions to maintain quality, securely deploy new versions to the web, and even build PDFs of the WSTG. We&amp;rsquo;re constantly looking into new ways that GitHub Actions can make our lives easier and our readers' projects more secure.&lt;/p>
&lt;h2 id="what-has-been-your-favorite-feature-of-github-actions" class="anchor-link">&lt;a href="#what-has-been-your-favorite-feature-of-github-actions">What has been your favorite feature of GitHub Actions?&lt;/a>&lt;/h2>
&lt;p>I like that I can build an Action using familiar and portable technologies, like Docker. Actions are easy for collaborators to work on too, since in the case of a Dockerized Action, you can use any language your team is comfortable with. This is especially useful in large organizations with polyglot teams and environments. There aren&amp;rsquo;t any complicated dependencies for running these portable tasks, and you don&amp;rsquo;t need to learn any special frameworks to get started.&lt;/p>
&lt;p>One of my first blog posts about GitHub Actions even describes how I used an Action to run a Makefile! This is especially useful for large legacy applications that want to modernize their pipeline by using GitHub Actions.&lt;/p>
&lt;h2 id="what-are-the-biggest-challenges-youve-faced-while-building-your-github-action" class="anchor-link">&lt;a href="#what-are-the-biggest-challenges-youve-faced-while-building-your-github-action">What are the biggest challenges youve faced while building your GitHub Action?&lt;/a>&lt;/h2>
&lt;p>The largest challenge of GitHub Actions isn&amp;rsquo;t really in GitHub Actions, but in the transition of legacy software and company culture.&lt;/p>
&lt;p>Migrating legacy software is always challenging, particularly with large legacy applications. Moving to modern CI/CD processes requires changes at the software level, team level, and even a shift in thinking when it comes to individual developers. It can help to have a tool like GitHub Actions, which is at once seamlessly modern and familiar, when transitioning legacy code to a modern pipeline.&lt;/p>
&lt;h2 id="anything-else-you-would-like-to-share-about-your-experience-any-stories-or-lessons-learned-through-building-your-action" class="anchor-link">&lt;a href="#anything-else-you-would-like-to-share-about-your-experience-any-stories-or-lessons-learned-through-building-your-action">Anything else you would like to share about your experience? Any stories or lessons learned through building your Action?&lt;/a>&lt;/h2>
&lt;p>I&amp;rsquo;m happiest when I&amp;rsquo;m solving a challenge that makes developing secure software less challenging in the future, both for myself and for the technology organization I&amp;rsquo;m leading. With tools like GitHub Actions, a lot of mental overhead can be offloaded to automatic processes &amp;ndash; like getting a whole other brain, for free! This can massively help organizations that are ready to scale up their development output.&lt;/p>
&lt;p>In the realm of cybersecurity, not only does creating portable and reusable software make developers' lives easier, it helps to make whole workflows repeatable, which in turn makes software development processes more secure. With smart processes in place, technical teams are happier. As an inevitable result, they&amp;rsquo;ll build better software for customers, too.&lt;/p></content:encoded><enclosure url="https://victoria.dev/blog/look-mom-im-a-github-action-hero/cover_hu32161be828bfd8bd18b75263073388c1_248508_640x0_resize_box_2.PNG" type="image/jpg"/></item><item><title>Technical ergonomics for the efficient developer</title><link>https://victoria.dev/blog/technical-ergonomics-for-the-efficient-developer/</link><pubDate>Mon, 22 Jun 2020 06:33:28 -0400</pubDate><author>hello@victoria.dev (Victoria Drake)</author><guid>https://victoria.dev/blog/technical-ergonomics-for-the-efficient-developer/</guid><description>If you knew these tools existed, you'd probably be using them by now.</description><content:encoded>
&lt;img src="https://victoria.dev/blog/technical-ergonomics-for-the-efficient-developer/cover_hu5cda4cdd5e21d9163d35d5008411ea74_437949_640x0_resize_box_2.png" width="640" height="256"/>
&lt;p>This article isn&amp;rsquo;t going to tell you about saving your neck with a Roost stand, or your wrists with a split keyboard - &lt;a href="https://heronebag.com/blog/next-level-ergonomics-for-remote-work-developers/">I&amp;rsquo;ve already done that&lt;/a>. This article is about saving your brain.&lt;/p>
&lt;p>When I first began to program full time, I found myself constantly tired from the mental exertion. Programming is hard! Thankfully, you can take some solace in knowing it gets easier with practice, and with a great supporting cast. Some very nice folks who preceded us both came up with tools to make the difficult bits of communicating with computers much easier on our poor human meatbrains.&lt;/p>
&lt;p>I invite you to explore these super helpful technical tools. They&amp;rsquo;ll improve your development set up and alleviate much of the mental stress of programming. You soon won&amp;rsquo;t believe you could have done without them.&lt;/p>
&lt;h2 id="not-your-average-syntax-highlighting" class="anchor-link">&lt;a href="#not-your-average-syntax-highlighting">Not your average syntax highlighting&lt;/a>&lt;/h2>
&lt;p>If you&amp;rsquo;re still working with syntax highlighting that just picks out variable and class names for you, that&amp;rsquo;s cute. Time to turn it up a notch.&lt;/p>
&lt;p>
&lt;img src="https://victoria.dev/blog/technical-ergonomics-for-the-efficient-developer/Screenshot_20200612_185858.png" alt="My current VSC theme and syntax highlighting" />
&lt;/p>
&lt;p>In all seriousness, syntax highlighting can make it much easier to find what you&amp;rsquo;re looking for on your screen: the current line, where your current code block starts and ends, or the absolute game-changing which-bracket-set-am-I-in highlight. I primarily use Visual Studio Code, but similar extensions can be found for the major text editors.&lt;/p>
&lt;p>Here are my favorites:&lt;/p>
&lt;ul>
&lt;li>&lt;a href="https://marketplace.visualstudio.com/items?itemName=CoenraadS.bracket-pair-colorizer-2">Bracket Pair Colorizer&lt;/a> highlights sequential bracket pairs in different matching colors, making the pain of picking through nested brackets and parentheses a thing of the past.&lt;/li>
&lt;li>&lt;a href="https://github.com/wayou/vscode-todo-highlight">TODO Highlight&lt;/a> effectively removes any excuse you may have had for unintentionally committing &lt;code>TODO&lt;/code> and &lt;code>FIXME&lt;/code> comments by making them really easy to see. You can even add your own custom keywords to be highlighted (I suggest, &lt;code>wtf&lt;/code>, but you didn&amp;rsquo;t hear it from me.)&lt;/li>
&lt;li>&lt;a href="https://github.com/byi8220/indented-block-highlighting">Indented Block Highlighting&lt;/a> puts an easy-to-distinguish but unobtrusive highlight behind your current indented code block, so you can see just where that &lt;code>if&lt;/code> ends and why that last &lt;code>else&lt;/code> isn&amp;rsquo;t doing anything at all.&lt;/li>
&lt;li>&lt;a href="https://github.com/cliffordfajardo/highlight-line-vscode">Highlight Line&lt;/a> puts a (slightly too) bright line where you last left your cursor. You can customize the line&amp;rsquo;s appearance - I set the &lt;code>borderWidth&lt;/code> of mine to &lt;code>1px&lt;/code>.&lt;/li>
&lt;/ul>
&lt;p>The theme pictured in Visual Studio Code above is &lt;a href="https://github.com/victoriadrake/kabukicho-vscode">Kabukich&lt;/a>. I made it.&lt;/p>
&lt;h2 id="use-git-hooks" class="anchor-link">&lt;a href="#use-git-hooks">Use Git hooks&lt;/a>&lt;/h2>
&lt;p>I previously brought you &lt;a href="https://victoria.dev/blog/an-automatic-interactive-pre-commit-checklist-in-the-style-of-infomercials/">an interactive pre-commit checklist in the style of infomercials&lt;/a> that&amp;rsquo;s both fun and useful for reinforcing the quality of your commits. But that&amp;rsquo;s not all!&lt;/p>
&lt;p>Git hooks are scripts that run automatically at pre-determined points in your workflow. Use them well, and you can save a ton of brainpower. A &lt;code>pre-commit&lt;/code> hook remembers to do things like lint and format code, and even runs local tests for you before you indelibly push something embarrassing. Hooks can be a little annoying to share (the &lt;code>.git/hooks&lt;/code> directory isn&amp;rsquo;t tracked and thus omitted when you clone or fork a repository) but there&amp;rsquo;s a framework for that: the confusingly-named &lt;a href="https://pre-commit.com/">pre-commit framework&lt;/a>, which allows you to create a sharable configuration file of Git hook plugins, not just for &lt;code>pre-commit&lt;/code>.&lt;/p>
&lt;p>I spend a majority of my time these days coding in Python, so here is my current &lt;code>.pre-commit-config.yaml&lt;/code>:&lt;/p>
&lt;div class="highlight">&lt;pre class="chroma">&lt;code class="language-yaml" data-lang="yaml">&lt;span class="l">fail_fast: true
repos:
- repo: https://github.com/pre-commit/pre-commit-hooks
rev: v3.1.0 # Use the ref you want to point at
hooks:
- id: detect-aws-credentials
- id: end-of-file-fixer
types: [markdown]
- id: trailing-whitespace
- repo: https://github.com/psf/black
rev: 19.3b0
hooks:
- id: black
- repo: https://github.com/asottile/blacken-docs
rev: v1.7.0
hooks:
- id: blacken-docs
additional_dependencies: [black==19.3b0]
- repo: local
hooks:
- id: markdownlint
name: markdownlint
description: "Lint Markdown files"
entry: markdownlint '**/*.md' --fix --ignore node_modules --config "./.markdownlint.json"
language: node
types: [markdown]
&lt;/span>&lt;span class="w">
&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>There are tons of &lt;a href="https://pre-commit.com/hooks.html">supported hooks&lt;/a> to explore.&lt;/p>
&lt;h2 id="use-a-type-system" class="anchor-link">&lt;a href="#use-a-type-system">Use a type system&lt;/a>&lt;/h2>
&lt;p>If you write in languages like Python and JavaScript, get yourself an early birthday present and start using a static type system. Not only will this help improve the way you think about code, it can help make type errors clear before running a single line.&lt;/p>
&lt;p>For Python, I like using &lt;a href="https://github.com/python/mypy">mypy&lt;/a> for static type checking. You can set it up as a &lt;code>pre-commit&lt;/code> hook (see above) and it&amp;rsquo;s &lt;a href="https://code.visualstudio.com/docs/python/linting#_mypy">supported in Visual Studio Code too&lt;/a>.&lt;/p>
&lt;p>&lt;a href="https://www.typescriptlang.org/">TypeScript&lt;/a> is my preferred way to write JavaScript. You can run the compiler on the command line using Node.js (see &lt;a href="https://github.com/Microsoft/TypeScript">instructions in the repo&lt;/a>), it works pretty well &lt;a href="https://code.visualstudio.com/Docs/languages/typescript">with Visual Studio Code&lt;/a> out of the box, and of course there are multiple options for &lt;a href="https://code.visualstudio.com/Docs/languages/typescript#_typescript-extensions">extension integrations&lt;/a>.&lt;/p>
&lt;h2 id="quit-unnecessarily-beating-up-your-meatbrain" class="anchor-link">&lt;a href="#quit-unnecessarily-beating-up-your-meatbrain">Quit unnecessarily beating up your meatbrain&lt;/a>&lt;/h2>
&lt;p>I mean, you wouldn&amp;rsquo;t stand on your head all day to do your work. It would be rather inconvenient to read things upside down all the time (at least &lt;a href="https://www.youtube.com/watch?v=jKUVpBJalNQ">until your brain adjusted&lt;/a>), and in any case you&amp;rsquo;d likely get uncomfortably congested in short order. Working without taking advantage of the technical ergonomic tools I&amp;rsquo;ve given you today is a little like unnecessary inversion - why would you, if you don&amp;rsquo;t have to?&lt;/p></content:encoded><enclosure url="https://victoria.dev/blog/technical-ergonomics-for-the-efficient-developer/cover_hu5cda4cdd5e21d9163d35d5008411ea74_437949_640x0_resize_box_2.png" type="image/jpg"/></item><item><title>How to choose and care for a secure open source project</title><link>https://victoria.dev/blog/how-to-choose-and-care-for-a-secure-open-source-project/</link><pubDate>Mon, 25 May 2020 05:53:09 -0400</pubDate><author>hello@victoria.dev (Victoria Drake)</author><guid>https://victoria.dev/blog/how-to-choose-and-care-for-a-secure-open-source-project/</guid><description>A few tricks for assessing the security of an open source project.</description><content:encoded>
&lt;img src="https://victoria.dev/blog/how-to-choose-and-care-for-a-secure-open-source-project/cover_hud54af7e7470f13d96c78ecc119e47c11_781309_640x0_resize_box_2.png" width="640" height="256"/>
&lt;p>There is a rather progressive sect of the software development world that believes that most people would be a lot happier and get a lot more work done if they just stopped building things that someone else has already built and is offering up for free use. They&amp;rsquo;re called the open source community. They want you to take their stuff.&lt;/p>
&lt;p>
&lt;img src="https://victoria.dev/blog/how-to-choose-and-care-for-a-secure-open-source-project/wheels.png" alt="A comic I drew about using other people&amp;amp;rsquo;s stuff, with the wheel as an example." />
&lt;/p>
&lt;p>Besides existing without you having to lift a finger, open source tools and software have some distinct advantages. Especially in the case of well-established projects, it&amp;rsquo;s highly likely that someone else has already worked out all the most annoying bugs for you. Thanks to the ease with which users can view and modify source code, it&amp;rsquo;s also more likely that a program has been tinkered with, improved, and secured over time. When many developers contribute, they bring their own unique expertise and experiences. This can result in a product far more robust and capable than one a single developer can produce.&lt;/p>
&lt;p>Of course, being as varied as the people who build them, not all open source projects are created equal, nor maintained to be equally secure. There are many factors that affect a project&amp;rsquo;s suitability for your use case. Here are a few general considerations that make a good starting point when choosing an open source project.&lt;/p>
&lt;h2 id="how-to-choose-an-open-source-project" class="anchor-link">&lt;a href="#how-to-choose-an-open-source-project">How to choose an open source project&lt;/a>&lt;/h2>
&lt;p>As its most basic requirements, a good software project is reliable, easy to understand, and has up-to-date components and security. There are several indicators that can help you make an educated guess about whether an open source project satisfies these criteria.&lt;/p>
&lt;h3 id="whos-using-it" class="anchor-link">&lt;a href="#whos-using-it">Who&amp;rsquo;s using it&lt;/a>&lt;/h3>
&lt;p>Taken in context, the number of people already using an open source project may be indicative of how good it is. If a project has a hundred users, for instance, it stands to reason that someone has tried to use it at least a hundred times before you found it. Thus by the ancient customs of &amp;ldquo;I don&amp;rsquo;t know what&amp;rsquo;s in that cave, you go first,&amp;rdquo; it&amp;rsquo;s more likely to be fine.&lt;/p>
&lt;p>You can draw conclusions about a project&amp;rsquo;s user base by looking at available statistics. Depending on your platform, these may include the number of downloads, reviews, issues or tickets, comments, contributions, forks, or &amp;ldquo;stars,&amp;rdquo; whatever those are.&lt;/p>
&lt;p>Evaluate social statistics on platforms like GitHub with a grain of salt. They can help you determine how popular a project may be, but only in the same way that restaurant review apps can help you figure out if you should eat at Foo&amp;rsquo;s Grill &amp;amp; Bar. Depending on where Foo&amp;rsquo;s Grill &amp;amp; Bar is, when it opened, and how likely people are to be near it when the invariable steak craving should call, having twenty-six reviews may be a good sign or a terrible one. While you would not expect a project that addresses a very obscure use case or technology to have hundreds of users, having a few active users is, in such a case, just as confidence-inspiring.&lt;/p>
&lt;p>External validation can also be useful. For example, packages that are included in a Linux operating system distribution (distro) must conform to stringent standards and undergo vetting. Choosing software that is included in a distro&amp;rsquo;s default repositories can mean it&amp;rsquo;s more likely to be secure.&lt;/p>
&lt;p>Perhaps one of the best indications to look for is whether a project&amp;rsquo;s development team is using their own project. Look for issues, discussions, or blog posts that show that the project&amp;rsquo;s creators and maintainers are using what they&amp;rsquo;ve built themselves. Commonly referred to as &lt;a href="https://en.wikipedia.org/wiki/Eating_your_own_dog_food">&amp;ldquo;eating your own dog food,&amp;quot;&lt;/a> or &amp;ldquo;dogfooding,&amp;rdquo; it&amp;rsquo;s an indicator that the project is most likely to be well-maintained by its developers.&lt;/p>
&lt;h3 id="whos-building-it" class="anchor-link">&lt;a href="#whos-building-it">Who&amp;rsquo;s building it&lt;/a>&lt;/h3>
&lt;p>The main enemy of good open source software is usually a lack of interest. The parties involved in an open source project can make the difference between a flash-in-the-pan library and a respected long-term utility. Multiple committed maintainers, even making contributions in their spare time, have a much higher success rate of sustaining a project and generating interest.&lt;/p>
&lt;p>Projects with healthy interest are usually supported by, and in turn cultivate, a community of contributors and users. New contributors may be actively welcomed, clear guides are available explaining how to help, and project maintainers are available and approachable when people have inevitable questions. Some communities even have chat rooms or forums where people can interact outside of contributions. Active communities help sustain project interest, relevance, and its ensuing quality.&lt;/p>
&lt;p>In a less organic fashion, a project can also be sustained through organizations that sponsor it. Governments and companies with financial interest are open source patrons too, and a project that enjoys public sector use or financial backing has added incentive to remain relevant and useful.&lt;/p>
&lt;h3 id="how-alive-is-it" class="anchor-link">&lt;a href="#how-alive-is-it">How alive is it&lt;/a>&lt;/h3>
&lt;p>The recency and frequency of an open source project&amp;rsquo;s activity is perhaps the best indicator of how much attention is likely paid to its security. Look at releases, commit history, changelogs, or documentation revisions to determine if a project is active. As projects vary in size and scope, here are some general things to look for.&lt;/p>
&lt;p>Maintaining security is an ongoing endeavor that requires regular monitoring and updates, especially for projects with third-party components. These may be libraries or any part of the project that relies on something outside itself, such as a payment gateway integration. An inactive project is more likely to have outdated code or use outdated versions of components. For a more concrete determination, you can research a project&amp;rsquo;s third-party components and compare their most recent patches or updates with the project&amp;rsquo;s last updates.&lt;/p>
&lt;p>Projects without third-party components may have no outside updates to apply. In these cases, you can use recent activity and release notes to determine how committed a project&amp;rsquo;s maintainers may be. Generally, active projects should show updates within the last months, with a notable release within the last year. This can be a good indication of whether the project is using an up-to-date version of its language or framework.&lt;/p>
&lt;p>You can also judge how active a project may be by looking at the project maintainers themselves. Active maintainers quickly respond to feedback or new issues, even if it&amp;rsquo;s just to say, &amp;ldquo;We&amp;rsquo;re on it.&amp;rdquo; If the project has a community, its maintainers are a part of it. They may have a dedicated website or write regular blogs. They may offer ways to contact them directly and privately, especially to raise security concerns.&lt;/p>
&lt;h3 id="can-you-understand-it" class="anchor-link">&lt;a href="#can-you-understand-it">Can you understand it&lt;/a>&lt;/h3>
&lt;p>Having documentation is a baseline requirement for a project that&amp;rsquo;s intended for anyone but its creator to use. Good open source projects have documentation that is easy to follow, honest, and thorough.&lt;/p>
&lt;p>Having &lt;a href="https://victoria.dev/blog/word-bugs-in-software-documentation-and-how-to-fix-them/">well-written documentation&lt;/a> is one way a project can stand out and demonstrate the thoughtfulness and dedication of its maintainers. A &amp;ldquo;Getting Started&amp;rdquo; section may detail all the requirements and initial set up for running the project. An accurate list of topics in the documentation enables users to quickly find the information they need. A clear license statement leaves no doubt as to how the project can be used, and for what purposes. These are characteristic aspects of documentation that serves its users.&lt;/p>
&lt;p>A project that is following sound coding practices likely has code that is as readable as its documentation. Code that is easy to read lends itself to being understood. Generally, it has clearly defined and appropriately-named functions and variables, a logical flow, and apparent purpose. Readable code is easier to fix, secure, and build upon.&lt;/p>
&lt;h3 id="how-compatible-is-it" class="anchor-link">&lt;a href="#how-compatible-is-it">How compatible is it&lt;/a>&lt;/h3>
&lt;p>A few factors will determine how compatible a project is with your goals. These are objective qualities, and can be determined by looking at a project&amp;rsquo;s repository files. They include:&lt;/p>
&lt;ul>
&lt;li>Code language&lt;/li>
&lt;li>Specific technologies or frameworks&lt;/li>
&lt;li>License compatibility&lt;/li>
&lt;/ul>
&lt;p>Compatibility doesn&amp;rsquo;t necessarily mean a direct match. Different code languages can interact with each other, as can various technologies and frameworks. You should carefully read a project&amp;rsquo;s license to understand if it permits usage for your goal, or if it is compatible with a license you would like to use.&lt;/p>
&lt;p>Ultimately, a project that satisfies all these criteria may still not quite suit your use case. Part of the beauty of open source software, however, is that you may still benefit from it by making alterations that better suit your usage. If those alterations make the project better for everyone, you can pay it back and pay it forward by contributing your work to the project.&lt;/p>
&lt;h2 id="proper-care-and-feeding-of-an-open-source-project" class="anchor-link">&lt;a href="#proper-care-and-feeding-of-an-open-source-project">Proper care and feeding of an open source project&lt;/a>&lt;/h2>
&lt;p>Once you adopt an open source project, a little attention is required to make sure it continues to be a boon to your goals. While its maintainers will look after the upstream project files, you alone are responsible for your own copy. Like all software, your open source project must be well-maintained in order to remain as secure and useful as possible.&lt;/p>
&lt;p>Have a system that provides you with notifications when updates for your software are made available. Update software promptly, treating each patch as if it were vital to security; it may well be. Keep in mind that open source project creators and maintainers are, in most cases, acting only out of the goodness of their own hearts. If you&amp;rsquo;ve got a particularly awesome one, its developers may make updates and security patches available on a regular basis. It&amp;rsquo;s up to you to keep tabs on updates and promptly apply them.&lt;/p>
&lt;p>As with most things in software, keeping your open source additions modular can come in handy. You might use &lt;a href="https://git-scm.com/book/en/v2/Git-Tools-Submodules">git submodules&lt;/a>, branches, or environments to isolate your additions. This can make it easier to apply updates or pinpoint the source of any bugs that arise.&lt;/p>
&lt;p>So although an open source project may cost no money, &lt;em>caveat emptor,&lt;/em> which means, &amp;ldquo;Jimmy, if we get you a puppy, it&amp;rsquo;s your responsibility to take care of it.&amp;rdquo;&lt;/p></content:encoded><enclosure url="https://victoria.dev/blog/how-to-choose-and-care-for-a-secure-open-source-project/cover_hud54af7e7470f13d96c78ecc119e47c11_781309_640x0_resize_box_2.png" type="image/jpg"/></item><item><title>If you want to build a treehouse, start at the bottom</title><link>https://victoria.dev/blog/if-you-want-to-build-a-treehouse-start-at-the-bottom/</link><pubDate>Mon, 11 May 2020 05:46:47 -0400</pubDate><author>hello@victoria.dev (Victoria Drake)</author><guid>https://victoria.dev/blog/if-you-want-to-build-a-treehouse-start-at-the-bottom/</guid><description>How threat modeling and pushing left help create a stable foundation for secure software.</description><content:encoded>
&lt;img src="https://victoria.dev/blog/if-you-want-to-build-a-treehouse-start-at-the-bottom/cover_hua8600e69334c6e7df6a768e48e64579b_2921368_640x0_resize_box_2.png" width="640" height="256"/>
&lt;p>If you&amp;rsquo;ve ever watched a kid draw a treehouse, you have some idea of how applications are built when security isn&amp;rsquo;t made a priority. It&amp;rsquo;s far more fun to draw the tire swing, front porch, and swimming pool than to worry about how a ten-thousand-gallon bucket of water stays suspended in midair. With too much attention spent on fun and flashy features, foundations suffer.&lt;/p>
&lt;p>
&lt;img src="https://victoria.dev/blog/if-you-want-to-build-a-treehouse-start-at-the-bottom/for-the-turrets.png" alt="A comic I drew about building castles with poor foundations. It&amp;amp;rsquo;s not that funny." />
&lt;/p>
&lt;p>Of course, spending undue hours building a back end like Fort Knox may not be necessary for your application, either. Being an advocate for security doesn&amp;rsquo;t mean always wearing your tinfoil hat (although you do look dashing in it) but does mean building in an appropriate amount of security.&lt;/p>
&lt;p>How much security is appropriate? The answer, frustratingly, is, &amp;ldquo;it depends.&amp;rdquo; The right amount of security for your application depends on who&amp;rsquo;s using it, what it does, and most importantly, what undesirable things it could be made to do. It takes some analysis to make decisions about the kinds of risks your application faces and how you&amp;rsquo;ll prepare to handle them. Okay, now&amp;rsquo;s a good time to don your tinfoil hat. Let&amp;rsquo;s imagine the worst.&lt;/p>
&lt;h2 id="threat-modeling-whats-the-worst-that-could-happen" class="anchor-link">&lt;a href="#threat-modeling-whats-the-worst-that-could-happen">Threat modeling: what&amp;rsquo;s the worst that could happen&lt;/a>&lt;/h2>
&lt;p>A &lt;em>threat model&lt;/em> is a stuffy term for the result of trying to imagine the worst things that could happen to an application. Using your imagination to assess risks (fittingly called &lt;em>risk assessment&lt;/em>) is a conveniently non-destructive method for finding ways an application can be attacked. You won&amp;rsquo;t need any tools; just an understanding of how the application might work, and a little imagination. You&amp;rsquo;ll want to record your results with pen and paper. For the younger folks, that means the notes app on your phone.&lt;/p>
&lt;p>A few different methodologies for application risk assessment can be found in the software world, including the in-depth &lt;a href="https://csrc.nist.gov/publications/detail/sp/800-30/rev-1/final">NIST Special Publication 800-30&lt;/a>. Each method&amp;rsquo;s framework has specific steps and output, and will go into various levels of detail when it comes to defining threats. If following a framework, first choose the one you&amp;rsquo;re most likely to complete. You can always add more depth and detail from there.&lt;/p>
&lt;p>Even informal risk assessments are beneficial. Typically taking the form of a set of questions, they may be oriented around possible threats, the impact to assets, or ways a vulnerability could be exploited. Here are some examples of questions addressing each orientation:&lt;/p>
&lt;ul>
&lt;li>What kind of adversary would want to break my app? What would they be after?&lt;/li>
&lt;li>If the control of &lt;em>x&lt;/em> fell into the wrong hands, what could an attacker do with it?&lt;/li>
&lt;li>Where could a &lt;em>x&lt;/em> vulnerability occur in my app?&lt;/li>
&lt;/ul>
&lt;p>A basic threat model explains the technical, business, and human considerations for each risk. It will typically detail:&lt;/p>
&lt;ul>
&lt;li>The vulnerabilities or components that can cause the risk&lt;/li>
&lt;li>The impact that a successful execution of the risk would have on the application&lt;/li>
&lt;li>The consequences for the application&amp;rsquo;s users or organization&lt;/li>
&lt;/ul>
&lt;p>The result of a risk assessment exercise is your threat model; in other words, a list of things you would very much like not to occur. It is usually sorted in a hierarchy of risks, from the worst to the mildest. The worst risks have the most negative impact, and are most important to protect against. The mildest risks are the most acceptable - while still an undesirable outcome, they have the least negative impact on the application and users.&lt;/p>
&lt;p>You can use this resulting hierarchy as a guide to determine how much of your cybersecurity efforts to apply to each risk area. An appropriate amount of security for your application will eliminate (where possible) or mitigate the worst risks.&lt;/p>
&lt;h2 id="pushing-left" class="anchor-link">&lt;a href="#pushing-left">Pushing left&lt;/a>&lt;/h2>
&lt;p>Although it sounds like a dance move meme, &lt;em>pushing left&lt;/em> refers instead to building in as much of your planned security as possible in the early stages of software development.&lt;/p>
&lt;p>Building software is a lot like building a treehouse, just without the pleasant fresh air. You start with the basic supporting components, such as attaching a platform to a tree. Then comes the framing, walls, and roof, and finally, your rustic-modern Instagram-worthy wall hangings and deer bust.&lt;/p>
&lt;p>The further along in the build process you are, the harder and more costly it becomes to make changes to a component that you&amp;rsquo;ve already installed. If you discover a problem with the walls only after the roof is put in place, you may need to change or remove the roof in order to fix it. Similar parallels can be drawn for software components, only without similar ease in detangling the attached parts.&lt;/p>
&lt;p>In the case of a treehouse, it&amp;rsquo;s rather impossible to start with decorations or even a roof, since you can&amp;rsquo;t really suspend them in midair. In the case of software development, it is, unfortunately, possible to build many top-layer components and abstractions without a sufficient supporting architecture. A push-left approach views each additional layer as adding cost and complication. Pushing left means attempting to mitigate security risks as much as possible at each development stage before proceeding to the next.&lt;/p>
&lt;h2 id="building-bottom-to-top" class="anchor-link">&lt;a href="#building-bottom-to-top">Building bottom-to-top&lt;/a>&lt;/h2>
&lt;p>By considering your threat model in the early stages of developing your application, you reduce the chances of necessitating a costly remodel later on. You can make choices about architecture, components, and code that support the main security goals of your particular application.&lt;/p>
&lt;p>While it&amp;rsquo;s not possible to foresee all the functionality your application may one day need to support, it is possible to prepare a solid foundation that allows additional functionality to be added more securely. Building in appropriate security from the bottom to the top will help make mitigating security risks much easier in the future.&lt;/p></content:encoded><enclosure url="https://victoria.dev/blog/if-you-want-to-build-a-treehouse-start-at-the-bottom/cover_hua8600e69334c6e7df6a768e48e64579b_2921368_640x0_resize_box_2.png" type="image/jpg"/></item><item><title>Hugo vs Jekyll: an epic battle of static site generator themes</title><link>https://victoria.dev/blog/hugo-vs-jekyll-an-epic-battle-of-static-site-generator-themes/</link><pubDate>Mon, 27 Apr 2020 06:34:41 -0400</pubDate><author>hello@victoria.dev (Victoria Drake)</author><guid>https://victoria.dev/blog/hugo-vs-jekyll-an-epic-battle-of-static-site-generator-themes/</guid><description>A comparison of nuances of creating themes for the top two static site generators.</description><content:encoded>
&lt;img src="https://victoria.dev/blog/hugo-vs-jekyll-an-epic-battle-of-static-site-generator-themes/cover_hu4062a8088076745a0cbb2c0ac38fd85a_2115819_640x0_resize_box_2.png" width="640" height="256"/>
&lt;p>I recently took on the task of creating a documentation site theme for two projects. Both projects needed the same basic features, but one uses Jekyll while the other uses Hugo.&lt;/p>
&lt;p>In typical developer rationality, there was clearly only one option. I decided to create the same theme in both frameworks, and to give you, dear reader, a side-by-side comparison.&lt;/p>
&lt;p>This post isn&amp;rsquo;t a comprehensive theme-building guide, but intended to familiarize you with the process of building a theme in either generator. Here&amp;rsquo;s what we&amp;rsquo;ll cover:&lt;/p>
&lt;ul>
&lt;li>&lt;a href="#how-theme-files-are-organized">How theme files are organized&lt;/a>&lt;/li>
&lt;li>&lt;a href="#where-to-put-content">Where to put content&lt;/a>&lt;/li>
&lt;li>&lt;a href="#how-templating-works">How templating works&lt;/a>&lt;/li>
&lt;li>&lt;a href="#creating-a-top-level-menu-with-the-pages-object">Creating a top-level menu with the &lt;code>pages&lt;/code> object&lt;/a>&lt;/li>
&lt;li>&lt;a href="#creating-a-menu-with-nested-links-from-a-data-list">Creating a menu with nested links from a data list&lt;/a>&lt;/li>
&lt;li>&lt;a href="#putting-the-template-together">Putting the template together&lt;/a>&lt;/li>
&lt;li>&lt;a href="#create-a-stylesheet">Create a stylesheet&lt;/a>
&lt;ul>
&lt;li>&lt;a href="#sass-and-css-in-jekyll">Sass and CSS in Jekyll&lt;/a>&lt;/li>
&lt;li>&lt;a href="#sass-and-hugo-pipes-in-hugo">Sass and Hugo Pipes in Hugo&lt;/a>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>&lt;a href="#configure-and-deploy-to-github-pages">Configure and deploy to GitHub Pages&lt;/a>
&lt;ul>
&lt;li>&lt;a href="#configure-jekyll">Configure Jekyll&lt;/a>&lt;/li>
&lt;li>&lt;a href="#configure-hugo">Configure Hugo&lt;/a>&lt;/li>
&lt;li>&lt;a href="#deploy-to-github-pages">Deploy to GitHub Pages&lt;/a>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>&lt;a href="#showtime">Showtime!&lt;/a>&lt;/li>
&lt;li>&lt;a href="#wait-who-won">Wait who won?&lt;/a>&lt;/li>
&lt;/ul>
&lt;p>Here&amp;rsquo;s a crappy wireframe of the theme I&amp;rsquo;m going to create.&lt;/p>
&lt;p>
&lt;img src="https://victoria.dev/blog/hugo-vs-jekyll-an-epic-battle-of-static-site-generator-themes/wireframe.jpg" alt="A sketch of the finished page" />
&lt;/p>
&lt;p>If you&amp;rsquo;re planning to build-along, it may be helpful to serve the theme locally as you build it; both generators offer this functionality. For Jekyll, run &lt;code>jekyll serve&lt;/code>, and for Hugo, &lt;code>hugo serve&lt;/code>.&lt;/p>
&lt;p>There are two main elements: the main content area, and the all-important sidebar menu. To create them, you&amp;rsquo;ll need template files that tell the site generator how to generate the HTML page. To organize theme template files in a sensible way, you first need to know what directory structure the site generator expects.&lt;/p>
&lt;h2 id="how-theme-files-are-organized" class="anchor-link">&lt;a href="#how-theme-files-are-organized">How theme files are organized&lt;/a>&lt;/h2>
&lt;p>Jekyll supports gem-based themes, which users can install like any other Ruby gems. This method hides theme files in the gem, so for the purposes of this comparison, we aren&amp;rsquo;t using gem-based themes.&lt;/p>
&lt;p>When you run &lt;code>jekyll new-theme &amp;lt;name&amp;gt;&lt;/code>, Jekyll will scaffold a new theme for you. Here&amp;rsquo;s what those files look like:&lt;/p>
&lt;div class="highlight">&lt;pre class="chroma">&lt;code class="language-sh" data-lang="sh">.
 assets
 Gemfile
 _includes
 _layouts
  default.html
  page.html
  post.html
 LICENSE.txt
 README.md
 _sass
 &amp;lt;name&amp;gt;.gemspec
&lt;/code>&lt;/pre>&lt;/div>&lt;p>The directory names are appropriately descriptive. The &lt;code>_includes&lt;/code> directory is for small bits of code that you reuse in different places, in much the same way you&amp;rsquo;d put butter on everything. (Just me?) The &lt;code>_layouts&lt;/code> directory contains templates for different types of pages on your site. The &lt;code>_sass&lt;/code> folder is for &lt;a href="https://sass-lang.com/documentation/syntax">Sass&lt;/a> files used to build your site&amp;rsquo;s stylesheet.&lt;/p>
&lt;p>You can scaffold a new Hugo theme by running &lt;code>hugo new theme &amp;lt;name&amp;gt;&lt;/code>. It has these files:&lt;/p>
&lt;div class="highlight">&lt;pre class="chroma">&lt;code class="language-sh" data-lang="sh">.
 archetypes
  default.md
 layouts
  404.html
  _default
   baseof.html
   list.html
   single.html
  index.html
  partials
  footer.html
  header.html
  head.html
 LICENSE
 static
  css
  js
 theme.toml
&lt;/code>&lt;/pre>&lt;/div>&lt;p>You can see some similarities. Hugo&amp;rsquo;s page template files are tucked into &lt;code>layouts/&lt;/code>. Note that the &lt;code>_default&lt;/code> page type has files for a &lt;code>list.html&lt;/code> and a &lt;code>single.html&lt;/code>. Unlike Jekyll, Hugo uses these specific file names to distinguish between &lt;a href="https://gohugo.io/templates/lists/">list pages&lt;/a> (like a page with links to all your blog posts on it) and &lt;a href="https://gohugo.io/templates/single-page-templates/">single pages&lt;/a> (like one of your blog posts). The &lt;code>layouts/partials/&lt;/code> directory contains the buttery reusable bits, and stylesheet files have a spot picked out in &lt;code>static/css/&lt;/code>.&lt;/p>
&lt;p>These directory structures aren&amp;rsquo;t set in stone, as both site generators allow some measure of customization. For example, Jekyll lets you define &lt;a href="https://jekyllrb.com/docs/collections/">collections&lt;/a>, and Hugo makes use of &lt;a href="https://gohugo.io/content-management/page-bundles/">page bundles&lt;/a>. These features let you organize your content multiple ways, but for now, lets look at where to put some simple pages.&lt;/p>
&lt;h2 id="where-to-put-content" class="anchor-link">&lt;a href="#where-to-put-content">Where to put content&lt;/a>&lt;/h2>
&lt;p>To create a site menu that looks like this:&lt;/p>
&lt;div class="highlight">&lt;pre class="chroma">&lt;code class="language-md" data-lang="md">Introduction
Getting Started
Configuration
Deploying
Advanced Usage
All Configuration Settings
Customizing
Help and Support
&lt;/code>&lt;/pre>&lt;/div>&lt;p>You&amp;rsquo;ll need two sections (&amp;ldquo;Introduction&amp;rdquo; and &amp;ldquo;Advanced Usage&amp;rdquo;) containing their respective subsections.&lt;/p>
&lt;p>Jekyll isn&amp;rsquo;t strict with its content location. It expects pages in the root of your site, and will build whatever&amp;rsquo;s there. Here&amp;rsquo;s how you might organize these pages in your Jekyll site root:&lt;/p>
&lt;div class="highlight">&lt;pre class="chroma">&lt;code class="language-sh" data-lang="sh">.
 404.html
 assets
 Gemfile
 _includes
 index.markdown
 intro
  config.md
  deploy.md
  index.md
  quickstart.md
 _layouts
  default.html
  page.html
  post.html
 LICENSE.txt
 README.md
 _sass
 &amp;lt;name&amp;gt;.gemspec
 usage
 customizing.md
 index.md
 settings.md
 support.md
&lt;/code>&lt;/pre>&lt;/div>&lt;p>You can change the location of the site source in your &lt;a href="https://jekyllrb.com/docs/configuration/default/">Jekyll configuration&lt;/a>.&lt;/p>
&lt;p>In Hugo, all rendered content is expected in the &lt;code>content/&lt;/code> folder. This prevents Hugo from trying to render pages you don&amp;rsquo;t want, such as &lt;code>404.html&lt;/code>, as site content. Here&amp;rsquo;s how you might organize your &lt;code>content/&lt;/code> directory in Hugo:&lt;/p>
&lt;div class="highlight">&lt;pre class="chroma">&lt;code class="language-sh" data-lang="sh">.
 _index.md
 intro
  config.md
  deploy.md
  _index.md
  quickstart.md
 usage
 customizing.md
 _index.md
 settings.md
 support.md
&lt;/code>&lt;/pre>&lt;/div>&lt;p>To Hugo, &lt;code>_index.md&lt;/code> and &lt;code>index.md&lt;/code> mean different things. It can be helpful to know what kind of &lt;a href="https://gohugo.io/content-management/page-bundles/">Page Bundle&lt;/a> you want for each section: Leaf, which has no children, or Branch.&lt;/p>
&lt;p>Now that you have some idea of where to put things, let&amp;rsquo;s look at how to build a page template.&lt;/p>
&lt;h2 id="how-templating-works" class="anchor-link">&lt;a href="#how-templating-works">How templating works&lt;/a>&lt;/h2>
&lt;p>Jekyll page templates are built with the &lt;a href="https://jekyllrb.com/docs/liquid/">Liquid templating language&lt;/a>. It uses braces to output variable content to a page, such as the page&amp;rsquo;s title: &lt;code>{{ page.title }}&lt;/code>.&lt;/p>
&lt;p>Hugo&amp;rsquo;s templates also use braces, but they&amp;rsquo;re built with &lt;a href="https://gohugo.io/templates/introduction/">Go Templates&lt;/a>. The syntax is similar, but different: &lt;code>{{ .Title }}&lt;/code>.&lt;/p>
&lt;p>Both Liquid and Go Templates can handle logic. Liquid uses &lt;em>tags&lt;/em> syntax to denote logic operations:&lt;/p>
&lt;pre>&lt;code class="language-liquid" data-lang="liquid">{% if user %}
Hello {{ user.name }}!
{% endif %}
&lt;/code>&lt;/pre>&lt;p>And Go Templates places its functions and arguments in its braces syntax:&lt;/p>
&lt;div class="highlight">&lt;pre class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="p">{{&lt;/span> &lt;span class="k">if&lt;/span> &lt;span class="p">.&lt;/span>&lt;span class="nx">User&lt;/span> &lt;span class="p">}}&lt;/span>
&lt;span class="nx">Hello&lt;/span> &lt;span class="p">{{&lt;/span> &lt;span class="p">.&lt;/span>&lt;span class="nx">User&lt;/span> &lt;span class="p">}}!&lt;/span>
&lt;span class="p">{{&lt;/span> &lt;span class="nx">end&lt;/span> &lt;span class="p">}}&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>Templating languages allow you to build one skeleton HTML page, then tell the site generator to put variable content in areas you define. Let&amp;rsquo;s compare two possible &lt;code>default&lt;/code> page templates for Jekyll and Hugo.&lt;/p>
&lt;p>Jekyll&amp;rsquo;s scaffold &lt;code>default&lt;/code> theme is bare, so we&amp;rsquo;ll look at their starter theme &lt;a href="https://github.com/jekyll/minima">Minima&lt;/a>. Here&amp;rsquo;s &lt;code>_layouts/default.html&lt;/code> in Jekyll (Liquid):&lt;/p>
&lt;div class="highlight">&lt;pre class="chroma">&lt;code class="language-html" data-lang="html">&lt;span class="cp">&amp;lt;!DOCTYPE html&amp;gt;&lt;/span>
&lt;span class="p">&amp;lt;&lt;/span>&lt;span class="nt">html&lt;/span> &lt;span class="na">lang&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s">&amp;#34;{{ page.lang | default: site.lang | default: &amp;#34;&lt;/span>&lt;span class="na">en&lt;/span>&lt;span class="err">&amp;#34;&lt;/span> &lt;span class="err">}}&amp;#34;&lt;/span>&lt;span class="p">&amp;gt;&lt;/span>
{%- include head.html -%}
&lt;span class="p">&amp;lt;&lt;/span>&lt;span class="nt">body&lt;/span>&lt;span class="p">&amp;gt;&lt;/span>
{%- include header.html -%}
&lt;span class="p">&amp;lt;&lt;/span>&lt;span class="nt">main&lt;/span> &lt;span class="na">class&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s">&amp;#34;page-content&amp;#34;&lt;/span> &lt;span class="na">aria-label&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s">&amp;#34;Content&amp;#34;&lt;/span>&lt;span class="p">&amp;gt;&lt;/span>
&lt;span class="p">&amp;lt;&lt;/span>&lt;span class="nt">div&lt;/span> &lt;span class="na">class&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s">&amp;#34;wrapper&amp;#34;&lt;/span>&lt;span class="p">&amp;gt;&lt;/span>
{{ content }}
&lt;span class="p">&amp;lt;/&lt;/span>&lt;span class="nt">div&lt;/span>&lt;span class="p">&amp;gt;&lt;/span>
&lt;span class="p">&amp;lt;/&lt;/span>&lt;span class="nt">main&lt;/span>&lt;span class="p">&amp;gt;&lt;/span>
{%- include footer.html -%}
&lt;span class="p">&amp;lt;/&lt;/span>&lt;span class="nt">body&lt;/span>&lt;span class="p">&amp;gt;&lt;/span>
&lt;span class="p">&amp;lt;/&lt;/span>&lt;span class="nt">html&lt;/span>&lt;span class="p">&amp;gt;&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>Here&amp;rsquo;s Hugo&amp;rsquo;s scaffold theme &lt;code>layouts/_default/baseof.html&lt;/code> (Go Templates):&lt;/p>
&lt;div class="highlight">&lt;pre class="chroma">&lt;code class="language-html" data-lang="html">&lt;span class="cp">&amp;lt;!DOCTYPE html&amp;gt;&lt;/span>
&lt;span class="p">&amp;lt;&lt;/span>&lt;span class="nt">html&lt;/span>&lt;span class="p">&amp;gt;&lt;/span>
{{- partial &amp;#34;head.html&amp;#34; . -}}
&lt;span class="p">&amp;lt;&lt;/span>&lt;span class="nt">body&lt;/span>&lt;span class="p">&amp;gt;&lt;/span>
{{- partial &amp;#34;header.html&amp;#34; . -}}
&lt;span class="p">&amp;lt;&lt;/span>&lt;span class="nt">div&lt;/span> &lt;span class="na">id&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s">&amp;#34;content&amp;#34;&lt;/span>&lt;span class="p">&amp;gt;&lt;/span>
{{- block &amp;#34;main&amp;#34; . }}{{- end }}
&lt;span class="p">&amp;lt;/&lt;/span>&lt;span class="nt">div&lt;/span>&lt;span class="p">&amp;gt;&lt;/span>
{{- partial &amp;#34;footer.html&amp;#34; . -}}
&lt;span class="p">&amp;lt;/&lt;/span>&lt;span class="nt">body&lt;/span>&lt;span class="p">&amp;gt;&lt;/span>
&lt;span class="p">&amp;lt;/&lt;/span>&lt;span class="nt">html&lt;/span>&lt;span class="p">&amp;gt;&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>Different syntax, same idea. Both templates pull in reusable bits for &lt;code>head.html&lt;/code>, &lt;code>header.html&lt;/code>, and &lt;code>footer.html&lt;/code>. These show up on a lot of pages, so it makes sense not to have to repeat yourself. Both templates also have a spot for the main content, though the Jekyll template uses a variable (&lt;code>{{ content }}&lt;/code>) while Hugo uses a block (&lt;code>{{- block &amp;quot;main&amp;quot; . }}{{- end }}&lt;/code>). &lt;a href="https://gohugo.io/templates/base/#readout">Blocks&lt;/a> are just another way Hugo lets you define reusable bits.&lt;/p>
&lt;p>Now that you know how templating works, you can build the sidebar menu for the theme.&lt;/p>
&lt;h2 id="creating-a-top-level-menu-with-the-pages-object" class="anchor-link">&lt;a href="#creating-a-top-level-menu-with-the-pages-object">Creating a top-level menu with the &lt;code>pages&lt;/code> object&lt;/a>&lt;/h2>
&lt;p>You can programmatically create a top-level menu from your pages. It will look like this:&lt;/p>
&lt;div class="highlight">&lt;pre class="chroma">&lt;code class="language-md" data-lang="md">Introduction
Advanced Usage
&lt;/code>&lt;/pre>&lt;/div>&lt;p>Let&amp;rsquo;s start with Jekyll. You can display links to site pages in your Liquid template by iterating through the &lt;code>site.pages&lt;/code> object that Jekyll provides and building a list:&lt;/p>
&lt;div class="highlight">&lt;pre class="chroma">&lt;code class="language-html" data-lang="html">&lt;span class="p">&amp;lt;&lt;/span>&lt;span class="nt">ul&lt;/span>&lt;span class="p">&amp;gt;&lt;/span>
{% for page in site.pages %}
&lt;span class="p">&amp;lt;&lt;/span>&lt;span class="nt">li&lt;/span>&lt;span class="p">&amp;gt;&amp;lt;&lt;/span>&lt;span class="nt">a&lt;/span> &lt;span class="na">href&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s">&amp;#34;{{ page.url | absolute_url }}&amp;#34;&lt;/span>&lt;span class="p">&amp;gt;&lt;/span>{{ page.title }}&lt;span class="p">&amp;lt;/&lt;/span>&lt;span class="nt">a&lt;/span>&lt;span class="p">&amp;gt;&amp;lt;/&lt;/span>&lt;span class="nt">li&lt;/span>&lt;span class="p">&amp;gt;&lt;/span>
{% endfor %}
&lt;span class="p">&amp;lt;/&lt;/span>&lt;span class="nt">ul&lt;/span>&lt;span class="p">&amp;gt;&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>This returns all of the site&amp;rsquo;s pages, including all the ones that you might not want, like &lt;code>404.html&lt;/code>. You can filter for the pages you actually want with a couple more tags, such as conditionally including pages if they have a &lt;code>section: true&lt;/code> parameter set:&lt;/p>
&lt;div class="highlight">&lt;pre class="chroma">&lt;code class="language-html" data-lang="html">&lt;span class="p">&amp;lt;&lt;/span>&lt;span class="nt">ul&lt;/span>&lt;span class="p">&amp;gt;&lt;/span>
{% for page in site.pages %}
{%- if page.section -%}
&lt;span class="p">&amp;lt;&lt;/span>&lt;span class="nt">li&lt;/span>&lt;span class="p">&amp;gt;&amp;lt;&lt;/span>&lt;span class="nt">a&lt;/span> &lt;span class="na">href&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s">&amp;#34;{{ page.url | absolute_url }}&amp;#34;&lt;/span>&lt;span class="p">&amp;gt;&lt;/span>{{ page.title }}&lt;span class="p">&amp;lt;/&lt;/span>&lt;span class="nt">a&lt;/span>&lt;span class="p">&amp;gt;&amp;lt;/&lt;/span>&lt;span class="nt">li&lt;/span>&lt;span class="p">&amp;gt;&lt;/span>
{%- endif -%}
{% endfor %}
&lt;span class="p">&amp;lt;/&lt;/span>&lt;span class="nt">ul&lt;/span>&lt;span class="p">&amp;gt;&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>You can achieve the same effect with slightly less code in Hugo. Loop through Hugo&amp;rsquo;s &lt;code>.Pages&lt;/code> object using Go Template&amp;rsquo;s &lt;a href="https://golang.org/pkg/text/template/#hdr-Actions">&lt;code>range&lt;/code> action&lt;/a>:&lt;/p>
&lt;div class="highlight">&lt;pre class="chroma">&lt;code class="language-html" data-lang="html">&lt;span class="p">&amp;lt;&lt;/span>&lt;span class="nt">ul&lt;/span>&lt;span class="p">&amp;gt;&lt;/span>
{{ range .Pages }}
&lt;span class="p">&amp;lt;&lt;/span>&lt;span class="nt">li&lt;/span>&lt;span class="p">&amp;gt;&lt;/span>
&lt;span class="p">&amp;lt;&lt;/span>&lt;span class="nt">a&lt;/span> &lt;span class="na">href&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s">&amp;#34;{{.Permalink}}&amp;#34;&lt;/span>&lt;span class="p">&amp;gt;&lt;/span>{{.Title}}&lt;span class="p">&amp;lt;/&lt;/span>&lt;span class="nt">a&lt;/span>&lt;span class="p">&amp;gt;&lt;/span>
&lt;span class="p">&amp;lt;/&lt;/span>&lt;span class="nt">li&lt;/span>&lt;span class="p">&amp;gt;&lt;/span>
{{ end }}
&lt;span class="p">&amp;lt;/&lt;/span>&lt;span class="nt">ul&lt;/span>&lt;span class="p">&amp;gt;&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>This template uses the &lt;code>.Pages&lt;/code> object to return all the top-level pages in &lt;code>content/&lt;/code> of your Hugo site. Since Hugo uses a specific folder for the site content you want rendered, there&amp;rsquo;s no additional filtering necessary to build a simple menu of site pages.&lt;/p>
&lt;h2 id="creating-a-menu-with-nested-links-from-a-data-list" class="anchor-link">&lt;a href="#creating-a-menu-with-nested-links-from-a-data-list">Creating a menu with nested links from a data list&lt;/a>&lt;/h2>
&lt;p>Both site generators can use a separately defined data list of links to render a menu in your template. This is more suitable for creating nested links, like this:&lt;/p>
&lt;div class="highlight">&lt;pre class="chroma">&lt;code class="language-md" data-lang="md">Introduction
Getting Started
Configuration
Deploying
Advanced Usage
All Configuration Settings
Customizing
Help and Support
&lt;/code>&lt;/pre>&lt;/div>&lt;p>Jekyll supports &lt;a href="https://jekyllrb.com/docs/datafiles/">data files&lt;/a> in a few formats, including YAML. Here&amp;rsquo;s the definition for the menu above in &lt;code>_data/menu.yml&lt;/code>:&lt;/p>
&lt;div class="highlight">&lt;pre class="chroma">&lt;code class="language-yml" data-lang="yml">&lt;span class="nt">section&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>- &lt;span class="nt">page&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">Introduction&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nt">url&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">/intro&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nt">subsection&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>- &lt;span class="nt">page&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">Getting Started&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nt">url&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">/intro/quickstart&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>- &lt;span class="nt">page&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">Configuration&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nt">url&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">/intro/config&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>- &lt;span class="nt">page&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">Deploying&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nt">url&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">/intro/deploy&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>- &lt;span class="nt">page&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">Advanced Usage&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nt">url&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">/usage&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nt">subsection&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>- &lt;span class="nt">page&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">Customizing&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nt">url&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">/usage/customizing&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>- &lt;span class="nt">page&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">All Configuration Settings&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nt">url&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">/usage/settings&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>- &lt;span class="nt">page&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">Help and Support&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nt">url&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">/usage/support&lt;/span>&lt;span class="w">
&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>Here&amp;rsquo;s how to render the data in the sidebar template:&lt;/p>
&lt;div class="highlight">&lt;pre class="chroma">&lt;code class="language-html" data-lang="html">{% for a in site.data.menu.section %}
&lt;span class="p">&amp;lt;&lt;/span>&lt;span class="nt">a&lt;/span> &lt;span class="na">href&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s">&amp;#34;{{ a.url }}&amp;#34;&lt;/span>&lt;span class="p">&amp;gt;&lt;/span>{{ a.page }}&lt;span class="p">&amp;lt;/&lt;/span>&lt;span class="nt">a&lt;/span>&lt;span class="p">&amp;gt;&lt;/span>
&lt;span class="p">&amp;lt;&lt;/span>&lt;span class="nt">ul&lt;/span>&lt;span class="p">&amp;gt;&lt;/span>
{% for b in a.subsection %}
&lt;span class="p">&amp;lt;&lt;/span>&lt;span class="nt">li&lt;/span>&lt;span class="p">&amp;gt;&amp;lt;&lt;/span>&lt;span class="nt">a&lt;/span> &lt;span class="na">href&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s">&amp;#34;{{ b.url }}&amp;#34;&lt;/span>&lt;span class="p">&amp;gt;&lt;/span>{{ b.page }}&lt;span class="p">&amp;lt;/&lt;/span>&lt;span class="nt">a&lt;/span>&lt;span class="p">&amp;gt;&amp;lt;/&lt;/span>&lt;span class="nt">li&lt;/span>&lt;span class="p">&amp;gt;&lt;/span>
{% endfor %}
&lt;span class="p">&amp;lt;/&lt;/span>&lt;span class="nt">ul&lt;/span>&lt;span class="p">&amp;gt;&lt;/span>
{% endfor %}
&lt;/code>&lt;/pre>&lt;/div>&lt;p>This method allows you to build a custom menu, two nesting levels deep. The nesting levels are limited by the &lt;code>for&lt;/code> loops in the template. For a recursive version that handles further levels of nesting, see &lt;a href="https://jekyllrb.com/tutorials/navigation/#scenario-9-nested-tree-navigation-with-recursion">Nested tree navigation with recursion&lt;/a>.&lt;/p>
&lt;p>Hugo does something similar with its &lt;a href="https://gohugo.io/templates/menu-templates/#section-menu-for-lazy-bloggers">menu templates&lt;/a>. You can define menu links in your &lt;a href="https://gohugo.io/getting-started/configuration/">Hugo site config&lt;/a>, and even add useful properties that Hugo understands, like weighting. Here&amp;rsquo;s a definition of the menu above in &lt;code>config.yaml&lt;/code>:&lt;/p>
&lt;div class="highlight">&lt;pre class="chroma">&lt;code class="language-yml" data-lang="yml">&lt;span class="nt">sectionPagesMenu&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">main&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w">&lt;/span>&lt;span class="nt">menu&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nt">main&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>- &lt;span class="nt">identifier&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">intro&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nt">name&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">Introduction&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nt">url&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">/intro/&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nt">weight&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="m">1&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>- &lt;span class="nt">name&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">Getting Started&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nt">parent&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">intro&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nt">url&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">/intro/quickstart/&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nt">weight&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="m">1&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>- &lt;span class="nt">name&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">Configuration&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nt">parent&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">intro&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nt">url&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">/intro/config/&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nt">weight&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="m">2&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>- &lt;span class="nt">name&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">Deploying&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nt">parent&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">intro&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nt">url&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">/intro/deploy/&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nt">weight&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="m">3&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>- &lt;span class="nt">identifier&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">usage&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nt">name&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">Advanced Usage&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nt">url&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">/usage/&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>- &lt;span class="nt">name&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">Customizing&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nt">parent&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">usage&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nt">url&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">/usage/customizing/&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nt">weight&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="m">2&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>- &lt;span class="nt">name&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">All Configuration Settings&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nt">parent&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">usage&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nt">url&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">/usage/settings/&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nt">weight&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="m">1&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>- &lt;span class="nt">name&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">Help and Support&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nt">parent&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">usage&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nt">url&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">/usage/support/&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nt">weight&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="m">3&lt;/span>&lt;span class="w">
&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>Hugo uses the &lt;code>identifier&lt;/code>, which must match the section name, along with the &lt;code>parent&lt;/code> variable to handle nesting. Here&amp;rsquo;s how to render the menu in the sidebar template:&lt;/p>
&lt;div class="highlight">&lt;pre class="chroma">&lt;code class="language-html" data-lang="html">&lt;span class="p">&amp;lt;&lt;/span>&lt;span class="nt">ul&lt;/span>&lt;span class="p">&amp;gt;&lt;/span>
{{ range .Site.Menus.main }}
{{ if .HasChildren }}
&lt;span class="p">&amp;lt;&lt;/span>&lt;span class="nt">li&lt;/span>&lt;span class="p">&amp;gt;&lt;/span>
&lt;span class="p">&amp;lt;&lt;/span>&lt;span class="nt">a&lt;/span> &lt;span class="na">href&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s">&amp;#34;{{ .URL }}&amp;#34;&lt;/span>&lt;span class="p">&amp;gt;&lt;/span>{{ .Name }}&lt;span class="p">&amp;lt;/&lt;/span>&lt;span class="nt">a&lt;/span>&lt;span class="p">&amp;gt;&lt;/span>
&lt;span class="p">&amp;lt;/&lt;/span>&lt;span class="nt">li&lt;/span>&lt;span class="p">&amp;gt;&lt;/span>
&lt;span class="p">&amp;lt;&lt;/span>&lt;span class="nt">ul&lt;/span> &lt;span class="na">class&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s">&amp;#34;sub-menu&amp;#34;&lt;/span>&lt;span class="p">&amp;gt;&lt;/span>
{{ range .Children }}
&lt;span class="p">&amp;lt;&lt;/span>&lt;span class="nt">li&lt;/span>&lt;span class="p">&amp;gt;&lt;/span>
&lt;span class="p">&amp;lt;&lt;/span>&lt;span class="nt">a&lt;/span> &lt;span class="na">href&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s">&amp;#34;{{ .URL }}&amp;#34;&lt;/span>&lt;span class="p">&amp;gt;&lt;/span>{{ .Name }}&lt;span class="p">&amp;lt;/&lt;/span>&lt;span class="nt">a&lt;/span>&lt;span class="p">&amp;gt;&lt;/span>
&lt;span class="p">&amp;lt;/&lt;/span>&lt;span class="nt">li&lt;/span>&lt;span class="p">&amp;gt;&lt;/span>
{{ end }}
&lt;span class="p">&amp;lt;/&lt;/span>&lt;span class="nt">ul&lt;/span>&lt;span class="p">&amp;gt;&lt;/span>
{{ else }}
&lt;span class="p">&amp;lt;&lt;/span>&lt;span class="nt">li&lt;/span>&lt;span class="p">&amp;gt;&lt;/span>
&lt;span class="p">&amp;lt;&lt;/span>&lt;span class="nt">a&lt;/span> &lt;span class="na">href&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s">&amp;#34;{{ .URL }}&amp;#34;&lt;/span>&lt;span class="p">&amp;gt;&lt;/span>{{ .Name }}&lt;span class="p">&amp;lt;/&lt;/span>&lt;span class="nt">a&lt;/span>&lt;span class="p">&amp;gt;&lt;/span>
&lt;span class="p">&amp;lt;/&lt;/span>&lt;span class="nt">li&lt;/span>&lt;span class="p">&amp;gt;&lt;/span>
{{ end }}
{{ end }}
&lt;span class="p">&amp;lt;/&lt;/span>&lt;span class="nt">ul&lt;/span>&lt;span class="p">&amp;gt;&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>The &lt;code>range&lt;/code> function iterates over the menu data, and Hugo&amp;rsquo;s &lt;code>.Children&lt;/code> variable handles nested pages for you.&lt;/p>
&lt;h2 id="putting-the-template-together" class="anchor-link">&lt;a href="#putting-the-template-together">Putting the template together&lt;/a>&lt;/h2>
&lt;p>With your menu in your reusable sidebar bit (&lt;code>_includes/sidebar.html&lt;/code> for Jekyll and &lt;code>partials/sidebar.html&lt;/code> for Hugo), you can add it to the &lt;code>default.html&lt;/code> template.&lt;/p>
&lt;p>In Jekyll:&lt;/p>
&lt;div class="highlight">&lt;pre class="chroma">&lt;code class="language-html" data-lang="html">&lt;span class="cp">&amp;lt;!DOCTYPE html&amp;gt;&lt;/span>
&lt;span class="p">&amp;lt;&lt;/span>&lt;span class="nt">html&lt;/span> &lt;span class="na">lang&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s">&amp;#34;{{ page.lang | default: site.lang | default: &amp;#34;&lt;/span>&lt;span class="na">en&lt;/span>&lt;span class="err">&amp;#34;&lt;/span> &lt;span class="err">}}&amp;#34;&lt;/span>&lt;span class="p">&amp;gt;&lt;/span>
{%- include head.html -%}
&lt;span class="p">&amp;lt;&lt;/span>&lt;span class="nt">body&lt;/span>&lt;span class="p">&amp;gt;&lt;/span>
{%- include sidebar.html -%}
{%- include header.html -%}
&lt;span class="p">&amp;lt;&lt;/span>&lt;span class="nt">div&lt;/span> &lt;span class="na">id&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s">&amp;#34;content&amp;#34;&lt;/span> &lt;span class="na">class&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s">&amp;#34;page-content&amp;#34;&lt;/span> &lt;span class="na">aria-label&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s">&amp;#34;Content&amp;#34;&lt;/span>&lt;span class="p">&amp;gt;&lt;/span>
{{ content }}
&lt;span class="p">&amp;lt;/&lt;/span>&lt;span class="nt">div&lt;/span>&lt;span class="p">&amp;gt;&lt;/span>
{%- include footer.html -%}
&lt;span class="p">&amp;lt;/&lt;/span>&lt;span class="nt">body&lt;/span>&lt;span class="p">&amp;gt;&lt;/span>
&lt;span class="p">&amp;lt;/&lt;/span>&lt;span class="nt">html&lt;/span>&lt;span class="p">&amp;gt;&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>In Hugo:&lt;/p>
&lt;div class="highlight">&lt;pre class="chroma">&lt;code class="language-html" data-lang="html">&lt;span class="cp">&amp;lt;!DOCTYPE html&amp;gt;&lt;/span>
&lt;span class="p">&amp;lt;&lt;/span>&lt;span class="nt">html&lt;/span>&lt;span class="p">&amp;gt;&lt;/span>
{{- partial &amp;#34;head.html&amp;#34; . -}}
&lt;span class="p">&amp;lt;&lt;/span>&lt;span class="nt">body&lt;/span>&lt;span class="p">&amp;gt;&lt;/span>
{{- partial &amp;#34;sidebar.html&amp;#34; . -}}
{{- partial &amp;#34;header.html&amp;#34; . -}}
&lt;span class="p">&amp;lt;&lt;/span>&lt;span class="nt">div&lt;/span> &lt;span class="na">id&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s">&amp;#34;content&amp;#34;&lt;/span> &lt;span class="na">class&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s">&amp;#34;page-content&amp;#34;&lt;/span> &lt;span class="na">aria-label&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s">&amp;#34;Content&amp;#34;&lt;/span>&lt;span class="p">&amp;gt;&lt;/span>
{{- block &amp;#34;main&amp;#34; . }}{{- end }}
&lt;span class="p">&amp;lt;/&lt;/span>&lt;span class="nt">div&lt;/span>&lt;span class="p">&amp;gt;&lt;/span>
{{- partial &amp;#34;footer.html&amp;#34; . -}}
&lt;span class="p">&amp;lt;/&lt;/span>&lt;span class="nt">body&lt;/span>&lt;span class="p">&amp;gt;&lt;/span>
&lt;span class="p">&amp;lt;/&lt;/span>&lt;span class="nt">html&lt;/span>&lt;span class="p">&amp;gt;&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>When the site is generated, each page will contain all the code from your &lt;code>sidebar.html&lt;/code>.&lt;/p>
&lt;h2 id="create-a-stylesheet" class="anchor-link">&lt;a href="#create-a-stylesheet">Create a stylesheet&lt;/a>&lt;/h2>
&lt;p>Both site generators accept Sass for creating CSS stylesheets. Jekyll &lt;a href="https://jekyllrb.com/docs/assets/">has Sass processing built in&lt;/a>, and Hugo uses &lt;a href="https://gohugo.io/hugo-pipes/scss-sass/">Hugo Pipes&lt;/a>. Both options have some quirks.&lt;/p>
&lt;h3 id="sass-and-css-in-jekyll" class="anchor-link">&lt;a href="#sass-and-css-in-jekyll">Sass and CSS in Jekyll&lt;/a>&lt;/h3>
&lt;p>To process a Sass file in Jekyll, create your style definitions in the &lt;code>_sass&lt;/code> directory. For example, in a file at &lt;code>_sass/style-definitions.scss&lt;/code>:&lt;/p>
&lt;div class="highlight">&lt;pre class="chroma">&lt;code class="language-scss" data-lang="scss">&lt;span class="nv">$background-color&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="mh">#eef&lt;/span> &lt;span class="nv">!default&lt;/span>&lt;span class="p">;&lt;/span>
&lt;span class="nv">$text-color&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="mh">#111&lt;/span> &lt;span class="nv">!default&lt;/span>&lt;span class="p">;&lt;/span>
&lt;span class="nt">body&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="nt">background-color&lt;/span>&lt;span class="nd">:&lt;/span> &lt;span class="err">$&lt;/span>&lt;span class="nt">background-color&lt;/span>&lt;span class="p">;&lt;/span>
&lt;span class="nt">color&lt;/span>&lt;span class="nd">:&lt;/span> &lt;span class="err">$&lt;/span>&lt;span class="nt">text-color&lt;/span>&lt;span class="p">;&lt;/span>
&lt;span class="p">}&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>Jekyll won&amp;rsquo;t generate this file directly, as it only processes files with front matter. To create the end-result filepath for your site&amp;rsquo;s stylesheet, use a placeholder with empty front matter where you want the &lt;code>.css&lt;/code> file to appear. For example, &lt;code>assets/css/style.scss&lt;/code>. In this file, simply import your styles:&lt;/p>
&lt;div class="highlight">&lt;pre class="chroma">&lt;code class="language-scss" data-lang="scss">&lt;span class="nt">---&lt;/span>
&lt;span class="nt">---&lt;/span>
&lt;span class="o">@&lt;/span>&lt;span class="nt">import&lt;/span> &lt;span class="s2">&amp;#34;style-definitions&amp;#34;&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>This rather hackish configuration has an upside: you can use Liquid template tags and variables in your placeholder file. This is a nice way to allow users to set variables from the site &lt;code>_config.yml&lt;/code>, for example.&lt;/p>
&lt;p>The resulting CSS stylesheet in your generated site has the path &lt;code>/assets/css/style.css&lt;/code>. You can link to it in your site&amp;rsquo;s &lt;code>head.html&lt;/code> using:&lt;/p>
&lt;div class="highlight">&lt;pre class="chroma">&lt;code class="language-html" data-lang="html">&lt;span class="p">&amp;lt;&lt;/span>&lt;span class="nt">link&lt;/span> &lt;span class="na">rel&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s">&amp;#34;stylesheet&amp;#34;&lt;/span> &lt;span class="na">href&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s">&amp;#34;{{ &amp;#34;&lt;/span>&lt;span class="err">/&lt;/span>&lt;span class="na">assets&lt;/span>&lt;span class="err">/&lt;/span>&lt;span class="na">css&lt;/span>&lt;span class="err">/&lt;/span>&lt;span class="na">style&lt;/span>&lt;span class="err">.&lt;/span>&lt;span class="na">css&lt;/span>&lt;span class="err">&amp;#34;&lt;/span> &lt;span class="err">|&lt;/span> &lt;span class="na">relative_url&lt;/span> &lt;span class="err">}}&amp;#34;&lt;/span> &lt;span class="na">media&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s">&amp;#34;screen&amp;#34;&lt;/span>&lt;span class="p">&amp;gt;&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>
&lt;h3 id="sass-and-hugo-pipes-in-hugo" class="anchor-link">&lt;a href="#sass-and-hugo-pipes-in-hugo">Sass and Hugo Pipes in Hugo&lt;/a>&lt;/h3>
&lt;p>Hugo uses &lt;a href="https://gohugo.io/hugo-pipes/scss-sass/">Hugo Pipes&lt;/a> to process Sass to CSS. You can achieve this by using Hugo&amp;rsquo;s asset processing function, &lt;code>resources.ToCSS&lt;/code>, which expects a source in the &lt;code>assets/&lt;/code> directory. It takes the SCSS file as an argument. With your style definitions in a Sass file at &lt;code>assets/sass/style.scss&lt;/code>, here&amp;rsquo;s how to get, process, and link your Sass in your theme&amp;rsquo;s &lt;code>head.html&lt;/code>:&lt;/p>
&lt;div class="highlight">&lt;pre class="chroma">&lt;code class="language-html" data-lang="html">{{ $style := resources.Get &amp;#34;/sass/style.scss&amp;#34; | resources.ToCSS }}
&lt;span class="p">&amp;lt;&lt;/span>&lt;span class="nt">link&lt;/span> &lt;span class="na">rel&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s">&amp;#34;stylesheet&amp;#34;&lt;/span> &lt;span class="na">href&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s">&amp;#34;{{ $style.RelPermalink }}&amp;#34;&lt;/span> &lt;span class="na">media&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s">&amp;#34;screen&amp;#34;&lt;/span>&lt;span class="p">&amp;gt;&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>Hugo asset processing &lt;a href="https://gohugo.io/troubleshooting/faq/#i-get-tocss--this-feature-is-not-available-in-your-current-hugo-version">requires extended Hugo&lt;/a>, which you may not have by default. You can get extended Hugo from the &lt;a href="https://github.com/gohugoio/hugo/releases">releases page&lt;/a>.&lt;/p>
&lt;h2 id="configure-and-deploy-to-github-pages" class="anchor-link">&lt;a href="#configure-and-deploy-to-github-pages">Configure and deploy to GitHub Pages&lt;/a>&lt;/h2>
&lt;p>Before your site generator can build your site, it needs a configuration file to set some necessary parameters. Configuration files live in the site root directory. Among other settings, you can declare the name of the theme to use when building the site.&lt;/p>
&lt;h3 id="configure-jekyll" class="anchor-link">&lt;a href="#configure-jekyll">Configure Jekyll&lt;/a>&lt;/h3>
&lt;p>Here&amp;rsquo;s a minimal &lt;code>_config.yml&lt;/code> for Jekyll:&lt;/p>
&lt;div class="highlight">&lt;pre class="chroma">&lt;code class="language-yml" data-lang="yml">&lt;span class="nt">title&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">Your awesome title&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w">&lt;/span>&lt;span class="nt">description&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">&amp;gt;-&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="c"># this means to ignore newlines until &amp;#34;baseurl:&amp;#34;&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">Write an awesome description for your new site here. You can edit this&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">line in _config.yml. It will appear in your document head meta (for&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">Google search results) and in your feed.xml site description.&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w">&lt;/span>&lt;span class="nt">baseurl&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="s2">&amp;#34;&amp;#34;&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="c"># the subpath of your site, e.g. /blog&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w">&lt;/span>&lt;span class="nt">url&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="s2">&amp;#34;&amp;#34;&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="c"># the base hostname &amp;amp; protocol for your site, e.g. http://example.com&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w">&lt;/span>&lt;span class="nt">theme&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="c"># for gem-based themes&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w">&lt;/span>&lt;span class="nt">remote_theme&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="c"># for themes hosted on GitHub, when used with GitHub Pages&lt;/span>&lt;span class="w">
&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>With &lt;code>remote_theme&lt;/code>, any &lt;a href="https://help.github.com/en/github/working-with-github-pages/adding-a-theme-to-your-github-pages-site-using-jekyll#adding-a-jekyll-theme-in-your-sites-_configyml-file">Jekyll theme hosted on GitHub can be used&lt;/a> with sites hosted on GitHub Pages.&lt;/p>
&lt;p>Jekyll has a &lt;a href="https://jekyllrb.com/docs/configuration/default/">default configuration&lt;/a>, so any parameters added to your configuration file will override the defaults. Here are &lt;a href="https://jekyllrb.com/docs/configuration/options/">additional configuration settings&lt;/a>.&lt;/p>
&lt;h3 id="configure-hugo" class="anchor-link">&lt;a href="#configure-hugo">Configure Hugo&lt;/a>&lt;/h3>
&lt;p>Here&amp;rsquo;s a minimal example of Hugo&amp;rsquo;s &lt;code>config.yml&lt;/code>:&lt;/p>
&lt;div class="highlight">&lt;pre class="chroma">&lt;code class="language-yml" data-lang="yml">&lt;span class="nt">baseURL&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">https://example.com/&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="c"># The full domain your site will live at&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w">&lt;/span>&lt;span class="nt">languageCode&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">en-us&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w">&lt;/span>&lt;span class="nt">title&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">Hugo Docs Site&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w">&lt;/span>&lt;span class="nt">theme&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="c"># theme name&lt;/span>&lt;span class="w">
&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>Hugo makes no assumptions, so if a necessary parameter is missing, you&amp;rsquo;ll see a warning when building or serving your site. Here are &lt;a href="https://gohugo.io/getting-started/configuration/#all-configuration-settings">all configuration settings for Hugo&lt;/a>.&lt;/p>
&lt;h3 id="deploy-to-github-pages" class="anchor-link">&lt;a href="#deploy-to-github-pages">Deploy to GitHub Pages&lt;/a>&lt;/h3>
&lt;p>Both generators build your site with a command.&lt;/p>
&lt;p>For Jekyll, use &lt;code>jekyll build&lt;/code>. See &lt;a href="https://jekyllrb.com/docs/configuration/options/#build-command-options">further build options here&lt;/a>.&lt;/p>
&lt;p>For Hugo, use &lt;code>hugo&lt;/code>. You can run &lt;code>hugo help&lt;/code> or see &lt;a href="https://gohugo.io/getting-started/usage/#test-installation">further build options here&lt;/a>.&lt;/p>
&lt;p>You&amp;rsquo;ll have to choose the source for your GitHub Pages site; once done, your site will update each time you push a new build. Of course, you can also automate your GitHub Pages build using GitHub Actions. Here&amp;rsquo;s one for &lt;a href="https://github.com/victoriadrake/hugo-latest-cd">building and deploying with Hugo&lt;/a>, and one for &lt;a href="https://github.com/victoriadrake/jekyll-cd">building and deploying Jekyll&lt;/a>.&lt;/p>
&lt;h2 id="showtime" class="anchor-link">&lt;a href="#showtime">Showtime&lt;/a>&lt;/h2>
&lt;p>All the substantial differences between these two generators are under the hood; all the same, let&amp;rsquo;s take a look at the finished themes, in two color variations.&lt;/p>
&lt;p>Here&amp;rsquo;s Hugo:&lt;/p>
&lt;p>
&lt;img src="https://victoria.dev/blog/hugo-vs-jekyll-an-epic-battle-of-static-site-generator-themes/ogd_hugo.png" alt="OpenGitDocs theme for Hugo" />
&lt;/p>
&lt;p>Here&amp;rsquo;s Jekyll:&lt;/p>
&lt;p>
&lt;img src="https://victoria.dev/blog/hugo-vs-jekyll-an-epic-battle-of-static-site-generator-themes/ogd_jekyll.png" alt="OpenGitDocs theme for Jekyll" />
&lt;/p>
&lt;p>Spiffy!&lt;/p>
&lt;h2 id="wait-who-won" class="anchor-link">&lt;a href="#wait-who-won">Wait who won&lt;/a>&lt;/h2>
&lt;p>&lt;/p>
&lt;p>Both Hugo and Jekyll have their quirks and conveniences.&lt;/p>
&lt;p>From this developer&amp;rsquo;s perspective, Jekyll is a workable choice for simple sites without complicated organizational needs. If you&amp;rsquo;re looking to render some one-page posts in an &lt;a href="https://jekyllrb.com/docs/themes/">available theme&lt;/a> and host with GitHub Pages, Jekyll will get you up and running fairly quickly.&lt;/p>
&lt;p>Personally, I use Hugo. I like the organizational capabilities of its Page Bundles, and it&amp;rsquo;s backed by a dedicated and conscientious team that really seems to strive to facilitate convenience for their users. This is evident in Hugo&amp;rsquo;s many functions, and handy tricks like &lt;a href="https://gohugo.io/content-management/image-processing/">Image Processing&lt;/a> and &lt;a href="https://gohugo.io/content-management/shortcodes/">Shortcodes&lt;/a>. They seem to release new fixes and versions about as often as I make a new cup of coffee - which, depending on your use case, may be fantastic, or annoying.&lt;/p>
&lt;p>If you still can&amp;rsquo;t decide, don&amp;rsquo;t worry. The &lt;a href="https://github.com/opengitdocs">OpenGitDocs documentation theme&lt;/a> I created is available for both Hugo and Jekyll. Start with one, switch later if you want. That&amp;rsquo;s the benefit of having options.&lt;/p></content:encoded><enclosure url="https://victoria.dev/blog/hugo-vs-jekyll-an-epic-battle-of-static-site-generator-themes/cover_hu4062a8088076745a0cbb2c0ac38fd85a_2115819_640x0_resize_box_2.png" type="image/jpg"/></item><item><title>Outsourcing security with 1Password, Authy, and Privacy.com</title><link>https://victoria.dev/blog/outsourcing-security-with-1password-authy-and-privacy.com/</link><pubDate>Mon, 16 Mar 2020 08:12:32 -0400</pubDate><author>hello@victoria.dev (Victoria Drake)</author><guid>https://victoria.dev/blog/outsourcing-security-with-1password-authy-and-privacy.com/</guid><description>Take some work off your plate while beefing up security with three changes you can make today.</description><content:encoded>
&lt;img src="https://victoria.dev/blog/outsourcing-security-with-1password-authy-and-privacy.com/cover_hu3d69063d670764dcb1197a3519d8d4fb_239400_640x0_resize_box_2.png" width="640" height="256"/>
&lt;p>We&amp;rsquo;ve already got enough to deal with without worrying about our cybersecurity. When humans are busy and under stress, we tend to get lax in less-obviously-pressing areas, like the integrity of our online accounts. These areas only become an obvious problem when it&amp;rsquo;s too late for prevention.&lt;/p>
&lt;p>Cybersecurity can be fiddly and time-consuming. You might need to reset forgotten passwords, transfer multifactor authentication (MFA) codes to different devices, or deal with the fallout of compromised payment details in the event one of your accounts is still breached.&lt;/p>
&lt;p>Thankfully, most of the work necessary to keep up our cybersecurity measures can be outsourced.&lt;/p>
&lt;p>Here are three changes you can make to significantly reduce the chances of needing to fiddle with any of these things again.&lt;/p>
&lt;h2 id="1password" class="anchor-link">&lt;a href="#1password">1Password&lt;/a>&lt;/h2>
&lt;p>
&lt;img src="https://victoria.dev/blog/outsourcing-security-with-1password-authy-and-privacy.com/1Password-iOS-FaceID-darkmode.jpg" alt="1Password on an iPhone" />
&lt;/p>
&lt;p>I&amp;rsquo;ve historically avoided password managers because of an irrational knee-jerk reaction to putting all my eggs in one basket. You know what&amp;rsquo;s great for irrational reactions? Education.&lt;/p>
&lt;p>To figure out if putting all my passwords into a password manager is more secure than not using one, I set out to see what some smart people wrote about it.&lt;/p>
&lt;p>First, we need to know a thing or two about passwords. Troy Hunt figured out almost a decade ago that &lt;a href="https://www.troyhunt.com/only-secure-password-is-one-you-cant/">trying to remember strong passwords doesn&amp;rsquo;t work&lt;/a>. In more recent times, Alex Weinert expanded on this in &lt;a href="https://techcommunity.microsoft.com/t5/azure-active-directory-identity/your-pa-word-doesn-t-matter/ba-p/731984">Your Pa$$word doesn&amp;rsquo;t matter&lt;/a>. TL;DR: our brains aren&amp;rsquo;t better at passwords than computers, and please use MFA.&lt;/p>
&lt;p>So passwords don&amp;rsquo;t matter, but complicated passwords are still better than memorable and guessable ones. Since I&amp;rsquo;ve next to no hope of remembering a dozen variations of &lt;code>p/q2-q4!&lt;/code> (I&amp;rsquo;m not a &lt;a href="https://inbox.vuxu.org/tuhs/CAG=a+rj8VcXjS-ftaj8P2_duLFSUpmNgB4-dYwnTsY_8g5WdEA@mail.gmail.com/">chess player&lt;/a>), this is a task I can outsource to &lt;a href="https://1password.com/">1Password&lt;/a>. I&amp;rsquo;ll still need to remember one, long, complicated master password - 1Password uses this to encrypt my data, so I really can&amp;rsquo;t lose it - but I can handle just one.&lt;/p>
&lt;p>Using 1Password specifically has another, decidedly obvious, advantage. I chose 1Password because of their &lt;a href="https://support.1password.com/watchtower/">Watchtower&lt;/a> feature. &lt;a href="https://www.troyhunt.com/have-i-been-pwned-is-now-partnering-with-1password/">Thanks to Troy Hunt&amp;rsquo;s Have I Been Pwned&lt;/a>, Watchtower will alert you if any of your passwords show up in a breach so you can change them. Passwords still don&amp;rsquo;t completely work, but this is probably the best band-aid there is.&lt;/p>
&lt;p>One last bonus is that using a password manager is a heck of a lot more convenient. I don&amp;rsquo;t need to take a few tries to type in a complicated password. I don&amp;rsquo;t end up spending time resetting passwords I&amp;rsquo;ve forgotten on sites I only rarely use.&lt;/p>
&lt;p>When tasked with remembering all their own passwords, people typically create simpler passwords that are easier to remember &amp;ndash; and easier to hack. This occurs most frequently on sites that are considered unimportant. Using 1Password and generated passwords, those sites are now also first-class citizens in the land of strong passwords, instead of being half-abandoned and half-open attack vectors.&lt;/p>
&lt;p>So, yes, all my eggs are in one basket. A well-protected, complex, and monitored basket.&lt;/p>
&lt;h2 id="authy" class="anchor-link">&lt;a href="#authy">Authy&lt;/a>&lt;/h2>
&lt;p>Okay - so it&amp;rsquo;s more like one-and-a-half baskets. &lt;/p>
&lt;p>
&lt;img src="https://victoria.dev/blog/outsourcing-security-with-1password-authy-and-privacy.com/Authy2019Logo.png" alt="Authy&amp;amp;rsquo;s logo" />
&lt;/p>
&lt;p>&lt;a href="https://authy.com/">Authy&lt;/a>, from the folks over at &lt;a href="https://www.twilio.com">Twilio&lt;/a>, provides a 2FA solution that&amp;rsquo;s more secure than SMS. &lt;a href="https://authy.com/blog/authy-vs-google-authenticator/">Unlike Google Authenticator&lt;/a>, you can choose to back up your 2FA codes in case you lose or change your phone. (1Password offers 2FA functionality as well - but, you know, redundancies.)&lt;/p>
&lt;p>With Authy, your back up is encrypted with your password, similarly to how 1Password works. This makes it the second password you can&amp;rsquo;t forget, if you don&amp;rsquo;t want to lose access to your codes. If you reset your account, they all go away. I can deal with remembering two passwords; I&amp;rsquo;ll take that trade.&lt;/p>
&lt;p>I&amp;rsquo;ve tried other methods of MFA, including hardware keys, which can make accessing accounts on your phone more complicated than I care to put up with. I find the combination of 1Password and Authy to be the most practical combination of convenience and security that yet exists to my knowledge.&lt;/p>
&lt;h2 id="privacycom" class="anchor-link">&lt;a href="#privacycom">Privacy.com&lt;/a>&lt;/h2>
&lt;p>
&lt;img src="https://victoria.dev/blog/outsourcing-security-with-1password-authy-and-privacy.com/privacy-ephemeral.png" alt="Screenshot of Privacy card" />
&lt;/p>
&lt;p>Finally, there&amp;rsquo;s one last line of defense you can put in place in the unfortunate event that one of your accounts is still compromised. All the strong passwords and MFA in the world won&amp;rsquo;t help if you open the doors yourself, and scams and phishing are a thing.&lt;/p>
&lt;p>Since it&amp;rsquo;s rather impractical to use a different real credit card every place you shop, virtual cards are just a great idea. There&amp;rsquo;s no good reason to spend an afternoon (or more) resetting your payment information on every account just to thwart a misbehaving merchant or patch up a data breach from that online shop for cute salt shakers you made a purchase at last year (just me?).&lt;/p>
&lt;p>As a bonus, a &lt;a href="https://blog.privacy.com/create-virtual-cards-with-privacy-and-1password/">partnership between 1Password and Privacy.com&lt;/a> lets you easily create virtual credit cards using the 1Password extension.&lt;/p>
&lt;p>By setting up a separate virtual card for each merchant, in the event that one of those merchants is compromised, you can simply pause or delete that card. None of your other accounts or actual bank details are caught up in the process. Cards can have time-based limits or be one-off burner numbers, making them ideal for setting up subscriptions.&lt;/p>
&lt;p>This is the sort of basic functionality that I hope, one day, becomes more prevalent from banks and credit cards. In the meantime, I&amp;rsquo;ll keep using &lt;a href="https://privacy.com/join/Q6V3V">Privacy.com&lt;/a>. That&amp;rsquo;s my referral link; if you&amp;rsquo;d like to thank me by using it, we&amp;rsquo;ll both get five bucks as a bonus.&lt;/p>
&lt;h2 id="outsource-better-security" class="anchor-link">&lt;a href="#outsource-better-security">Outsource better security&lt;/a>&lt;/h2>
&lt;p>All together, implementing these changes will probably take up an afternoon, depending on how many accounts you have. It&amp;rsquo;s worth it for the time you&amp;rsquo;d otherwise spend resetting passwords, setting up new devices, or (knock on wood) recovering from compromised banking details. Best of all, you&amp;rsquo;ll have continual protection just running in the background.&lt;/p>
&lt;ul>
&lt;li>&lt;a href="https://1password.com/">1Password&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://authy.com/">Authy&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://privacy.com/join/Q6V3V">Privacy.com&lt;/a>&lt;/li>
&lt;/ul>
&lt;p>We have the technology. Free up some brain cycles to focus on other things - or simply remove some unnecessary stress from your life by outsourcing the fiddly bits.&lt;/p>
&lt;p>Want to give the gift of cybersecurity to someone you know? Get them started with a &lt;a href="https://victoria.dev/blog/your-cybersecurity-starter-pack/">cybersecurity starter pack&lt;/a>.&lt;/p></content:encoded><enclosure url="https://victoria.dev/blog/outsourcing-security-with-1password-authy-and-privacy.com/cover_hu3d69063d670764dcb1197a3519d8d4fb_239400_640x0_resize_box_2.png" type="image/jpg"/></item><item><title>SQLite in production with WAL </title><link>https://victoria.dev/blog/sqlite-in-production-with-wal/</link><pubDate>Thu, 05 Mar 2020 10:14:43 -0500</pubDate><author>hello@victoria.dev (Victoria Drake)</author><guid>https://victoria.dev/blog/sqlite-in-production-with-wal/</guid><description>An underappreciated candidate for light and fast database transactions.</description><content:encoded>
&lt;img src="https://victoria.dev/blog/sqlite-in-production-with-wal/cover_hucd0e6312363c308744eec049709d6b2b_994778_640x0_resize_box_2.png" width="640" height="256"/>
&lt;p>&lt;a href="https://sqlite.org/index.html">SQLite&lt;/a> (&amp;ldquo;see-quell-lite&amp;rdquo;) is a lightweight Sequel, or Structured Query Language (&lt;a href="https://en.wikipedia.org/wiki/SQL">SQL&lt;/a>), database engine. Instead of using the client-server database management system model, SQLite is self-contained in a single file. It is library, database, and data, all in one package.&lt;/p>
&lt;p>For certain applications, SQLite is a solid choice for a production database. It&amp;rsquo;s lightweight, ultra-portable, and has no external dependencies. Remember when MacBook Air first came out? It&amp;rsquo;s nothing like that.&lt;/p>
&lt;p>SQLite is best suited for production use in applications that:&lt;/p>
&lt;ul>
&lt;li>Desire fast and simple set up.&lt;/li>
&lt;li>Require high reliability in a small package.&lt;/li>
&lt;li>Have, and want to retain, a small footprint.&lt;/li>
&lt;li>Are read-heavy but not write-heavy.&lt;/li>
&lt;li>Don&amp;rsquo;t need multiple user accounts or features like multiversion concurrency snapshots.&lt;/li>
&lt;/ul>
&lt;p>If your application can benefit from SQLite&amp;rsquo;s serverless convenience, you may like to know about the different modes available for managing database changes.&lt;/p>
&lt;h2 id="with-and-without-wal" class="anchor-link">&lt;a href="#with-and-without-wal">With and without WAL&lt;/a>&lt;/h2>
&lt;p>POSIX &lt;a href="https://linux.die.net/man/2/fsync">system call &lt;code>fsync()&lt;/code>&lt;/a> commits buffered data (data saved in the operating system cache) referred to by a specified file descriptor to permanent storage or disk. This is relevant to understanding the difference between SQLite&amp;rsquo;s two modes, as &lt;code>fsync()&lt;/code> will block until the device reports the transfer is complete.&lt;/p>
&lt;p>For efficiency, SQLite uses &lt;a href="https://sqlite.org/atomiccommit.html">atomic commits&lt;/a> to batch database changes into a single transaction. This enables the apparent writing of many transactions to a database file simultaneously. Atomic commits are performed using one of two modes: a rollback journal, or a write-ahead log (WAL).&lt;/p>
&lt;h3 id="rollback-journal" class="anchor-link">&lt;a href="#rollback-journal">Rollback journal&lt;/a>&lt;/h3>
&lt;p>A &lt;a href="https://www.sqlite.org/lockingv3.html#rollback">rollback journal&lt;/a> is essentially a back-up file created by SQLite before write changes occur on a database file. It has the advantage of providing high reliability by helping SQLite restore the database to its original state in case a write operation is compromised during the disk-writing process.&lt;/p>
&lt;p>Assuming a cold cache, SQLite first needs to read the relevant pages from a database file before it can write to it. Information is read out into the operating system cache, then transferred into user space. SQLite obtains a reserved lock on the database file, preventing other processes from writing to the database. At this point, other processes may still read from the database.&lt;/p>
&lt;p>SQLite creates a separate file, the rollback journal, with the original content of the pages that will be changed. Initially existing in the cache, the rollback journal is written to persistent disk storage with &lt;code>fsync()&lt;/code> to enable SQLite to restore the database should its next operations be compromised.&lt;/p>
&lt;p>SQLite then obtains an exclusive lock preventing other processes from reading or writing, and writes the page changes to the database file in cache. Since writing to disk is slower than interaction with the cache, writing to disk doesn&amp;rsquo;t occur immediately. The rollback journal continues to exist until changes are safely written to disk, with a second &lt;code>fsync()&lt;/code>. From a user-space process point of view, the change to the disk (the COMMIT, or end of the transaction) happens instantaneously once the rollback journal is deleted - hence, atomic commits. However, the two &lt;code>fsync()&lt;/code> operations required to complete the COMMIT make this option, from a transactional standpoint, slower than SQLite&amp;rsquo;s lesser known WAL mode.&lt;/p>
&lt;h3 id="write-ahead-logging-wal" class="anchor-link">&lt;a href="#write-ahead-logging-wal">Write-ahead logging (WAL)&lt;/a>&lt;/h3>
&lt;p>While the rollback journal method uses a separate file to preserve the original database state, the &lt;a href="https://www.sqlite.org/wal.html">WAL method&lt;/a> uses a separate WAL file to instead record the changes. Instead of a COMMIT depending on writing changes to disk, a COMMIT in WAL mode occurs when a record of one or more commits is appended to the WAL. This has the advantage of not requiring blocking read or write operations to the database file in order to make a COMMIT, so more transactions can happen concurrently.&lt;/p>
&lt;p>WAL mode introduces the concept of the checkpoint, which is when the WAL file is synced to persistent storage before all its transactions are transferred to the database file. You can optionally specify when this occurs, but SQLite provides reasonable defaults. The checkpoint is the WAL version of the atomic commit.&lt;/p>
&lt;p>In WAL mode, write transactions are performed faster than in the traditional rollback journal mode. Each transaction involves writing the changes only once to the WAL file instead of twice - to the rollback journal, and then to disk - before the COMMIT signals that the transaction is over.&lt;/p>
&lt;h2 id="the-simplicity-of-sqlite" class="anchor-link">&lt;a href="#the-simplicity-of-sqlite">The simplicity of SQLite&lt;/a>&lt;/h2>
&lt;p>For medium-sized read-heavy applications, SQLite may be a great choice. Using SQLite in WAL mode may make it an even better one. Benchmarks on the smallest EC2 instance, with no provisioned &lt;a href="https://en.wikipedia.org/wiki/IOPS">IOPS&lt;/a>, put this little trooper at 400 write transactions per second, and thousands of reads. That&amp;rsquo;s some perfectly adequate capability, in a perfectly compact package.&lt;/p></content:encoded><enclosure url="https://victoria.dev/blog/sqlite-in-production-with-wal/cover_hucd0e6312363c308744eec049709d6b2b_994778_640x0_resize_box_2.png" type="image/jpg"/></item><item><title>Multithreaded Python: slithering through an I/O bottleneck</title><link>https://victoria.dev/blog/multithreaded-python-slithering-through-an-i/o-bottleneck/</link><pubDate>Fri, 28 Feb 2020 09:31:02 -0500</pubDate><author>hello@victoria.dev (Victoria Drake)</author><guid>https://victoria.dev/blog/multithreaded-python-slithering-through-an-i/o-bottleneck/</guid><description>How taking advantage of parallelism in Python can make your software orders of magnitude faster.</description><content:encoded>
&lt;img src="https://victoria.dev/blog/multithreaded-python-slithering-through-an-i/o-bottleneck/cover_hufc3f293689518f785bfb54ed57068ead_360041_640x0_resize_box_2.png" width="640" height="256"/>
&lt;p>I recently developed a project that I called &lt;a href="https://github.com/victoriadrake/hydra-link-checker">Hydra&lt;/a>: a multithreaded link checker written in Python. Unlike many Python site crawlers I found while researching, Hydra uses only standard libraries, with no external dependencies like BeautifulSoup. It&amp;rsquo;s intended to be run as part of a CI/CD process, so part of its success depended on being fast.&lt;/p>
&lt;p>Multiple threads in Python is a bit of a bitey subject (not sorry) in that the Python interpreter doesn&amp;rsquo;t actually let multiple threads execute at the same time. Python&amp;rsquo;s &lt;a href="https://wiki.python.org/moin/GlobalInterpreterLock">Global Interpreter Lock&lt;/a>, or GIL, prevents multiple threads from executing Python bytecodes at once. Each thread that wants to execute must first wait for the GIL to be released by the currently executing thread. The GIL is pretty much the microphone in a low-budget conference panel, except where no one gets to shout.&lt;/p>
&lt;p>This has the advantage of preventing &lt;a href="https://en.wikipedia.org/wiki/Race_condition">race conditions&lt;/a>. It does, however, lack the performance advantages afforded by running multiple tasks in parallel. (If you&amp;rsquo;d like a refresher on concurrency, parallelism, and multithreading, see &lt;a href="https://victoria.dev/blog/concurrency-parallelism-and-the-many-threads-of-santa-claus/">Concurrency, parallelism, and the many threads of Santa Claus&lt;/a>.) While I prefer Go for its convenient first-class primitives that support concurrency (see &lt;a href="https://tour.golang.org/concurrency/1">Goroutines&lt;/a>), this project&amp;rsquo;s recipients were more comfortable with Python. I took it as an opportunity to test and explore!&lt;/p>
&lt;p>Simultaneously performing multiple tasks in Python isn&amp;rsquo;t impossible; it just takes a little extra work. For Hydra, the main advantage is in overcoming the input/output (I/O) bottleneck.&lt;/p>
&lt;p>In order to get web pages to check, Hydra needs to go out to the Internet and fetch them. When compared to tasks that are performed by the CPU alone, going out over the network is comparatively slower. How slow?&lt;/p>
&lt;p>Here are approximate timings for tasks performed on a typical PC:&lt;/p>
&lt;table>
&lt;thead>
&lt;tr>
&lt;th>&lt;/th>
&lt;th>Task&lt;/th>
&lt;th>Time&lt;/th>
&lt;/tr>
&lt;/thead>
&lt;tbody>
&lt;tr>
&lt;td>CPU&lt;/td>
&lt;td>execute typical instruction&lt;/td>
&lt;td>1/1,000,000,000 sec = 1 nanosec&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>CPU&lt;/td>
&lt;td>fetch from L1 cache memory&lt;/td>
&lt;td>0.5 nanosec&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>CPU&lt;/td>
&lt;td>branch misprediction&lt;/td>
&lt;td>5 nanosec&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>CPU&lt;/td>
&lt;td>fetch from L2 cache memory&lt;/td>
&lt;td>7 nanosec&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>RAM&lt;/td>
&lt;td>Mutex lock/unlock&lt;/td>
&lt;td>25 nanosec&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>RAM&lt;/td>
&lt;td>fetch from main memory&lt;/td>
&lt;td>100 nanosec&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>Network&lt;/td>
&lt;td>send 2K bytes over 1Gbps network&lt;/td>
&lt;td>20,000 nanosec&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>RAM&lt;/td>
&lt;td>read 1MB sequentially from memory&lt;/td>
&lt;td>250,000 nanosec&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>Disk&lt;/td>
&lt;td>fetch from new disk location (seek)&lt;/td>
&lt;td>8,000,000 nanosec (8ms)&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>Disk&lt;/td>
&lt;td>read 1MB sequentially from disk&lt;/td>
&lt;td>20,000,000 nanosec (20ms)&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>Network&lt;/td>
&lt;td>send packet US to Europe and back&lt;/td>
&lt;td>150,000,000 nanosec (150ms)&lt;/td>
&lt;/tr>
&lt;/tbody>
&lt;/table>
&lt;p>Peter Norvig first published these numbers some years ago in &lt;a href="http://norvig.com/21-days.html#answers">Teach Yourself Programming in Ten Years&lt;/a>. Since computers and their components change year over year, the exact numbers shown above aren&amp;rsquo;t the point. What these numbers help to illustrate is the difference, in orders of magnitude, between operations.&lt;/p>
&lt;p>Compare the difference between fetching from main memory and sending a simple packet over the Internet. While both these operations occur in less than the blink of an eye (literally) from a human perspective, you can see that sending a simple packet over the Internet is over a million times slower than fetching from RAM. It&amp;rsquo;s a difference that, in a single-thread program, can quickly accumulate to form troublesome bottlenecks.&lt;/p>
&lt;p>In Hydra, the task of parsing response data and assembling results into a report is relatively fast, since it all happens on the CPU. The slowest portion of the program&amp;rsquo;s execution, by over six orders of magnitude, is network latency. Not only does Hydra need to fetch packets, but whole web pages! One way of improving Hydra&amp;rsquo;s performance is to find a way for the page fetching tasks to execute without blocking the main thread.&lt;/p>
&lt;p>Python has a couple options for doing tasks in parallel: multiple processes, or multiple threads. These methods allow you to circumvent the GIL and speed up execution in a couple different ways.&lt;/p>
&lt;h2 id="multiple-processes" class="anchor-link">&lt;a href="#multiple-processes">Multiple processes&lt;/a>&lt;/h2>
&lt;p>To execute parallel tasks using multiple processes, you can use Python&amp;rsquo;s &lt;a href="https://docs.python.org/3/library/concurrent.futures.html#concurrent.futures.ProcessPoolExecutor">&lt;code>ProcessPoolExecutor&lt;/code>&lt;/a>. A concrete subclass of &lt;a href="https://docs.python.org/3/library/concurrent.futures.html#concurrent.futures.Executor">&lt;code>Executor&lt;/code>&lt;/a> from the &lt;a href="https://docs.python.org/3/library/concurrent.futures.html">&lt;code>concurrent.futures&lt;/code> module&lt;/a>, &lt;code>ProcessPoolExecutor&lt;/code> uses a pool of processes spawned with the &lt;a href="https://docs.python.org/3/library/multiprocessing.html#module-multiprocessing">&lt;code>multiprocessing&lt;/code> module&lt;/a> to avoid the GIL.&lt;/p>
&lt;p>This option uses worker subprocesses that maximally default to the number of processors on the machine. The &lt;code>multiprocessing&lt;/code> module allows you to maximally parallelize function execution across processes, which can really speed up compute-bound (or &lt;a href="https://en.wikipedia.org/wiki/CPU-bound">CPU-bound&lt;/a>) tasks.&lt;/p>
&lt;p>Since the main bottleneck for Hydra is I/O and not the processing to be done by the CPU, I&amp;rsquo;m better served by using multiple threads.&lt;/p>
&lt;h2 id="multiple-threads" class="anchor-link">&lt;a href="#multiple-threads">Multiple threads&lt;/a>&lt;/h2>
&lt;p>Fittingly named, Python&amp;rsquo;s &lt;a href="https://docs.python.org/3/library/concurrent.futures.html#concurrent.futures.ThreadPoolExecutor">&lt;code>ThreadPoolExecutor&lt;/code>&lt;/a> uses a pool of threads to execute asynchronous tasks. Also a subclass of &lt;a href="https://docs.python.org/3/library/concurrent.futures.html#concurrent.futures.Executor">&lt;code>Executor&lt;/code>&lt;/a>, it uses a defined number of maximum worker threads (at least five by default, according to the formula &lt;code>min(32, os.cpu_count() + 4)&lt;/code>) and reuses idle threads before starting new ones, making it pretty efficient.&lt;/p>
&lt;p>Here is a snippet of Hydra with comments showing how Hydra uses &lt;code>ThreadPoolExecutor&lt;/code> to achieve parallel multithreaded bliss:&lt;/p>
&lt;div class="highlight">&lt;pre class="chroma">&lt;code class="language-py" data-lang="py">&lt;span class="c1"># Create the Checker class&lt;/span>
&lt;span class="k">class&lt;/span> &lt;span class="nc">Checker&lt;/span>&lt;span class="p">:&lt;/span>
&lt;span class="c1"># Queue of links to be checked&lt;/span>
&lt;span class="n">TO_PROCESS&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">Queue&lt;/span>&lt;span class="p">()&lt;/span>
&lt;span class="c1"># Maximum workers to run&lt;/span>
&lt;span class="n">THREADS&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="mi">100&lt;/span>
&lt;span class="c1"># Maximum seconds to wait for HTTP response&lt;/span>
&lt;span class="n">TIMEOUT&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="mi">60&lt;/span>
&lt;span class="k">def&lt;/span> &lt;span class="fm">__init__&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="bp">self&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">url&lt;/span>&lt;span class="p">):&lt;/span>
&lt;span class="o">...&lt;/span>
&lt;span class="c1"># Create the thread pool&lt;/span>
&lt;span class="bp">self&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">pool&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">futures&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">ThreadPoolExecutor&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">max_workers&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="bp">self&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">THREADS&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="k">def&lt;/span> &lt;span class="nf">run&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="bp">self&lt;/span>&lt;span class="p">):&lt;/span>
&lt;span class="c1"># Run until the TO_PROCESS queue is empty&lt;/span>
&lt;span class="k">while&lt;/span> &lt;span class="bp">True&lt;/span>&lt;span class="p">:&lt;/span>
&lt;span class="k">try&lt;/span>&lt;span class="p">:&lt;/span>
&lt;span class="n">target_url&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="bp">self&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">TO_PROCESS&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">get&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">block&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="bp">True&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">timeout&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="mi">2&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="c1"># If we haven&amp;#39;t already checked this link&lt;/span>
&lt;span class="k">if&lt;/span> &lt;span class="n">target_url&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="s2">&amp;#34;url&amp;#34;&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="ow">not&lt;/span> &lt;span class="ow">in&lt;/span> &lt;span class="bp">self&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">visited&lt;/span>&lt;span class="p">:&lt;/span>
&lt;span class="c1"># Mark it as visited&lt;/span>
&lt;span class="bp">self&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">visited&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">add&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">target_url&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="s2">&amp;#34;url&amp;#34;&lt;/span>&lt;span class="p">])&lt;/span>
&lt;span class="c1"># Submit the link to the pool&lt;/span>
&lt;span class="n">job&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="bp">self&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">pool&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">submit&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="bp">self&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">load_url&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">target_url&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="bp">self&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">TIMEOUT&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="n">job&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">add_done_callback&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="bp">self&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">handle_future&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="k">except&lt;/span> &lt;span class="n">Empty&lt;/span>&lt;span class="p">:&lt;/span>
&lt;span class="k">return&lt;/span>
&lt;span class="k">except&lt;/span> &lt;span class="ne">Exception&lt;/span> &lt;span class="k">as&lt;/span> &lt;span class="n">e&lt;/span>&lt;span class="p">:&lt;/span>
&lt;span class="k">print&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">e&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>You can view the full code in &lt;a href="https://github.com/victoriadrake/hydra-link-checker">Hydra&amp;rsquo;s GitHub repository&lt;/a>.&lt;/p>
&lt;h2 id="single-thread-to-multithread" class="anchor-link">&lt;a href="#single-thread-to-multithread">Single thread to multithread&lt;/a>&lt;/h2>
&lt;p>If you&amp;rsquo;d like to see the full effect, I compared the run times for checking my website between a prototype single-thread program, and the &lt;del>multiheaded&lt;/del>multithreaded Hydra.&lt;/p>
&lt;div class="highlight">&lt;pre class="chroma">&lt;code class="language-text" data-lang="text">time python3 slow-link-check.py https://victoria.dev
real 17m34.084s
user 11m40.761s
sys 0m5.436s
time python3 hydra.py https://victoria.dev
real 0m15.729s
user 0m11.071s
sys 0m2.526s
&lt;/code>&lt;/pre>&lt;/div>&lt;p>The single-thread program, which blocks on I/O, ran in about seventeen minutes. When I first ran the multithreaded version, it finished in 1m13.358s - after some profiling and tuning, it took a little under sixteen seconds. Again, the exact times don&amp;rsquo;t mean all that much; they&amp;rsquo;ll vary depending on factors such as the size of the site being crawled, your network speed, and your program&amp;rsquo;s balance between the overhead of thread management and the benefits of parallelism.&lt;/p>
&lt;p>The more important thing, and the result I&amp;rsquo;ll take any day, is a program that runs some orders of magnitude faster.&lt;/p></content:encoded><enclosure url="https://victoria.dev/blog/multithreaded-python-slithering-through-an-i/o-bottleneck/cover_hufc3f293689518f785bfb54ed57068ead_360041_640x0_resize_box_2.png" type="image/jpg"/></item><item><title>Breaking bottlenecks </title><link>https://victoria.dev/blog/breaking-bottlenecks/</link><pubDate>Tue, 25 Feb 2020 12:50:29 -0500</pubDate><author>hello@victoria.dev (Victoria Drake)</author><guid>https://victoria.dev/blog/breaking-bottlenecks/</guid><description>A talk on the benefits of non-blocking functions for programs, developers, and organizations.</description><content:encoded>
&lt;img src="https://victoria.dev/blog/breaking-bottlenecks/cover_hucd0e6312363c308744eec049709d6b2b_396830_640x0_resize_box_2.png" width="640" height="256"/>
&lt;p>&lt;em>I recently gave a lecture on the benefits of building non-blocking processes. This is a write-up of the full talk, minus any &amp;ldquo;ums&amp;rdquo; that may have occurred. You can &lt;a href="https://victoria.dev/slides/bottlenecks">view the slides here&lt;/a>.&lt;/em>&lt;/p>
&lt;p>I&amp;rsquo;ve been helping out a group called the Open Web Application Security Project (OWASP). They&amp;rsquo;re a non-profit foundation that produces some of the foremost application testing guides and cybersecurity resources. OWASP&amp;rsquo;s publications, checklists, and reference materials are a help to security professionals, penetration testers, and developers all over the world. Most of the individual teams that create these materials are run almost entirely by volunteers.&lt;/p>
&lt;p>OWASP is a great group doing important work. I&amp;rsquo;ve seen this firsthand as part of the core team that produces the Web Security Testing Guide. However, while OWASP inspires in its large volunteer base, it lacks in the area of central organization.&lt;/p>
&lt;p>This lack of organization was most recently apparent in the group&amp;rsquo;s website, &lt;a href="https://owasp.org">OWASP.org&lt;/a>. A big organization with an even bigger website to match, OWASP.org enjoys hundreds of thousands of visitors. Unfortunately, many of its pages - individually managed by disparate projects - are infrequently updated. Some are abandoned. The website as a whole lacks a centralized quality assurance process, and as a result, OWASP.org is peppered with broken links.&lt;/p>
&lt;h2 id="the-trouble-with-broken-links" class="anchor-link">&lt;a href="#the-trouble-with-broken-links">The trouble with broken links&lt;/a>&lt;/h2>
&lt;p>Customers don&amp;rsquo;t like broken links; attackers really do. That&amp;rsquo;s because broken links are a security vulnerability. Broken links can signal opportunities for attacks like &lt;a href="https://edoverflow.com/2017/broken-link-hijacking/">broken link hijacking&lt;/a> and &lt;a href="https://www.hackerone.com/blog/Guide-Subdomain-Takeovers">subdomain takeovers&lt;/a>. At their least effective, these attacks can be embarrassing; at their worst, severely damaging to businesses and organizations. One OWASP group, the Application Security Verification Standard (ASVS) project, writes about &lt;a href="https://github.com/OWASP/ASVS/blob/d9e0ac99828ef3c1e9233bd8a1f691f2a6958aa3/4.0/en/0x18-V10-Malicious.md#v103-deployed-application-integrity-controls">integrity controls&lt;/a> that can help to mitigate the likelihood of these attacks. This knowledge, unfortunately, has not yet propagated throughout the rest of OWASP yet.&lt;/p>
&lt;p>This is the story of how I created a fast and efficient tool to help OWASP solve this problem.&lt;/p>
&lt;h2 id="the-job" class="anchor-link">&lt;a href="#the-job">The job&lt;/a>&lt;/h2>
&lt;p>I took on the task of creating a program that could run as part of a CI/CD process to detect and report broken links. The program needed to:&lt;/p>
&lt;ul>
&lt;li>Find and enumerate all the broken links on OWASP.org in a report.&lt;/li>
&lt;li>Keep track of the parent pages the broken links were on so they could be fixed.&lt;/li>
&lt;li>Run efficiently as part of a CI/CD pipeline.&lt;/li>
&lt;/ul>
&lt;p>Essentially; I need to build a web crawler.&lt;/p>
&lt;p>My original journey through this process was also in Python, as that was a comfortable language choice for everyone in the OWASP group. Personally, I prefer to use Go for higher performance as it offers more convenient concurrency primitives. Between the task and this talk, I wrote three programs: a prototype single-thread Python program, a multithreaded Python program, and a Go program using goroutines. We&amp;rsquo;ll see a comparison of how each worked out near the end of the talk - first, let&amp;rsquo;s explore how to build a web crawler.&lt;/p>
&lt;h2 id="prototyping-a-web-crawler" class="anchor-link">&lt;a href="#prototyping-a-web-crawler">Prototyping a web crawler&lt;/a>&lt;/h2>
&lt;p>Here&amp;rsquo;s what our web crawler will need to do:&lt;/p>
&lt;ol>
&lt;li>Get the HTML data of the first page of the website (for example, &lt;code>https://victoria.dev&lt;/code>)&lt;/li>
&lt;li>Check all of the links on the page
&lt;ol>
&lt;li>Keep track of the links we&amp;rsquo;ve already visited so we don&amp;rsquo;t end up checking them twice&lt;/li>
&lt;li>Record any broken links we find&lt;/li>
&lt;/ol>
&lt;/li>
&lt;li>Fetch more HTML data from any valid links on the page, as long as they&amp;rsquo;re in the same domain (&lt;code>https://victoria.dev&lt;/code> and not &lt;code>https://github.com&lt;/code>, for instance)&lt;/li>
&lt;li>Repeat step #2 until all of the links on the site have been checked&lt;/li>
&lt;/ol>
&lt;p>Here&amp;rsquo;s what the execution flow will look like:&lt;/p>
&lt;figure class="screenshot">
&lt;img src="execution_flow.png"
alt="A flow chart showing program execution"/>
&lt;/figure>
&lt;p>As you can see, the nodes &amp;ldquo;GET page&amp;rdquo; -&amp;gt; &amp;ldquo;HTML&amp;rdquo; -&amp;gt; &amp;ldquo;Parse links&amp;rdquo; -&amp;gt; &amp;ldquo;Valid link&amp;rdquo; -&amp;gt; &amp;ldquo;Check visited&amp;rdquo; all form a loop. These are what enable our web crawler to continue crawling until all the links on the site have been accounted for in the &amp;ldquo;Check visited&amp;rdquo; node. When the crawler encounters links it&amp;rsquo;s already checked, it will &amp;ldquo;Stop.&amp;rdquo; This loop will become more important in a moment.&lt;/p>
&lt;p>For now, the question on everyone&amp;rsquo;s mind (I hope): how do we make it fast?&lt;/p>
&lt;h2 id="how-fast-can-you-do-the-thing" class="anchor-link">&lt;a href="#how-fast-can-you-do-the-thing">How fast can you do the thing&lt;/a>&lt;/h2>
&lt;p>Here are some approximate timings for tasks performed on a typical PC:&lt;/p>
&lt;table>
&lt;thead>
&lt;tr>
&lt;th>&lt;/th>
&lt;th>Task&lt;/th>
&lt;th>Time&lt;/th>
&lt;/tr>
&lt;/thead>
&lt;tbody>
&lt;tr>
&lt;td>CPU&lt;/td>
&lt;td>execute typical instruction&lt;/td>
&lt;td>1/1,000,000,000 sec = 1 nanosec&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>CPU&lt;/td>
&lt;td>fetch from L1 cache memory&lt;/td>
&lt;td>0.5 nanosec&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>CPU&lt;/td>
&lt;td>branch misprediction&lt;/td>
&lt;td>5 nanosec&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>CPU&lt;/td>
&lt;td>fetch from L2 cache memory&lt;/td>
&lt;td>7 nanosec&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>RAM&lt;/td>
&lt;td>Mutex lock/unlock&lt;/td>
&lt;td>25 nanosec&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>RAM&lt;/td>
&lt;td>fetch from main memory&lt;/td>
&lt;td>100 nanosec&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>RAM&lt;/td>
&lt;td>read 1MB sequentially from memory&lt;/td>
&lt;td>250,000 nanosec&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>Disk&lt;/td>
&lt;td>fetch from new disk location (seek)&lt;/td>
&lt;td>8,000,000 nanosec (8ms)&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>Disk&lt;/td>
&lt;td>read 1MB sequentially from disk&lt;/td>
&lt;td>20,000,000 nanosec (20ms)&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>Network&lt;/td>
&lt;td>send packet US to Europe and back&lt;/td>
&lt;td>150,000,000 nanosec (150ms)&lt;/td>
&lt;/tr>
&lt;/tbody>
&lt;/table>
&lt;p>Peter Norvig first published these numbers some years ago in &lt;a href="http://norvig.com/21-days.html#answers">Teach Yourself Programming in Ten Years&lt;/a>. They typically crop up now and then in articles titled along the lines of, &amp;ldquo;Latency numbers every developer should know.&amp;rdquo;&lt;/p>
&lt;p>Since computers and their components change year over year, the exact numbers shown above aren&amp;rsquo;t the point. What these numbers help to illustrate is the difference, in orders of magnitude, between operations.&lt;/p>
&lt;p>Compare the difference between fetching from main memory and sending a simple packet over the Internet. While both these operations occur in less than the blink of an eye (literally) from a human perspective, you can see that sending a simple packet over the Internet is over a million times slower than fetching from RAM. It&amp;rsquo;s a difference that, in a single-thread program, can quickly accumulate to form troublesome bottlenecks.&lt;/p>
&lt;h2 id="bottleneck-network-latency" class="anchor-link">&lt;a href="#bottleneck-network-latency">Bottleneck: network latency&lt;/a>&lt;/h2>
&lt;p>The numbers above mean that the difference in time it takes to send something over the Internet compared to fetching data from main memory is over six orders of magnitude. Remember the loop in our execution chart? The &amp;ldquo;GET page&amp;rdquo; node, in which our crawler fetches page data over the network, is going to be &lt;em>a million times slower&lt;/em> than the next slowest thing in the loop!&lt;/p>
&lt;p>We don&amp;rsquo;t need to run our prototype to see what that means in practical terms; we can estimate it. Let&amp;rsquo;s take OWASP.org, which has upwards of 12,000 links, as an example:&lt;/p>
&lt;div class="highlight">&lt;pre class="chroma">&lt;code class="language-text" data-lang="text"> 150 milliseconds
x 12,000 links
---------
1,800,000 milliseconds (30 minutes)
&lt;/code>&lt;/pre>&lt;/div>&lt;p>A whole half hour, just for the network tasks. It may even be much slower than that, since web pages are frequently much larger than a packet. This means that in our single-thread prototype web crawler, our biggest bottleneck is network latency. Why is this problematic?&lt;/p>
&lt;h3 id="feedback-loops" class="anchor-link">&lt;a href="#feedback-loops">Feedback loops&lt;/a>&lt;/h3>
&lt;p>I previously wrote about &lt;a href="https://victoria.dev/blog/how-to-set-up-a-short-feedback-loop-as-a-solo-coder/">feedback loops&lt;/a>. In essence, in order to improve at doing anything, you first need to be able to get feedback from your last attempt. That way, you have the necessary information to make adjustments and get closer to your goal on your next iteration.&lt;/p>
&lt;p>As a software developer, bottlenecks can contribute to long and inefficient feedback loops. If I&amp;rsquo;m waiting on a process that&amp;rsquo;s part of a CI/CD pipeline, in our bottlenecked web crawler example, I&amp;rsquo;d be sitting around for a minimum of a half hour before learning whether or not changes in my last push were successful, or whether they broke &lt;code>master&lt;/code> (hopefully &lt;code>staging&lt;/code>).&lt;/p>
&lt;p>Multiply a slow and inefficient feedback loop by many runs per day, over many days, and you&amp;rsquo;ve got a slow and inefficient developer. Multiply that by many developers in an organization bottlenecked on the same process, and you&amp;rsquo;ve got a slow and inefficient company.&lt;/p>
&lt;h3 id="the-cost-of-bottlenecks" class="anchor-link">&lt;a href="#the-cost-of-bottlenecks">The cost of bottlenecks&lt;/a>&lt;/h3>
&lt;p>To add insult to injury, not only are you waiting on a bottlenecked process to run; you&amp;rsquo;re also paying to wait. Take the serverless example - AWS Lambda, for instance. Here&amp;rsquo;s a chart showing the cost of functions by compute time and CPU usage.&lt;/p>
&lt;figure>
&lt;img src="lambda-chart.png"
alt="Chart showing Total Lambda compute cost by function execution"/> &lt;figcaption>
&lt;p>Source: &lt;a href="https://serverless.com/blog/understanding-and-controlling-aws-lambda-costs/">Understanding and Controlling AWS Lambda Costs&lt;/a>&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;p>Again, the numbers change over the years, but the main concepts remain the same: the bigger the function and the longer its compute time, the bigger the cost. For applications taking advantage of serverless, these costs can add up dramatically.&lt;/p>
&lt;p>Bottlenecks are a recipe for failure, for both productivity and the bottom line.&lt;/p>
&lt;p>The good news is that bottlenecks are mostly unnecessary. If we know how to identify them, we can strategize our way out of them. To understand how, let&amp;rsquo;s get some tacos.&lt;/p>
&lt;h2 id="tacos-and-threading" class="anchor-link">&lt;a href="#tacos-and-threading">Tacos and threading&lt;/a>&lt;/h2>
&lt;p>Everyone, meet Bob. He&amp;rsquo;s a gopher who works at the taco stand down the street as the cashier. Say &amp;ldquo;Hi,&amp;rdquo; Bob.&lt;/p>
&lt;div class="highlight">&lt;pre class="chroma">&lt;code class="language-text" data-lang="text">
 

 
 Hi I&amp;#39;m Bob 
  \
  


 

&lt;/code>&lt;/pre>&lt;/div>&lt;p>Bob works very hard at being a cashier, but he&amp;rsquo;s still just one gopher. The customers who frequent Bob&amp;rsquo;s taco stand can eat tacos really quickly; but in order to get the tacos to eat them, they&amp;rsquo;ve got to order them through Bob. Here&amp;rsquo;s what our bottlenecked, single-thread taco stand currently looks like:&lt;/p>
&lt;div class="highlight">&lt;pre class="chroma">&lt;code class="language-text" data-lang="text">
 


 
  



 

&lt;/code>&lt;/pre>&lt;/div>&lt;p>As you can see, all the customers are queued up, right out the door. Poor Bob handles one customer&amp;rsquo;s transaction at a time, starting and finishing with that customer completely before moving on to the next. Bob can only do so much, so our taco stand is rather inefficient at the moment. How can we make Bob faster?&lt;/p>
&lt;p>We can try splitting the queue:&lt;/p>
&lt;div class="highlight">&lt;pre class="chroma">&lt;code class="language-text" data-lang="text">
 

 
 
 

 

 

&lt;/code>&lt;/pre>&lt;/div>&lt;p>Now Bob can do some multitasking. For example, he can start a transaction with a customer in one queue; then, while that customer counts their bills, Bob can pop over to the second queue and get started there. This arrangement, known as a &lt;a href="https://en.wikipedia.org/wiki/Concurrency_(computer_science)">concurrency model&lt;/a>, helps Bob go a little bit faster by jumping back and forth between lines. However, it&amp;rsquo;s still just one Bob, which limits our improvement possibilities. If we were to make four queues, they&amp;rsquo;d all be shorter; but Bob would be very thinly stretched between them. Can we do better?&lt;/p>
&lt;p>We could get two Bobs:&lt;/p>
&lt;div class="highlight">&lt;pre class="chroma">&lt;code class="language-text" data-lang="text">
 

 
  
 
  
 

 

&lt;/code>&lt;/pre>&lt;/div>&lt;p>With twice the Bobs, each can handle a queue of his own. This is our most efficient solution for our taco stand so far, since two Bobs can handle much more than one Bob can, even if each customer is still attended to one at a time.&lt;/p>
&lt;p>We can do even better than that:&lt;/p>
&lt;div class="highlight">&lt;pre class="chroma">&lt;code class="language-text" data-lang="text">
 
  
 
  
 
  
 
  
 

&lt;/code>&lt;/pre>&lt;/div>&lt;p>With quadruple the Bobs, we have some very short queues, and a much more efficient taco stand. In computing, the concept of having multiple workers do tasks in parallel is called &lt;a href="https://en.wikipedia.org/wiki/Multithreading_(computer_architecture)">multithreading&lt;/a>.&lt;/p>
&lt;p>In Go, we can apply this concept using goroutines. Here are some illustrative snippets from my Go solution.&lt;/p>
&lt;h2 id="setting-up-a-go-web-crawler" class="anchor-link">&lt;a href="#setting-up-a-go-web-crawler">Setting up a Go web crawler&lt;/a>&lt;/h2>
&lt;p>In order to share data between our &lt;a href="https://tour.golang.org/concurrency/1">goroutines&lt;/a>, we&amp;rsquo;ll need to create some data structures. Our &lt;code>Checker&lt;/code> structure will be shared, so it will have a &lt;code>Mutex&lt;/code> (&lt;a href="https://en.wikipedia.org/wiki/Mutual_exclusion">mutual exclusion&lt;/a>) to allow our goroutines to lock and unlock it. The &lt;code>Checker&lt;/code> structure will also hold a list of &lt;code>brokenLinks&lt;/code> results, and &lt;code>visitedLinks&lt;/code>. The latter will be a map of strings to booleans, which we&amp;rsquo;ll use to directly and efficiently check for visited links. By using a map instead of iterating over a list, our &lt;code>visitedLinks&lt;/code> lookup will have a constant complexity of O(1) as opposed to a linear complexity of O(n), thus avoiding the creation of another bottleneck. For more on time complexity, see my &lt;a href="https://victoria.dev/blog/a-coffee-break-introduction-to-time-complexity-of-algorithms/">coffee-break introduction to time complexity of algorithms&lt;/a> article.&lt;/p>
&lt;div class="highlight">&lt;pre class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="kd">type&lt;/span> &lt;span class="nx">Checker&lt;/span> &lt;span class="kd">struct&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="nx">startDomain&lt;/span> &lt;span class="kt">string&lt;/span>
&lt;span class="nx">brokenLinks&lt;/span> &lt;span class="p">[]&lt;/span>&lt;span class="nx">Result&lt;/span>
&lt;span class="nx">visitedLinks&lt;/span> &lt;span class="kd">map&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="kt">string&lt;/span>&lt;span class="p">]&lt;/span>&lt;span class="kt">bool&lt;/span>
&lt;span class="nx">workerCount&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">maxWorkers&lt;/span> &lt;span class="kt">int&lt;/span>
&lt;span class="nx">sync&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">Mutex&lt;/span>
&lt;span class="p">}&lt;/span>
&lt;span class="o">...&lt;/span>
&lt;span class="c1">// Page allows us to retain parent and sublinks
&lt;/span>&lt;span class="c1">&lt;/span>&lt;span class="kd">type&lt;/span> &lt;span class="nx">Page&lt;/span> &lt;span class="kd">struct&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="nx">parent&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">loc&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">data&lt;/span> &lt;span class="kt">string&lt;/span>
&lt;span class="p">}&lt;/span>
&lt;span class="c1">// Result adds error information for the report
&lt;/span>&lt;span class="c1">&lt;/span>&lt;span class="kd">type&lt;/span> &lt;span class="nx">Result&lt;/span> &lt;span class="kd">struct&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="nx">Page&lt;/span>
&lt;span class="nx">reason&lt;/span> &lt;span class="kt">string&lt;/span>
&lt;span class="nx">code&lt;/span> &lt;span class="kt">int&lt;/span>
&lt;span class="p">}&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>To extract links from HTML data, here&amp;rsquo;s a parser I wrote on top of &lt;a href="https://pkg.go.dev/golang.org/x/net/html?tab=doc">package &lt;code>html&lt;/code>&lt;/a>:&lt;/p>
&lt;div class="highlight">&lt;pre class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="c1">// Extract links from HTML
&lt;/span>&lt;span class="c1">&lt;/span>&lt;span class="kd">func&lt;/span> &lt;span class="nf">parse&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">parent&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">data&lt;/span> &lt;span class="kt">string&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">([]&lt;/span>&lt;span class="kt">string&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="p">[]&lt;/span>&lt;span class="kt">string&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="nx">doc&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">err&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="nx">html&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Parse&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">strings&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">NewReader&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">data&lt;/span>&lt;span class="p">))&lt;/span>
&lt;span class="k">if&lt;/span> &lt;span class="nx">err&lt;/span> &lt;span class="o">!=&lt;/span> &lt;span class="kc">nil&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="nx">fmt&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Println&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;Could not parse: &amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">err&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="p">}&lt;/span>
&lt;span class="nx">goodLinks&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="nb">make&lt;/span>&lt;span class="p">([]&lt;/span>&lt;span class="kt">string&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="nx">badLinks&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="nb">make&lt;/span>&lt;span class="p">([]&lt;/span>&lt;span class="kt">string&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="kd">var&lt;/span> &lt;span class="nx">f&lt;/span> &lt;span class="kd">func&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="o">*&lt;/span>&lt;span class="nx">html&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">Node&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="nx">f&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="kd">func&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">n&lt;/span> &lt;span class="o">*&lt;/span>&lt;span class="nx">html&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">Node&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="k">if&lt;/span> &lt;span class="nx">n&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">Type&lt;/span> &lt;span class="o">==&lt;/span> &lt;span class="nx">html&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">ElementNode&lt;/span> &lt;span class="o">&amp;amp;&amp;amp;&lt;/span> &lt;span class="nf">checkKey&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nb">string&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">n&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">Data&lt;/span>&lt;span class="p">))&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="k">for&lt;/span> &lt;span class="nx">_&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">a&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="k">range&lt;/span> &lt;span class="nx">n&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">Attr&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="k">if&lt;/span> &lt;span class="nf">checkAttr&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nb">string&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">a&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">Key&lt;/span>&lt;span class="p">))&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="nx">j&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">err&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="nf">formatURL&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">parent&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">a&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">Val&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="k">if&lt;/span> &lt;span class="nx">err&lt;/span> &lt;span class="o">!=&lt;/span> &lt;span class="kc">nil&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="nx">badLinks&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="nb">append&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">badLinks&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">j&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="p">}&lt;/span> &lt;span class="k">else&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="nx">goodLinks&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="nb">append&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">goodLinks&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">j&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="p">}&lt;/span>
&lt;span class="k">break&lt;/span>
&lt;span class="p">}&lt;/span>
&lt;span class="p">}&lt;/span>
&lt;span class="p">}&lt;/span>
&lt;span class="k">for&lt;/span> &lt;span class="nx">c&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="nx">n&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">FirstChild&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="nx">c&lt;/span> &lt;span class="o">!=&lt;/span> &lt;span class="kc">nil&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="nx">c&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="nx">c&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">NextSibling&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="nf">f&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">c&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="p">}&lt;/span>
&lt;span class="p">}&lt;/span>
&lt;span class="nf">f&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">doc&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="k">return&lt;/span> &lt;span class="nx">goodLinks&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">badLinks&lt;/span>
&lt;span class="p">}&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>If you&amp;rsquo;re wondering why I didn&amp;rsquo;t use a more full-featured package for this project, I highly recommend &lt;a href="https://www.theregister.co.uk/2016/03/23/npm_left_pad_chaos/">the story of &lt;code>left-pad&lt;/code>&lt;/a>. The short of it: more dependencies, more problems.&lt;/p>
&lt;p>Here are snippets of the &lt;code>main&lt;/code> function, where we pass in our starting URL and create a queue (or &lt;a href="https://tour.golang.org/concurrency/2">channels&lt;/a>, in Go) to be filled with links for our goroutines to process.&lt;/p>
&lt;div class="highlight">&lt;pre class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="kd">func&lt;/span> &lt;span class="nf">main&lt;/span>&lt;span class="p">()&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="o">...&lt;/span>
&lt;span class="nx">startURL&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="nx">flag&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">String&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;url&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s">&amp;#34;http://example.com&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s">&amp;#34;full URL of site&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="o">...&lt;/span>
&lt;span class="nx">firstPage&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="nx">Page&lt;/span>&lt;span class="p">{&lt;/span>
&lt;span class="nx">parent&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="o">*&lt;/span>&lt;span class="nx">startURL&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="nx">loc&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="o">*&lt;/span>&lt;span class="nx">startURL&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="p">}&lt;/span>
&lt;span class="nx">toProcess&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="nb">make&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="kd">chan&lt;/span> &lt;span class="nx">Page&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">1&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="nx">toProcess&lt;/span> &lt;span class="o">&amp;lt;-&lt;/span> &lt;span class="nx">firstPage&lt;/span>
&lt;span class="kd">var&lt;/span> &lt;span class="nx">wg&lt;/span> &lt;span class="nx">sync&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">WaitGroup&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>The last significant piece of the puzzle is to create our workers, which we&amp;rsquo;ll do here:&lt;/p>
&lt;div class="highlight">&lt;pre class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="k">for&lt;/span> &lt;span class="nx">i&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="k">range&lt;/span> &lt;span class="nx">toProcess&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="nx">wg&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Add&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="nx">checker&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">addWorker&lt;/span>&lt;span class="p">()&lt;/span>
&lt;span class="err">&lt;/span> &lt;span class="k">go&lt;/span> &lt;span class="nf">worker&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">i&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="o">&amp;amp;&lt;/span>&lt;span class="nx">checker&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="o">&amp;amp;&lt;/span>&lt;span class="nx">wg&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">toProcess&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="k">if&lt;/span> &lt;span class="nx">checker&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">workerCount&lt;/span> &lt;span class="p">&amp;gt;&lt;/span> &lt;span class="nx">checker&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">maxWorkers&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="nx">time&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Sleep&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mi">1&lt;/span> &lt;span class="o">*&lt;/span> &lt;span class="nx">time&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">Second&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="c1">// throttle down
&lt;/span>&lt;span class="c1">&lt;/span> &lt;span class="p">}&lt;/span>
&lt;span class="p">}&lt;/span>
&lt;span class="nx">wg&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Wait&lt;/span>&lt;span class="p">()&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>A &lt;a href="https://golang.org/pkg/sync/#WaitGroup">WaitGroup&lt;/a> does just what it says on the tin: it waits for our group of goroutines to finish. When they have, we&amp;rsquo;ll know our Go web crawler has finished checking all the links on the site.&lt;/p>
&lt;h2 id="did-we-do-the-thing-fast" class="anchor-link">&lt;a href="#did-we-do-the-thing-fast">Did we do the thing fast&lt;/a>&lt;/h2>
&lt;p>Here&amp;rsquo;s a comparison of the three programs I wrote on this journey. First, the prototype single-thread Python version:&lt;/p>
&lt;div class="highlight">&lt;pre class="chroma">&lt;code class="language-text" data-lang="text">time python3 slow-link-check.py https://victoria.dev
real 17m34.084s
user 11m40.761s
sys 0m5.436s
&lt;/code>&lt;/pre>&lt;/div>&lt;p>This finished crawling my website in about seventeen-and-a-half minutes, which is rather long for a site at least an order of magnitude smaller than OWASP.org.&lt;/p>
&lt;p>The multithreaded Python version did a bit better:&lt;/p>
&lt;div class="highlight">&lt;pre class="chroma">&lt;code class="language-text" data-lang="text">time python3 hydra.py https://victoria.dev
real 1m13.358s
user 0m13.161s
sys 0m2.826s
&lt;/code>&lt;/pre>&lt;/div>&lt;p>My multithreaded Python program (which I dubbed &lt;a href="https://github.com/victoriadrake/hydra-link-checker">Hydra&lt;/a>) finished in one minute and thirteen seconds.&lt;/p>
&lt;p>How did Go do?&lt;/p>
&lt;div class="highlight">&lt;pre class="chroma">&lt;code class="language-text" data-lang="text">time ./go-link-check --url=https://victoria.dev
real 0m7.926s
user 0m9.044s
sys 0m0.932s
&lt;/code>&lt;/pre>&lt;/div>&lt;p>At just under eight seconds, I found the Go version to be extremely palatable.&lt;/p>
&lt;h2 id="breaking-bottlenecks" class="anchor-link">&lt;a href="#breaking-bottlenecks">Breaking bottlenecks&lt;/a>&lt;/h2>
&lt;p>As fun as it is to simply enjoy the speedups, we can directly relate these results to everything we&amp;rsquo;ve learned so far. Consider taking a process that used to soak up seventeen minutes and turning it into an eight-second-affair instead. Not only will that give developers a much shorter and more efficient feedback loop, it will give companies the ability to develop faster, and thus grow more quickly - while costing less. To drive the point home: a process that runs in seventeen-and-a-half minutes when it could take eight seconds will also cost over a hundred and thirty times as much to run!&lt;/p>
&lt;p>A better work day for developers, and a better bottom line for companies. There&amp;rsquo;s a lot of benefit to be had in making functions, code, and processes as efficient as possible - by breaking bottlenecks.&lt;/p></content:encoded><enclosure url="https://victoria.dev/blog/breaking-bottlenecks/cover_hucd0e6312363c308744eec049709d6b2b_396830_640x0_resize_box_2.png" type="image/jpg"/></item><item><title>Command line tricks for managing your messy open source repository</title><link>https://victoria.dev/blog/command-line-tricks-for-managing-your-messy-open-source-repository/</link><pubDate>Mon, 17 Feb 2020 08:05:06 -0500</pubDate><author>hello@victoria.dev (Victoria Drake)</author><guid>https://victoria.dev/blog/command-line-tricks-for-managing-your-messy-open-source-repository/</guid><description>A handy toolbox for the terminal to help open source maintainers make their projects sparkle.</description><content:encoded>
&lt;img src="https://victoria.dev/blog/command-line-tricks-for-managing-your-messy-open-source-repository/cover_hu34a251ab6f2f701c7053eda64afcb4cd_858328_640x0_resize_box_2.png" width="640" height="320"/>
&lt;p>Effective collaboration, especially in open source software development, starts with effective organization. To make sure that nothing gets missed, the general rule, &amp;ldquo;one issue, one pull request&amp;rdquo; is a nice rule of thumb.&lt;/p>
&lt;p>Instead of opening an issue with a large scope like, &amp;ldquo;Fix all the broken links in the documentation,&amp;rdquo; open source projects will have more luck attracting contributors with several smaller and more manageable issues. In the preceding example, you might scope broken links by section or by page. This allows more contributors to jump in and dedicate small windows of their time, rather than waiting for one person to take on a larger and more tedious contribution effort.&lt;/p>
&lt;p>Smaller scoped issues also help project maintainers see where work has been completed and where it hasn&amp;rsquo;t. This reduces the chances that some part of the issue is missed, assumed to be completed, and later leads to bugs or security vulnerabilities.&lt;/p>
&lt;p>That&amp;rsquo;s all well and good; but what if you&amp;rsquo;ve already opened several massively-scoped issues, some PRs have already been submitted or merged, and you currently have no idea where the work started or stopped?&lt;/p>
&lt;p>It&amp;rsquo;s going to take a little sorting out to get the state of your project back under control. Thankfully, there are a number of command line tools to help you scan, sort, and make sense of a messy repository. Here&amp;rsquo;s a small selection of ones I use.&lt;/p>
&lt;p>Jump to:&lt;/p>
&lt;ul>
&lt;li>&lt;a href="#interactive-search-and-replace-with-vim">Interactive search-and-replace with &lt;code>vim&lt;/code>&lt;/a>&lt;/li>
&lt;li>&lt;a href="#find-dead-links-in-markdown-files-with-a-node-module">Find dead links in Markdown files with a node module&lt;/a>&lt;/li>
&lt;li>&lt;a href="#list-subdirectories-with-or-without-a-git-repository-with-find">List subdirectories with or without a git repository with &lt;code>find&lt;/code>&lt;/a>&lt;/li>
&lt;li>&lt;a href="#pull-multiple-git-repositories-from-a-list-with-xargs">Pull multiple git repositories from a list with &lt;code>xargs&lt;/code>&lt;/a>&lt;/li>
&lt;li>&lt;a href="#list-issues-by-number-with-jot">List issues by number with &lt;code>jot&lt;/code>&lt;/a>&lt;/li>
&lt;li>&lt;a href="#cli-powered-open-source-organization">CLI-powered open source organization&lt;/a>&lt;/li>
&lt;/ul>
&lt;h2 id="interactive-search-and-replace-with-vim" class="anchor-link">&lt;a href="#interactive-search-and-replace-with-vim">Interactive search-and-replace with &lt;code>vim&lt;/code>&lt;/a>&lt;/h2>
&lt;p>You can open a file in Vim, then interactively search and replace with:&lt;/p>
&lt;div class="highlight">&lt;pre class="chroma">&lt;code class="language-vim" data-lang="vim">&lt;span class="p">:&lt;/span>%&lt;span class="nx">s&lt;/span>&lt;span class="sr">/\&amp;lt;word\&amp;gt;/&lt;/span>&lt;span class="nx">newword&lt;/span>/&lt;span class="nx">gc&lt;/span>&lt;span class="err">
&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>The &lt;code>%&lt;/code> indicates to look in all lines of the current file; &lt;code>s&lt;/code> is for substitute; &lt;code>\&amp;lt;word\&amp;gt;&lt;/code> matches the whole word; and the &lt;code>g&lt;/code> for &amp;ldquo;global&amp;rdquo; is for every occurrence. The &lt;code>c&lt;/code> at the end will let you view and confirm each change before it&amp;rsquo;s made. You can run it automatically, and much faster, without &lt;code>c&lt;/code>; however, you put yourself at risk of complicating things if you&amp;rsquo;ve made a pattern-matching error.&lt;/p>
&lt;h2 id="find-dead-links-in-markdown-files-with-a-node-module" class="anchor-link">&lt;a href="#find-dead-links-in-markdown-files-with-a-node-module">Find dead links in Markdown files with a node module&lt;/a>&lt;/h2>
&lt;p>The &lt;a href="https://github.com/tcort/markdown-link-check">markdown-link-check&lt;/a> node module has a great &lt;a href="https://github.com/tcort/markdown-link-check#command-line-tool">CLI buddy&lt;/a>.&lt;/p>
&lt;p>I use this so often I turned it into a &lt;a href="https://victoria.dev/blog/how-to-do-twice-as-much-with-half-the-keystrokes-using-.bashrc/#bash-functions">Bash alias function&lt;/a>. To do the same, add this to your &lt;code>.bashrc&lt;/code>:&lt;/p>
&lt;div class="highlight">&lt;pre class="chroma">&lt;code class="language-sh" data-lang="sh">&lt;span class="c1"># Markdown link check in a folder, recursive&lt;/span>
&lt;span class="k">function&lt;/span> mlc &lt;span class="o">()&lt;/span> &lt;span class="o">{&lt;/span>
find &lt;span class="nv">$1&lt;/span> -name &lt;span class="se">\*&lt;/span>.md -exec markdown-link-check -p &lt;span class="o">{}&lt;/span> &lt;span class="se">\;&lt;/span>
&lt;span class="o">}&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>Then run with &lt;code>mlc &amp;lt;filename&amp;gt;&lt;/code>.&lt;/p>
&lt;h2 id="list-subdirectories-with-or-without-a-git-repository-with-find" class="anchor-link">&lt;a href="#list-subdirectories-with-or-without-a-git-repository-with-find">List subdirectories with or without a git repository with &lt;code>find&lt;/code>&lt;/a>&lt;/h2>
&lt;p>Print all subdirectories that are git repositories, or in other words, have a &lt;code>.git&lt;/code> in them:&lt;/p>
&lt;div class="highlight">&lt;pre class="chroma">&lt;code class="language-sh" data-lang="sh">find . -maxdepth &lt;span class="m">1&lt;/span> -type d -exec &lt;span class="nb">test&lt;/span> -e &lt;span class="s1">&amp;#39;{}/.git&amp;#39;&lt;/span> &lt;span class="s1">&amp;#39;;&amp;#39;&lt;/span> -printf &lt;span class="s2">&amp;#34;is git repo: %p\n&amp;#34;&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>To print all subdirectories that are not git repositories, negate the test with &lt;code>!&lt;/code>:&lt;/p>
&lt;div class="highlight">&lt;pre class="chroma">&lt;code class="language-sh" data-lang="sh">find . -maxdepth &lt;span class="m">1&lt;/span> -type d -exec &lt;span class="nb">test&lt;/span> &lt;span class="s1">&amp;#39;!&amp;#39;&lt;/span> -e &lt;span class="s1">&amp;#39;{}/.git&amp;#39;&lt;/span> &lt;span class="s1">&amp;#39;;&amp;#39;&lt;/span> -printf &lt;span class="s2">&amp;#34;not git repo: %p\n&amp;#34;&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>
&lt;h2 id="pull-multiple-git-repositories-from-a-list-with-xargs" class="anchor-link">&lt;a href="#pull-multiple-git-repositories-from-a-list-with-xargs">Pull multiple git repositories from a list with &lt;code>xargs&lt;/code>&lt;/a>&lt;/h2>
&lt;p>I initially used this as part of &lt;a href="https://victoria.dev/blog/how-to-set-up-a-fresh-ubuntu-desktop-using-only-dotfiles-and-bash-scripts/">automatically re-creating my laptop with Bash scripts&lt;/a>, but it&amp;rsquo;s pretty handy when you&amp;rsquo;re working with cloud instances or Dockerfiles.&lt;/p>
&lt;p>Given a file, &lt;code>repos.txt&lt;/code> with a repositorys SSH link on each line (and your SSH keys set up), run:&lt;/p>
&lt;div class="highlight">&lt;pre class="chroma">&lt;code class="language-sh" data-lang="sh">xargs -n1 git clone &amp;lt; repos.txt
&lt;/code>&lt;/pre>&lt;/div>&lt;p>If you want to pull and push many repositories, I previously wrote about &lt;a href="https://victoria.dev/blog/how-to-write-bash-one-liners-for-cloning-and-managing-github-and-gitlab-repositories/">how to use a Bash one-liner to manage your repositories&lt;/a>.&lt;/p>
&lt;h2 id="list-issues-by-number-with-jot" class="anchor-link">&lt;a href="#list-issues-by-number-with-jot">List issues by number with &lt;code>jot&lt;/code>&lt;/a>&lt;/h2>
&lt;p>I&amp;rsquo;m a co-author and maintainer for the &lt;a href="https://github.com/OWASP/wstg/">OWASP Web Security Testing Guide&lt;/a> repository where I recently took one large issue (yup, it was &amp;ldquo;Fix all the broken links in the documentation&amp;rdquo; - how&amp;rsquo;d you guess?) and broke it up into several smaller, more manageable issues. A whole thirty-seven smaller, more manageable issues.&lt;/p>
&lt;p>I wanted to enumerate all the issues that the original one became, but the idea of typing out thirty-seven issue numbers (#275 through #312) seemed awfully tedious and time-consuming. So, in natural programmer fashion, I spent the same amount of time I would have used to type out all those numbers and crafted a way to automate it instead.&lt;/p>
&lt;p>The &lt;code>jot&lt;/code> utility (&lt;code>apt install athena-jot&lt;/code>) is a tiny tool that&amp;rsquo;s a big help when you want to print out some numbers. Just tell it how many you want, and where to start and stop.&lt;/p>
&lt;div class="highlight">&lt;pre class="chroma">&lt;code class="language-sh" data-lang="sh">&lt;span class="c1"># jot [ reps [ begin [ end ] ] ]&lt;/span>
jot &lt;span class="m">37&lt;/span> &lt;span class="m">275&lt;/span> &lt;span class="m">312&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>This prints each number, inclusively, from 275 to 312 on a new line. To make these into issue number notations that GitHub and many other platforms automatically recognize and turn into links, you can pipe the output to &lt;code>awk&lt;/code>.&lt;/p>
&lt;div class="highlight">&lt;pre class="chroma">&lt;code class="language-sh" data-lang="sh">jot &lt;span class="m">37&lt;/span> &lt;span class="m">275&lt;/span> &lt;span class="m">312&lt;/span> &lt;span class="p">|&lt;/span> awk &lt;span class="s1">&amp;#39;{printf &amp;#34;#&amp;#34;$0&amp;#34;, &amp;#34;}&amp;#39;&lt;/span>
&lt;span class="c1">#275, #276, #277, #278, #279, #280, #281, #282, #283, #284, #285, #286, #287, #288, #289, #290, #291, #292, #293, #295, #296, #297, #298, #299, #300, #301, #302, #303, #304, #305, #306, #307, #308, #309, #310, #311, #312&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>You can also use &lt;code>jot&lt;/code> to generate random or redundant data, mainly for development or testing purposes.&lt;/p>
&lt;h2 id="cli-powered-open-source-organization" class="anchor-link">&lt;a href="#cli-powered-open-source-organization">CLI-powered open source organization&lt;/a>&lt;/h2>
&lt;p>A well-organized open source repository is a well-maintained open source project. Save this post for handy reference, and use your newfound CLI superpowers for good! &lt;/p></content:encoded><enclosure url="https://victoria.dev/blog/command-line-tricks-for-managing-your-messy-open-source-repository/cover_hu34a251ab6f2f701c7053eda64afcb4cd_858328_640x0_resize_box_2.png" type="image/jpg"/></item><item><title>The past ten years, or, how to get better at anything</title><link>https://victoria.dev/blog/the-past-ten-years-or-how-to-get-better-at-anything/</link><pubDate>Tue, 31 Dec 2019 08:27:31 -0400</pubDate><author>hello@victoria.dev (Victoria Drake)</author><guid>https://victoria.dev/blog/the-past-ten-years-or-how-to-get-better-at-anything/</guid><description>Thoughts on learning software development, technical blogging, and what the past ten years have taught me.</description><content:encoded>
&lt;img src="https://victoria.dev/blog/the-past-ten-years-or-how-to-get-better-at-anything/cover_hu12c1050867d89ecd3be413b30fdb4a56_1745840_640x0_resize_box_2.png" width="640" height="256"/>
&lt;p>If you want to get better at anything:&lt;/p>
&lt;ol>
&lt;li>Solve your own problems,&lt;/li>
&lt;li>Write about it,&lt;/li>
&lt;li>Teach others.&lt;/li>
&lt;/ol>
&lt;h2 id="1-searching-a-decade-ago" class="anchor-link">&lt;a href="#1-searching-a-decade-ago">1. Searching, a decade ago&lt;/a>&lt;/h2>
&lt;p>I was a young graduate with newly-minted freedoms, and I was about to fall in love. I had plenty of imagination, a couple handfuls of tenacity, and no sense of direction at all.&lt;/p>
&lt;p>For much of my youth, when I encountered a problem, I just sort of bumped up against it. I tried using whatever was in my head from past experiences or my own imagination to find a solution. For some problems, like managing staff duties at work, my experience was sufficient guidance. For other, more complicated problems, it wasn&amp;rsquo;t.&lt;/p>
&lt;p>When you don&amp;rsquo;t have a wealth of experience to draw upon, relying on it is a poor strategy. Like many people at my age then, I thought I knew enough. Like many people at my age now, I recognize how insufficient &amp;ldquo;enough&amp;rdquo; can be. A lack of self-directed momentum meant being dragged in any direction life&amp;rsquo;s currents took me. When falling in love turned out to mean falling from a far greater height than I had anticipated, I tumbled on, complacent. When higher-ups at work handed me further responsibilities, I accepted them without considering if I wanted them at all. When, inevitably, life became more and more complicated, I encountered even more problems I didn&amp;rsquo;t know how to solve. I felt stuck.&lt;/p>
&lt;p>Though I was morbidly embarrassed about it at the time, I&amp;rsquo;m not shy to say it now. At one point, it had to be pointed out to me that I could search the Internet for the solution to any of my problems. Anything I wanted to solve - interactions with people at work, a floundering relationship, or the practicalities of filing taxes - I was lucky enough to have the greatest collection of human knowledge ever assembled at my disposal.&lt;/p>
&lt;p>Instead of bumbling along in the floatsam of my own trial and error, I started to take advantage of the collective experiences of all those who have been here before me. They weren&amp;rsquo;t always right, and I often found information only somewhat similar to my own experience. Still, it always got me moving in the right direction. Eventually, I started to steer.&lt;/p>
&lt;p>There&amp;rsquo;s a learning curve, even when just searching for a problem. Distilling the jumble of confusion in your head to the right search terms is a learned skill. It helped me to understand &lt;a href="https://www.google.com/search/howsearchworks/crawling-indexing/">how search engines like Google work&lt;/a>:&lt;/p>
&lt;blockquote>
&lt;p>We use software known as web crawlers to discover publicly available webpages. Crawlers look at webpages and follow links on those pages, much like you would if you were browsing content on the web. They go from link to link and bring data about those webpages back to Googles servers&amp;hellip;&lt;/p>
&lt;p>When crawlers find a webpage, our systems render the content of the page, just as a browser does. We take note of key signals  from keywords to website freshness  and we keep track of it all in the Search index.&lt;/p>
&lt;/blockquote>
&lt;p>Sometimes, I find what I need by using the right keyword. Other times, I discover the keyword by searching for text that might surround it on the content of the page. For software development, I search for the weirdest word or combination of words attached to what I&amp;rsquo;m trying to learn. I rarely find whole solutions in my search results, but I always find direction for solving the problem myself.&lt;/p>
&lt;p>Solving my own problems, even just a few little ones at a time, gave me confidence and built momentum. I began to pursue the experiences I wanted, instead of waiting for experiences to happen to me.&lt;/p>
&lt;h2 id="2-updating-the-internet-some-years-ago" class="anchor-link">&lt;a href="#2-updating-the-internet-some-years-ago">2. Updating the Internet, some years ago&lt;/a>&lt;/h2>
&lt;p>I&amp;rsquo;d solved myself out of a doomed relationship and stagnant job. I found myself, rather gleefully, country-hopping with just &lt;a href="https://heronebag.com">one backpack&lt;/a> of possessions. I met, though I didn&amp;rsquo;t know it at the time, my future husband. I found a new sense of freedom, of having options, that I knew I never wanted to give up. I had to find a means to sustain myself by working remotely.&lt;/p>
&lt;p>When I first tried to make a living on the Internet, I felt like a right amateur. Sitting on the bed, hunched over my laptop, I started a crappy Wordpress blog with a modified theme that didn&amp;rsquo;t entirely work. I posted about how I tried and failed to start a dropshipping business. My site was terrible, and I knew it. My first forays into being a &amp;ldquo;real&amp;rdquo; developer were to solve my own problems: how to get my blog working, how to set up a custom domain, how to get and use a security certificate. I found some guidance in blogs and answers that others had written, but much of it was outdated, or not entirely correct. Still, it helped me.&lt;/p>
&lt;p>I can&amp;rsquo;t imagine a world in which people did nothing to pass on their knowledge to future generations. Our stories are all we have beyond instinct and determination.&lt;/p>
&lt;p>I stopped posting about dropshipping and started writing about the technical problems I was solving. I wrote about what I tried, and ultimately what worked. I started hearing from people who thanked me for explaining the solution they were looking for. Even in posts where all I&amp;rsquo;d done was link to the correct set of instructions on some other website, people thanked me for leading them to it. I still thought my website was terrible, but I realized I was doing something useful. The more problems I solved, the better I got at solving them, and the more I wrote about it in turn.&lt;/p>
&lt;p>One day, someone offered me money for one of my solutions. To my great delight, they weren&amp;rsquo;t the last to do so.&lt;/p>
&lt;p>As I built up my skills, I started taking on more challenging offers to solve problems. I discovered, as others have before me, that especially in software development, not every solution is out there waiting for you. The most frustrating part of working on an unsolved problem is that, at least to your knowledge, there&amp;rsquo;s no one about to tell you how to solve it. If you&amp;rsquo;re lucky, you&amp;rsquo;ve at least got a heading from someone&amp;rsquo;s cold trail in an old blog post. If you&amp;rsquo;re lucky and tenacious, you&amp;rsquo;ll find a working solution.&lt;/p>
&lt;p>Don&amp;rsquo;t leave it scribbled in the corner of a soon-forgotten notepad, never to ease the path of someone who comes along later. Update that old blog post by commenting on it, or sending a note to the author. Put your solution on the Internet, somewhere. Ideally, blog about it yourself in as much detail as you can recall. Some of the people who find your post might have the same problem, and might even be willing to pay you to solve it. And, if my own experience and some scattered stories hold true, one of the people to who&amp;rsquo;ll come along later, looking for that same solution, will be you.&lt;/p>
&lt;h2 id="3-paying-it-forwards-backwards-and-investing-two-years-ago" class="anchor-link">&lt;a href="#3-paying-it-forwards-backwards-and-investing-two-years-ago">3. Paying it forwards, backwards, and investing; two years ago&lt;/a>&lt;/h2>
&lt;p>Already being familiar with how easy it is to stop steering and start drifting, I sought new ways to challenge myself and my skills. I wanted to do more than just sustain my lifestyle. I wanted to offer something to others; something that mattered.&lt;/p>
&lt;p>A strange thing started happening when I decided, deliberately, to write an in-depth technical blog about topics I was only beginning to become familiar with. I started to deeply understand some fundamental computer science topics - and trust me, that was strange enough - but odder than that was that others started to see me as a resource. People asked me questions because they thought I had the answers. I didn&amp;rsquo;t, at least, not always - but I knew enough now to not let that stop me. I went to find the answers, to test and understand them, and then I wrote about them to teach those who had asked. I hardly noticed, along the way, that I was learning too.&lt;/p>
&lt;p>When someone&amp;rsquo;s outdated blog post leads you to an eventual solution, you can pay them back by posting an update, or blogging about it yourself. When you solve an unsolved problem, you pay it forward by recording that solution for the next person who comes along (sometimes you). In either case, by writing about it - honestly, and with your best effort to be thorough and correct - you end up investing in yourself.&lt;/p>
&lt;p>Explaining topics you&amp;rsquo;re interested in to other people helps you find the missing pieces in your own knowledge. It helps you fill those gaps with learning, and integrate the things you learn into a new, greater understanding. Teaching something to others helps you become better at it yourself. Getting better at something - anything - means you have more to offer.&lt;/p>
&lt;h2 id="the-past-decade-and-the-next-decade" class="anchor-link">&lt;a href="#the-past-decade-and-the-next-decade">The past decade, and the next decade&lt;/a>&lt;/h2>
&lt;p>It&amp;rsquo;s the end of a decade. I went from an aimless drift through life to being captain of my ship. I bettered my environment, learned new skills, made myself a resource, and became a wife to my best friend. I&amp;rsquo;m pretty happy with all of it.&lt;/p>
&lt;p>It&amp;rsquo;s the end of 2019. Despite a whole lot of life happening just this year, I&amp;rsquo;ve written one article on this blog for each week since I started in July. That&amp;rsquo;s 23 articles for 23 weeks, plus one Christmas bonus. I hear from people almost every day who tell me that an article I wrote was helpful to them, and it makes me happy and proud to think that I&amp;rsquo;ve been doing something that matters. The first week of January will make this blog two years old.&lt;/p>
&lt;p>The past several months have seen me change tack, slightly. I&amp;rsquo;ve become very interested in cybersecurity, and have been lending my skills to the Open Web Application Security Project. I&amp;rsquo;m now an author and maintainer of the &lt;a href="https://github.com/OWASP/wstg">Web Security Testing Guide&lt;/a>, version 5. I&amp;rsquo;m pretty happy with that, too.&lt;/p>
&lt;p>Next year, I&amp;rsquo;ll be posting a little less, though writing even more, as I pursue an old dream of publishing a book, as well as develop my new cybersecurity interests. I aim to get better at quite a few things. Thankfully, I know just how to do it - and now, so do you:&lt;/p>
&lt;ol>
&lt;li>Solve your own problems,&lt;/li>
&lt;li>Write about it,&lt;/li>
&lt;li>Teach others.&lt;/li>
&lt;/ol>
&lt;p>Have a very happy new decade, dear reader.&lt;/p></content:encoded><enclosure url="https://victoria.dev/blog/the-past-ten-years-or-how-to-get-better-at-anything/cover_hu12c1050867d89ecd3be413b30fdb4a56_1745840_640x0_resize_box_2.png" type="image/jpg"/></item><item><title>Healthy habits for good cybersecurity</title><link>https://victoria.dev/blog/healthy-habits-for-good-cybersecurity/</link><pubDate>Thu, 26 Dec 2019 08:27:31 -0400</pubDate><author>hello@victoria.dev (Victoria Drake)</author><guid>https://victoria.dev/blog/healthy-habits-for-good-cybersecurity/</guid><description>A few helpful cybersecurity resolutions to take into the new year. Happy holidays!</description><content:encoded>
&lt;img src="https://victoria.dev/blog/healthy-habits-for-good-cybersecurity/cover_hucc270bede5c5a0079c1820747943bf01_239198_640x0_resize_box_2.png" width="640" height="256"/>
&lt;p>In a similar fashion to everyone getting the flu now and again, the risk of catching a cyberattack is a common one. Both a sophisticated social engineering attack or grammatically-lacking email phishing scam can cause real damage. No one who communicates over the Internet is immune.&lt;/p>
&lt;p>Like proper hand washing and getting a flu shot, good habits can lower your risk of inadvertently allowing cybergerms to spread. Since the new year is an inspiring time for beginning new habits, I offer a few suggestions for ways to help protect yourself and those around you.&lt;/p>
&lt;h2 id="1-get-a-follow-up" class="anchor-link">&lt;a href="#1-get-a-follow-up">1. Get a follow-up&lt;/a>&lt;/h2>
&lt;p>Recognizing a delivery method for cyberattack is getting more difficult. Messages with malicious links do not always come from strangers. They may appear to be routine communications, or seem to originate from someone you know or work with. Attacks use subtle but deeply-engrained cognitive biases to override your common sense. Your natural response ensures you click.&lt;/p>
&lt;p>Thankfully, there&amp;rsquo;s a simple low-tech habit you can use to deter these attacks: before you act, follow-up.&lt;/p>
&lt;p>You may get an email from a friend that needs help, or from your boss who&amp;rsquo;s about to get on a plane. It could be as enticing and mysterious as a direct message from an acquaintance who sends a link asking, &amp;ldquo;Lol. Is this you?&amp;rdquo; It takes presence of mind to override the panic these attacks prey on, but the deterrent itself is quick and straightforward. Send a text message, pick up the phone and call, or walk down the hall, and ask, &amp;ldquo;Did you send me this?&amp;rdquo;&lt;/p>
&lt;p>If the message is genuine, there&amp;rsquo;s no harm in a few extra minutes to double check. If it&amp;rsquo;s not, you&amp;rsquo;ll immediately alert the originating party that they may be compromised, and you may have deterred a cyberattack!&lt;/p>
&lt;h2 id="2-use-and-encourage-others-to-use-end-to-end-encrypted-messaging" class="anchor-link">&lt;a href="#2-use-and-encourage-others-to-use-end-to-end-encrypted-messaging">2. Use, and encourage others to use, end-to-end encrypted messaging&lt;/a>&lt;/h2>
&lt;p>When individuals in a neighborhood get the flu shot, others in that neighborhood are safer for it. Encryption is similarly beneficial. Encourage your friends, coworkers, and Aunt Matilda to switch to an app like Signal. By doing so, you&amp;rsquo;ll reduce everyone&amp;rsquo;s exposure to more exploitable messaging systems.&lt;/p>
&lt;p>This doesn&amp;rsquo;t mean that you must stop using other methods of communication entirely. Instead, think of it as a hierarchy. Use Signal for important messages that should be trusted, like requests for money or making travel arrangements. Use all other methods of messaging, like SMS or social sites, only for &amp;ldquo;unimportant&amp;rdquo; communications. Now, if requests or links that seem important come to you through your unimportant methods, you&amp;rsquo;ll be all the more likely to second-guess them.&lt;/p>
&lt;h2 id="3-dont-put-that-dirty-usb-plug-into-your-" class="anchor-link">&lt;a href="#3-dont-put-that-dirty-usb-plug-into-your-">3. Don&amp;rsquo;t put that dirty USB plug into your ***&lt;/a>&lt;/h2>
&lt;p>You wouldn&amp;rsquo;t brush your teeth with a toothbrush you found on the sidewalk. Why would you plug in a USB device if you don&amp;rsquo;t know where it&amp;rsquo;s been?! While we might ascribe &lt;a href="https://en.wikipedia.org/wiki/2008_cyberattack_on_United_States">putting a random found USB drive in your computer&lt;/a> to a clever exploitation of natural human curiosity, we&amp;rsquo;re no sooner likely to suspect using &lt;a href="https://www.howtogeek.com/444267/how-safe-are-public-charging-stations/">a public phone-charging station&lt;/a> or &lt;a href="https://www.theverge.com/2019/8/15/20807854/apple-mac-lightning-cable-hack-mike-grover-mg-omg-cables-defcon-cybersecurity">a USB cable&lt;/a> we bought ourselves. Even seemingly-innocuous USB &lt;a href="https://www.cbsnews.com/news/why-your-usb-device-is-a-security-risk/">peripherals&lt;/a> or &lt;a href="https://www.us-cert.gov/ncas/current-activity/2010/03/08/Energizer-DUO-USB-Battery-Charger-Software-Allows-Remote-System">rechargeable&lt;/a> devices can be a risk.&lt;/p>
&lt;p>Unlike email and some file-sharing services that scan and filter files before they reach your computer, plugging in via USB is as direct and &lt;a href="https://www.wired.com/2014/07/usb-security/">unprotected&lt;/a> as connection gets. Once this connection is made, the user doesn&amp;rsquo;t need to do anything else for a whole host of bad things to happen. Through USB connections, problems like malware and ransomware can easily infect your computer or phone.&lt;/p>
&lt;p>There&amp;rsquo;s no need to swear off the convenience of USB connectivity, or to avoid these devices altogether. Instead of engaging in questionable USB behavior, don&amp;rsquo;t cheap out on USB devices and cables. If it&amp;rsquo;s going to get plugged into your computer, ensure you&amp;rsquo;re being extra cautious. Buy it from the manufacturer (like the Apple Store) or from a reputable company or reseller with supply chain control. When juicing up USB-rechargeables, don&amp;rsquo;t plug them into your computer. Use &lt;a href="https://heronebag.com/blog/40-hours-drive-time-my-road-trip-charging-essentials/">a wall charger with a USB port&lt;/a> instead.&lt;/p>
&lt;h2 id="practice-healthy-cybersecurity-habits" class="anchor-link">&lt;a href="#practice-healthy-cybersecurity-habits">Practice healthy cybersecurity habits&lt;/a>&lt;/h2>
&lt;p>Keeping your devices healthy and happy is a matter of practicing good habits. Like battling the flu, good habits can help protect yourself and those around you. Incorporate some conscientious cybersecurity practices in your new year resolutions - or start them right away.&lt;/p>
&lt;p>Have a safe and happy holiday!&lt;/p></content:encoded><enclosure url="https://victoria.dev/blog/healthy-habits-for-good-cybersecurity/cover_hucc270bede5c5a0079c1820747943bf01_239198_640x0_resize_box_2.png" type="image/jpg"/></item><item><title>Concurrency, parallelism, and the many threads of Santa Claus </title><link>https://victoria.dev/blog/concurrency-parallelism-and-the-many-threads-of-santa-claus/</link><pubDate>Mon, 23 Dec 2019 19:29:01 -0500</pubDate><author>hello@victoria.dev (Victoria Drake)</author><guid>https://victoria.dev/blog/concurrency-parallelism-and-the-many-threads-of-santa-claus/</guid><description>A seasonal exploration of the difference between concurrent, parallel, and multithreaded processes.</description><content:encoded>
&lt;img src="https://victoria.dev/blog/concurrency-parallelism-and-the-many-threads-of-santa-claus/cover_huad486c0cadb16dfd85c71edfd1b24caf_604773_640x0_resize_box_2.png" width="640" height="256"/>
&lt;p>Consider the following: Santa brings toys to all the good girls and boys.&lt;/p>
&lt;p>There are &lt;a href="https://en.wikipedia.org/wiki/Demographics_of_the_world#Current_population_distribution">7,713,468,100 people&lt;/a> in the world in 2019, &lt;a href="https://en.wikipedia.org/wiki/Demographics_of_the_world#Age_structure">around 26.3%&lt;/a> of which are under 15 years old. This works out to 2,028,642,110 children (persons under 15 years of age) in the world this year.&lt;/p>
&lt;p>Santa doesn&amp;rsquo;t seem to visit children of every religion, so we&amp;rsquo;ll generalize and only include Christians and non-religious folks. Collectively that makes up &lt;a href="https://en.wikipedia.org/wiki/List_of_religious_populations#Adherent_estimates_in_2019">approximately 44.72%&lt;/a> of the population. If we assume that all kids take after their parents, then 907,208,751.6 children would appear to be Santa-eligible.&lt;/p>
&lt;p>What percentage of those children are good? It&amp;rsquo;s impossible to know; however, we can work on a few assumptions. One is that Santa Claus functions more on optimism than economics and would likely have prepared for the possibility that every child is a good child in any given year. Thus, he would be prepared to give a toy to every child. Let&amp;rsquo;s assume it&amp;rsquo;s been a great year and that all 907,208,751.6 children are getting toys.&lt;/p>
&lt;p>That&amp;rsquo;s a lot of presents, and, as we know, they&amp;rsquo;re all made by Santa&amp;rsquo;s elves at his North &lt;del>China&lt;/del> Pole workshop. Given that there are 365 days in a year and one of them is Christmas, let&amp;rsquo;s assume that Santa&amp;rsquo;s elves collectively have 364 days to create and gift wrap 907,208,752 (rounded up) presents. That works out to 2,492,331.74 presents per day.&lt;/p>
&lt;p>Almost two-and-a-half million presents per day is a heavy workload for any workshop. Let&amp;rsquo;s look at two paradigms that Santa might employ to hit this goal: concurrency, and parallelism.&lt;/p>
&lt;h2 id="a-sequential-process" class="anchor-link">&lt;a href="#a-sequential-process">A sequential process&lt;/a>&lt;/h2>
&lt;p>Suppose that Santa&amp;rsquo;s workshop is staffed by exactly one, very hard working, very tired elf. The production of one present involves four steps:&lt;/p>
&lt;ol>
&lt;li>Cutting wood&lt;/li>
&lt;li>Assembly and glueing&lt;/li>
&lt;li>Painting&lt;/li>
&lt;li>Gift-wrapping&lt;/li>
&lt;/ol>
&lt;p>With a single elf, only one step for one present can be happening at any instance in time. If the elf were to produce one present at a time from beginning to end, that process would be executed &lt;em>sequentially&lt;/em>. It&amp;rsquo;s not the most efficient method for producing two-and-a-half million presents per day; for instance, the elf would have to wait around doing nothing while the glue on the present was drying before moving on to the next step.&lt;/p>
&lt;p>
&lt;img src="https://victoria.dev/blog/concurrency-parallelism-and-the-many-threads-of-santa-claus/sequence.png" alt="Illustration of sequence" />
&lt;/p>
&lt;h2 id="concurrency" class="anchor-link">&lt;a href="#concurrency">Concurrency&lt;/a>&lt;/h2>
&lt;p>In order to be more efficient, the elf works on all presents &lt;em>concurrently&lt;/em>.&lt;/p>
&lt;p>Instead of completing one present at a time, the elf first cuts all the wood for all the toys, one by one. When everything is cut, the elf assembles and glues the toys together, one after the other. This &lt;a href="https://en.wikipedia.org/wiki/Concurrent_computing">concurrent processing&lt;/a> means that the glue from the first toy has time to dry (without needing more attention from the elf) while the remaining toys are glued together. The same goes for painting, one toy at a time, and finally wrapping.&lt;/p>
&lt;p>
&lt;img src="https://victoria.dev/blog/concurrency-parallelism-and-the-many-threads-of-santa-claus/concurrency.png" alt="Illustration of concurrency" />
&lt;/p>
&lt;p>Since one elf can only do one task at a time, a single elf is using the day as efficiently as possible by concurrently producing presents.&lt;/p>
&lt;h2 id="parallelism" class="anchor-link">&lt;a href="#parallelism">Parallelism&lt;/a>&lt;/h2>
&lt;p>Hopefully, Santa&amp;rsquo;s workshop has more than just one elf. With more elves, more toys can be built simultaneously over the course of a day. This simultaneous work means that the presents are being produced in &lt;em>parallel&lt;/em>. &lt;a href="https://en.wikipedia.org/wiki/Parallel_computing">Parallel processing&lt;/a> carried out by multiple elves means more work happens at the same time.&lt;/p>
&lt;p>
&lt;img src="https://victoria.dev/blog/concurrency-parallelism-and-the-many-threads-of-santa-claus/parallel.png" alt="Illustration of parallel processes" />
&lt;/p>
&lt;p>Elves working in parallel can also employ concurrency. One elf can still tackle only one task at a time, so it&amp;rsquo;s most efficient to have multiple elves concurrently producing presents.&lt;/p>
&lt;p>Of course, if Santa&amp;rsquo;s workshop has, say, two-and-a-half million elves, each elf would only need to finish a maximum of one present per day. In this case, working sequentially doesn&amp;rsquo;t detract from the workshop&amp;rsquo;s efficiency. There would still be 7,668.26 elves left over to fetch coffee and lunch.&lt;/p>
&lt;h2 id="santa-claus-and-threading" class="anchor-link">&lt;a href="#santa-claus-and-threading">Santa Claus, and threading&lt;/a>&lt;/h2>
&lt;p>After all the elves' hard work is done, it&amp;rsquo;s up to Santa Claus to deliver the presents &amp;ndash; all 907,208,752 of them.&lt;/p>
&lt;p>Santa doesn&amp;rsquo;t need to make a visit to every kid; just to the one household tree. So how many trees does Santa need to visit? Again with broad generalization, we&amp;rsquo;ll say that the average number of children per household worldwide is &lt;a href="https://en.wikipedia.org/wiki/Demographics_of_the_world#Total_fertility_rate">2.45, based on the year&amp;rsquo;s predicted fertility rates&lt;/a>. That makes 370,289,286.4 houses to visit. Let&amp;rsquo;s round that up to 370,289,287.&lt;/p>
&lt;p>How long does Santa have? The lore says one night, which means one earthly rotation, and thus 24 hours. &lt;a href="https://www.noradsanta.org/">NORAD confirms&lt;/a>.&lt;/p>
&lt;p>This means Santa must visit 370,289,287 households in 24 hours (86,400 seconds), at a rate of 4,285.75 households per second, nevermind the time it takes to put presents under the tree and grab a cookie.&lt;/p>
&lt;p>Clearly, Santa doesn&amp;rsquo;t exist in our dimension. This is especially likely given that despite being chubby and plump, he fits down a chimney (with a lit fire, while remaining unhurt) carrying a sack of toys containing presents for all the household&amp;rsquo;s children. We haven&amp;rsquo;t even considered the fact that his sleigh carries enough toys for every believing boy and girl around the world, and flies.&lt;/p>
&lt;p>Does Santa exist outside our rules of physics? How could one entity manage to travel around the world, delivering packages, in under 24 hours at a rate of 4,285.75 households per second, and still have time for milk and cookies and kissing mommy?&lt;/p>
&lt;p>One thing is certain: Santa uses the Internet. No other technology has yet enabled packages to travel quite so far and quite so quickly. Even so, attempting to reach upwards of four thousand households per second is no small task, even with even the best gigabit Internet hookup the North Pole has to offer. How might Santa increase his efficiency?&lt;/p>
&lt;p>There&amp;rsquo;s clearly only one logical conclusion to this mystery: Santa Claus is a multithreaded process.&lt;/p>
&lt;h2 id="a-single-thread" class="anchor-link">&lt;a href="#a-single-thread">A single thread&lt;/a>&lt;/h2>
&lt;p>Let&amp;rsquo;s work outward. Think of a &lt;a href="https://en.wikipedia.org/wiki/Thread_(computing)">thread&lt;/a> as one particular task, or the most granular sequence of instructions that Santa might execute. One thread might execute the task, &lt;code>put present under tree&lt;/code>. A thread is a component of a process, in this case, Santa&amp;rsquo;s process of delivering presents.&lt;/p>
&lt;p>If Santa Claus is &lt;a href="https://en.wikipedia.org/wiki/Thread_(computing)#Single_threading">single-threaded&lt;/a>, he, as a process, would only be able to accomplish one task at a time. Since he&amp;rsquo;s old and a bit forgetful, he probably has a set of instructions for delivering presents, as well as a schedule to abide by. These two things guide Santa&amp;rsquo;s thread until his process is complete.&lt;/p>
&lt;p>
&lt;img src="https://victoria.dev/blog/concurrency-parallelism-and-the-many-threads-of-santa-claus/single.png" alt="A single Santa Claus emoji" />
&lt;/p>
&lt;p>Single-threaded Santa Claus might work something like this:&lt;/p>
&lt;ol>
&lt;li>Land sleigh at Timmy&amp;rsquo;s house&lt;/li>
&lt;li>Get Timmy&amp;rsquo;s present from sleigh&lt;/li>
&lt;li>Enter house via chimney&lt;/li>
&lt;li>Locate Christmas tree&lt;/li>
&lt;li>Place Timmy&amp;rsquo;s present under Christmas tree&lt;/li>
&lt;li>Exit house via chimney&lt;/li>
&lt;li>Take off in sleigh&lt;/li>
&lt;/ol>
&lt;p>Rinse and repeat&amp;hellip; another 370,289,286 times.&lt;/p>
&lt;h2 id="multithreading" class="anchor-link">&lt;a href="#multithreading">Multithreading&lt;/a>&lt;/h2>
&lt;p>&lt;a href="https://en.wikipedia.org/wiki/Thread_(computing)#Multithreading">Multithreaded&lt;/a> Santa Claus, by contrast, is the &lt;a href="https://dc.fandom.com/wiki/Jonathan_Osterman_(Watchmen)">Doctor Manhattan&lt;/a> of the North Pole. There&amp;rsquo;s still only one Santa Claus in the world; however, he has the amazing ability to multiply his consciousness and accomplish multiple instruction sets of tasks simultaneously. These additional task workers, or worker threads, are created and controlled by the main process of Santa delivering presents.&lt;/p>
&lt;p>
&lt;img src="https://victoria.dev/blog/concurrency-parallelism-and-the-many-threads-of-santa-claus/cover.png" alt="Multiple Santa threads" />
&lt;/p>
&lt;p>Each worker thread acts independently to complete its instructions. Since they all belong to Santa&amp;rsquo;s consciousness, they share Santa&amp;rsquo;s memory and know everything that Santa knows, including what planet they&amp;rsquo;re running around on, and where to get the presents from.&lt;/p>
&lt;p>With this shared knowledge, each thread is able to execute its set of instructions in parallel with the other threads. This multithreaded parallelism makes the one and only Santa Claus as efficient as possible.&lt;/p>
&lt;p>If an average present delivery run takes an hour, Santa need only spawn 4,286 worker threads. With each making one delivery trip per hour, Santa will have completed all 370,289,287 trips by the end of the night.&lt;/p>
&lt;p>Of course, in theory, Santa could even spawn 370,289,287 worker threads, each flying to one household to deliver presents for all the children in it! That would make Santa&amp;rsquo;s process extremely efficient, and also explain how he manages to consume all those milk-dunked cookies without getting full. &lt;/p>
&lt;h2 id="an-efficient-and-merry-multithreaded-christmas" class="anchor-link">&lt;a href="#an-efficient-and-merry-multithreaded-christmas">An efficient and merry multithreaded Christmas&lt;/a>&lt;/h2>
&lt;p>Thanks to modern computing, we now finally understand how Santa Claus manages the seemingly-impossible task of delivering toys to good girls and boys the world-over. From my family to yours, I hope you have a wonderful Christmas. Don&amp;rsquo;t forget to hang up your stockings on the router shelf.&lt;/p>
&lt;p>Of course, none of this explains how reindeer manage to fly.&lt;/p></content:encoded><enclosure url="https://victoria.dev/blog/concurrency-parallelism-and-the-many-threads-of-santa-claus/cover_huad486c0cadb16dfd85c71edfd1b24caf_604773_640x0_resize_box_2.png" type="image/jpg"/></item><item><title>Word bugs in software documentation and how to fix them</title><link>https://victoria.dev/blog/word-bugs-in-software-documentation-and-how-to-fix-them/</link><pubDate>Wed, 18 Dec 2019 09:01:23 -0400</pubDate><author>hello@victoria.dev (Victoria Drake)</author><guid>https://victoria.dev/blog/word-bugs-in-software-documentation-and-how-to-fix-them/</guid><description>A collection of mistakes that make documentation less awesome than it could be.</description><content:encoded>
&lt;img src="https://victoria.dev/blog/word-bugs-in-software-documentation-and-how-to-fix-them/cover_hub71530efa4dbeb6102a2a18458d3318e_229742_640x0_resize_box_2.png" width="640" height="256"/>
&lt;p>I&amp;rsquo;ve been an editor longer than I&amp;rsquo;ve been a developer, so this topic for me is a real root issue.  When I see a great project with poorly-written docs, it hits close to &lt;code>/home&lt;/code>. Okay, okay, I&amp;rsquo;m done.&lt;/p>
&lt;p>I help the &lt;a href="https://github.com/OWASP">Open Web Application Security Project (OWASP)&lt;/a> with their &lt;a href="https://github.com/OWASP/wstg">Web Security Testing Guide (WSTG)&lt;/a>. I was recently tasked with writing a &lt;a href="https://github.com/OWASP/wstg/blob/master/style_guide.md">style guide&lt;/a> and article template that show how to write technical instruction for testing software applications.&lt;/p>
&lt;p>I thought parts of the guide would benefit more people than just OWASP&amp;rsquo;s contributors, so I&amp;rsquo;m sharing some here.&lt;/p>
&lt;p>Many of the projects I participate in are open source. This is a wonderful way for people to share solutions and to build on each others' ideas. Unfortunately, it&amp;rsquo;s also a great way for misused and non-existent words to catch on. Here&amp;rsquo;s an excerpt of the guide with some mistakes I&amp;rsquo;ve noticed and how you can fix them in your technical documents.&lt;/p>
&lt;hr>
&lt;h2 id="use-correct-words" class="anchor-link">&lt;a href="#use-correct-words">Use Correct Words&lt;/a>&lt;/h2>
&lt;p>The following are frequently misused words and how to correct them.&lt;/p>
&lt;h3 id="_andor_" class="anchor-link">&lt;a href="#_andor_">&lt;em>and/or&lt;/em>&lt;/a>&lt;/h3>
&lt;p>While sometimes used in legal documents, &lt;em>and/or&lt;/em> leads to ambiguity and confusion in technical writing. Instead, use &lt;em>or&lt;/em>, which in the English language includes &lt;em>and&lt;/em>. For example:&lt;/p>
&lt;blockquote>
&lt;p>Bad: &amp;ldquo;The code will output an error number and/or description.&amp;rdquo;
Good: &amp;ldquo;The code will output an error number or description.&amp;rdquo;&lt;/p>
&lt;/blockquote>
&lt;p>The latter sentence does not exclude the possibility of having both an error number and description.&lt;/p>
&lt;p>If you need to specify all possible outcomes, use a list:&lt;/p>
&lt;blockquote>
&lt;p>&amp;ldquo;The code will output an error number, or a description, or both.&amp;rdquo;&lt;/p>
&lt;/blockquote>
&lt;h3 id="_frontend-backend_" class="anchor-link">&lt;a href="#_frontend-backend_">&lt;em>frontend, backend&lt;/em>&lt;/a>&lt;/h3>
&lt;p>While it&amp;rsquo;s true that the English language evolves over time, these are not yet words.&lt;/p>
&lt;p>When referring to nouns, use &lt;em>front end&lt;/em> and &lt;em>back end&lt;/em>. For example:&lt;/p>
&lt;blockquote>
&lt;p>Security is equally important on the front end as it is on the back end.&lt;/p>
&lt;/blockquote>
&lt;p>As a descriptive adverb, use the hyphenated &lt;em>front-end&lt;/em> and &lt;em>back-end&lt;/em>.&lt;/p>
&lt;blockquote>
&lt;p>Both front-end developers and back-end developers are responsible for application security.&lt;/p>
&lt;/blockquote>
&lt;h3 id="_whitebox_-_blackbox_-_greybox_" class="anchor-link">&lt;a href="#_whitebox_-_blackbox_-_greybox_">&lt;em>whitebox&lt;/em>, &lt;em>blackbox&lt;/em>, &lt;em>greybox&lt;/em>&lt;/a>&lt;/h3>
&lt;p>These are not words.&lt;/p>
&lt;p>As nouns, use &lt;em>white box&lt;/em>, &lt;em>black box&lt;/em>, and &lt;em>grey box&lt;/em>. These nouns rarely appear in connection with cybersecurity.&lt;/p>
&lt;blockquote>
&lt;p>My cat enjoys jumping into that grey box.&lt;/p>
&lt;/blockquote>
&lt;p>As adverbs, use the hyphenated &lt;em>white-box&lt;/em>, &lt;em>black-box&lt;/em>, and &lt;em>grey-box&lt;/em>. Do not use capitalization unless the words are in a title.&lt;/p>
&lt;blockquote>
&lt;p>While white-box testing involves knowledge of source code, black-box testing does not. A grey-box test is somewhere in-between.&lt;/p>
&lt;/blockquote>
&lt;h3 id="_ie_-_eg_" class="anchor-link">&lt;a href="#_ie_-_eg_">&lt;em>ie&lt;/em>, &lt;em>eg&lt;/em>&lt;/a>&lt;/h3>
&lt;p>These are letters.&lt;/p>
&lt;p>The abbreviation &lt;em>i.e.&lt;/em> refers to the Latin &lt;em>id est&lt;/em>, which means &amp;ldquo;in other words.&amp;rdquo; The abbreviation &lt;em>e.g.&lt;/em> is for &lt;em>exempli gratia&lt;/em>, translating to &amp;ldquo;for example.&amp;rdquo; To use these in a sentence:&lt;/p>
&lt;blockquote>
&lt;p>Write using proper English, i.e. correct spelling and grammar. Use common words over uncommon ones, e.g. &amp;ldquo;learn&amp;rdquo; instead of &amp;ldquo;glean.&amp;rdquo;&lt;/p>
&lt;/blockquote>
&lt;h3 id="_etc_" class="anchor-link">&lt;a href="#_etc_">&lt;em>etc&lt;/em>&lt;/a>&lt;/h3>
&lt;p>These are also letters.&lt;/p>
&lt;p>The Latin phrase &lt;em>et cetera&lt;/em> translates to &amp;ldquo;and the rest.&amp;rdquo; It is abbreviated &lt;em>etc.&lt;/em> and typically placed at the end of a list that seems redundant to complete:&lt;/p>
&lt;blockquote>
&lt;p>WSTG authors like rainbow colors, such as red, yellow, green, etc.&lt;/p>
&lt;/blockquote>
&lt;p>In technical writing, the use of &lt;em>etc.&lt;/em> is problematic. It assumes the reader knows what you&amp;rsquo;re talking about, and they may not. Violet is one of the colors of the rainbow, but the example above does not explicitly tell you if violet is a color that WSTG authors like.&lt;/p>
&lt;p>It is better to be explicit and thorough than to make assumptions of the reader. Only use &lt;em>etc.&lt;/em> to avoid completing a list that was given in full earlier in the document.&lt;/p>
&lt;h3 id="__-ellipsis" class="anchor-link">&lt;a href="#__-ellipsis">&lt;em>&amp;hellip;&lt;/em> (ellipsis)&lt;/a>&lt;/h3>
&lt;p>The ellipsis punctuation mark can indicate that words have been left out of a quote:&lt;/p>
&lt;blockquote>
&lt;p>Linus Torvalds once said, &amp;ldquo;Once you realize that documentation should be laughed at&amp;hellip; THEN, and only then, have you reached the level where you can safely read it and try to use it to actually implement a driver.&amp;rdquo;&lt;/p>
&lt;/blockquote>
&lt;p>As long as the omission does not change the meaning of the quote, this is acceptable usage of ellipsis in the WSTG.&lt;/p>
&lt;p>All other uses of ellipsis, such as to indicate an unfinished thought, are not.&lt;/p>
&lt;h3 id="_ex_" class="anchor-link">&lt;a href="#_ex_">&lt;em>ex&lt;/em>&lt;/a>&lt;/h3>
&lt;p>While this is a word, it is likely not the word you are looking for. The word &lt;em>ex&lt;/em> has particular meaning in the fields of finance and commerce, and may refer to a person if you are discussing your past relationships. None of these topics should appear in the WSTG.&lt;/p>
&lt;p>The abbreviation &lt;em>ex.&lt;/em> may be used to mean &amp;ldquo;example&amp;rdquo; by lazy writers. Please don&amp;rsquo;t be lazy, and write &lt;em>example&lt;/em> instead.&lt;/p>
&lt;hr>
&lt;h2 id="go-forth-and-write-docs" class="anchor-link">&lt;a href="#go-forth-and-write-docs">Go forth and write docs&lt;/a>&lt;/h2>
&lt;p>If these reminders are helpful, please share them freely and use them when writing your own READMEs and documentation! If there&amp;rsquo;s some I&amp;rsquo;ve missed, I&amp;rsquo;d love to know.&lt;/p>
&lt;p>And if you&amp;rsquo;re here for the comments&amp;hellip;&lt;/p>
&lt;p>
&lt;img src="https://victoria.dev/blog/word-bugs-in-software-documentation-and-how-to-fix-them/crowder-change-my-mind.png#center" alt="Change my mind meme" />
&lt;/p>
&lt;p>There are none on my blog. You can still &lt;a href="https://victoria.dev/contact">@ me&lt;/a>.&lt;/p>
&lt;p>If you&amp;rsquo;d like to help contribute to the OWASP WSTG, please read &lt;a href="https://github.com/OWASP/wstg/blob/master/CONTRIBUTING.md">the contribution guide&lt;/a>. See the &lt;a href="https://github.com/OWASP/wstg/blob/master/style_guide.md">full style guide here&lt;/a>.&lt;/p></content:encoded><enclosure url="https://victoria.dev/blog/word-bugs-in-software-documentation-and-how-to-fix-them/cover_hub71530efa4dbeb6102a2a18458d3318e_229742_640x0_resize_box_2.png" type="image/jpg"/></item><item><title>Secure web forms for the front-end developer</title><link>https://victoria.dev/blog/secure-web-forms-for-the-front-end-developer/</link><pubDate>Wed, 11 Dec 2019 08:27:31 -0400</pubDate><author>hello@victoria.dev (Victoria Drake)</author><guid>https://victoria.dev/blog/secure-web-forms-for-the-front-end-developer/</guid><description>How to design secure web forms: validate, sanitize, and control.</description><content:encoded>
&lt;img src="https://victoria.dev/blog/secure-web-forms-for-the-front-end-developer/cover_hu07d29ec2cae21d8634af4fbdb25c976c_325727_640x0_resize_box_2.png" width="640" height="256"/>
&lt;p>While cybersecurity is often thought of in terms of databases and architecture, much of a strong security posture relies on elements in the domain of the front-end developer. For certain potentially devastating vulnerabilities like &lt;a href="https://owasp.org/www-project-top-ten/OWASP_Top_Ten_2017/Top_10-2017_A1-Injection">SQL injection&lt;/a> and &lt;a href="https://owasp.org/www-project-top-ten/OWASP_Top_Ten_2017/Top_10-2017_A7-Cross-Site_Scripting_(XSS)">Cross-Site Scripting (XSS)&lt;/a>, a well-considered user interface is the first line of defense.&lt;/p>
&lt;p>Here are a few areas of focus for front-end developers who want to help fight the good fight.&lt;/p>
&lt;h2 id="control-user-input" class="anchor-link">&lt;a href="#control-user-input">Control user input&lt;/a>&lt;/h2>
&lt;p>A whole whack of &lt;a href="https://victoria.dev/blog/sql-injection-and-xss-what-white-hat-hackers-know-about-trusting-user-input/">crazy things&lt;/a> can happen when developers build a form that fails to control user input. To combat vulnerabilities like injection, it&amp;rsquo;s important to validate or sanitize user input.&lt;/p>
&lt;p>Input can be validated by constraining it to known values, such as by using &lt;a href="https://developer.mozilla.org/en-US/docs/Web/Guide/HTML/HTML5/Constraint_validation#Semantic_input_types">semantic input types&lt;/a> or &lt;a href="https://developer.mozilla.org/en-US/docs/Web/Guide/HTML/HTML5/Constraint_validation#Validation-related_attributes">validation-related attributes&lt;/a> in forms. Frameworks like &lt;a href="https://www.djangoproject.com/">Django&lt;/a> also help by providing &lt;a href="https://docs.djangoproject.com/en/3.0/ref/models/fields/#field-types">field types&lt;/a> for this purpose. Sanitizing data can be done by removing or replacing contextually-dangerous characters, such as by using a whitelist or escaping the input data.&lt;/p>
&lt;p>While it may not be intuitive, even data that a user submits to their own area on a site should be validated. One of the fastest viruses to proliferate was the &lt;a href="https://en.wikipedia.org/wiki/Samy_(computer_worm)">Samy worm&lt;/a> on MySpace (yes, I&amp;rsquo;m old), thanks to code that Samy Kamkar was able to inject into his own profile page. Don&amp;rsquo;t directly return any input to your site without thorough validation or santization.&lt;/p>
&lt;p>For some further guidance on battling injection attacks, see the &lt;a href="https://github.com/OWASP/CheatSheetSeries/blob/master/cheatsheets/Injection_Prevention_Cheat_Sheet.md">OWASP Injection Prevention Cheat Sheet&lt;/a>.&lt;/p>
&lt;h2 id="beware-hidden-fields" class="anchor-link">&lt;a href="#beware-hidden-fields">Beware hidden fields&lt;/a>&lt;/h2>
&lt;p>Adding &lt;code>type=&amp;quot;hidden&amp;quot;&lt;/code> is an enticingly convenient way to hide sensitive data in pages and forms, but unfortunately not an effective one. With tools like &lt;a href="https://www.zaproxy.org/">ZapProxy&lt;/a> and even inspection tools in plain ol' web browsers, users can easily click to reveal tasty bits of invisible information. Hiding checkboxes can be a neat hack for creating CSS-only switches, but hidden fields do little to contribute to security.&lt;/p>
&lt;p>If you must use hidden fields, here are some &lt;a href="https://www.owasp.org/index.php/Data_Validation#Hidden_fields">helpful guidelines&lt;/a>.&lt;/p>
&lt;h2 id="carefully-consider-autofill-fields" class="anchor-link">&lt;a href="#carefully-consider-autofill-fields">Carefully consider autofill fields&lt;/a>&lt;/h2>
&lt;p>When a user chooses to give you their &lt;a href="https://en.wikipedia.org/wiki/Personal_data">Personally Identifiable Information&lt;/a> (PII), it should be a conscious choice. Autofill form fields can be convenient - for both users and attackers. &lt;a href="https://freedom-to-tinker.com/2017/12/27/no-boundaries-for-user-identities-web-trackers-exploit-browser-login-managers/">Exploits using hidden fields can harvest PII&lt;/a> previously captured by an autocomplete field.&lt;/p>
&lt;p>Many users aren&amp;rsquo;t even aware what information their browser&amp;rsquo;s autofill has stored up. Use these fields sparingly, and disable autofilled forms for particularly sensitive data.&lt;/p>
&lt;p>It&amp;rsquo;s important to also weigh your risk profile against its trade-offs. If your project must be &lt;a href="https://www.w3.org/WAI/standards-guidelines/wcag/">WCAG&lt;/a> compliant, disabling autocomplete can break your input for different modalities. For more, see &lt;a href="https://www.w3.org/WAI/WCAG21/Understanding/identify-input-purpose.html">1.3.5: Identify Input Purpose in WCAG 2.1&lt;/a>.&lt;/p>
&lt;h2 id="keep-errors-generic" class="anchor-link">&lt;a href="#keep-errors-generic">Keep errors generic&lt;/a>&lt;/h2>
&lt;p>While it may seem helpful to let users know whether a piece of data exists, it&amp;rsquo;s also very helpful to attackers. When dealing with accounts, emails, and PII, it&amp;rsquo;s most secure to err () on the side of less. Instead of returning &amp;ldquo;Your password for this account is incorrect,&amp;rdquo; try the more ambiguous feedback &amp;ldquo;Incorrect login information,&amp;rdquo; and avoid revealing whether the username or email is in the system.&lt;/p>
&lt;p>In order to be more helpful, provide a prominent way to contact a human in case an error should arise. Avoid revealing information that isn&amp;rsquo;t necessary. If nothing else, for heaven&amp;rsquo;s sake, don&amp;rsquo;t suggest data that&amp;rsquo;s a close match to the user input.&lt;/p>
&lt;h2 id="be-a-bad-guy" class="anchor-link">&lt;a href="#be-a-bad-guy">Be a bad guy&lt;/a>&lt;/h2>
&lt;p>When considering security, it&amp;rsquo;s helpful to take a step back, observe the information on display, and ask yourself how a malicious attacker would be able to utilize it. Play devil&amp;rsquo;s advocate. If a bad guy saw this page, what new information would they gain? Does the view show any PII?&lt;/p>
&lt;p>Ask yourself if everything on the page is actually necessary for a genuine user. If not, redact or remove it. Less is safer.&lt;/p>
&lt;h2 id="security-starts-at-the-front-door" class="anchor-link">&lt;a href="#security-starts-at-the-front-door">Security starts at the front door&lt;/a>&lt;/h2>
&lt;p>These days, there&amp;rsquo;s a lot more overlap between coding on the front end and the back end. To create a well-rounded and secure application, it helps to have a general understanding of ways attackers can get their foot in the front door.&lt;/p></content:encoded><enclosure url="https://victoria.dev/blog/secure-web-forms-for-the-front-end-developer/cover_hu07d29ec2cae21d8634af4fbdb25c976c_325727_640x0_resize_box_2.png" type="image/jpg"/></item><item><title>The surprisingly difficult task of printing newlines in a terminal</title><link>https://victoria.dev/blog/the-surprisingly-difficult-task-of-printing-newlines-in-a-terminal/</link><pubDate>Wed, 04 Dec 2019 09:17:35 -0500</pubDate><author>hello@victoria.dev (Victoria Drake)</author><guid>https://victoria.dev/blog/the-surprisingly-difficult-task-of-printing-newlines-in-a-terminal/</guid><description>Your guide to string interpolation quirks that confound the best ofus.</description><content:encoded>
&lt;img src="https://victoria.dev/blog/the-surprisingly-difficult-task-of-printing-newlines-in-a-terminal/cover_huad486c0cadb16dfd85c71edfd1b24caf_253243_640x0_resize_box_2.png" width="640" height="256"/>
&lt;p>Surprisingly, getting computers to give humans readable output is no easy feat. With the introduction of &lt;a href="https://en.wikipedia.org/wiki/Standard_streams">standard streams&lt;/a> and specifically standard output, programs gained a way to talk to each other using plain text streams; humanizing and displaying stdout is another matter. Technology throughout the computing age has tried to solve this problem, from the use of &lt;a href="https://en.wikipedia.org/wiki/Computer_terminal#Early_VDUs">ASCII characters in video computer displays&lt;/a> to modern shell commands like &lt;code>echo&lt;/code> and &lt;code>printf&lt;/code>.&lt;/p>
&lt;p>These advancements have not been seamless. The job of printing output to a terminal is fraught with quirks for programmers to navigate, as exemplified by the deceptively nontrivial task of expanding an &lt;a href="https://en.wikipedia.org/wiki/Escape_sequence">escape sequence&lt;/a> to print newlines. The expansion of the placeholder &lt;code>\n&lt;/code> can be accomplished in a multitude of ways, each with its own unique history and complications.&lt;/p>
&lt;h2 id="using-echo" class="anchor-link">&lt;a href="#using-echo">Using &lt;code>echo&lt;/code>&lt;/a>&lt;/h2>
&lt;p>From its appearance in &lt;a href="https://en.wikipedia.org/wiki/Multics">Multics&lt;/a> to its modern-day Unix-like system ubiquity, &lt;code>echo&lt;/code> remains a familiar tool for getting your terminal to say &amp;ldquo;Hello world!&amp;rdquo; Unfortunately, inconsistent implementations across operating systems make its usage tricky. Where &lt;code>echo&lt;/code> on some systems will automatically expand escape sequences, others require the &lt;code>-e&lt;/code> option to do the same:&lt;/p>
&lt;div class="highlight">&lt;pre class="chroma">&lt;code class="language-sh" data-lang="sh">&lt;span class="nb">echo&lt;/span> &lt;span class="s2">&amp;#34;the study of European nerves is \neurology&amp;#34;&lt;/span>
&lt;span class="c1"># the study of European nerves is \neurology&lt;/span>
&lt;span class="nb">echo&lt;/span> -e &lt;span class="s2">&amp;#34;the study of European nerves is \neurology&amp;#34;&lt;/span>
&lt;span class="c1"># the study of European nerves is&lt;/span>
&lt;span class="c1"># eurology&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>Because of these inconsistencies in implementations, &lt;code>echo&lt;/code> is considered non-portable. Additionally, its usage in conjunction with user input is relatively easy to corrupt through &lt;a href="https://en.wikipedia.org/wiki/Code_injection#Shell_injection">shell injection attack&lt;/a> using command substitutions.&lt;/p>
&lt;p>In modern systems, it is retained only to provide compatibility with the many programs that still use it. The &lt;a href="https://pubs.opengroup.org/onlinepubs/9699919799/utilities/echo.html#tag_20_37_16">POSIX specification recommends&lt;/a> the use of &lt;code>printf&lt;/code> in new programs.&lt;/p>
&lt;h2 id="using-printf" class="anchor-link">&lt;a href="#using-printf">Using &lt;code>printf&lt;/code>&lt;/a>&lt;/h2>
&lt;p>Since 4th &lt;a href="https://en.wikipedia.org/wiki/Research_Unix#Versions">Edition&lt;/a> Unix, the portable &lt;a href="https://en.wikipedia.org/wiki/Printf_(Unix)">&lt;code>printf&lt;/code> command&lt;/a> has essentially been the new and better &lt;code>echo&lt;/code>. It allows you to use &lt;a href="https://en.wikipedia.org/wiki/Printf_format_string#Format_placeholder_specification">format specifiers&lt;/a> to humanize input. To interpret backslash escape sequences, use &lt;code>%b&lt;/code>. The character sequence &lt;code>\n&lt;/code> ensures the output ends with a newline:&lt;/p>
&lt;div class="highlight">&lt;pre class="chroma">&lt;code class="language-sh" data-lang="sh">&lt;span class="nb">printf&lt;/span> &lt;span class="s2">&amp;#34;%b\n&amp;#34;&lt;/span> &lt;span class="s2">&amp;#34;Many females in Oble are \noblewomen&amp;#34;&lt;/span>
&lt;span class="c1"># Many females in Oble are&lt;/span>
&lt;span class="c1"># oblewomen&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>Though &lt;code>printf&lt;/code> has further options that make it a far more powerful replacement of &lt;code>echo&lt;/code>, this utility is not foolproof and can be vulnerable to an &lt;a href="https://en.wikipedia.org/wiki/Uncontrolled_format_string">uncontrolled format string&lt;/a> attack. It&amp;rsquo;s important for programmers to ensure they &lt;a href="https://victoria.dev/blog/sql-injection-and-xss-what-white-hat-hackers-know-about-trusting-user-input/">carefully handle user input&lt;/a>.&lt;/p>
&lt;h2 id="putting-newlines-in-variables" class="anchor-link">&lt;a href="#putting-newlines-in-variables">Putting newlines in variables&lt;/a>&lt;/h2>
&lt;p>In an effort to improve portability amongst compilers, the &lt;a href="https://en.wikipedia.org/wiki/ANSI_C">ANSI C Standard&lt;/a> was established in 1983. With &lt;a href="https://www.gnu.org/software/bash/manual/html_node/ANSI_002dC-Quoting.html#ANSI_002dC-Quoting">ANSI-C quoting&lt;/a> using &lt;code>$'...'&lt;/code>, &lt;a href="https://en.wikipedia.org/wiki/Escape_sequences_in_C#Table_of_escape_sequences">escape sequences&lt;/a> are replaced in output according to the standard.&lt;/p>
&lt;p>This allows us to store strings with newlines in variables that are printed with the newlines interpreted. You can do this by setting the variable, then calling it with &lt;code>printf&lt;/code> using &lt;code>$&lt;/code>:&lt;/p>
&lt;div class="highlight">&lt;pre class="chroma">&lt;code class="language-sh" data-lang="sh">&lt;span class="nv">puns&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s1">$&amp;#39;\number\narrow\nether\nice&amp;#39;&lt;/span>
&lt;span class="nb">printf&lt;/span> &lt;span class="s2">&amp;#34;%b\n&amp;#34;&lt;/span> &lt;span class="s2">&amp;#34;These words started with n but don&amp;#39;t make &lt;/span>&lt;span class="nv">$puns&lt;/span>&lt;span class="s2">&amp;#34;&lt;/span>
&lt;span class="c1"># These words started with n but don&amp;#39;t make&lt;/span>
&lt;span class="c1"># umber&lt;/span>
&lt;span class="c1"># arrow&lt;/span>
&lt;span class="c1"># ether&lt;/span>
&lt;span class="c1"># ice&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>The expanded variable is single-quoted, which is passed literally to &lt;code>printf&lt;/code>. As always, it is important to properly handle the input.&lt;/p>
&lt;h2 id="bonus-round-shell-parameter-expansion" class="anchor-link">&lt;a href="#bonus-round-shell-parameter-expansion">Bonus round: shell parameter expansion&lt;/a>&lt;/h2>
&lt;p>In my article explaining &lt;a href="https://victoria.dev/blog/bash-and-shell-expansions-lazy-list-making/">Bash and braces&lt;/a>, I covered the magic of &lt;a href="https://www.gnu.org/software/bash/manual/html_node/Shell-Parameter-Expansion.html">shell parameter expansion&lt;/a>. We can use one expansion, &lt;code>${parameter@operator}&lt;/code>, to interpret escape sequences, too. We use &lt;code>printf&lt;/code>&amp;rsquo;s &lt;code>%s&lt;/code> specifier to print as a string, and the &lt;code>E&lt;/code> operator will properly expand the escape sequences in our variable:&lt;/p>
&lt;div class="highlight">&lt;pre class="chroma">&lt;code class="language-sh" data-lang="sh">&lt;span class="nb">printf&lt;/span> &lt;span class="s2">&amp;#34;%s\n&amp;#34;&lt;/span> &lt;span class="si">${&lt;/span>&lt;span class="nv">puns&lt;/span>&lt;span class="p">@E&lt;/span>&lt;span class="si">}&lt;/span>
&lt;span class="c1"># umber&lt;/span>
&lt;span class="c1"># arrow&lt;/span>
&lt;span class="c1"># ether&lt;/span>
&lt;span class="c1"># ice&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>
&lt;h2 id="the-ongoing-challenge-of-humanizing-output" class="anchor-link">&lt;a href="#the-ongoing-challenge-of-humanizing-output">The ongoing challenge of humanizing output&lt;/a>&lt;/h2>
&lt;p>&lt;a href="https://en.wikipedia.org/wiki/String_interpolation">String interpolation&lt;/a> continues to be a chewy problem for programmers. Besides getting languages and shells to agree on what certain placeholders mean, properly using the correct escape sequences requires an eye for detail.&lt;/p>
&lt;p>Poor string interpolation can lead to silly-looking output, as well as introduce security vulnerabilities, such as from &lt;a href="https://en.wikipedia.org/wiki/Code_injection">injection attacks&lt;/a>. Until the next evolution of the terminal has us talking in emojis, we&amp;rsquo;d best pay attention when printing output for humans.&lt;/p></content:encoded><enclosure url="https://victoria.dev/blog/the-surprisingly-difficult-task-of-printing-newlines-in-a-terminal/cover_huad486c0cadb16dfd85c71edfd1b24caf_253243_640x0_resize_box_2.png" type="image/jpg"/></item><item><title>The care and feeding of an IoT device</title><link>https://victoria.dev/blog/the-care-and-feeding-of-an-iot-device/</link><pubDate>Wed, 27 Nov 2019 08:59:35 -0500</pubDate><author>hello@victoria.dev (Victoria Drake)</author><guid>https://victoria.dev/blog/the-care-and-feeding-of-an-iot-device/</guid><description>Why IoT devices are, basically, puppies, and whether or not you should give somebody one for Christmas.</description><content:encoded>
&lt;img src="https://victoria.dev/blog/the-care-and-feeding-of-an-iot-device/cover_hud30f2a27d6d9efe5f1116f60f0ded394_298910_640x0_resize_box_2.png" width="640" height="389"/>
&lt;p>Giving someone a puppy for Christmas might work really well in a movie, but in real life often comes hitched to a multitude of responsibilities that the giftee may not be fully prepared to take on. The same is true for Internet of Things (IoT) devices, including Amazon&amp;rsquo;s Alexa-enabled devices, Google Home, and other Internet-connected appliances like cameras, lightbulbs, and toasters. Yes, they have those now.&lt;/p>
&lt;p>Like puppies, IoT devices are still young. Many contain &lt;a href="https://threatpost.com/iot-devices-vulnerable-takeover/144167/">known vulnerabilities&lt;/a> that remote attackers can use to gain access to device owners' networks. These attacks are sometimes as laughably simple as using a default username and password that the &lt;a href="https://gdpr.report/news/2019/06/12/research-reveals-the-most-vulnerable-iot-devices/">device owner cannot change&lt;/a>.&lt;/p>
&lt;p>Does all this mean you shouldn&amp;rsquo;t give Grandma Mabel a new app-enabled coffee maker or Ring doorbell for Christmas? Probably, although not necessarily. Like puppies, properly-maintained IoT devices are capable of warming your heart without causing &lt;em>too&lt;/em> much havoc; but they take a lot of work to care for. Here are a few responsibilities to keep in mind for the care and feeding of an IoT device.&lt;/p>
&lt;h2 id="immature-security" class="anchor-link">&lt;a href="#immature-security">Immature security&lt;/a>&lt;/h2>
&lt;p>Many manufacturers of IoT devices &lt;a href="https://www.infosecurity-magazine.com/news/vulnerabilities-in-iot-devices/">have not made security a priority&lt;/a>. There aren&amp;rsquo;t yet any enforced &lt;a href="https://blog.rapid7.com/2019/03/27/the-iot-cybersecurity-improvement-act-of-2019/">security requirements&lt;/a> for this industry, which leaves the protection of your device and the network it&amp;rsquo;s connected to in the hands of the manufacturer.&lt;/p>
&lt;p>It&amp;rsquo;s not just obscure no-name toasters, either; malicious third-party apps have snuck onto Amazon&amp;rsquo;s and Google&amp;rsquo;s more reputable devices and enabled attackers to &lt;a href="https://www.cnet.com/news/alexa-and-google-voice-assistants-app-exploits-left-it-vulnerable-to-eavesdropping/">eavesdrop&lt;/a> on unsuspecting owners.&lt;/p>
&lt;p>Until security regulations are put in place and enforced, it&amp;rsquo;s buyer beware for both devices and third-party applications. To the extent possible, potential owners must do ample research to weed out vulnerable devices and untrustworthy apps.&lt;/p>
&lt;h2 id="protecting-your-network" class="anchor-link">&lt;a href="#protecting-your-network">Protecting your network&lt;/a>&lt;/h2>
&lt;p>If you think hackers aren&amp;rsquo;t likely to find your device in the vast expanse of the Internet, you might be wrong. These days, obscurity doesn&amp;rsquo;t provide security. It&amp;rsquo;s no longer left up to a potential attacker&amp;rsquo;s fallible human eyes to find your insecure front door camera in a cacophony of wireless traffic; &lt;a href="https://money.cnn.com/2013/04/08/technology/security/shodan/index.html">IoT search engines&lt;/a> like &lt;a href="https://www.shodan.io/">Shodan&lt;/a> will do that for them. Thankfully, these search engines are also used for good, enabling white hat hackers and penetration testers to find and fix insecure devices.&lt;/p>
&lt;p>Just like locking your own front door, IoT owners are responsible for locking down access to their devices. This may mean searching through device settings to make sure default credentials are changed, or checking to make sure that a device used on your private home network doesn&amp;rsquo;t by default have public Internet access.&lt;/p>
&lt;p>Where the options are available, HTTPS and &lt;a href="https://victoria.dev/blog/personal-cybersecurity-posture-for-when-youre-just-this-guy-you-know/#1-use-multifactor-authentication">multifactor authentication&lt;/a> should be enabled. The use of a &lt;a href="https://victoria.dev/blog/personal-cybersecurity-posture-for-when-youre-just-this-guy-you-know/#2-use-a-vpn">VPN&lt;/a> can also keep your devices from being found.&lt;/p>
&lt;h2 id="keeping-them-patched" class="anchor-link">&lt;a href="#keeping-them-patched">Keeping them patched&lt;/a>&lt;/h2>
&lt;p>Unlike puppies, many IoT devices are &amp;ldquo;headless&amp;rdquo; and have no inherent way of interfacing with a human. An app-controlled lightbulb, for example, may be all but useless without the software that makes it shine. As convenient as it may be to have your 1500K mood lighting come on automatically at dusk, it also means automatically ceding control of the device to its software developers.&lt;/p>
&lt;p>When vulnerabilities in your phone&amp;rsquo;s operating system are discovered and patched, it&amp;rsquo;s likely that automatic updates are pushed and installed overnight, possibly without you even knowing. Your IoT device, on the other hand, may have no such support. In those cases, it&amp;rsquo;s completely up to the user to discover that an update is needed, find and download the patch, then correctly update their device. Even for owners with some technical expertise, this process takes significant effort. Many &lt;a href="https://www.machinedesign.com/industrial-automation/software-updates-are-new-hurdle-iot-security">device owners aren&amp;rsquo;t even aware&lt;/a> that their software is dangerously outdated.&lt;/p>
&lt;p>In practical terms, this means that users without the time, knowledge, or willingness to keep their devices updated should reconsider owning them. Alternatively, some research can help prospective owners choose devices that receive automatic push updates from their (hopefully responsible) manufacturers over WiFi.&lt;/p>
&lt;h2 id="being-responsible" class="anchor-link">&lt;a href="#being-responsible">Being responsible&lt;/a>&lt;/h2>
&lt;p>Raising a healthy and happy IoT device is no small task, especially for potential owners with little time or willingness to put in the required effort. With the proper attention and maintenance, your Internet-connected appliance can bring joy and convenience to your life; but without, it introduces a potential security risk and a whole lot of trouble.&lt;/p>
&lt;p>Before getting or giving IoT, be sure the potential owner is up to the task of caring for it.&lt;/p>
&lt;p>You can learn more about basic cybersecurity for IoT (as a user or maker) by reading &lt;a href="https://csrc.nist.gov/publications/detail/nistir/8259/draft">NIST&amp;rsquo;s draft guidelines publication&lt;/a>.&lt;/p></content:encoded><enclosure url="https://victoria.dev/blog/the-care-and-feeding-of-an-iot-device/cover_hud30f2a27d6d9efe5f1116f60f0ded394_298910_640x0_resize_box_2.png" type="image/jpg"/></item><item><title>Bash and shell expansions: lazy list-making</title><link>https://victoria.dev/blog/bash-and-shell-expansions-lazy-list-making/</link><pubDate>Mon, 18 Nov 2019 07:07:24 -0500</pubDate><author>hello@victoria.dev (Victoria Drake)</author><guid>https://victoria.dev/blog/bash-and-shell-expansions-lazy-list-making/</guid><description>A tour of brace expansion, shell parameter expansions, and playing with substrings in Bash.</description><content:encoded>
&lt;img src="https://victoria.dev/blog/bash-and-shell-expansions-lazy-list-making/cover_huc56d82ef2c6ac9d9e523f876cca18a54_233813_640x0_resize_box_2.png" width="640" height="309"/>
&lt;p>It&amp;rsquo;s that time of year again! When stores start putting up colourful sparkly lit-up plastic bits, we all begin to feel a little festive, and by festive I mean let&amp;rsquo;s go shopping. Specifically, holiday gift shopping! (Gifts for yourself are still gifts, technically.)&lt;/p>
&lt;p>Just so this doesn&amp;rsquo;t all go completely madcap, you ought to make some gift lists. Bash can help.&lt;/p>
&lt;h2 id="brace-expansion" class="anchor-link">&lt;a href="#brace-expansion">Brace expansion&lt;/a>&lt;/h2>
&lt;p>These are not braces: &lt;code>()&lt;/code>&lt;/p>
&lt;p>Neither are these: &lt;code>[]&lt;/code>&lt;/p>
&lt;p>&lt;em>These&lt;/em> are braces: &lt;code>{}&lt;/code>&lt;/p>
&lt;p>Braces tell Bash to do something with the arbitrary string or strings it finds between them. Multiple strings are comma-separated: &lt;code>{a,b,c}&lt;/code>. You can also add an optional preamble and postscript to be attached to each expanded result. Mostly, this can save some typing, such as with common file paths and extensions.&lt;/p>
&lt;p>Let&amp;rsquo;s make some lists for each person we want to give stuff to. The following commands are equivalent:&lt;/p>
&lt;div class="highlight">&lt;pre class="chroma">&lt;code class="language-sh" data-lang="sh">touch /home/me/gift-lists/Amy.txt /home/me/gift-lists/Bryan.txt /home/me/gift-lists/Charlie.txt
&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre class="chroma">&lt;code class="language-sh" data-lang="sh">touch /home/me/gift-lists/&lt;span class="o">{&lt;/span>Amy,Bryan,Charlie&lt;span class="o">}&lt;/span>.txt
&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre class="chroma">&lt;code class="language-sh" data-lang="sh">tree gift-lists
/home/me/gift-lists
 Amy.txt
 Bryan.txt
 Charlie.txt
&lt;/code>&lt;/pre>&lt;/div>&lt;p>Oh darn, &amp;ldquo;Bryan&amp;rdquo; spells his name with an &amp;ldquo;i.&amp;rdquo; I can fix that.&lt;/p>
&lt;div class="highlight">&lt;pre class="chroma">&lt;code class="language-sh" data-lang="sh">mv /home/me/gift-lists/&lt;span class="o">{&lt;/span>Bryan,Brian&lt;span class="o">}&lt;/span>.txt
renamed &lt;span class="s1">&amp;#39;/home/me/gift-lists/Bryan.txt&amp;#39;&lt;/span> -&amp;gt; &lt;span class="s1">&amp;#39;/home/me/gift-lists/Brian.txt&amp;#39;&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>
&lt;h2 id="shell-parameter-expansions" class="anchor-link">&lt;a href="#shell-parameter-expansions">Shell parameter expansions&lt;/a>&lt;/h2>
&lt;p>&lt;a href="https://www.gnu.org/software/bash/manual/html_node/Shell-Parameter-Expansion.html">Shell parameter expansion&lt;/a> allows us to make all sorts of changes to parameters enclosed in braces, like manipulate and substitute text.&lt;/p>
&lt;p>There are a few stocking stuffers that all our giftees deserve. Let&amp;rsquo;s make that a variable:&lt;/p>
&lt;div class="highlight">&lt;pre class="chroma">&lt;code class="language-sh" data-lang="sh">&lt;span class="nv">STUFF&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s1">$&amp;#39;socks\nlump of coal\nwhite chocolate&amp;#39;&lt;/span>
&lt;span class="nb">echo&lt;/span> &lt;span class="s2">&amp;#34;&lt;/span>&lt;span class="nv">$STUFF&lt;/span>&lt;span class="s2">&amp;#34;&lt;/span>
socks
lump of coal
white chocolate
&lt;/code>&lt;/pre>&lt;/div>&lt;p>Now to add these items to each of our lists with some help from &lt;a href="https://en.wikipedia.org/wiki/Tee_(command)">the &lt;code>tee&lt;/code> command&lt;/a> to get &lt;code>echo&lt;/code> and expansions to play nice.&lt;/p>
&lt;div class="highlight">&lt;pre class="chroma">&lt;code class="language-sh" data-lang="sh">&lt;span class="nb">echo&lt;/span> &lt;span class="s2">&amp;#34;&lt;/span>&lt;span class="nv">$STUFF&lt;/span>&lt;span class="s2">&amp;#34;&lt;/span> &lt;span class="p">|&lt;/span> tee &lt;span class="o">{&lt;/span>Amy,Brian,Charlie&lt;span class="o">}&lt;/span>.txt
cat &lt;span class="o">{&lt;/span>Amy,Brian,Charlie&lt;span class="o">}&lt;/span>.txt
socks
lump of coal
white chocolate
socks
lump of coal
white chocolate
socks
lump of coal
white chocolate
&lt;/code>&lt;/pre>&lt;/div>
&lt;h3 id="pattern-match-substitution" class="anchor-link">&lt;a href="#pattern-match-substitution">Pattern match substitution&lt;/a>&lt;/h3>
&lt;p>On second thought, maybe the lump of coal isn&amp;rsquo;t such a nice gift. You can replace it with something better using a pattern match substitution in the form of &lt;code>${parameter/pattern/string}&lt;/code>:&lt;/p>
&lt;div class="highlight">&lt;pre class="chroma">&lt;code class="language-sh" data-lang="sh">&lt;span class="nb">echo&lt;/span> &lt;span class="s2">&amp;#34;&lt;/span>&lt;span class="si">${&lt;/span>&lt;span class="nv">STUFF&lt;/span>&lt;span class="p">/lump of coal/candy cane&lt;/span>&lt;span class="si">}&lt;/span>&lt;span class="s2">&amp;#34;&lt;/span> &lt;span class="p">|&lt;/span> tee &lt;span class="o">{&lt;/span>Amy,Brian,Charlie&lt;span class="o">}&lt;/span>.txt
cat &lt;span class="o">{&lt;/span>Amy,Brian,Charlie&lt;span class="o">}&lt;/span>.txt
socks
candy cane
white chocolate
socks
candy cane
white chocolate
socks
candy cane
white chocolate
&lt;/code>&lt;/pre>&lt;/div>&lt;p>This replaces the first instance of &amp;ldquo;lump of coal&amp;rdquo; with &amp;ldquo;candy cane.&amp;rdquo; To replace all instances (if there were multiple), use &lt;code>${parameter//pattern/string}&lt;/code>. This doesn&amp;rsquo;t change our &lt;code>$STUFF&lt;/code> variable, so we can still reuse the original list for someone naughty later.&lt;/p>
&lt;h3 id="substrings" class="anchor-link">&lt;a href="#substrings">Substrings&lt;/a>&lt;/h3>
&lt;p>While we&amp;rsquo;re improving things, our giftees may not all like white chocolate. We&amp;rsquo;d better add some regular chocolate to our lists just in case. Since I&amp;rsquo;m super lazy, I&amp;rsquo;m just going to hit the up arrow and modify a previous Bash command. Luckily, the last word in the &lt;code>$STUFF&lt;/code> variable is &amp;ldquo;chocolate,&amp;rdquo; which is nine characters long, so I&amp;rsquo;ll tell Bash to keep just that part using &lt;code>${parameter:offset}&lt;/code>. I&amp;rsquo;ll use &lt;code>tee&lt;/code>&amp;rsquo;s &lt;code>-a&lt;/code> flag to &lt;code>a&lt;/code>ppend to my existing lists:&lt;/p>
&lt;div class="highlight">&lt;pre class="chroma">&lt;code class="language-sh" data-lang="sh">&lt;span class="nb">echo&lt;/span> &lt;span class="s2">&amp;#34;&lt;/span>&lt;span class="si">${&lt;/span>&lt;span class="nv">STUFF&lt;/span>&lt;span class="p">: -9&lt;/span>&lt;span class="si">}&lt;/span>&lt;span class="s2">&amp;#34;&lt;/span> &lt;span class="p">|&lt;/span> tee -a &lt;span class="o">{&lt;/span>Amy,Brian,Charlie&lt;span class="o">}&lt;/span>.txt
cat &lt;span class="o">{&lt;/span>Amy,Brian,Charlie&lt;span class="o">}&lt;/span>.txt
socks
candy cane
white chocolate
chocolate
socks
candy cane
white chocolate
chocolate
socks
candy cane
white chocolate
chocolate
&lt;/code>&lt;/pre>&lt;/div>&lt;p>You can also:&lt;/p>
&lt;table>
&lt;thead>
&lt;tr>
&lt;th>Do this&lt;/th>
&lt;th>With this&lt;/th>
&lt;/tr>
&lt;/thead>
&lt;tbody>
&lt;tr>
&lt;td>Get substring from &lt;em>n&lt;/em> characters onwards&lt;/td>
&lt;td>&lt;code>${parameter:n}&lt;/code>&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>Get substring for &lt;em>x&lt;/em> characters starting at &lt;em>n&lt;/em>&lt;/td>
&lt;td>&lt;code>${parameter:n:x}&lt;/code>&lt;/td>
&lt;/tr>
&lt;/tbody>
&lt;/table>
&lt;p>There! Now our base lists are finished. Let&amp;rsquo;s have some eggnog.&lt;/p>
&lt;h3 id="testing-variables" class="anchor-link">&lt;a href="#testing-variables">Testing variables&lt;/a>&lt;/h3>
&lt;p>You know, it may be the eggnog, but I think I started a list for Amy yesterday and stored it in a variable that I might have called &lt;code>amy&lt;/code>. Let&amp;rsquo;s see if I did. I&amp;rsquo;ll use the &lt;code>${parameter:?word}&lt;/code> expansion. It&amp;rsquo;ll write &lt;code>word&lt;/code> to standard error and exit if there&amp;rsquo;s no &lt;code>amy&lt;/code> parameter.&lt;/p>
&lt;div class="highlight">&lt;pre class="chroma">&lt;code class="language-sh" data-lang="sh">&lt;span class="nb">echo&lt;/span> &lt;span class="s2">&amp;#34;&lt;/span>&lt;span class="si">${&lt;/span>&lt;span class="nv">amy&lt;/span>&lt;span class="p">:?no such&lt;/span>&lt;span class="si">}&lt;/span>&lt;span class="s2">&amp;#34;&lt;/span>
bash: amy: no such
&lt;/code>&lt;/pre>&lt;/div>&lt;p>I guess not. Maybe it was Brian instead?&lt;/p>
&lt;div class="highlight">&lt;pre class="chroma">&lt;code class="language-sh" data-lang="sh">&lt;span class="nb">echo&lt;/span> &lt;span class="s2">&amp;#34;&lt;/span>&lt;span class="si">${&lt;/span>&lt;span class="nv">brian&lt;/span>&lt;span class="p">:?no such&lt;/span>&lt;span class="si">}&lt;/span>&lt;span class="s2">&amp;#34;&lt;/span>
Lederhosen
&lt;/code>&lt;/pre>&lt;/div>&lt;p>You can also:&lt;/p>
&lt;table>
&lt;thead>
&lt;tr>
&lt;th>Do this&lt;/th>
&lt;th>With this&lt;/th>
&lt;/tr>
&lt;/thead>
&lt;tbody>
&lt;tr>
&lt;td>Substitute &lt;code>word&lt;/code> if &lt;code>parameter&lt;/code> is unset or null&lt;/td>
&lt;td>&lt;code>${parameter:-word}&lt;/code>&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>Substitute &lt;code>word&lt;/code> if &lt;code>parameter&lt;/code> is not unset or null&lt;/td>
&lt;td>&lt;code>${parameter:+word}&lt;/code>&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>Assign &lt;code>word&lt;/code> to &lt;code>parameter&lt;/code> if &lt;code>parameter&lt;/code> is unset or null&lt;/td>
&lt;td>&lt;code>${parameter:=word}&lt;/code>&lt;/td>
&lt;/tr>
&lt;/tbody>
&lt;/table>
&lt;h3 id="changing-case" class="anchor-link">&lt;a href="#changing-case">Changing case&lt;/a>&lt;/h3>
&lt;p>That&amp;rsquo;s right! Brian said he wanted some lederhosen and so I made myself a note. This is pretty important, so I&amp;rsquo;ll add it to Brian&amp;rsquo;s list in capital letters with the &lt;code>${parameter^^pattern}&lt;/code> expansion. The &lt;code>pattern&lt;/code> part is optional. We&amp;rsquo;re only writing to Brian&amp;rsquo;s list, so I&amp;rsquo;ll just use &lt;code>&amp;gt;&amp;gt;&lt;/code> instead of &lt;code>tee -a&lt;/code>.&lt;/p>
&lt;div class="highlight">&lt;pre class="chroma">&lt;code class="language-sh" data-lang="sh">&lt;span class="nb">echo&lt;/span> &lt;span class="s2">&amp;#34;&lt;/span>&lt;span class="si">${&lt;/span>&lt;span class="nv">brian&lt;/span>&lt;span class="p">^^&lt;/span>&lt;span class="si">}&lt;/span>&lt;span class="s2">&amp;#34;&lt;/span> &amp;gt;&amp;gt; Brian.txt
cat Brian.txt
socks
candy cane
white chocolate
chocolate
LEDERHOSEN
&lt;/code>&lt;/pre>&lt;/div>&lt;p>You can also:&lt;/p>
&lt;table>
&lt;thead>
&lt;tr>
&lt;th>Do this&lt;/th>
&lt;th>With this&lt;/th>
&lt;/tr>
&lt;/thead>
&lt;tbody>
&lt;tr>
&lt;td>Capitalize the first letter&lt;/td>
&lt;td>&lt;code>${parameter^pattern}&lt;/code>&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>Lowercase the first letter&lt;/td>
&lt;td>&lt;code>${parameter,pattern}&lt;/code>&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>Lowercase all letters&lt;/td>
&lt;td>&lt;code>${parameter,,pattern}&lt;/code>&lt;/td>
&lt;/tr>
&lt;/tbody>
&lt;/table>
&lt;h3 id="expanding-arrays" class="anchor-link">&lt;a href="#expanding-arrays">Expanding arrays&lt;/a>&lt;/h3>
&lt;p>You know what, all this gift-listing business is a lot of work. I&amp;rsquo;m just going to make &lt;a href="https://www.gnu.org/savannah-checkouts/gnu/bash/manual/bash.html#Arrays">an array&lt;/a> of things I saw at the store:&lt;/p>
&lt;div class="highlight">&lt;pre class="chroma">&lt;code class="language-sh" data-lang="sh">&lt;span class="nv">gifts&lt;/span>&lt;span class="o">=(&lt;/span>sweater gameboy wagon pillows chestnuts hairbrush&lt;span class="o">)&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>I can use substring expansion in the form of &lt;code>${parameter:offset:length}&lt;/code> to make this simple. I&amp;rsquo;ll add the first two to Amy&amp;rsquo;s list, the middle two to Brian&amp;rsquo;s, and the last two to Charlie&amp;rsquo;s. I&amp;rsquo;ll use &lt;code>printf&lt;/code> to help with newlines.&lt;/p>
&lt;div class="highlight">&lt;pre class="chroma">&lt;code class="language-sh" data-lang="sh">&lt;span class="nb">printf&lt;/span> &lt;span class="s1">&amp;#39;%s\n&amp;#39;&lt;/span> &lt;span class="s2">&amp;#34;&lt;/span>&lt;span class="si">${&lt;/span>&lt;span class="nv">gifts&lt;/span>&lt;span class="p">[@]:&lt;/span>&lt;span class="nv">0&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="nv">2&lt;/span>&lt;span class="si">}&lt;/span>&lt;span class="s2">&amp;#34;&lt;/span> &amp;gt;&amp;gt; Amy.txt
&lt;span class="nb">printf&lt;/span> &lt;span class="s1">&amp;#39;%s\n&amp;#39;&lt;/span> &lt;span class="s2">&amp;#34;&lt;/span>&lt;span class="si">${&lt;/span>&lt;span class="nv">gifts&lt;/span>&lt;span class="p">[@]:&lt;/span>&lt;span class="nv">2&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="nv">2&lt;/span>&lt;span class="si">}&lt;/span>&lt;span class="s2">&amp;#34;&lt;/span> &amp;gt;&amp;gt; Brian.txt
&lt;span class="nb">printf&lt;/span> &lt;span class="s1">&amp;#39;%s\n&amp;#39;&lt;/span> &lt;span class="s2">&amp;#34;&lt;/span>&lt;span class="si">${&lt;/span>&lt;span class="nv">gifts&lt;/span>&lt;span class="p">[@]: -2&lt;/span>&lt;span class="si">}&lt;/span>&lt;span class="s2">&amp;#34;&lt;/span> &amp;gt;&amp;gt; Charlie.txt
&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre class="chroma">&lt;code class="language-sh" data-lang="sh">cat Amy.txt
socks
candy cane
white chocolate
chocolate
sweater
gameboy
cat Brian.txt
socks
candy cane
white chocolate
chocolate
LEDERHOSEN
wagon
pillows
cat Charlie.txt
socks
candy cane
white chocolate
chocolate
chestnuts
hairbrush
&lt;/code>&lt;/pre>&lt;/div>&lt;p>There! Now we&amp;rsquo;ve got a comprehensive set of super personalized gift lists. Thanks Bash! Too bad it can&amp;rsquo;t do the shopping for us, too.&lt;/p></content:encoded><enclosure url="https://victoria.dev/blog/bash-and-shell-expansions-lazy-list-making/cover_huc56d82ef2c6ac9d9e523f876cca18a54_233813_640x0_resize_box_2.png" type="image/jpg"/></item><item><title>A cron job that could save you from a ransomware attack</title><link>https://victoria.dev/blog/a-cron-job-that-could-save-you-from-a-ransomware-attack/</link><pubDate>Wed, 13 Nov 2019 08:27:31 -0400</pubDate><author>hello@victoria.dev (Victoria Drake)</author><guid>https://victoria.dev/blog/a-cron-job-that-could-save-you-from-a-ransomware-attack/</guid><description>How a simple scheduled job can help you quickly recover from ransomware.</description><content:encoded>
&lt;img src="https://victoria.dev/blog/a-cron-job-that-could-save-you-from-a-ransomware-attack/cover_hue3aef3cab743e28f902a30a77ac75013_151327_640x0_resize_q75_box.jpg" width="640" height="178"/>
&lt;p>It&amp;rsquo;s 2019, and ransomware has become a thing.&lt;/p>
&lt;p>Systems that interact with the public, like companies, educational institutions, and public services, are most susceptible. While delivery methods for ransomware vary from the physical realm to communication via social sites and email, all methods only require one person to make one mistake in order for ransomware to proliferate.&lt;/p>
&lt;p>Ransomware, as you may have heard, is a malicious program that encrypts your files, rendering them unreadable and useless to you. It can include instructions for paying a ransom, usually by sending cryptocurrency, in order to obtain the decryption key. Successful ransomware attacks typically exploit vital, time-sensitive systems. Victims like public services and medical facilities are more likely to have poor or zero recovery processes, leaving governments or insurance providers to reward attackers with ransom payments.&lt;/p>
&lt;p>Individuals, especially less-than-tech-savvy ones, are no less at risk. Ransomware can occlude personal documents and family photos that may only exist on one machine.&lt;/p>
&lt;p>Thankfully, a fairly low-tech solution exists for rendering ransomware inept: back up your data!&lt;/p>
&lt;p>You could achieve this with a straightforward system like plugging in an external hard drive and dragging files over once a day, but this method has a few hurdles. Manually transferring files may be slow or incomplete, and besides, you&amp;rsquo;ll first have to remember to do it.&lt;/p>
&lt;p>In my constant pursuit of automating all the things, there&amp;rsquo;s one tool I often return to for its simplicity and reliability: &lt;code>cron&lt;/code>. Cron does one thing, and does it well: it runs commands on a schedule.&lt;/p>
&lt;p>I first used it a few months shy of three years ago (Have I really been blogging that long?!) to create &lt;a href="https://victoria.dev/blog/how-i-created-custom-desktop-notifications-using-terminal-and-cron/">custom desktop notifications on Linux&lt;/a>. Using the crontab configuration file, which you can edit by running &lt;code>crontab -e&lt;/code>, you can specify a schedule for running any commands you like. Here&amp;rsquo;s what the scheduling syntax looks like, from the &lt;a href="https://en.wikipedia.org/wiki/Cron">Wikipedia cron page&lt;/a>:&lt;/p>
&lt;div class="highlight">&lt;pre class="chroma">&lt;code class="language-sh" data-lang="sh">&lt;span class="c1">#  minute (0 - 59)&lt;/span>
&lt;span class="c1">#   hour (0 - 23)&lt;/span>
&lt;span class="c1">#    day of the month (1 - 31)&lt;/span>
&lt;span class="c1">#     month (1 - 12)&lt;/span>
&lt;span class="c1">#      day of the week (0 - 6)&lt;/span>
&lt;span class="c1">#     &lt;/span>
&lt;span class="c1">#     &lt;/span>
&lt;span class="c1">#     &lt;/span>
&lt;span class="c1"># * * * * * command to execute&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>For example, a cron job that runs every day at 00:00 would look like:&lt;/p>
&lt;div class="highlight">&lt;pre class="chroma">&lt;code class="language-sh" data-lang="sh">&lt;span class="m">0&lt;/span> &lt;span class="m">0&lt;/span> * * *
&lt;/code>&lt;/pre>&lt;/div>&lt;p>To run a job every twelve hours, the syntax is:&lt;/p>
&lt;div class="highlight">&lt;pre class="chroma">&lt;code class="language-sh" data-lang="sh">&lt;span class="m">0&lt;/span> */12 * * *
&lt;/code>&lt;/pre>&lt;/div>&lt;p>This &lt;a href="https://crontab.guru/">great tool&lt;/a> can help you wrap your head around the cron scheduling syntax.&lt;/p>
&lt;p>What&amp;rsquo;s a scheduler have to do with backing up? By itself, not much. The simple beauty of cron is that it runs commands - any shell commands, and any scripts that you&amp;rsquo;d normally run on the command line. As you may have gleaned from my other posts, I&amp;rsquo;m of the strong opinion that you can do just about anything on the command line, including backing up your files. Options for storage in this area are plentiful, from near-to-free local and cloud options, as well as paid managed services too numerous to list. For CLI tooling, we have utilitarian classics like &lt;code>rsync&lt;/code>, and CLI tools for specific cloud providers like AWS.&lt;/p>
&lt;h2 id="backing-up-with-rsync" class="anchor-link">&lt;a href="#backing-up-with-rsync">Backing up with &lt;code>rsync&lt;/code>&lt;/a>&lt;/h2>
&lt;p>&lt;a href="https://en.wikipedia.org/wiki/Rsync">The &lt;code>rsync&lt;/code> utility&lt;/a> is a classic choice, and can back up your files to an external hard drive or remote server while making intelligent determinations about which files to update. It uses file size and modification times to recognize file changes, and then only transfers changed files, saving time and bandwidth.&lt;/p>
&lt;p>The &lt;a href="https://download.samba.org/pub/rsync/rsync.html">&lt;code>rsync&lt;/code> syntax&lt;/a> can be a little nuanced; for example, a trailing forward slash will copy just the contents of the directory, instead of the directory itself. I found examples to be helpful in understanding the usage and syntax.&lt;/p>
&lt;p>Here&amp;rsquo;s one for backing up a local directory to a local destination, such as an external hard drive:&lt;/p>
&lt;div class="highlight">&lt;pre class="chroma">&lt;code class="language-sh" data-lang="sh">rsync -a /home/user/directory /media/user/destination
&lt;/code>&lt;/pre>&lt;/div>&lt;p>The first argument is the source, and the second is the destination. Reversing these in the above example would copy files from the mounted drive to the local home directory.&lt;/p>
&lt;p>The &lt;code>a&lt;/code> flag for archive mode is one of &lt;code>rsync&lt;/code>&amp;rsquo;s superpowers. Equivalent to flags &lt;code>-rlptgoD&lt;/code>, it:&lt;/p>
&lt;ul>
&lt;li>Syncs files recursively through directories (&lt;code>r&lt;/code>);&lt;/li>
&lt;li>Preserves symlinks (&lt;code>l&lt;/code>), permissions (&lt;code>p&lt;/code>), modification times (&lt;code>t&lt;/code>), groups (&lt;code>g&lt;/code>), and owner (&lt;code>o&lt;/code>); and&lt;/li>
&lt;li>Copies device and special files (&lt;code>D&lt;/code>).&lt;/li>
&lt;/ul>
&lt;p>Here&amp;rsquo;s another example, this time for backing up the contents of a local directory to a directory on a remote server using SSH:&lt;/p>
&lt;div class="highlight">&lt;pre class="chroma">&lt;code class="language-sh" data-lang="sh">rsync -avze ssh /home/user/directory/ user@remote.host.net:home/user/directory
&lt;/code>&lt;/pre>&lt;/div>&lt;p>The &lt;code>v&lt;/code> flag turns on verbose output, which is helpful if you like realtime feedback on which files are being transferred. During large transfers, however, it can tend to slow things down. The &lt;code>z&lt;/code> flag can help with that, as it indicates that files should be compressed during transfer.&lt;/p>
&lt;p>The &lt;code>e&lt;/code> flag, followed by &lt;code>ssh&lt;/code>, tells &lt;code>rsync&lt;/code> to use SSH according to the destination instructions provided in the final argument.&lt;/p>
&lt;h2 id="backing-up-with-aws-cli" class="anchor-link">&lt;a href="#backing-up-with-aws-cli">Backing up with AWS CLI&lt;/a>&lt;/h2>
&lt;p>Amazon Web Services offers a command line interface tool for doing just about everything with your AWS set up, including a straightforward &lt;a href="https://docs.aws.amazon.com/ja_jp/cli/latest/reference/s3/sync.html">&lt;code>s3 sync&lt;/code> command&lt;/a> for recursively copying new and updated files to your S3 storage buckets. As a storage method for back up data, S3 is a stable and inexpensive choice. You can even &lt;a href="https://docs.aws.amazon.com/AmazonS3/latest/dev/Versioning.html">turn on versioning in your bucket&lt;/a>.&lt;/p>
&lt;p>The &lt;a href="https://docs.aws.amazon.com/ja_jp/cli/latest/reference/s3/index.html#directory-and-s3-prefix-operations">syntax for interacting with directories&lt;/a> is fairly straightforward, and you can directly indicate your S3 bucket as an &lt;code>S3Uri&lt;/code> argument in the form of &lt;code>s3://mybucket/mykey&lt;/code>. To back up a local directory to your S3 bucket, the command is:&lt;/p>
&lt;div class="highlight">&lt;pre class="chroma">&lt;code class="language-sh" data-lang="sh">aws s3 sync /home/user/directory s3://mybucket
&lt;/code>&lt;/pre>&lt;/div>&lt;p>Similar to &lt;code>rsync&lt;/code>, reversing the source and destination would download files from the S3 bucket.&lt;/p>
&lt;p>The &lt;code>sync&lt;/code> command is intuitive by default. It will guess the mime type of uploaded files, as well as include files discovered by following symlinks. A variety of options exist to control these and other defaults, even including flags to specify the server-side encryption to be used.&lt;/p>
&lt;h2 id="setting-up-your-cronjob-back-up" class="anchor-link">&lt;a href="#setting-up-your-cronjob-back-up">Setting up your cronjob back up&lt;/a>&lt;/h2>
&lt;p>You can edit your machine&amp;rsquo;s cron file by running:&lt;/p>
&lt;div class="highlight">&lt;pre class="chroma">&lt;code class="language-sh" data-lang="sh">crontab -e
&lt;/code>&lt;/pre>&lt;/div>&lt;p>Intuitive as it may be, it&amp;rsquo;s worth mentioning that your back up commands will only run when your computer is turned on and the cron daemon is running. With this in mind, choose a schedule for your cronjob that aligns with times when your machine is powered on, and maybe not overloaded with other work.&lt;/p>
&lt;p>To back up to an S3 bucket every day at 8AM, for example, you&amp;rsquo;d put a line in your crontab that looks like:&lt;/p>
&lt;div class="highlight">&lt;pre class="chroma">&lt;code class="language-sh" data-lang="sh">&lt;span class="m">0&lt;/span> &lt;span class="m">8&lt;/span> * * * aws s3 sync /home/user/directory s3://mybucket
&lt;/code>&lt;/pre>&lt;/div>&lt;p>If you&amp;rsquo;re curious whether your cron job is currently running, find the PID of cron with:&lt;/p>
&lt;div class="highlight">&lt;pre class="chroma">&lt;code class="language-sh" data-lang="sh">pstree -ap &lt;span class="p">|&lt;/span> grep cron
&lt;/code>&lt;/pre>&lt;/div>&lt;p>Then run &lt;code>pstree -ap &amp;lt;PID&amp;gt;&lt;/code>.&lt;/p>
&lt;p>This rabbit hole goes deeper; a quick search can reveal different ways of organizing and scheduling cronjobs, or help you find different utilities to run cronjobs when your computer is asleep. To protect against the possibility of ransomware-affected files being transferred to your back up, incrementally separated archives are a good idea. In essence, however, this basic set up is all you really need to create a reliable, automatic back up system.&lt;/p>
&lt;h2 id="dont-feed-the-trolls" class="anchor-link">&lt;a href="#dont-feed-the-trolls">Don&amp;rsquo;t feed the trolls&lt;/a>&lt;/h2>
&lt;p>Humans are fallible; that&amp;rsquo;s why cyberattacks work. The success of a ransomware attack depends on the victim having no choice but to pay up in order to return to business as usual. A highly accessible recent back up undermines attackers who depend on us being unprepared. By blowing away a system and restoring from yesterday&amp;rsquo;s back up, we may lose a day of progress; ransomers, however, gain nothing at all.&lt;/p>
&lt;p>For further resources on ransomware defense for users and organizations, check out &lt;a href="https://www.us-cert.gov/Ransomware">CISA&amp;rsquo;s advice on ransomware&lt;/a>.&lt;/p></content:encoded><enclosure url="https://victoria.dev/blog/a-cron-job-that-could-save-you-from-a-ransomware-attack/cover_hue3aef3cab743e28f902a30a77ac75013_151327_640x0_resize_q75_box.jpg" type="image/jpg"/></item><item><title>Publishing GitHub event data with GitHub Actions and Pages</title><link>https://victoria.dev/blog/publishing-github-event-data-with-github-actions-and-pages/</link><pubDate>Mon, 04 Nov 2019 09:13:23 -0400</pubDate><author>hello@victoria.dev (Victoria Drake)</author><guid>https://victoria.dev/blog/publishing-github-event-data-with-github-actions-and-pages/</guid><description>A guide to overcoming the GitHub event data horizon with a little command-line magic.</description><content:encoded>
&lt;img src="https://victoria.dev/blog/publishing-github-event-data-with-github-actions-and-pages/cover_huaee6554f1e095f5c5379368e27b9bf74_24874_640x0_resize_box_2.png" width="640" height="270"/>
&lt;p>Teams who work on GitHub rely on event data to collaborate. The data recorded as issues, pull requests, and comments, become vital to understanding the project.&lt;/p>
&lt;p>With the general availability of GitHub Actions, we have a chance to programmatically access and preserve GitHub event data in our repository. Making the data part of the repository itself is a way of preserving it outside of GitHub, and also gives us the ability to feature the data on a front-facing website, such as with GitHub Pages, through an automated process that&amp;rsquo;s part of our CI/CD pipeline.&lt;/p>
&lt;p>And, if you&amp;rsquo;re like me, you can turn &lt;a href="https://github.com/victoriadrake/github-guestbook/issues/1">GitHub issue comments&lt;/a> into an &lt;a href="https://victoria.dev/github-guestbook/">awesome 90s guestbook page&lt;/a>.&lt;/p>
&lt;p>No matter the usage, the principle concepts are the same. We can use Actions to access, preserve, and display GitHub event data - with just one workflow file. To illustrate the process, I&amp;rsquo;ll take you through the &lt;a href="https://github.com/victoriadrake/github-guestbook/blob/master/.github/workflows/publish-comments.yml">workflow code&lt;/a> that makes my guestbook shine on.&lt;/p>
&lt;p>For an introductory look at GitHub Actions including how workflows are triggered, see &lt;a href="https://victoria.dev/blog/a-lightweight-tool-agnostic-ci/cd-flow-with-github-actions/">A lightweight, tool-agnostic CI/CD flow with GitHub Actions&lt;/a>.&lt;/p>
&lt;h2 id="accessing-github-event-data" class="anchor-link">&lt;a href="#accessing-github-event-data">Accessing GitHub event data&lt;/a>&lt;/h2>
&lt;p>An Action workflow runs in an environment with some default environment variables. A lot of convenient information is available here, including event data. The most complete way to access the event data is using the &lt;code>$GITHUB_EVENT_PATH&lt;/code> variable, the path of the file with the complete JSON event payload.&lt;/p>
&lt;p>The expanded path looks like &lt;code>/home/runner/work/_temp/_github_workflow/event.json&lt;/code> and its data corresponds to its webhook event. You can find the documentation for webhook event data in GitHub REST API &lt;a href="https://developer.github.com/webhooks/#events">Event Types and Payloads&lt;/a>. To make the JSON data available in the workflow environment, you can use a tool like &lt;code>jq&lt;/code> to parse the event data and put it in an environment variable.&lt;/p>
&lt;p>Below, I grab the comment ID from an &lt;a href="https://developer.github.com/v3/activity/events/types/#issuecommentevent">issue comment event&lt;/a>:&lt;/p>
&lt;div class="highlight">&lt;pre class="chroma">&lt;code class="language-sh" data-lang="sh">&lt;span class="nv">ID&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s2">&amp;#34;&lt;/span>&lt;span class="k">$(&lt;/span>jq &lt;span class="s1">&amp;#39;.comment.id&amp;#39;&lt;/span> &lt;span class="nv">$GITHUB_EVENT_PATH&lt;/span>&lt;span class="k">)&lt;/span>&lt;span class="s2">&amp;#34;&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>Most event data is also available via the &lt;a href="https://help.github.com/en/github/automating-your-workflow-with-github-actions/contexts-and-expression-syntax-for-github-actions#github-context">&lt;code>github.event&lt;/code> context variable&lt;/a> without needing to parse JSON. The fields are accessed using dot notation, as in the example below where I grab the same comment ID:&lt;/p>
&lt;div class="highlight">&lt;pre class="chroma">&lt;code class="language-sh" data-lang="sh">&lt;span class="nv">ID&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="si">${&lt;/span>&lt;span class="p">{ github.event.comment.id &lt;/span>&lt;span class="si">}&lt;/span>&lt;span class="o">}&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>For my guestbook, I want to display entries with the user&amp;rsquo;s handle, and the date and time. I can capture this event data like so:&lt;/p>
&lt;div class="highlight">&lt;pre class="chroma">&lt;code class="language-sh" data-lang="sh">&lt;span class="nv">AUTHOR&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="si">${&lt;/span>&lt;span class="p">{ github.event.comment.user.login &lt;/span>&lt;span class="si">}&lt;/span>&lt;span class="o">}&lt;/span>
&lt;span class="nv">DATE&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="si">${&lt;/span>&lt;span class="p">{ github.event.comment.created_at &lt;/span>&lt;span class="si">}&lt;/span>&lt;span class="o">}&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>Shell variables are handy for accessing data, however, they&amp;rsquo;re ephemeral. The workflow environment is created anew each run, and even shell variables set in one step do not persist to other steps. To persist the captured data, you have two options: use artifacts, or commit it to the repository.&lt;/p>
&lt;h2 id="preserving-event-data-using-artifacts" class="anchor-link">&lt;a href="#preserving-event-data-using-artifacts">Preserving event data: using artifacts&lt;/a>&lt;/h2>
&lt;p>Using artifacts, you can persist data between workflow jobs without committing it to your repository. This is handy when, for example, you wish to transform or incorporate the data before putting it somewhere more permanent. It&amp;rsquo;s necessary to persist data between workflow jobs because:&lt;/p>
&lt;blockquote>
&lt;p>Each job in a workflow runs in a fresh instance of the virtual environment. When the job completes, the runner terminates and deletes the instance of the virtual environment. &lt;em>(&lt;a href="https://help.github.com/en/github/automating-your-workflow-with-github-actions/persisting-workflow-data-using-artifacts">Persisting workflow data using artifacts&lt;/a>)&lt;/em>&lt;/p>
&lt;/blockquote>
&lt;p>Two actions assist with using artifacts: &lt;code>upload-artifact&lt;/code> and &lt;code>download-artifact&lt;/code>. You can use these actions to make files available to other jobs in the same workflow. For a full example, see &lt;a href="https://help.github.com/en/github/automating-your-workflow-with-github-actions/persisting-workflow-data-using-artifacts#passing-data-between-jobs-in-a-workflow">passing data between jobs in a workflow&lt;/a>.&lt;/p>
&lt;p>The &lt;code>upload-artifact&lt;/code> action&amp;rsquo;s &lt;code>action.yml&lt;/code> contains an &lt;a href="https://github.com/actions/upload-artifact/blob/master/action.yml">explanation&lt;/a> of the keywords. The uploaded files are saved in &lt;code>.zip&lt;/code> format. Another job in the same workflow run can use the &lt;code>download-artifact&lt;/code> action to utilize the data in another step.&lt;/p>
&lt;p>You can also manually download the archive on the workflow run page, under the repository&amp;rsquo;s Actions tab.&lt;/p>
&lt;p>Persisting workflow data between jobs does not make any changes to the repository files, as the artifacts generated live only in the workflow environment. Personally, being comfortable working in a shell environment, I see a narrow use case for artifacts, though I&amp;rsquo;d have been remiss not to mention them. Besides passing data between jobs, they could be useful for creating &lt;code>.zip&lt;/code> format archives of, say, test output data. In the case of my guestbook example, I simply ran all the necessary steps in one job, negating any need for passing data between jobs.&lt;/p>
&lt;h2 id="preserving-event-data-pushing-workflow-files-to-the-repository" class="anchor-link">&lt;a href="#preserving-event-data-pushing-workflow-files-to-the-repository">Preserving event data: pushing workflow files to the repository&lt;/a>&lt;/h2>
&lt;p>To preserve data captured in the workflow in the repository itself, it is necessary to add and push this data to the Git repository. You can do this in the workflow by creating new files with the data, or by appending data to existing files, using shell commands.&lt;/p>
&lt;h3 id="creating-files-in-the-workflow" class="anchor-link">&lt;a href="#creating-files-in-the-workflow">Creating files in the workflow&lt;/a>&lt;/h3>
&lt;p>To work with the repository files in the workflow, use the &lt;a href="https://github.com/actions/checkout">&lt;code>checkout&lt;/code> action&lt;/a> to first get a copy to work with:&lt;/p>
&lt;div class="highlight">&lt;pre class="chroma">&lt;code class="language-yml" data-lang="yml">- &lt;span class="nt">uses&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">actions/checkout@master&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nt">with&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nt">fetch-depth&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="m">1&lt;/span>&lt;span class="w">
&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>To add comments to my guestbook, I turn the event data captured in shell variables into proper files, using substitutions in &lt;a href="https://www.gnu.org/software/bash/manual/html_node/Shell-Parameter-Expansion.html">shell parameter expansion&lt;/a> to sanitize user input and translate newlines to paragraphs. I wrote previously about &lt;a href="https://victoria.dev/blog/sql-injection-and-xss-what-white-hat-hackers-know-about-trusting-user-input/">why user input should be treated carefully&lt;/a>.&lt;/p>
&lt;div class="highlight">&lt;pre class="chroma">&lt;code class="language-yml" data-lang="yml">- &lt;span class="nt">name&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">Turn comment into file&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nt">run&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">|&lt;/span>&lt;span class="sd">
&lt;/span>&lt;span class="sd"> ID=${{ github.event.comment.id }}
&lt;/span>&lt;span class="sd"> AUTHOR=${{ github.event.comment.user.login }}
&lt;/span>&lt;span class="sd"> DATE=${{ github.event.comment.created_at }}
&lt;/span>&lt;span class="sd"> COMMENT=$(echo &amp;#34;${{ github.event.comment.body }}&amp;#34;)
&lt;/span>&lt;span class="sd"> NO_TAGS=${COMMENT//[&amp;lt;&amp;gt;]/\`}
&lt;/span>&lt;span class="sd"> FOLDER=comments
&lt;/span>&lt;span class="sd">
&lt;/span>&lt;span class="sd"> printf &amp;#39;%b\n&amp;#39; &amp;#34;&amp;lt;div class=\&amp;#34;comment\&amp;#34;&amp;gt;&amp;lt;p&amp;gt;${AUTHOR} says:&amp;lt;/p&amp;gt;&amp;lt;p&amp;gt;${NO_TAGS//$&amp;#39;\n&amp;#39;/\&amp;lt;\/p\&amp;gt;\&amp;lt;p\&amp;gt;}&amp;lt;/p&amp;gt;&amp;lt;p&amp;gt;${DATE}&amp;lt;/p&amp;gt;&amp;lt;/div&amp;gt;\r\n&amp;#34; &amp;gt; ${FOLDER}/${ID}.html&lt;/span>&lt;span class="w">
&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>By using &lt;code>printf&lt;/code> and directing its output with &lt;code>&amp;gt;&lt;/code> to a new file, the event data is transformed into an HTML file, named with the comment ID number, that contains the captured event data. Formatted, it looks like:&lt;/p>
&lt;div class="highlight">&lt;pre class="chroma">&lt;code class="language-html" data-lang="html">&lt;span class="p">&amp;lt;&lt;/span>&lt;span class="nt">div&lt;/span> &lt;span class="na">class&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s">&amp;#34;comment&amp;#34;&lt;/span>&lt;span class="p">&amp;gt;&lt;/span>
&lt;span class="p">&amp;lt;&lt;/span>&lt;span class="nt">p&lt;/span>&lt;span class="p">&amp;gt;&lt;/span>victoriadrake says:&lt;span class="p">&amp;lt;/&lt;/span>&lt;span class="nt">p&lt;/span>&lt;span class="p">&amp;gt;&lt;/span>
&lt;span class="p">&amp;lt;&lt;/span>&lt;span class="nt">p&lt;/span>&lt;span class="p">&amp;gt;&lt;/span>This is a comment!&lt;span class="p">&amp;lt;/&lt;/span>&lt;span class="nt">p&lt;/span>&lt;span class="p">&amp;gt;&lt;/span>
&lt;span class="p">&amp;lt;&lt;/span>&lt;span class="nt">p&lt;/span>&lt;span class="p">&amp;gt;&lt;/span>2019-11-04T00:28:36Z&lt;span class="p">&amp;lt;/&lt;/span>&lt;span class="nt">p&lt;/span>&lt;span class="p">&amp;gt;&lt;/span>
&lt;span class="p">&amp;lt;/&lt;/span>&lt;span class="nt">div&lt;/span>&lt;span class="p">&amp;gt;&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>When working with comments, one effect of naming files using the comment ID is that a new file with the same ID will overwrite the previous. This is handy for a guestbook, as it allows any edits to a comment to replace the original comment file.&lt;/p>
&lt;p>If you&amp;rsquo;re using a static site generator like Hugo, you could build a Markdown format file, stick it in your &lt;code>content/&lt;/code> folder, and the regular site build will take care of the rest. In the case of my simplistic guestbook, I have an extra step to consolidate the individual comment files into a page. Each time it runs, it overwrites the existing &lt;code>index.html&lt;/code> with the &lt;code>header.html&lt;/code> portion (&lt;code>&amp;gt;&lt;/code>), then finds and appends (&lt;code>&amp;gt;&amp;gt;&lt;/code>) all the comment files' contents in descending order, and lastly appends the &lt;code>footer.html&lt;/code> portion to end the page.&lt;/p>
&lt;div class="highlight">&lt;pre class="chroma">&lt;code class="language-yml" data-lang="yml">- &lt;span class="nt">name&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">Assemble page&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nt">run&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">|&lt;/span>&lt;span class="sd">
&lt;/span>&lt;span class="sd"> cat header.html &amp;gt; index.html
&lt;/span>&lt;span class="sd"> find comments/ -name &amp;#34;*.html&amp;#34; | sort -r | xargs -I % cat % &amp;gt;&amp;gt; index.html
&lt;/span>&lt;span class="sd"> cat footer.html &amp;gt;&amp;gt; index.html&lt;/span>&lt;span class="w">
&lt;/span>&lt;/code>&lt;/pre>&lt;/div>
&lt;h3 id="committing-changes-to-the-repository" class="anchor-link">&lt;a href="#committing-changes-to-the-repository">Committing changes to the repository&lt;/a>&lt;/h3>
&lt;p>Since the &lt;code>checkout&lt;/code> action is not quite the same as cloning the repository, at time of writing, there are some &lt;a href="https://github.community/t5/GitHub-Actions/Checkout-Action-does-not-create-local-master-and-has-no-options/td-p/31575">issues&lt;/a> still to work around. A couple extra steps are necessary to &lt;code>pull&lt;/code>, &lt;code>checkout&lt;/code>, and successfully &lt;code>push&lt;/code> changes back to the &lt;code>master&lt;/code> branch, but this is pretty trivially done in the shell.&lt;/p>
&lt;p>Below is the step that adds, commits, and pushes changes made by the workflow back to the repository&amp;rsquo;s &lt;code>master&lt;/code> branch.&lt;/p>
&lt;div class="highlight">&lt;pre class="chroma">&lt;code class="language-yml" data-lang="yml">- &lt;span class="nt">name&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">Push changes to repo&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nt">run&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="p">|&lt;/span>&lt;span class="sd">
&lt;/span>&lt;span class="sd"> REMOTE=https://${{ secrets.GITHUB_TOKEN }}@github.com/${{ github.repository }}
&lt;/span>&lt;span class="sd"> git config user.email &amp;#34;${{ github.actor }}@users.noreply.github.com&amp;#34;
&lt;/span>&lt;span class="sd"> git config user.name &amp;#34;${{ github.actor }}&amp;#34;
&lt;/span>&lt;span class="sd">
&lt;/span>&lt;span class="sd"> git pull ${REMOTE}
&lt;/span>&lt;span class="sd"> git checkout master
&lt;/span>&lt;span class="sd"> git add .
&lt;/span>&lt;span class="sd"> git status
&lt;/span>&lt;span class="sd"> git commit -am &amp;#34;Add new comment&amp;#34;
&lt;/span>&lt;span class="sd"> git push ${REMOTE} master&lt;/span>&lt;span class="w">
&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>The remote, in fact, our repository, is specified using the &lt;code>github.repository&lt;/code> context variable. For our workflow to be allowed to push to master, we give the remote URL using &lt;a href="https://help.github.com/en/github/automating-your-workflow-with-github-actions/authenticating-with-the-github_token">the default &lt;code>secrets.GITHUB_TOKEN&lt;/code> variable&lt;/a>.&lt;/p>
&lt;p>Since the workflow environment is shiny and newborn, we need to configure Git. In the above example, I&amp;rsquo;ve used the &lt;code>github.actor&lt;/code> context variable to input the username of the account initiating the workflow. The email is similarly configured using the &lt;a href="https://help.github.com/en/github/setting-up-and-managing-your-github-user-account/setting-your-commit-email-address#setting-your-commit-email-address-on-github">default &lt;code>noreply&lt;/code> GitHub email address&lt;/a>.&lt;/p>
&lt;h2 id="displaying-event-data" class="anchor-link">&lt;a href="#displaying-event-data">Displaying event data&lt;/a>&lt;/h2>
&lt;p>If you&amp;rsquo;re using GitHub Pages with the default &lt;code>secrets.GITHUB_TOKEN&lt;/code> variable and without a site generator, pushing changes to the repository in the workflow will only update the repository files. The GitHub Pages build will fail with an error, &amp;ldquo;Your site is having problems building: Page build failed.&amp;rdquo;&lt;/p>
&lt;p>To enable Actions to trigger a Pages site build, you&amp;rsquo;ll need to create a Personal Access Token. This token can be &lt;a href="https://help.github.com/en/github/automating-your-workflow-with-github-actions/creating-and-using-encrypted-secrets">stored as a secret in the repository&lt;/a> settings and passed into the workflow in place of the default &lt;code>secrets.GITHUB_TOKEN&lt;/code> variable. I wrote more about &lt;a href="https://victoria.dev/blog/a-lightweight-tool-agnostic-ci/cd-flow-with-github-actions/#environment-and-variables">Actions environment and variables in this post&lt;/a>.&lt;/p>
&lt;p>With the use of a Personal Access Token, a push initiated by the Actions workflow will also update the Pages site. You can see it for yourself by &lt;a href="https://github.com/victoriadrake/github-guestbook/issues/1">leaving a comment&lt;/a> in my &lt;a href="https://victoria.dev/github-guestbook/">guestbook&lt;/a>! The comment creation event triggers the workflow, which then takes around 30 seconds to run and update the guestbook page.&lt;/p>
&lt;p>Where a site build is necessary for changes to be published, such as when using Hugo, an Action can do this too. However, in order to avoid creating unintended loops, &lt;a href="https://help.github.com/en/github/automating-your-workflow-with-github-actions/events-that-trigger-workflows#about-workflow-events">one Action workflow will not trigger another&lt;/a>. Instead, it&amp;rsquo;s extremely convenient to handle the process of &lt;a href="https://victoria.dev/blog/a-portable-makefile-for-continuous-delivery-with-hugo-and-github-pages/">building the site with a Makefile&lt;/a>, which any workflow can then run. Simply add running the Makefile as the final step in your workflow job, with the repository token where necessary:&lt;/p>
&lt;div class="highlight">&lt;pre class="chroma">&lt;code class="language-yml" data-lang="yml">- &lt;span class="nt">name&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">Run Makefile&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nt">env&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nt">TOKEN&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">${{ secrets.GITHUB_TOKEN }}&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nt">run&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">make all&lt;/span>&lt;span class="w">
&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>This ensures that the final step of your workflow builds and deploys the updated site.&lt;/p>
&lt;h2 id="no-more-event-data-horizon" class="anchor-link">&lt;a href="#no-more-event-data-horizon">No more event data horizon&lt;/a>&lt;/h2>
&lt;p>GitHub Actions provides a neat way to capture and utilize event data so that it&amp;rsquo;s not only available within GitHub. The possibilities are only as limited as your imagination! Here are a few ideas for things this lets us create:&lt;/p>
&lt;ol>
&lt;li>A public-facing issues board, where customers without GitHub accounts can view and give feedback on project issues.&lt;/li>
&lt;li>An automatically-updating RSS feed of new issues, comments, or PRs for any repository.&lt;/li>
&lt;li>A comments system for static sites, utilizing GitHub issue comments as an input method.&lt;/li>
&lt;li>An awesome 90s guestbook page.&lt;/li>
&lt;/ol>
&lt;p>Did I mention I made a &lt;a href="https://victoria.dev/github-guestbook/">90s guestbook page&lt;/a>? My inner-Geocities-nerd is a little excited.&lt;/p></content:encoded><enclosure url="https://victoria.dev/blog/publishing-github-event-data-with-github-actions-and-pages/cover_huaee6554f1e095f5c5379368e27b9bf74_24874_640x0_resize_box_2.png" type="image/jpg"/></item><item><title>A lightweight, tool-agnostic CI/CD flow with GitHub Actions</title><link>https://victoria.dev/blog/a-lightweight-tool-agnostic-ci/cd-flow-with-github-actions/</link><pubDate>Mon, 28 Oct 2019 08:28:52 -0400</pubDate><author>hello@victoria.dev (Victoria Drake)</author><guid>https://victoria.dev/blog/a-lightweight-tool-agnostic-ci/cd-flow-with-github-actions/</guid><description>How to take advantage of a simple GitHub Actions workflow without sacrificing agnostic tooling.</description><content:encoded>
&lt;img src="https://victoria.dev/blog/a-lightweight-tool-agnostic-ci/cd-flow-with-github-actions/cover_hu9453ff9858136595f547e00bf2681d14_107954_640x0_resize_box_2.png" width="640" height="202"/>
&lt;p>Agnostic tooling is the clever notion that you should be able to run your code in various environments. With many continuous integration and continuous development (CI/CD) apps available, agnostic tooling gives developers a big advantage: portability.&lt;/p>
&lt;p>Of course, having your CI/CD work &lt;em>everywhere&lt;/em> is a tall order. Popular &lt;a href="https://github.com/marketplace/category/continuous-integration">CI apps for GitHub repositories&lt;/a> alone use a multitude of configuration languages spanning &lt;a href="https://groovy-lang.org/syntax.html">Groovy&lt;/a>, &lt;a href="https://yaml.org/">YAML&lt;/a>, &lt;a href="https://github.com/toml-lang/toml">TOML&lt;/a>, &lt;a href="https://json.org/">JSON&lt;/a>, and more&amp;hellip; all with differing syntax, of course. Porting workflows from one tool to another is more than a one-cup-of-coffee process.&lt;/p>
&lt;p>The introduction of &lt;a href="https://github.com/features/actions">GitHub Actions&lt;/a> has the potential to add yet another tool to the mix; or, for the right set up, greatly simplify a CI/CD workflow.&lt;/p>
&lt;p>Prior to this article, I accomplished my CD flow with several lashed-together apps. I used AWS Lambda to trigger site builds on a schedule. I had Netlify build on push triggers, as well as run image optimization, and then push my site to the public Pages repository. I used Travis CI in the public repository to test the HTML. All this worked in conjunction with GitHub Pages, which actually hosts the site.&lt;/p>
&lt;p>I&amp;rsquo;m now using the GitHub Actions beta to accomplish all the same tasks, with one &lt;a href="https://victoria.dev/blog/a-portable-makefile-for-continuous-delivery-with-hugo-and-github-pages/">portable Makefile&lt;/a> of build instructions, and without any other CI/CD apps.&lt;/p>
&lt;h2 id="appreciating-the-shell" class="anchor-link">&lt;a href="#appreciating-the-shell">Appreciating the shell&lt;/a>&lt;/h2>
&lt;p>What do most CI/CD tools have in common? They run your workflow instructions in a shell environment! This is wonderful, because that means that most CI/CD tools can do anything that you can do in a terminal&amp;hellip; and you can do pretty much &lt;em>anything&lt;/em> in a terminal.&lt;/p>
&lt;p>Especially for a contained use case like building my static site with a generator like Hugo, running it all in a shell is a no-brainer. To tell the magic box what to do, we just need to write instructions.&lt;/p>
&lt;p>While a shell script is certainly the most portable option, I use the still-very-portable &lt;a href="https://en.wikipedia.org/wiki/Make_(software)">Make&lt;/a> to write my process instructions. This provides me with some advantages over simple shell scripting, like the use of variables and &lt;a href="https://en.wikipedia.org/wiki/Make_(software)#Macros">macros&lt;/a>, and the modularity of &lt;a href="https://en.wikipedia.org/wiki/Makefile#Rules">rules&lt;/a>.&lt;/p>
&lt;p>I got into the &lt;a href="https://victoria.dev/blog/a-portable-makefile-for-continuous-delivery-with-hugo-and-github-pages/">nitty-gritty of my Makefile in my last post&lt;/a>. Let&amp;rsquo;s look at how to get GitHub Actions to run it.&lt;/p>
&lt;h2 id="using-a-makefile-with-github-actions" class="anchor-link">&lt;a href="#using-a-makefile-with-github-actions">Using a Makefile with GitHub Actions&lt;/a>&lt;/h2>
&lt;p>To our point on portability, my magic Makefile is stored right in the repository root. Since it&amp;rsquo;s included with the code, I can run the Makefile locally on any system where I can clone the repository, provided I set the environment variables. Using GitHub Actions as my CI/CD tool is as straightforward as making Make go worky-worky.&lt;/p>
&lt;p>I found the &lt;a href="https://help.github.com/en/articles/workflow-syntax-for-github-actions">GitHub Actions workflow syntax guide&lt;/a> to be pretty straightforward, though also lengthy on options. Here&amp;rsquo;s the necessary set up for getting the Makefile to run.&lt;/p>
&lt;p>The workflow file at &lt;code>.github/workflows/make-master.yml&lt;/code> contains the following:&lt;/p>
&lt;div class="highlight">&lt;pre class="chroma">&lt;code class="language-yml" data-lang="yml">&lt;span class="nt">name&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">make-master&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w">&lt;/span>&lt;span class="nt">on&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nt">push&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nt">branches&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>- &lt;span class="l">master&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nt">schedule&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>- &lt;span class="nt">cron&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="s1">&amp;#39;20 13 * * *&amp;#39;&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w">&lt;/span>&lt;span class="nt">jobs&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nt">build&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nt">runs-on&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">ubuntu-latest&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nt">steps&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>- &lt;span class="nt">uses&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">actions/checkout@master&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nt">with&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nt">fetch-depth&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="m">1&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>- &lt;span class="nt">name&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">Run Makefile&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nt">env&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nt">TOKEN&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">${{ secrets.TOKEN }}&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nt">run&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">make all&lt;/span>&lt;span class="w">
&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>I&amp;rsquo;ll explain the components that make this work.&lt;/p>
&lt;h2 id="triggering-the-workflow" class="anchor-link">&lt;a href="#triggering-the-workflow">Triggering the workflow&lt;/a>&lt;/h2>
&lt;p>Actions support multiple &lt;a href="https://help.github.com/en/articles/events-that-trigger-workflows">triggers for a workflow&lt;/a>. Using the &lt;code>on&lt;/code> syntax, I&amp;rsquo;ve defined two triggers for mine: a &lt;a href="https://help.github.com/en/articles/workflow-syntax-for-github-actions#onpushpull_requestbranchestags">push event&lt;/a> to the &lt;code>master&lt;/code> branch only, and a &lt;a href="https://help.github.com/en/articles/events-that-trigger-workflows#scheduled-events-schedule">scheduled&lt;/a> &lt;code>cron&lt;/code> job.&lt;/p>
&lt;p>Once the &lt;code>make-master.yml&lt;/code> file is in your repository, either of your triggers will cause Actions to run your Makefile. To see how the last run went, you can also &lt;a href="https://help.github.com/en/articles/configuring-a-workflow#adding-a-workflow-status-badge-to-your-repository">add a fun badge&lt;/a> to the README.&lt;/p>
&lt;h3 id="one-hacky-thing" class="anchor-link">&lt;a href="#one-hacky-thing">One hacky thing&lt;/a>&lt;/h3>
&lt;p>Because the Makefile runs on every push to &lt;code>master&lt;/code>, I sometimes would get errors when the site build had no changes. When Git, via &lt;a href="https://victoria.dev/blog/a-portable-makefile-for-continuous-delivery-with-hugo-and-github-pages/">my Makefile&lt;/a>, attempted to commit to the Pages repository, no changes were detected and the commit would fail annoyingly:&lt;/p>
&lt;div class="highlight">&lt;pre class="chroma">&lt;code class="language-txt" data-lang="txt">nothing to commit, working tree clean
On branch master
Your branch is up to date with &amp;#39;origin/master&amp;#39;.
nothing to commit, working tree clean
Makefile:62: recipe for target &amp;#39;deploy&amp;#39; failed
make: *** [deploy] Error 1
##[error]Process completed with exit code 2.
&lt;/code>&lt;/pre>&lt;/div>&lt;p>I came across some solutions that proposed using &lt;code>diff&lt;/code> to check if a commit should be made, but this may not work for &lt;a href="https://github.com/benmatselby/hugo-deploy-gh-pages/issues/4">reasons&lt;/a>. As a workaround, I simply added the &lt;a href="https://gohugo.io/functions/format/#use-local-and-utc">current UTC time&lt;/a> to my index page so that every build would contain a change to be committed.&lt;/p>
&lt;h2 id="environment-and-variables" class="anchor-link">&lt;a href="#environment-and-variables">Environment and variables&lt;/a>&lt;/h2>
&lt;p>You can define the &lt;a href="https://help.github.com/en/github/automating-your-workflow-with-github-actions/virtual-environments-for-github-hosted-runners#supported-runners-and-hardware-resources">virtual environment&lt;/a> for your workflow to run in using the &lt;code>runs-on&lt;/code> syntax. The &lt;del>obvious best choice&lt;/del> one I chose is Ubuntu. Using &lt;code>ubuntu-latest&lt;/code> gets me the most updated version, whatever that happens to be when you&amp;rsquo;re reading this.&lt;/p>
&lt;p>GitHub sets some &lt;a href="https://help.github.com/en/github/automating-your-workflow-with-github-actions/using-environment-variables#default-environment-variables">default environment variables&lt;/a> for workflows. The &lt;a href="https://github.com/actions/checkout">&lt;code>actions/checkout&lt;/code> action&lt;/a> with &lt;code>fetch-depth: 1&lt;/code> creates a copy of just the most recent commit your repository in the &lt;code>GITHUB_WORKSPACE&lt;/code> variable. This allows the workflow to access the Makefile at &lt;code>GITHUB_WORKSPACE/Makefile&lt;/code>. Without using the checkout action, the Makefile won&amp;rsquo;t be found, and I get an error that looks like this:&lt;/p>
&lt;div class="highlight">&lt;pre class="chroma">&lt;code class="language-txt" data-lang="txt">make: *** No rule to make target &amp;#39;all&amp;#39;. Stop.
Running Makefile
##[error]Process completed with exit code 2.
&lt;/code>&lt;/pre>&lt;/div>&lt;p>While there is a &lt;a href="https://help.github.com/en/github/automating-your-workflow-with-github-actions/authenticating-with-the-github_token">default &lt;code>GITHUB_TOKEN&lt;/code> secret&lt;/a>, this is not the one I used. The default is only locally scoped to the current repository. To be able to push to my separate GitHub Pages repository, I created a &lt;a href="https://github.com/settings/tokens">personal access token&lt;/a> scoped to &lt;code>public_repo&lt;/code> and pass it in as the &lt;code>secrets.TOKEN&lt;/code> encrypted variable. For a step-by-step, see &lt;a href="https://help.github.com/en/github/automating-your-workflow-with-github-actions/creating-and-using-encrypted-secrets">Creating and using encrypted secrets&lt;/a>.&lt;/p>
&lt;h2 id="portable-tooling" class="anchor-link">&lt;a href="#portable-tooling">Portable tooling&lt;/a>&lt;/h2>
&lt;p>The nice thing about using a simple Makefile to define the bulk of my CI/CD process is that it&amp;rsquo;s completely portable. I can run a Makefile anywhere I have access to an environment, which is most CI/CD apps, virtual instances, and, of course, on my local machine.&lt;/p>
&lt;p>One of the reasons I like GitHub Actions is that getting my Makefile to run was pretty straightforward. I think the syntax is well done - easy to read, and intuitive when it comes to finding an option you&amp;rsquo;re looking for. For someone already using GitHub Pages, Actions provides a pretty seamless CD experience; and if that should ever change, I can run my Makefile elsewhere. \_()_/&lt;/p></content:encoded><enclosure url="https://victoria.dev/blog/a-lightweight-tool-agnostic-ci/cd-flow-with-github-actions/cover_hu9453ff9858136595f547e00bf2681d14_107954_640x0_resize_box_2.png" type="image/jpg"/></item><item><title>A portable Makefile for continuous delivery with Hugo and GitHub Pages</title><link>https://victoria.dev/blog/a-portable-makefile-for-continuous-delivery-with-hugo-and-github-pages/</link><pubDate>Mon, 21 Oct 2019 09:09:06 -0400</pubDate><author>hello@victoria.dev (Victoria Drake)</author><guid>https://victoria.dev/blog/a-portable-makefile-for-continuous-delivery-with-hugo-and-github-pages/</guid><description>My Makefile for building this site, optimizing images, and running my CI/CD GitHub Actions flow.</description><content:encoded>
&lt;img src="https://victoria.dev/blog/a-portable-makefile-for-continuous-delivery-with-hugo-and-github-pages/cover_hu9d9ed8ea95bbaa69b5034cdaef6f2293_689918_640x0_resize_box_2.png" width="640" height="390"/>
&lt;p>Fun fact: I first launched this GitHub Pages site 1,018 days ago.&lt;/p>
&lt;p>Since then, we&amp;rsquo;ve grown together. From early cringe-worthy commit messages, through eighty-six versions of &lt;a href="https://gohugo.io/">Hugo&lt;/a>, and up until last week, a less-than-streamlined multi-app continuous integration and deployment (CI/CD) workflow.&lt;/p>
&lt;p>If you know me at all, you know I love to automate things. I&amp;rsquo;ve been using a combination of AWS Lambda, Netlify, and Travis CI to automatically build and publish this site. My workflow for the task includes:&lt;/p>
&lt;ul>
&lt;li>Build with &lt;a href="https://gohugo.io/">Hugo&lt;/a> on push to master, and on a schedule (Netlify and Lambda);&lt;/li>
&lt;li>Optimize and resize images (Netlify);&lt;/li>
&lt;li>Test with &lt;a href="https://github.com/gjtorikian/html-proofer">HTMLProofer&lt;/a> (Travis CI); and&lt;/li>
&lt;li>Deploy to my &lt;a href="https://victoria.dev/blog/two-ways-to-deploy-a-public-github-pages-site-from-a-private-hugo-repository/">separate, public, GitHub Pages repository&lt;/a> (Netlify).&lt;/li>
&lt;/ul>
&lt;p>Thanks to the introduction of GitHub Actions, I&amp;rsquo;m able to do all the above with just one portable &lt;a href="https://en.wikipedia.org/wiki/Makefile">Makefile&lt;/a>.&lt;/p>
&lt;p>Next week I&amp;rsquo;ll cover my Actions set up; today, I&amp;rsquo;ll take you through the nitty-gritty of my Makefile so you can write your own.&lt;/p>
&lt;h2 id="makefile-portability" class="anchor-link">&lt;a href="#makefile-portability">Makefile portability&lt;/a>&lt;/h2>
&lt;p>&lt;a href="https://pubs.opengroup.org/onlinepubs/9699919799/utilities/make.html">POSIX-standard-flavour Make&lt;/a> runs on every Unix-like system out there. &lt;a href="https://en.wikipedia.org/wiki/Make_(software)#Derivatives">Make derivatives&lt;/a>, such as &lt;a href="https://www.gnu.org/software/make/">GNU Make&lt;/a> and several flavours of BSD Make also run on Unix-like systems, though their particular use requires installing the respective program. To write a truly portable Makefile, mine follows the POSIX standard. (For a more thorough summation of POSIX-compatible Makefiles, I found this article helpful: &lt;a href="https://nullprogram.com/blog/2017/08/20/">A Tutorial on Portable Makefiles&lt;/a>.) I run Ubuntu, so I&amp;rsquo;ve tested the portability aspect using the BSD Make programs &lt;code>bmake&lt;/code>, &lt;code>pmake&lt;/code>, and &lt;code>fmake&lt;/code>. Compatibility with non-Unix-like systems is a little more complicated, since shell commands differ. With derivatives such as Nmake, it&amp;rsquo;s better to write a separate Makefile with appropriate Windows commands.&lt;/p>
&lt;p>While much of my particular use case could be achieved with shell scripting, I find Make offers some worthwhile advantages. I enjoy the ease of using variables and &lt;a href="https://en.wikipedia.org/wiki/Make_(software)#Macros">macros&lt;/a>, and the modularity of &lt;a href="https://en.wikipedia.org/wiki/Makefile#Rules">rules&lt;/a> when it comes to organizing my steps.&lt;/p>
&lt;p>The writing of rules mostly comes down to shell commands, which is the main reason Makefiles are as portable as they are. The best part is that you can do pretty much &lt;em>anything&lt;/em> in a terminal, and certainly handle all the workflow steps listed above.&lt;/p>
&lt;h2 id="my-continuous-deployment-makefile" class="anchor-link">&lt;a href="#my-continuous-deployment-makefile">My continuous deployment Makefile&lt;/a>&lt;/h2>
&lt;p>Here&amp;rsquo;s the portable Makefile that handles my workflow. Yes, I put emojis in there. I&amp;rsquo;m a monster.&lt;/p>
&lt;div class="highlight">&lt;pre class="chroma">&lt;code class="language-Makefile" data-lang="Makefile">&lt;span class="nf">.POSIX&lt;/span>&lt;span class="o">:&lt;/span>
&lt;span class="nv">DESTDIR&lt;/span>&lt;span class="o">=&lt;/span>public
&lt;span class="nv">HUGO_VERSION&lt;/span>&lt;span class="o">=&lt;/span>0.58.3
&lt;span class="nv">OPTIMIZE&lt;/span> &lt;span class="o">=&lt;/span> find &lt;span class="k">$(&lt;/span>DESTDIR&lt;span class="k">)&lt;/span> -not -path &lt;span class="s2">&amp;#34;*/static/*&amp;#34;&lt;/span> &lt;span class="se">\(&lt;/span> -name &lt;span class="s1">&amp;#39;*.png&amp;#39;&lt;/span> -o -name &lt;span class="s1">&amp;#39;*.jpg&amp;#39;&lt;/span> -o -name &lt;span class="s1">&amp;#39;*.jpeg&amp;#39;&lt;/span> &lt;span class="se">\)&lt;/span> -print0 &lt;span class="p">|&lt;/span> &lt;span class="se">\
&lt;/span>&lt;span class="se">&lt;/span>&lt;span class="err">xargs&lt;/span> &lt;span class="err">-0&lt;/span> &lt;span class="err">-P8&lt;/span> &lt;span class="err">-n2&lt;/span> &lt;span class="err">mogrify&lt;/span> &lt;span class="err">-strip&lt;/span> &lt;span class="err">-thumbnail&lt;/span> &lt;span class="s1">&amp;#39;1000&amp;gt;&amp;#39;&lt;/span>
&lt;span class="nf">.PHONY&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="n">all&lt;/span>
&lt;span class="nf">all&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="n">get_repository&lt;/span> &lt;span class="n">clean&lt;/span> &lt;span class="n">get&lt;/span> &lt;span class="n">build&lt;/span> &lt;span class="n">test&lt;/span> &lt;span class="n">deploy&lt;/span>
&lt;span class="nf">.PHONY&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="n">get_repository&lt;/span>
&lt;span class="nf">get_repository&lt;/span>&lt;span class="o">:&lt;/span>
@echo &lt;span class="s2">&amp;#34; Getting Pages repository&amp;#34;&lt;/span>
git clone https://github.com/victoriadrake/victoriadrake.github.io.git &lt;span class="k">$(&lt;/span>DESTDIR&lt;span class="k">)&lt;/span>
&lt;span class="nf">.PHONY&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="n">clean&lt;/span>
&lt;span class="nf">clean&lt;/span>&lt;span class="o">:&lt;/span>
@echo &lt;span class="s2">&amp;#34; Cleaning old build&amp;#34;&lt;/span>
&lt;span class="nb">cd&lt;/span> &lt;span class="k">$(&lt;/span>DESTDIR&lt;span class="k">)&lt;/span> &lt;span class="o">&amp;amp;&amp;amp;&lt;/span> rm -rf *
&lt;span class="nf">.PHONY&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="n">get&lt;/span>
&lt;span class="nf">get&lt;/span>&lt;span class="o">:&lt;/span>
@echo &lt;span class="s2">&amp;#34; Checking for hugo&amp;#34;&lt;/span>
@if ! &lt;span class="o">[&lt;/span> -x &lt;span class="s2">&amp;#34;&lt;/span>&lt;span class="nv">$$&lt;/span>&lt;span class="s2">(command -v hugo)&amp;#34;&lt;/span> &lt;span class="o">]&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="k">then&lt;/span>&lt;span class="se">\
&lt;/span>&lt;span class="se">&lt;/span> &lt;span class="nb">echo&lt;/span> &lt;span class="s2">&amp;#34; Getting Hugo&amp;#34;&lt;/span>&lt;span class="p">;&lt;/span>&lt;span class="se">\
&lt;/span>&lt;span class="se">&lt;/span> wget -q -P tmp/ https://github.com/gohugoio/hugo/releases/download/v&lt;span class="k">$(&lt;/span>HUGO_VERSION&lt;span class="k">)&lt;/span>/hugo_extended_&lt;span class="k">$(&lt;/span>HUGO_VERSION&lt;span class="k">)&lt;/span>_Linux-64bit.tar.gz&lt;span class="p">;&lt;/span>&lt;span class="se">\
&lt;/span>&lt;span class="se">&lt;/span> tar xf tmp/hugo_extended_&lt;span class="k">$(&lt;/span>HUGO_VERSION&lt;span class="k">)&lt;/span>_Linux-64bit.tar.gz -C tmp/&lt;span class="p">;&lt;/span>&lt;span class="se">\
&lt;/span>&lt;span class="se">&lt;/span> sudo mv -f tmp/hugo /usr/bin/&lt;span class="p">;&lt;/span>&lt;span class="se">\
&lt;/span>&lt;span class="se">&lt;/span> rm -rf tmp/&lt;span class="p">;&lt;/span>&lt;span class="se">\
&lt;/span>&lt;span class="se">&lt;/span> hugo version&lt;span class="p">;&lt;/span>&lt;span class="se">\
&lt;/span>&lt;span class="se">&lt;/span> &lt;span class="k">fi&lt;/span>
&lt;span class="nf">.PHONY&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="n">build&lt;/span>
&lt;span class="nf">build&lt;/span>&lt;span class="o">:&lt;/span>
@echo &lt;span class="s2">&amp;#34; Generating site&amp;#34;&lt;/span>
hugo --gc --minify -d &lt;span class="k">$(&lt;/span>DESTDIR&lt;span class="k">)&lt;/span>
@echo &lt;span class="s2">&amp;#34; Optimizing images&amp;#34;&lt;/span>
&lt;span class="k">$(&lt;/span>OPTIMIZE&lt;span class="k">)&lt;/span>
&lt;span class="nf">.PHONY&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="n">test&lt;/span>
&lt;span class="nf">test&lt;/span>&lt;span class="o">:&lt;/span>
@echo &lt;span class="s2">&amp;#34; Testing HTML&amp;#34;&lt;/span>
docker run -v &lt;span class="k">$(&lt;/span>GITHUB_WORKSPACE&lt;span class="k">)&lt;/span>/&lt;span class="k">$(&lt;/span>DESTDIR&lt;span class="k">)&lt;/span>/:/mnt 18fgsa/html-proofer mnt --disable-external
&lt;span class="nf">.PHONY&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="n">deploy&lt;/span>
&lt;span class="nf">deploy&lt;/span>&lt;span class="o">:&lt;/span>
@echo &lt;span class="s2">&amp;#34; Preparing commit&amp;#34;&lt;/span>
@cd &lt;span class="k">$(&lt;/span>DESTDIR&lt;span class="k">)&lt;/span> &lt;span class="se">\
&lt;/span>&lt;span class="se">&lt;/span> &lt;span class="o">&amp;amp;&amp;amp;&lt;/span> git config user.email &lt;span class="s2">&amp;#34;hello@victoria.dev&amp;#34;&lt;/span> &lt;span class="se">\
&lt;/span>&lt;span class="se">&lt;/span> &lt;span class="o">&amp;amp;&amp;amp;&lt;/span> git config user.name &lt;span class="s2">&amp;#34;Victoria via GitHub Actions&amp;#34;&lt;/span> &lt;span class="se">\
&lt;/span>&lt;span class="se">&lt;/span> &lt;span class="o">&amp;amp;&amp;amp;&lt;/span> git add . &lt;span class="se">\
&lt;/span>&lt;span class="se">&lt;/span> &lt;span class="o">&amp;amp;&amp;amp;&lt;/span> git status &lt;span class="se">\
&lt;/span>&lt;span class="se">&lt;/span> &lt;span class="o">&amp;amp;&amp;amp;&lt;/span> git commit -m &lt;span class="s2">&amp;#34; CD bot is helping&amp;#34;&lt;/span> &lt;span class="se">\
&lt;/span>&lt;span class="se">&lt;/span> &lt;span class="o">&amp;amp;&amp;amp;&lt;/span> git push -f -q https://&lt;span class="k">$(&lt;/span>TOKEN&lt;span class="k">)&lt;/span>@github.com/victoriadrake/victoriadrake.github.io.git master
@echo &lt;span class="s2">&amp;#34; Site is deployed!&amp;#34;&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>Sequentially, this workflow:&lt;/p>
&lt;ol>
&lt;li>Clones the public Pages repository;&lt;/li>
&lt;li>Cleans (deletes) the previous build files;&lt;/li>
&lt;li>Downloads and installs the specified version of Hugo, if Hugo is not already present;&lt;/li>
&lt;li>Builds the site;&lt;/li>
&lt;li>Optimizes images;&lt;/li>
&lt;li>Tests the built site with HTMLProofer, and&lt;/li>
&lt;li>Prepares a new commit and pushes to the public Pages repository.&lt;/li>
&lt;/ol>
&lt;p>If you&amp;rsquo;re familiar with command line, most of this may look familiar. Here are a couple bits that might warrant a little explanation.&lt;/p>
&lt;h3 id="checking-if-a-program-is-already-installed" class="anchor-link">&lt;a href="#checking-if-a-program-is-already-installed">Checking if a program is already installed&lt;/a>&lt;/h3>
&lt;p>I think this bit is pretty tidy:&lt;/p>
&lt;div class="highlight">&lt;pre class="chroma">&lt;code class="language-sh" data-lang="sh">&lt;span class="k">if&lt;/span> ! &lt;span class="o">[&lt;/span> -x &lt;span class="s2">&amp;#34;&lt;/span>&lt;span class="nv">$$&lt;/span>&lt;span class="s2">(command -v hugo)&amp;#34;&lt;/span> &lt;span class="o">]&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="k">then&lt;/span>&lt;span class="se">\
&lt;/span>&lt;span class="se">&lt;/span>...
&lt;span class="k">fi&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>I use a negated &lt;code>if&lt;/code> conditional in conjunction with &lt;code>command -v&lt;/code> to check if an executable (&lt;code>-x&lt;/code>) called &lt;code>hugo&lt;/code> exists. If one is not present, the script gets the specified version of Hugo and installs it. &lt;a href="https://stackoverflow.com/a/677212">This Stack Overflow answer&lt;/a> has a nice summation of why &lt;code>command -v&lt;/code> is a more portable choice than &lt;code>which&lt;/code>.&lt;/p>
&lt;h3 id="image-optimization" class="anchor-link">&lt;a href="#image-optimization">Image optimization&lt;/a>&lt;/h3>
&lt;p>My Makefile uses &lt;code>mogrify&lt;/code> to batch resize and compress images in particular folders. It finds them automatically using the file extension, and only modifies images that are larger than the target size of 1000px in any dimension. I wrote more about the &lt;a href="https://victoria.dev/blog/how-to-quickly-batch-resize-compress-and-convert-images-with-a-bash-one-liner/">batch-processing one-liner in this post&lt;/a>.&lt;/p>
&lt;p>There are a few different ways to achieve this same task, one of which, theoretically, is to take advantage of Make&amp;rsquo;s &lt;a href="https://en.wikipedia.org/wiki/Make_(software)#Suffix_rules">suffix rules&lt;/a> to run commands only on image files. I find the shell script to be more readable.&lt;/p>
&lt;h3 id="using-dockerized-htmlproofer" class="anchor-link">&lt;a href="#using-dockerized-htmlproofer">Using Dockerized HTMLProofer&lt;/a>&lt;/h3>
&lt;p>HTMLProofer is installed with &lt;code>gem&lt;/code>, and uses Ruby and &lt;a href="https://nokogiri.org/tutorials/ensuring_well_formed_markup.html">Nokogiri&lt;/a>, which adds up to a lot of installation time for a CI workflow. Thankfully, &lt;a href="https://github.com/18F">18F&lt;/a> has a &lt;a href="https://github.com/18F/html-proofer-docker">Dockerized version&lt;/a> that is much faster to implement. Its usage requires starting the container with the built site directory &lt;a href="https://docs.docker.com/storage/volumes/#start-a-container-with-a-volume">mounted as a data volume&lt;/a>, which is easily achieved by appending to the &lt;code>docker run&lt;/code> command.&lt;/p>
&lt;div class="highlight">&lt;pre class="chroma">&lt;code class="language-sh" data-lang="sh">docker run -v /absolute/path/to/site/:/mounted-site 18fgsa/html-proofer /mounted-site
&lt;/code>&lt;/pre>&lt;/div>&lt;p>In my Makefile, I specify the absolute site path using the &lt;a href="https://help.github.com/en/articles/virtual-environments-for-github-actions#environment-variables">default environment variable&lt;/a> &lt;code>GITHUB_WORKSPACE&lt;/code>. I&amp;rsquo;ll dive into this and other GitHub Actions features in the next post.&lt;/p>
&lt;p>In the meantime, happy Making!&lt;/p></content:encoded><enclosure url="https://victoria.dev/blog/a-portable-makefile-for-continuous-delivery-with-hugo-and-github-pages/cover_hu9d9ed8ea95bbaa69b5034cdaef6f2293_689918_640x0_resize_box_2.png" type="image/jpg"/></item><item><title>How to quickly batch resize, compress, and convert images with a Bash one-liner</title><link>https://victoria.dev/blog/how-to-quickly-batch-resize-compress-and-convert-images-with-a-bash-one-liner/</link><pubDate>Mon, 14 Oct 2019 08:27:49 -0400</pubDate><author>hello@victoria.dev (Victoria Drake)</author><guid>https://victoria.dev/blog/how-to-quickly-batch-resize-compress-and-convert-images-with-a-bash-one-liner/</guid><description>A fast command line interface solution for batch image processing.</description><content:encoded>
&lt;img src="https://victoria.dev/blog/how-to-quickly-batch-resize-compress-and-convert-images-with-a-bash-one-liner/cover_hud69be56925ea18eef655f06e008202c3_854420_640x0_resize_box_2.png" width="640" height="345"/>
&lt;p>Part of my Hugo site continuous deployment workflow is the processing of 210 images, at time of writing.&lt;/p>
&lt;p>Here&amp;rsquo;s my one-liner:&lt;/p>
&lt;div class="highlight">&lt;pre class="chroma">&lt;code class="language-sh" data-lang="sh">find public/ -not -path &lt;span class="s2">&amp;#34;*/static/*&amp;#34;&lt;/span> &lt;span class="se">\(&lt;/span> -name &lt;span class="s1">&amp;#39;*.png&amp;#39;&lt;/span> -o -name &lt;span class="s1">&amp;#39;*.jpg&amp;#39;&lt;/span> -o -name &lt;span class="s1">&amp;#39;*.jpeg&amp;#39;&lt;/span> &lt;span class="se">\)&lt;/span> -print0 &lt;span class="p">|&lt;/span> xargs -0 -P8 -n2 mogrify -strip -thumbnail &lt;span class="s1">&amp;#39;1000&amp;gt;&amp;#39;&lt;/span> -format jpg
&lt;/code>&lt;/pre>&lt;/div>&lt;p>I use &lt;code>find&lt;/code> to target only certain image file formats in certain directories. With &lt;a href="https://www.imagemagick.org/script/mogrify.php">&lt;code>mogrify&lt;/code>, part of ImageMagick&lt;/a>, I resize only the images that are larger than a certain dimension, compress them, and strip the metadata. I tack on the &lt;code>format&lt;/code> flag to create jpg copies of the images.&lt;/p>
&lt;p>Here&amp;rsquo;s the one-liner again (broken up for better reading):&lt;/p>
&lt;div class="highlight">&lt;pre class="chroma">&lt;code class="language-sh" data-lang="sh">&lt;span class="c1"># Look in the public/ directory&lt;/span>
find public/ &lt;span class="se">\
&lt;/span>&lt;span class="se">&lt;/span>&lt;span class="c1"># Ignore directories called &amp;#34;static&amp;#34; regardless of location&lt;/span>
-not -path &lt;span class="s2">&amp;#34;*/static/*&amp;#34;&lt;/span> &lt;span class="se">\
&lt;/span>&lt;span class="se">&lt;/span>&lt;span class="c1"># Print the file paths of all files ending with any of these extensions&lt;/span>
&lt;span class="se">\(&lt;/span> -name &lt;span class="s1">&amp;#39;*.png&amp;#39;&lt;/span> -o -name &lt;span class="s1">&amp;#39;*.jpg&amp;#39;&lt;/span> -o -name &lt;span class="s1">&amp;#39;*.jpeg&amp;#39;&lt;/span> &lt;span class="se">\)&lt;/span> -print0 &lt;span class="se">\
&lt;/span>&lt;span class="se">&lt;/span>&lt;span class="c1"># Pipe the file paths to xargs and use 8 parallel workers to process 2 arguments&lt;/span>
&lt;span class="p">|&lt;/span> xargs -0 -P8 -n2 &lt;span class="se">\
&lt;/span>&lt;span class="se">&lt;/span>&lt;span class="c1"># Tell mogrify to strip metadata, and...&lt;/span>
mogrify -strip &lt;span class="se">\
&lt;/span>&lt;span class="se">&lt;/span>&lt;span class="c1"># ...compress and resize any images larger than the target size (1000px in either dimension)&lt;/span>
-thumbnail &lt;span class="s1">&amp;#39;1000&amp;gt;&amp;#39;&lt;/span> &lt;span class="se">\
&lt;/span>&lt;span class="se">&lt;/span>&lt;span class="c1"># Convert the files to jpg format&lt;/span>
-format jpg
&lt;/code>&lt;/pre>&lt;/div>&lt;p>That&amp;rsquo;s it. That&amp;rsquo;s the post.&lt;/p></content:encoded><enclosure url="https://victoria.dev/blog/how-to-quickly-batch-resize-compress-and-convert-images-with-a-bash-one-liner/cover_hud69be56925ea18eef655f06e008202c3_854420_640x0_resize_box_2.png" type="image/jpg"/></item><item><title>Secure application architecture basics: separation, configuration, and access</title><link>https://victoria.dev/blog/secure-application-architecture-basics-separation-configuration-and-access/</link><pubDate>Mon, 30 Sep 2019 08:03:12 -0400</pubDate><author>hello@victoria.dev (Victoria Drake)</author><guid>https://victoria.dev/blog/secure-application-architecture-basics-separation-configuration-and-access/</guid><description>A starting point for building secure application architecture, for busy developers.</description><content:encoded>
&lt;img src="https://victoria.dev/blog/secure-application-architecture-basics-separation-configuration-and-access/cover_hu73e92637aebb1682b96cf0460f9cc452_2063427_640x0_resize_box_2.png" width="640" height="443"/>
&lt;p>Software developers today are encouraged to focus on building, and that&amp;rsquo;s a great thing. We&amp;rsquo;re benefitting from maker culture, an attitude of &amp;ldquo;always be shipping,&amp;rdquo; open source collaboration, and a bevy of apps that help us prioritize and execute with maximum efficiency. We&amp;rsquo;re in an environment of constant creation, where both teams and solo entrepreneurs can be maximally productive.&lt;/p>
&lt;p>Sometimes, this breakneck-speed productivity shows its downsides.&lt;/p>
&lt;p>As I learn more about security best practices, I can&amp;rsquo;t help but see more and more applications that just don&amp;rsquo;t have a clue. A lack of awareness of security seems to lead to a lack of prioritization of tasks that don&amp;rsquo;t directly support bringing the product to launch. The market seems to have made it more important to launch a usable product than a secure one, with the prevailing attitude being, &amp;ldquo;we can do the security stuff later.&amp;rdquo;&lt;/p>
&lt;p>Cobbling together a foundation based more on expediency than longevity is a bad way to build applications and a great way to build security debt. Security debt, like technical debt, amasses when developers make (usually hasty) decisions that can make it more difficult to secure the application later on. If you&amp;rsquo;re familiar with the concept of &amp;ldquo;pushing left&amp;rdquo; (or if you read my &lt;a href="https://victoria.dev/blog/hackers-are-googling-your-plain-text-passwords-preventing-sensitive-data-exposure/">article about sensitive data exposure&lt;/a>), you&amp;rsquo;ll know that when it comes to security, sometimes there isn&amp;rsquo;t a version of &amp;ldquo;later&amp;rdquo; that isn&amp;rsquo;t &lt;em>too&lt;/em> late. It&amp;rsquo;s a shame, especially since following some basic security practices with high benefit yield early on in the development process doesn&amp;rsquo;t take significantly more time than &lt;em>not&lt;/em> following them. Often, it comes down to having some basic but important knowledge that enables making the more secure decision.&lt;/p>
&lt;p>While application architecture specifics vary, there are a few basic principles we can commonly apply. This article will provide a high-level overview of areas that I hope will help point developers in the right direction.&lt;/p>
&lt;p>There must be a reason we call it application &amp;ldquo;architecture.&amp;rdquo; I like to think it&amp;rsquo;s because the architecture of software is similar in some basic ways to the architecture of a building. (Or at least, in my absolute zero building-creation expertise, how I imagine a pretty utilitarian building to be.) Here&amp;rsquo;s how I like to summarize three basic points of building secure application architecture:&lt;/p>
&lt;ol>
&lt;li>Separated storage&lt;/li>
&lt;li>Customized configuration&lt;/li>
&lt;li>Controlled access and user scope&lt;/li>
&lt;/ol>
&lt;p>This is only a jumping-off point meant to get us started on the right foot; a complete picture of a fully-realized application&amp;rsquo;s security posture includes areas outside the scope of this post, including authentication, logging and monitoring, integration, and sometimes compliance.&lt;/p>
&lt;h2 id="1-separated-storage" class="anchor-link">&lt;a href="#1-separated-storage">1. Separated storage&lt;/a>&lt;/h2>
&lt;p>From a security standpoint, the concept of separation refers to storing files that serve different purposes in different places. When we&amp;rsquo;re constructing our building and deciding where all the rooms go, we similarly create the lobby on the ground floor and place administrative offices on higher floors, perhaps off the main path. While both are rooms, we understand that they serve different purposes, have different functional needs, and possibly very different security requirements.&lt;/p>
&lt;p>
&lt;img src="https://victoria.dev/blog/secure-application-architecture-basics-separation-configuration-and-access/separation.png" alt="Separation of building floors" />
&lt;/p>
&lt;p>When it comes to our files, the benefit is perhaps easiest for us to understand if we consider a simple file structure:&lt;/p>
&lt;div class="highlight">&lt;pre class="chroma">&lt;code class="language-txt" data-lang="txt">application/
html/
 index.html
assets/
 images/
  rainbows.jpg
  unicorns.jpg
 style.css
super-secret-configurations/
master-keys.txt
&lt;/code>&lt;/pre>&lt;/div>&lt;p>In our simplified example, let&amp;rsquo;s say that all our application&amp;rsquo;s images are stored in the &lt;code>application/assets/images/&lt;/code> directory. When one of our users creates a profile and uploads their picture to it, this picture is also stored in this folder. Makes sense, right? It&amp;rsquo;s an image, and that&amp;rsquo;s where the images go. What&amp;rsquo;s the issue?&lt;/p>
&lt;p>If you&amp;rsquo;re familiar with navigating a file structure in a terminal, you may have seen this syntax before: &lt;code>../../&lt;/code>. The two dots are a handy way of saying, &amp;ldquo;go up one directory.&amp;rdquo; If we execute the command &lt;code>cd ../../&lt;/code> in the &lt;code>images/&lt;/code> directory of our simple file structure above, we&amp;rsquo;d go up into &lt;code>assets/&lt;/code>, then up again to the root directory, &lt;code>application/&lt;/code>. This is a problem because of a wee little vulnerability dubbed &lt;a href="https://cwe.mitre.org/data/definitions/22.html">path traversal&lt;/a>.&lt;/p>
&lt;p>While the dot syntax saves us some typing, it also introduces the interesting advantage of not actually needing to know what the parent directory is called in order to go to it. Consider an attack payload script, delivered into the &lt;code>images/&lt;/code> folder of our insecure application, that went up one directory using &lt;code>cd ../&lt;/code> and then sent everything it found to the attacker, on repeat. Eventually, it would reach the root application directory and access the &lt;code>super-secret-configurations/&lt;/code> folder. Not good.&lt;/p>
&lt;p>While other measures should be in place to prevent path traversal and related user upload vulnerabilities, the simplest prevention by far is a separation of storage. Core application files and assets should not be combined with other data, and especially not with &lt;a href="https://victoria.dev/blog/sql-injection-and-xss-what-white-hat-hackers-know-about-trusting-user-input/">user input&lt;/a>. It&amp;rsquo;s best to keep user-uploaded files and activity logs (which may contain juicy data and can be vulnerable to injection attacks) separate from the main application.&lt;/p>
&lt;p>Separation can be achieved in a few ways, such as by using a different server, different instance, separate IP range, or separate domain.&lt;/p>
&lt;h2 id="2-customized-configuration" class="anchor-link">&lt;a href="#2-customized-configuration">2. Customized configuration&lt;/a>&lt;/h2>
&lt;p>While wasting time on customization can hinder productivity, one area that we definitely want to customize is configuration settings. &lt;a href="https://github.com/OWASP/Top10/blob/cb5f8967bba106e14a350761ac4f93b8aec7f8fa/2017/en/0xa6-security-misconfiguration.md">Security misconfiguration&lt;/a> is listed in the OWASP Top 10. A significant number of security incidents occur because a server, firewall, or administrative account is running in production with default settings. Upon the opening of our new building, we&amp;rsquo;d hopefully be more careful to ensure we haven&amp;rsquo;t left any keys in the locks.&lt;/p>
&lt;p>
&lt;img src="https://victoria.dev/blog/secure-application-architecture-basics-separation-configuration-and-access/defaultkey.png" alt="Three keys" />
&lt;/p>
&lt;p>Usually, the victims of attacks related to default settings aren&amp;rsquo;t specifically targeted. Rather, they are found by automated scanning tools that attackers run over many possible targets, effectively prodding at many different systems to see if any roll over and expose some useful exploit. The automated nature of this attack means that it&amp;rsquo;s important for us to review settings for every piece of our architecture. Even if an individual piece doesn&amp;rsquo;t seem significant, it may provide a vulnerability that allows an attacker to use it as a gateway to our larger application.&lt;/p>
&lt;p>In particular, examine architecture components for unattended areas such as:&lt;/p>
&lt;ul>
&lt;li>Default accounts, especially with default passwords, left in service;&lt;/li>
&lt;li>Example web pages, tutorial applications, or sample data left in the application;&lt;/li>
&lt;li>Unnecessary ports left in service, or ports left open to the Internet;&lt;/li>
&lt;li>Unrestricted permitted HTTP methods;&lt;/li>
&lt;li>Sensitive information stored in automated logs;&lt;/li>
&lt;li>Default configured permissions in managed services; and,&lt;/li>
&lt;li>Directory listings, or sensitive file types, left accessible by default.&lt;/li>
&lt;/ul>
&lt;p>This list isn&amp;rsquo;t exhaustive. Specific architecture components, such as cloud storage or web servers, will have other configurable features that should be reviewed. In general, reduce the application&amp;rsquo;s attack surface by using minimal architecture components. If we use fewer components or don&amp;rsquo;t install modules we don&amp;rsquo;t need, we&amp;rsquo;ll have fewer possible attack entry points to configure and safeguard.&lt;/p>
&lt;h2 id="3-controlled-access-and-user-scope" class="anchor-link">&lt;a href="#3-controlled-access-and-user-scope">3. Controlled access and user scope&lt;/a>&lt;/h2>
&lt;p>One of the more difficult security problems to test in an application is misconfigured access control. Automated testing tools have limited capability to find areas of an application that one user shouldn&amp;rsquo;t be able to access. Thus, this is often left to manual testing or source code review to discover. By considering this vulnerability early on in the software development lifecycle when architectural decisions are being made, we reduce the risk that it becomes a problem that&amp;rsquo;s harder to fix later. After all, we wouldn&amp;rsquo;t simply leave our master keys out of reach on a high ledge and hope no one comes along with a ladder.&lt;/p>
&lt;p>
&lt;img src="https://victoria.dev/blog/secure-application-architecture-basics-separation-configuration-and-access/access.png" alt="A cartoon of a user attempting to elevate privilege" />
&lt;/p>
&lt;p>&lt;a href="https://github.com/OWASP/Top10/blob/master/2017/en/0xa5-broken-access-control.md">Broken access control&lt;/a> is listed in the OWASP Top 10, which goes into more detail on its various forms. As a simple example, consider an application with two levels of access: administrators, and users. We want to build a new feature - the ability to moderate or ban users - with the intention that only administrators would be allowed to use it.&lt;/p>
&lt;p>If we&amp;rsquo;re aware of the possibility of access control misconfigurations or exploits, we may decide to build the moderation feature in a completely separate area from the user-accessible space, such as on a different domain, or as part of a model that users don&amp;rsquo;t share. This greatly reduces the risk that an access control misconfiguration or elevation of privilege vulnerability might allow a user to improperly access the moderation feature later on.&lt;/p>
&lt;p>Of course, robust access control in our application needs more support to be effective. Consider factors such as sensitive tokens, or keys passed as URL parameters, or whether a control fails securely or insecurely. Nevertheless, by considering authorization at the architectural stage, we can set ourselves up to make further reinforcements easier to implement.&lt;/p>
&lt;h2 id="security-basics-for-maximum-benefit" class="anchor-link">&lt;a href="#security-basics-for-maximum-benefit">Security basics for maximum benefit&lt;/a>&lt;/h2>
&lt;p>Similar to avoiding racking up technical debt by choosing a well-vetted framework, developers can avoid security debt by becoming aware of common vulnerabilities and the simple architectural decisions we can make to help mitigate them. For a much more detailed resource on how to bake security into our applications from the start, the &lt;a href="https://github.com/OWASP/ASVS">OWASP Application Security Verification Standard&lt;/a> is a robust guide.&lt;/p></content:encoded><enclosure url="https://victoria.dev/blog/secure-application-architecture-basics-separation-configuration-and-access/cover_hu73e92637aebb1682b96cf0460f9cc452_2063427_640x0_resize_box_2.png" type="image/jpg"/></item><item><title>Migrating to the cloud but without screwing it up, or how to move house</title><link>https://victoria.dev/blog/migrating-to-the-cloud-but-without-screwing-it-up-or-how-to-move-house/</link><pubDate>Mon, 23 Sep 2019 08:03:12 -0400</pubDate><author>hello@victoria.dev (Victoria Drake)</author><guid>https://victoria.dev/blog/migrating-to-the-cloud-but-without-screwing-it-up-or-how-to-move-house/</guid><description>A practical guide to moving to cloud services with minimal downtime, using AWS examples.</description><content:encoded>
&lt;img src="https://victoria.dev/blog/migrating-to-the-cloud-but-without-screwing-it-up-or-how-to-move-house/cover_hu9516d7166362a6834fd7ca185e602fb0_827135_640x0_resize_box_2.png" width="640" height="468"/>
&lt;p>For an application that&amp;rsquo;s ready to scale, not using managed cloud architecture these days is like insisting on digging your own well for water. It&amp;rsquo;s far more labour-intensive, requires buying all your own equipment, takes a lot more time, and there&amp;rsquo;s a higher chance you&amp;rsquo;re going to get it wrong because you don&amp;rsquo;t personally have a whole lot of experience digging wells, anyway.&lt;/p>
&lt;p>That said - let&amp;rsquo;s just get this out of the way first - there is no cloud. It&amp;rsquo;s just someone else&amp;rsquo;s computer.&lt;/p>
&lt;p>Of course, these days, cloud services go far beyond the utility we&amp;rsquo;d expect from a single computer. Besides being able to quickly set up and utilize the kind of computing power that previously required a new office lease agreement to house, there are now a multitude of monitoring, management, and analysis tools at our giddy fingertips. While it&amp;rsquo;s important to understand that the cloud isn&amp;rsquo;t a better option in every case, for applications that can take advantage of it, we can do more, do it faster, and do it for less money than if we were to insist on building our own on-premises infrastructure.&lt;/p>
&lt;p>That&amp;rsquo;s all great, and easily said; moving to the cloud, however, can look from the outset like a pretty daunting task. How, exactly, do we go about shifting what may be years of on-premises data and built-up systems to &lt;em>someone else&amp;rsquo;s computer?&lt;/em> You know, without being able to see it, touch it, and without completely screwing up our stuff.&lt;/p>
&lt;p>While it probably takes less work and money than setting up or maintaining the same architecture on-premise, it does take some work to move to the cloud initially. It&amp;rsquo;s important that our application is prepared to migrate, and capable of using the benefits of cloud services once it gets there. To accomplish this, and a smooth transition, preparation is key. In fact, it&amp;rsquo;s a whole lot like moving to a new house.&lt;/p>
&lt;p>In this article, we&amp;rsquo;ll take a high-level look at the general stages of taking an on-premise or self-hosted application and moving it to the cloud. This guide is meant to serve as a starting point for designing the appropriate process for your particular situation, and to enable you to better understand the cloud migration process. While cloud migration may not be the best choice for some applications - such as ones without scalable architecture or where very high computing resources are needed - a majority of modular and modern applications stand to benefit from a move to the cloud.&lt;/p>
&lt;p>It&amp;rsquo;s certainly possible, as I discovered at a recent event put on by &lt;a href="https://aws.amazon.com/">Amazon Web Services&lt;/a> (AWS) Solutions Architects, to migrate smoothly and efficiently, with near-zero loss of availability to customers. I&amp;rsquo;ll specifically reference some services provided by AWS, however, similar functionality can be found with other cloud providers. I&amp;rsquo;ve found the offerings from AWS to be pleasantly modular in scope, which is why I use them myself and why they make good examples for discussing general concepts.&lt;/p>
&lt;p>To have our move go as smoothly as possible, here are the things we&amp;rsquo;ll want to consider:&lt;/p>
&lt;ol>
&lt;li>The type of move we&amp;rsquo;re making;&lt;/li>
&lt;li>The things we&amp;rsquo;ll take, and the things we&amp;rsquo;ll clean up;&lt;/li>
&lt;li>How to choose the right type and size for the infrastructure we&amp;rsquo;re moving into; and&lt;/li>
&lt;li>How to do test runs to practice for the big day.&lt;/li>
&lt;/ol>
&lt;h2 id="the-type-of-move-were-making" class="anchor-link">&lt;a href="#the-type-of-move-were-making">The type of move we&amp;rsquo;re making&lt;/a>&lt;/h2>
&lt;p>While it&amp;rsquo;s important to understand why we&amp;rsquo;re moving our application to cloud services, we should also have an idea of what we&amp;rsquo;d like it to look like when it gets there. There are three main ways to move to the cloud: re-host, re-platform, or re-factor.&lt;/p>
&lt;h3 id="re-host" class="anchor-link">&lt;a href="#re-host">Re-host&lt;/a>&lt;/h3>
&lt;p>A re-host scenario is the the most straightforward type of move. It involves no change to the way our application is built or how it runs. For example, if we currently have Python code, use PostgreSQL, and serve our application with Apache, a re-host move would mean we use all the same components, combined in just the same way, only now they&amp;rsquo;re in the cloud. It&amp;rsquo;s a lot like moving into a new house that has the exact same floor plan as the current one. All the furniture goes into the same room it&amp;rsquo;s in now, and it&amp;rsquo;s going to feel pretty familiar when we get there.&lt;/p>
&lt;p>The main draw of a re-host move is that it may offer the least amount of complication necessary in order to take advantage of going to the cloud. Scalable applications, for example, can gain the ability to automatically manage necessary application resources.&lt;/p>
&lt;p>While re-hosting makes scaling more automatic, it&amp;rsquo;s important to note that it won&amp;rsquo;t in itself make an application scalable. If the application infrastructure is not organized in such a way that gives it the ability to scale, a re-factor may be necessary instead.&lt;/p>
&lt;h3 id="re-platform" class="anchor-link">&lt;a href="#re-platform">Re-platform&lt;/a>&lt;/h3>
&lt;p>If a component of our current application set up isn&amp;rsquo;t working out well for us, we&amp;rsquo;re probably going to want to re-platform. In this case, we&amp;rsquo;re making a change to at least one component of our architecture; for example, switching our database from Oracle to MySQL on &lt;a href="https://aws.amazon.com/rds/">Amazon Relational Database Service&lt;/a> (RDS).&lt;/p>
&lt;p>Like moving from a small apartment in Tokyo to an equally small apartment in New York, a re-platform doesn&amp;rsquo;t change the basic nature of our application, but does change its appearance and environment. In the database change example, we&amp;rsquo;ll have all the same data, just organized or formatted a little differently. In most cases, we won&amp;rsquo;t have to make these changes manually. A tool such as &lt;a href="https://aws.amazon.com/dms/">Amazon Database Migration Service&lt;/a> (DMS) can help to seamlessly shift our data over to the new database.&lt;/p>
&lt;p>We might re-platform in order to enable us to better meet a business demand in the future, such as scaling up, integrating with other technological components, or choosing a more modern technology stack.&lt;/p>
&lt;h3 id="re-factor" class="anchor-link">&lt;a href="#re-factor">Re-factor&lt;/a>&lt;/h3>
&lt;p>A move in which we re-factor our application is necessarily more complicated than our other options, however, it may provide the most overall benefit for companies or applications that have reason to make this type of move. As with code, refactoring is done when fundamental changes need to be made in order for our application to meet a business need. The specifics necessarily differ case-by-case, but typically involve changes to architectural components or how those components relate to one another. This type of move may also involve changing application code in order to optimize the application&amp;rsquo;s performance in a cloud environment. We can think of it like moving out from our parent&amp;rsquo;s basement in the suburbs and getting a nice townhouse in the city. There&amp;rsquo;s no way we&amp;rsquo;re taking that ancient hand-me-down sofa, so we&amp;rsquo;ll need some new furniture, and for our neighbour&amp;rsquo;s sake, probably window dressings.&lt;/p>
&lt;p>Refactoring may enable us to modernize a dated application, or make it more efficient in general. With greater efficiency, we can better take advantage of services that cloud providers typically offer, like bursting resources or attaining deep analytical insight.&lt;/p>
&lt;p>If a re-factor is necessary but time is scarce, it may be better to re-host or re-platform first, then re-factor later. That way, we&amp;rsquo;ll have a job well done later instead of a hasty, botched migration (and more problems) sooner.&lt;/p>
&lt;h2 id="what-to-take-and-what-to-clean-up" class="anchor-link">&lt;a href="#what-to-take-and-what-to-clean-up">What to take, and what to clean up&lt;/a>&lt;/h2>
&lt;p>Over the years of living in one place, stuff tends to pile up unnoticed in nooks and crannies. When moving house, it&amp;rsquo;s usually a great opportunity to sort everything out and decide what is useful enough to keep, and what should be discarded or given away. Moving to the cloud is a similarly great opportunity to do the same when it comes to our application.&lt;/p>
&lt;p>While cloud storage is inexpensive nowadays, there may be some things that don&amp;rsquo;t make sense to store any longer, or at least not keep stored with our primary application. If data cannot be discarded due to policy or regulations, we may choose a different storage class to house data that we don&amp;rsquo;t expect to need anytime soon outside of our main application.&lt;/p>
&lt;p>In the case of &lt;a href="https://aws.amazon.com/s3/">Amazon&amp;rsquo;s Simple Storage Service&lt;/a> (S3), we can choose to use different &lt;a href="https://aws.amazon.com/s3/storage-classes/">storage classes&lt;/a> that accomplish this goal. While the data that our business relies on every day can take advantage of the Standard class 99.99% availability, data meant for long-term cold storage such as archival backups can be put into the Glacier class, which has longer retrieval time and lower cost.&lt;/p>
&lt;h2 id="the-right-type-and-size" class="anchor-link">&lt;a href="#the-right-type-and-size">The right type and size&lt;/a>&lt;/h2>
&lt;p>Choosing the type and size of cloud infrastructure appropriate for our business is usually the part that can be the most confusing. How should we predict, in a new environment or for a growing company, the computing power we&amp;rsquo;ll need?&lt;/p>
&lt;p>Part of the beauty of not procuring hardware on our own is that won&amp;rsquo;t have to make predictions like these. Using cloud storage and instances, expanding or scaling back resources can be done in a matter of minutes, sometimes seconds. With managed services, it can even be done automatically for us. With the proper support for scalability in our application, it&amp;rsquo;s like having a magical house that instantly generates any type of room and amenity we need at that moment. The ability to continually ensure that we&amp;rsquo;re using appropriate, cost-effective resources is at our fingertips, and often clearly visualized in charts and dashboards.&lt;/p>
&lt;p>For applications new to the cloud, some leeway for experimentation may be necessary. While cloud services enables us to quickly spin up and try out different architectures, there&amp;rsquo;s no guarantee that all of those set ups will work well for our application. For example, running a single instance may be &lt;a href="http://einaregilsson.com/serverless-15-percent-slower-and-eight-times-more-expensive/">less expensive than going serverless&lt;/a>, but we&amp;rsquo;d be hard pressed to know this until we tried it out.&lt;/p>
&lt;p>As a starting point, we simply need enough storage and computing power to support the application as it is currently running, today. For example, in the case of storage, consider the size of the current database - the actual database data, not the total storage capacity of hardware on-premises. For a detailed cost exploration, AWS even offers a &lt;a href="https://calculator.s3.amazonaws.com/index.html">Simple Monthly Calculator&lt;/a> with use case samples to help guide expectations.&lt;/p>
&lt;h2 id="do-test-runs-before-the-big-day" class="anchor-link">&lt;a href="#do-test-runs-before-the-big-day">Do test runs before the big day&lt;/a>&lt;/h2>
&lt;p>Running a trial cloud migration may be an odd concept, but it is an essential component to ensuring that the move goes as planned with minimal service interruption. Imagine the time and energy that would be saved in the moving house example if we could automate test runs! Invariably, some box or still-hung picture is forgotten and left out of the main truck, necessitating additional trips in other vehicles. With multiple chances to ensure we&amp;rsquo;ve got it down pat, we minimize the possibility that our move causes any break in normal day-to-day business.&lt;/p>
&lt;p>Generally, to do a test run, we create a duplicate version of our application. The more we can duplicate, the more thorough the test run will be, especially if our data is especially large. Though duplication may seem tedious, working with the actual components we intend to migrate is essential to ensuring the migration goes as planned. After all, if we only did a moving-house test run with one box, it wouldn&amp;rsquo;t be very representative.&lt;/p>
&lt;p>Test runs can help to validate our migration plan against any challenges we may encounter. These challenges might include:&lt;/p>
&lt;ul>
&lt;li>Downtime restrictions;&lt;/li>
&lt;li>Encrypting data in transit and immediately when at rest on the target;&lt;/li>
&lt;li>Schema conversion to a new target schema (the &lt;a href="https://aws.amazon.com/dms/schema-conversion-tool/">AWS Schema Conversion Tool&lt;/a> can also help);&lt;/li>
&lt;li>Access to databases, such as through firewalls or VPNs;&lt;/li>
&lt;li>Developing a process to ensure that all the data successfully migrated, such as by using a hash function.&lt;/li>
&lt;/ul>
&lt;p>Test runs also help to give us a more accurate picture of the overall time that a migration will take, as well as affording us the opportunity to fine-tune it. Factors that may affect the overall speed of a migration include:&lt;/p>
&lt;ul>
&lt;li>The sizes of the source and target instances;&lt;/li>
&lt;li>Available bandwidth for moving data;&lt;/li>
&lt;li>Schema configurations; and&lt;/li>
&lt;li>Transaction pressure on the source, such as changes to the data and the volume of incoming transactions.&lt;/li>
&lt;/ul>
&lt;p>Once the duplicate application has been migrated via one or more &lt;a href="https://aws.amazon.com/cloud-data-migration/">options&lt;/a>, we test the heck out of the application that&amp;rsquo;s now running in the cloud to ensure it performs as expected. Ideally, on the big day, we&amp;rsquo;d follow this same general process to move up-to-date duplicate data, and then seamlessly point the &amp;ldquo;real&amp;rdquo; application or web address to the new location in the cloud. This means that our customers experience near-zero downtime; essentially, only the amount of time that the change in location-pointing would need to propagate to their device.&lt;/p>
&lt;p>In the case of very large or complex applications with many components or many teams working together at the same time, a more gradual approach may be more appropriate than the &amp;ldquo;Big Bang&amp;rdquo; approach, and may help to mitigate risk of any interruptions. This means migrating in stages, component by component, and running tests between stages to ensure that all parts of the application are communicating with each other as expected.&lt;/p>
&lt;h2 id="preparation-is-essential-to-a-smooth-migration" class="anchor-link">&lt;a href="#preparation-is-essential-to-a-smooth-migration">Preparation is essential to a smooth migration&lt;/a>&lt;/h2>
&lt;p>I hope this article has enabled a more practical understanding of how cloud migration can be achieved. With thorough preparation, it&amp;rsquo;s possible to take advantage of all the cloud has to offer, with minimal hassle to get there.&lt;/p>
&lt;p>My thanks to the AWS Solutions Architects who presented at Pop-Up Loft and shared their knowledge on these topics, in particular: Chandra Kapireddy, Stephen Moon, John Franklin, Michael Alpaugh, and Priyanka Mahankali.&lt;/p>
&lt;p>One last nugget of wisdom, courtesy of John: &amp;ldquo;Friends don&amp;rsquo;t let friends use DMS to create schema objects.&amp;rdquo;&lt;/p></content:encoded><enclosure url="https://victoria.dev/blog/migrating-to-the-cloud-but-without-screwing-it-up-or-how-to-move-house/cover_hu9516d7166362a6834fd7ca185e602fb0_827135_640x0_resize_box_2.png" type="image/jpg"/></item><item><title>How users and applications stay safe on the Internet: it's proxy servers all the way down</title><link>https://victoria.dev/blog/how-users-and-applications-stay-safe-on-the-internet-its-proxy-servers-all-the-way-down/</link><pubDate>Mon, 16 Sep 2019 09:35:28 -0400</pubDate><author>hello@victoria.dev (Victoria Drake)</author><guid>https://victoria.dev/blog/how-users-and-applications-stay-safe-on-the-internet-its-proxy-servers-all-the-way-down/</guid><description>An overview of how proxy servers form the basis of online anonymity, and how their use in various forms helps both users and web applications.</description><content:encoded>
&lt;img src="https://victoria.dev/blog/how-users-and-applications-stay-safe-on-the-internet-its-proxy-servers-all-the-way-down/cover_hua9810ca0d5d352b6afac9eae7c2c33fc_779068_640x0_resize_box_2.png" width="640" height="480"/>
&lt;p>Both Internet users and Internet-connected applications can benefit from investing in cybersecurity. One core aspect of online privacy is the use of a proxy server, though this basic building block may not be initially visible underneath its more recognizable forms. Proxy servers are a useful thing to know about nowadays, for developers, software product owners, as well as the average dog on the Internet. Let&amp;rsquo;s explore what makes proxy servers an important piece of cybersecurity support.&lt;/p>
&lt;blockquote>
&lt;p>&amp;ldquo;On the Internet, nobody knows you&amp;rsquo;re a dog.&amp;rdquo;&lt;/p>
&lt;/blockquote>
&lt;p>When &lt;a href="https://en.wikipedia.org/wiki/On_the_Internet,_nobody_knows_you%27re_a_dog">Peter Steiner&amp;rsquo;s caption&lt;/a> was first published in The New Yorker in 1993, it reportedly went largely unnoticed. Only later did the ominous and slightly frightening allusion to online anonymity touch the public consciousness with the icy fingers of the unknown. As Internet usage became more popular, users became concerned that other people could represent themselves online in any manner they chose, without anyone else knowing who they truly were.&lt;/p>
&lt;p>This, to make a gross understatement, is no longer the case. Thanks to &lt;a href="https://support.mozilla.org/en-US/kb/enable-and-disable-cookies-website-preferences">tracking cookies&lt;/a>, &lt;a href="https://robertheaton.com/2017/10/17/we-see-you-democratizing-de-anonymization/">browser fingerprinting&lt;/a>, &lt;a href="https://www.privacypolicies.com/blog/isp-tracking-you/">Internet Service Providers (ISPs) selling our browsing logs to advertisers&lt;/a>, and our own inexplicable inclination to put our names and faces on social networks, online anonymity is out like last year&amp;rsquo;s LaCroix flavours. While your next-door neighbor may not know how to find you online (well, except for through that location-based secondhand marketplace app you&amp;rsquo;re using), you can be certain that at least one large advertising company has a series of zeroes and ones somewhere that represent you, the specific details of your market demographic, and all your online habits, including your preferred flavour of LaCroix.&lt;/p>
&lt;p>There are ways to add &lt;em>some&lt;/em> layers of obscurity, like using a corporate firewall that hides your IP, or &lt;a href="https://www.torproject.org/">using Tor&lt;/a>. The underlying mechanism of both these methods is the same. Like being enshrouded in the layers of an onion, we&amp;rsquo;re using one or more &lt;a href="https://en.wikipedia.org/wiki/Proxy_server">proxy servers&lt;/a> to shield our slightly sulfuric selves from third-party tracking.&lt;/p>
&lt;h2 id="whats-a-proxy-server-anyway" class="anchor-link">&lt;a href="#whats-a-proxy-server-anyway">What&amp;rsquo;s a proxy server, anyway&lt;/a>&lt;/h2>
&lt;p>A proxy, in the traditional English definition, is the &amp;ldquo;authority or power to act for another.&amp;rdquo; (&lt;a href="https://www.merriam-webster.com/dictionary/proxy">Merriam-Webster&lt;/a>) A proxy server, in the computing context, is a server that acts on behalf of another server, or a user&amp;rsquo;s machine.&lt;/p>
&lt;p>By using a proxy to browse the Internet, for example, a user can defer being personally identifiable. All of the user&amp;rsquo;s Internet traffic appears to come from the proxy server instead of their machine.&lt;/p>
&lt;h2 id="proxy-servers-are-for-users" class="anchor-link">&lt;a href="#proxy-servers-are-for-users">Proxy servers are for users&lt;/a>&lt;/h2>
&lt;p>There are a few ways that we, as the client, can use a proxy server to conceal our identity when we go online. It&amp;rsquo;s important to know that these methods offer differing levels of anonymity, and that no single method will really provide &lt;em>true&lt;/em> anonymity; if others are actively seeking to find you on the Internet, for whatever reason, further steps should be taken to make your activity truly difficult to identify. (Those steps are beyond the scope of this article, but you can get started with the &lt;a href="https://ssd.eff.org/">Electronic Frontier Foundation&amp;rsquo;s (EFF) Surveillance Self-Defense&lt;/a> resource.) For the average user, however, here is a small menu of options ranging from least to most anonymous.&lt;/p>
&lt;h3 id="use-a-proxy-in-your-web-browser" class="anchor-link">&lt;a href="#use-a-proxy-in-your-web-browser">Use a proxy in your web browser&lt;/a>&lt;/h3>
&lt;p>Certain web browsers, including Firefox and Safari on Mac, allow us to configure them to send our Internet traffic through a proxy server. The proxy server attempts to &lt;a href="https://en.wikipedia.org/wiki/Anonymizer">anonymize&lt;/a> our requests by replacing our originating IP address with the proxy server&amp;rsquo;s own IP. This provides us with some anonymity, as the website we&amp;rsquo;re trying to reach will not see our originating IP address; however, the proxy server that we choose to use will know exactly who originated the request. This method also doesn&amp;rsquo;t necessarily encrypt traffic, block cookies, or stop social media and cross-site trackers from following us around; on the upside, it&amp;rsquo;s the method least likely to prevent websites that use cookies from functioning properly.&lt;/p>
&lt;p>
&lt;img src="https://victoria.dev/blog/how-users-and-applications-stay-safe-on-the-internet-its-proxy-servers-all-the-way-down/browser-proxy.png" alt="A cartoon of a proxy server guarding a browser" />
&lt;/p>
&lt;p>Public proxy servers are out there, and deciding whether or not we should use any one of them is on par with deciding whether we should eat a piece of candy handed to us by a smiling stranger. If your academic institution or company provides a proxy server address, it is (hopefully) a private server with some security in place. My preferred method, if we have a little time and a few monthly dollars to invest in our security, is to set up our own virtual instance with a company such as &lt;a href="https://aws.amazon.com/ec2/">Amazon Web Services&lt;/a> or &lt;a href="https://www.digitalocean.com/products/droplets/">Digital Ocean&lt;/a> and use this as our proxy server.&lt;/p>
&lt;p>To use a proxy through our browser, we can &lt;a href="https://support.mozilla.org/en-US/kb/connection-settings-firefox">edit our Connection Settings in Firefox&lt;/a>, or &lt;a href="https://support.apple.com/guide/safari/set-up-a-proxy-server-ibrw1053/mac">set up a proxy server using Safari on Mac&lt;/a>.&lt;/p>
&lt;p>In regards to choosing a browser, I would happily recommend &lt;a href="https://www.mozilla.org/en-US/firefox/new/">Firefox&lt;/a> to any Internet user who wants to beef up the security of their browsing experience right out of the box. Mozilla has been a champion of privacy-first since I&amp;rsquo;ve heard of them, and recently made some well-received changes to &lt;a href="https://blog.mozilla.org/blog/2019/06/04/firefox-now-available-with-enhanced-tracking-protection-by-default/">Enhanced Tracking Protection in Firefox Browser&lt;/a> that blocks social media trackers, cross-site tracking cookies, fingerprinters, and cryptominers by default.&lt;/p>
&lt;h3 id="use-a-vpn-on-your-device" class="anchor-link">&lt;a href="#use-a-vpn-on-your-device">Use a VPN on your device&lt;/a>&lt;/h3>
&lt;p>In order to take advantage of a proxy server for all our Internet usage instead of just through one browser, we can use a Virtual Private Network (VPN). A VPN is a service, usually paid, that sends our Internet traffic through their servers, thus acting as a proxy. A VPN can be used on our laptop as well as phone and tablet devices, and since it encompasses all our Internet traffic, it doesn&amp;rsquo;t require much extra effort to use other than ensuring our device is connected. Using a VPN is an effective way to keep nosy ISPs from snooping on our requests.&lt;/p>
&lt;p>
&lt;img src="https://victoria.dev/blog/how-users-and-applications-stay-safe-on-the-internet-its-proxy-servers-all-the-way-down/vpn.png" alt="A cartoon depicting a private VPN" />
&lt;/p>
&lt;p>To use a paid, third-party VPN service, we&amp;rsquo;d usually sign up on their website and download their app. It&amp;rsquo;s important to keep in mind that whichever provider we choose, we&amp;rsquo;re entrusting them with our data. VPN providers anonymize our activity from the Internet, but can themselves see all our requests. Providers vary in terms of their privacy policies and the data they choose to log, so a little research may be necessary to determine which, if any, we are comfortable trusting.&lt;/p>
&lt;p>We can also roll our own VPN service by using a virtual instance and &lt;a href="https://openvpn.net/">OpenVPN&lt;/a>. OpenVPN is an open source VPN protocol, and can be used with a few virtual instance providers, such as &lt;a href="https://openvpn.net/amazon-cloud/">Amazon VPC&lt;/a>, &lt;a href="https://openvpn.net/microsoft-azure/">Microsoft Azure&lt;/a>, &lt;a href="https://openvpn.net/google-cloud-vpn/">Google Cloud&lt;/a>, and &lt;a href="https://openvpn.net/digital-ocean-vpn/">Digital Ocean Droplets&lt;/a>. I previously wrote a tutorial on &lt;a href="https://victoria.dev/blog/how-to-set-up-openvpn-on-aws-ec2-and-fix-dns-leaks-on-ubuntu-18.04-lts/">setting up your own personal VPN service with AWS&lt;/a> using an EC2 instance. I&amp;rsquo;ve been running this solution personally for about a month, and it&amp;rsquo;s cost me almost $4 USD in total, which is a price I&amp;rsquo;m quite comfortable paying for some peace of mind.&lt;/p>
&lt;h3 id="use-tor" class="anchor-link">&lt;a href="#use-tor">Use Tor&lt;/a>&lt;/h3>
&lt;p>Tor takes the anonymity offered by a proxy server and compounds it by forwarding our requests through a &lt;a href="https://en.wikipedia.org/wiki/Relay_network">relay network&lt;/a> of other servers, each called a &amp;ldquo;node.&amp;rdquo; Our traffic passes through three nodes on its way to a destination: the &lt;em>guard&lt;/em>, &lt;em>middle&lt;/em>, and &lt;em>exit&lt;/em> nodes. At each step, the request is encrypted and anonymized such that the current node only knows where to send it, and nothing more about what the request contains. This separation of knowledge means that, of the options discussed, Tor provides the most complete version of anonymity. (For a more complete explanation, see &lt;a href="https://robertheaton.com/2019/04/06/how-does-tor-work/">Robert Heaton&amp;rsquo;s article on how Tor works&lt;/a>, which is so excellently done that I wish I&amp;rsquo;d written it myself.)&lt;/p>
&lt;p>
&lt;img src="https://victoria.dev/blog/how-users-and-applications-stay-safe-on-the-internet-its-proxy-servers-all-the-way-down/tor.png" alt="Tor onion holding a Free Hugs sign" />
&lt;/p>
&lt;p>That said, this level of anonymity comes with its own cost. Not monetary, as &lt;a href="https://www.torproject.org/download/">Tor Browser&lt;/a> is free to download and use. It is, however, slower than using a VPN or simple proxy server through a browser, due to the circuitous route our requests take.&lt;/p>
&lt;h2 id="proxy-servers-are-for-servers-too" class="anchor-link">&lt;a href="#proxy-servers-are-for-servers-too">Proxy servers are for servers too&lt;/a>&lt;/h2>
&lt;p>We&amp;rsquo;re now familiar with proxy servers in the context of protecting users as they surf the web, but proxies aren&amp;rsquo;t just for clients. Websites and Internet-connected applications can use &lt;a href="https://en.wikipedia.org/wiki/Reverse_proxy">reverse proxy servers&lt;/a> for obfuscation too. The &amp;ldquo;reverse&amp;rdquo; part just means that the proxy is acting on behalf of the server, instead of the client.&lt;/p>
&lt;p>Why would a web server care about anonymity? Generally, they don&amp;rsquo;t, at least not in the same way some users do. Web servers can benefit from using a proxy for a few different reasons; for example, they typically offer faster service to users by &lt;a href="https://en.wikipedia.org/wiki/Web_cache">caching&lt;/a> or &lt;a href="https://en.wikipedia.org/wiki/HTTP_compression">compressing&lt;/a> content to optimize delivery. From a cybersecurity perspective, however, a reverse proxy can improve an application&amp;rsquo;s security posture by obfuscating the underlying infrastructure.&lt;/p>
&lt;p>
&lt;img src="https://victoria.dev/blog/how-users-and-applications-stay-safe-on-the-internet-its-proxy-servers-all-the-way-down/syllables.png" alt="A cartoon making fun of the big words I used" />
&lt;/p>
&lt;p>Basically, by placing another web server (the &amp;ldquo;proxy&amp;rdquo;) in front of the web server that directly accesses all the files and assets, we make it more difficult for an attacker to pinpoint our &amp;ldquo;real&amp;rdquo; web server and mess with our stuff. Like when you want to see the store manager and the clerk you&amp;rsquo;re talking to says, &amp;ldquo;I speak for the manager,&amp;rdquo; and you&amp;rsquo;re not really sure there even &lt;em>is&lt;/em> a manager, anyway, but you successfully exchange the hot pink My Little Pony they sold you for a &lt;em>fuchsia&lt;/em> one, thankyouverymuch, so now you&amp;rsquo;re no longer concerned with who the manager is and whether or not they really exist, and if you passed them on the street you would not be able to stop them and call them out for passing off hot pink as fuchsia, and the manager is just fine with that.&lt;/p>
&lt;p>Some common web servers can also act as reverse proxies, often with just a minimal and straightforward configuration change. While the best choice for your particular architecture is unknown to me, I will offer a couple common examples here.&lt;/p>
&lt;h3 id="using-nginx-as-a-reverse-proxy" class="anchor-link">&lt;a href="#using-nginx-as-a-reverse-proxy">Using NGINX as a reverse proxy&lt;/a>&lt;/h3>
&lt;p>NGINX uses the &lt;code>proxy_pass&lt;/code> directive in its &lt;a href="https://docs.nginx.com/nginx/admin-guide/basic-functionality/managing-configuration-files/">configuration file&lt;/a> (&lt;code>nginx.conf&lt;/code> by default) to turn itself into a reverse proxy server. The set up requires the following lines to be placed in the configuration file:&lt;/p>
&lt;pre>&lt;code class="language-conf" data-lang="conf">location /requested/path/ {
proxy_pass http://www.example.com/target/path/;
}
&lt;/code>&lt;/pre>&lt;p>This specifies that all requests for the path &lt;code>/requested/path/&lt;/code> are forwarded to &lt;code>http://www.example.com/target/path/&lt;/code>. The target can be a domain name or an IP address, the latter with or without a port.&lt;/p>
&lt;p>The full &lt;a href="https://docs.nginx.com/nginx/admin-guide/web-server/reverse-proxy/">guide to using NGINX as a reverse proxy&lt;/a> is part of the NGINX documentation.&lt;/p>
&lt;h3 id="using-apache-httpd-as-a-reverse-proxy" class="anchor-link">&lt;a href="#using-apache-httpd-as-a-reverse-proxy">Using Apache httpd as a reverse proxy&lt;/a>&lt;/h3>
&lt;p>Apache httpd similarly requires some straightforward configuration to act as a reverse proxy server. In the &lt;a href="https://httpd.apache.org/docs/current/configuring.html">configuration file&lt;/a>, usually &lt;code>httpd.conf&lt;/code>, set the following directives:&lt;/p>
&lt;pre>&lt;code class="language-conf" data-lang="conf">ProxyPass &amp;quot;/requested/path/&amp;quot; &amp;quot;http://www.example.com/target/path/&amp;quot;
ProxyPassReverse &amp;quot;/requested/path/&amp;quot; &amp;quot;http://www.example.com/target/path/&amp;quot;
&lt;/code>&lt;/pre>&lt;p>The &lt;code>ProxyPass&lt;/code> directive ensures that all requests for the path &lt;code>/requested/path/&lt;/code> are forwarded to &lt;code>http://www.example.com/target/path/&lt;/code>. The &lt;code>ProxyPassReverse&lt;/code> directive ensures that the headers sent by the web server are modified to point to the reverse proxy server instead.&lt;/p>
&lt;p>The full &lt;a href="https://httpd.apache.org/docs/2.4/howto/reverse_proxy.html">reverse proxy guide for Apache HTTP server&lt;/a> is available in their documentation.&lt;/p>
&lt;h2 id="proxy-servers-_most-of_-the-way-down" class="anchor-link">&lt;a href="#proxy-servers-_most-of_-the-way-down">Proxy servers &lt;em>most of&lt;/em> the way down&lt;/a>&lt;/h2>
&lt;p>I concede that my title is a little facetious, as cybersecurity best practices aren&amp;rsquo;t really some eternal infinite-regression mystery (though they may sometimes seem to be). Regardless, I hope this post has helped in your understanding of what proxy servers are, how they contribute to online anonymity for both clients and servers, and that they are an integral building block of cybersecurity practices.&lt;/p>
&lt;p>If you&amp;rsquo;d like to learn more about personal best practices for online security, I highly recommend exploring the articles and resources provided by &lt;a href="https://www.eff.org/">EFF&lt;/a>. For a guide to securing web sites and applications, the &lt;a href="https://github.com/OWASP/CheatSheetSeries">OWASP Cheat Sheet Series&lt;/a> is a fantastic resource.&lt;/p></content:encoded><enclosure url="https://victoria.dev/blog/how-users-and-applications-stay-safe-on-the-internet-its-proxy-servers-all-the-way-down/cover_hua9810ca0d5d352b6afac9eae7c2c33fc_779068_640x0_resize_box_2.png" type="image/jpg"/></item><item><title>Hackers are Googling your plain text passwords: preventing sensitive data exposure</title><link>https://victoria.dev/blog/hackers-are-googling-your-plain-text-passwords-preventing-sensitive-data-exposure/</link><pubDate>Mon, 09 Sep 2019 09:10:11 -0400</pubDate><author>hello@victoria.dev (Victoria Drake)</author><guid>https://victoria.dev/blog/hackers-are-googling-your-plain-text-passwords-preventing-sensitive-data-exposure/</guid><description>Why sensitive data controls need to be established long before you think you needthem, as demonstrated by Google dorking.</description><content:encoded>
&lt;img src="https://victoria.dev/blog/hackers-are-googling-your-plain-text-passwords-preventing-sensitive-data-exposure/cover_hu3d85b89eb9d0f9ebca0ddd94c26060d4_587474_640x0_resize_box_2.png" width="640" height="454"/>
&lt;p>Last week, I wrote about &lt;a href="https://victoria.dev/blog/sql-injection-and-xss-what-white-hat-hackers-know-about-trusting-user-input/">the importance of properly handling user input&lt;/a> in our websites and applications. I alluded to an overarching security lesson that I hope to make explicit today: the security of our software, application, and customer data is built from the ground up, long before the product goes live.&lt;/p>
&lt;p>The &lt;a href="https://www.owasp.org/index.php/Category:OWASP_Top_Ten_Project">OWASP Top 10&lt;/a> is a comprehensive guide to web application security risks. It is relied upon by technology professionals, corporations, and those interested in cybersecurity or information security. The most recent publication lists Sensitive Data Exposure as the third most critical web application security risk. Here&amp;rsquo;s how the risk is described:&lt;/p>
&lt;blockquote>
&lt;p>Many web applications and APIs do not properly protect sensitive data, such as financial, healthcare, and PII. Attackers may steal or modify such weakly protected data to conduct credit card fraud, identity theft, or other crimes. Sensitive data may be compromised without extra protection, such as encryption at rest or in transit, and requires special precautions when exchanged with the browser.&lt;/p>
&lt;/blockquote>
&lt;p>&amp;ldquo;Sensitive Data Exposure&amp;rdquo; is a sort of catch-all category for leaked data resulting from many sources, ranging from weak cryptographic algorithms to unenforced encryption. The simplest source of this security risk, however, takes far fewer syllables to describe: people.&lt;/p>
&lt;p>The phrase &amp;ldquo;an ounce of prevention is worth a pound of cure,&amp;rdquo; applies to medicine as well as secure software development. In the world of the latter, this is referred to as &amp;ldquo;pushing left,&amp;rdquo; a rather unintuitive term for establishing security best practices earlier, rather than later, in the software development life cycle (SDLC). Establishing procedures &amp;ldquo;to the left&amp;rdquo; of the SDLC can help ensure that the people involved in creating a software product are properly taking care of sensitive data from day one.&lt;/p>
&lt;p>Unfortunately, a good amount of security testing often seems to occur much farther to the right side of the SDLC; too late for some security issues, such as sensitive data leakage, to be prevented.&lt;/p>
&lt;p>I&amp;rsquo;m one of the authors contributing to the upcoming &lt;a href="https://github.com/OWASP/OWASP-Testing-Guide-v5">OWASP Testing Guide&lt;/a> and recently expanded a section on search engine discovery reconnaissance, or what the kids these days call &amp;ldquo;Google dorking.&amp;rdquo; This is one method, and arguably the most accessible method, by which a security tester (or black hat hacker) could find exposed sensitive data on the Internet. Here&amp;rsquo;s an excerpt from that section (currently a work in progress on GitHub, to be released in v5):&lt;/p>
&lt;blockquote>
&lt;h3 id="search-operators" class="anchor-link">&lt;a href="#search-operators">Search Operators&lt;/a>&lt;/h3>
&lt;p>A search operator is a special keyword that extends the capabilities of regular search queries, and can help obtain more specific results. They generally take the form of &lt;code>operator:query&lt;/code>. Here are some commonly supported search operators:&lt;/p>
&lt;ul>
&lt;li>&lt;code>site:&lt;/code> will limit the search to the provided URL.&lt;/li>
&lt;li>&lt;code>inurl:&lt;/code> will only return results that include the keyword in the URL.&lt;/li>
&lt;li>&lt;code>intitle:&lt;/code> will only return results that have the keyword in the page title.&lt;/li>
&lt;li>&lt;code>intext:&lt;/code> or &lt;code>inbody:&lt;/code> will only search for the keyword in the body of pages.&lt;/li>
&lt;li>&lt;code>filetype:&lt;/code> will match only a specific filetype, i.e. png, or php.&lt;/li>
&lt;/ul>
&lt;p>For example, to find the web content of owasp.org as indexed by a typical search engine, the syntax required is:&lt;/p>
&lt;p>&lt;code>site:owasp.org&lt;/code>&lt;/p>
&lt;p>&amp;hellip;
Searching with operators can be a very effective discovery reconnaissance technique when combined with the creativity of the tester. Operators can be chained to effectively discover specific kinds of sensitive files and information. This technique, called &lt;a href="https://en.wikipedia.org/wiki/Google_hacking">Google hacking&lt;/a> or Google dorking, is also possible using other search engines, as long as the search operators are supported.&lt;/p>
&lt;p>A database of dorks, such as &lt;a href="https://www.exploit-db.com/google-hacking-database">Google Hacking Database&lt;/a>, is a useful resource that can help uncover specific information.&lt;/p>
&lt;/blockquote>
&lt;p>Regularly reviewing search engine results can be a fruitful task for security testers. However, when a search for &lt;code>site:myapp.com passwords&lt;/code> turns up no results, it may still be a little too early to break for lunch. Here are a couple other places a security tester might like to look for sensitive data exposed in the wild.&lt;/p>
&lt;h2 id="pastebin" class="anchor-link">&lt;a href="#pastebin">Pastebin&lt;/a>&lt;/h2>
&lt;p>The self-declared &amp;ldquo;#1 paste tool since 2002,&amp;rdquo; &lt;a href="https://pastebin.com">Pastebin&lt;/a> allows users to temporarily store any kind of text. It&amp;rsquo;s mostly used for sharing information with others, or retrieving your own &amp;ldquo;paste&amp;rdquo; on another machine, perhaps in another location. Pastebin makes it easy to share large amounts of complicated text, like error logs, source code, configuration files, tokens, api keys&amp;hellip; what&amp;rsquo;s that? Oh, yes, it&amp;rsquo;s public by default.&lt;/p>
&lt;p>Here are some screenshots of a little dorking I did for a public bug bounty program.&lt;/p>
&lt;figure class="screenshot">
&lt;img src="pastebin_apikey.png"
alt="A screenshot of exposed api key in Google search"/> &lt;figcaption>
&lt;p>API keys in plain view.&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;figure class="screenshot">
&lt;img src="pastebin_pass.png"
alt="A screenshot of exposed username and password in Google search"/> &lt;figcaption>
&lt;p>Log-in details out in the open.&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;p>Thanks in part to the convenience of using Pastebin and similar websites, it would appear that some people fail to think twice before making sensitive data publicly available.&lt;/p>
&lt;h3 id="but-why" class="anchor-link">&lt;a href="#but-why">But why&lt;/a>&lt;/h3>
&lt;p>Granted, non-technical employees with access to the application may not have an understanding of which items should or should not be freely shared. Someone unfamiliar with what encrypted data is or what it looks like may not realize the difference between an encrypted string and an unencrypted token made up of many random letters and numbers. Even technical staff can miss things, make mistakes, or act carelessly after a hard day at work. It may be easy to call this a training problem and move on; however, none of these rationalizations address the root cause of the issue.&lt;/p>
&lt;p>When people turn to outside solutions for an issue they face, it&amp;rsquo;s usually because they haven&amp;rsquo;t been provided with an equally-appealing internal solution, or are unaware that one exists. Employees using pastes to share or move sensitive data do so because they don&amp;rsquo;t have an easier, more convenient, and secure internal solution to use instead.&lt;/p>
&lt;h3 id="mitigation" class="anchor-link">&lt;a href="#mitigation">Mitigation&lt;/a>&lt;/h3>
&lt;p>Everyone involved in the creation and maintenance of a web application should be briefed on a few basic things in regards to sensitive data protection:&lt;/p>
&lt;ol>
&lt;li>what constitutes sensitive data,&lt;/li>
&lt;li>the difference between plain text and encrypted data, and&lt;/li>
&lt;li>how to properly transmit and store sensitive data.&lt;/li>
&lt;/ol>
&lt;p>When it comes to third-party services, ensure people are aware that some transmission may not be encrypted, or may be publicly searchable. If there is no system currently in place for safely sharing and storing sensitive data internally, this is a good place to start. The security of application data is in the hands of everyone on the team, from administrative staff to C-level executives. Ensure people have the tools they need to work securely.&lt;/p>
&lt;h2 id="public-repositories" class="anchor-link">&lt;a href="#public-repositories">Public repositories&lt;/a>&lt;/h2>
&lt;p>Developers are notorious for leaving sensitive information hanging out where it doesn&amp;rsquo;t belong (yes, I&amp;rsquo;ve done it too!). Without a strong push-left approach in place for handling tokens, secrets, and keys, these little gems can end up in full public view on sites like GitHub, GitLab, and Bitbucket (to name a few). &lt;a href="https://www.ndss-symposium.org/wp-content/uploads/2019/02/ndss2019_04B-3_Meli_paper.pdf">A 2019 study&lt;/a> found that thousands of new, unique secrets are leaked every day on GitHub alone.&lt;/p>
&lt;figure class="screenshot">
&lt;img src="github_tok.png"
alt="A screenshot of a Google search for tokens on GitHub"/>
&lt;/figure>
&lt;p>GitHub has implemented measures like &lt;a href="https://github.blog/2018-10-17-behind-the-scenes-of-github-token-scanning/">token scanning&lt;/a>, and GitLab 11.9 &lt;a href="https://about.gitlab.com/2019/03/22/gitlab-11-9-released/">introduced secret detection&lt;/a>. While these tools aim to reduce the chances that a secret might accidentally be committed, to put it bluntly, it&amp;rsquo;s really not their job. Secret scanning won&amp;rsquo;t stop developers from committing the data in the first place.&lt;/p>
&lt;h3 id="but-why-1" class="anchor-link">&lt;a href="#but-why-1">But why&lt;/a>&lt;/h3>
&lt;p>Without an obvious process in place for managing secrets, developers may tend too much towards their innate sense of just-get-it-done-ness. Sometimes this leads to the expedient but irresponsible practice of storing keys as unencrypted variables within the program, perhaps with the intention of it being temporary. Nonetheless, these variables inevitably fall from front of mind and end up in a commit.&lt;/p>
&lt;h3 id="mitigation-1" class="anchor-link">&lt;a href="#mitigation-1">Mitigation&lt;/a>&lt;/h3>
&lt;p>Having a strong push-left culture means ensuring that sensitive data is properly stored and can be securely retrieved long before anyone is ready to make a commit. Tools and strategies for doing so are readily available for those who seek them. Here are some examples of tools that can support a push-left approach:&lt;/p>
&lt;ul>
&lt;li>Use a management tool to store and control access to keys and secrets, such as &lt;a href="https://aws.amazon.com/kms/">Amazon Key Management Service&lt;/a> or Microsoft&amp;rsquo;s &lt;a href="https://azure.microsoft.com/en-us/services/key-vault/">Azure Key Vault&lt;/a>.&lt;/li>
&lt;li>Make use of encrypted environment variables in CI tools, such as &lt;a href="https://www.netlify.com/docs/continuous-deployment/#environment-variables">Netlify&amp;rsquo;s environment variables&lt;/a> or &lt;a href="https://help.github.com/en/articles/virtual-environments-for-github-actions#creating-and-using-secrets-encrypted-variables">virtual environments in GitHub Actions&lt;/a>.&lt;/li>
&lt;li>Craft a robust &lt;code>.gitignore&lt;/code> file that everyone on the team can contribute to and use.&lt;/li>
&lt;/ul>
&lt;p>We also need not rely entirely on the public repository to catch those mistakes that may still slip through. It&amp;rsquo;s possible to set up Git pre-commit hooks that scan for committed secrets using &lt;a href="https://en.wikipedia.org/wiki/Regular_expression">regular expressions&lt;/a>. There are some open-source programs available for this, such as &lt;a href="https://github.com/thoughtworks/talisman">Talisman from ThoughtWorks&lt;/a> and &lt;a href="https://github.com/awslabs/git-secrets">git-secrets from AWS Labs&lt;/a>.&lt;/p>
&lt;h2 id="pushing-left-to-prevent-sensitive-data-exposure" class="anchor-link">&lt;a href="#pushing-left-to-prevent-sensitive-data-exposure">Pushing left to prevent sensitive data exposure&lt;/a>&lt;/h2>
&lt;p>A little perspective can go a long way in demonstrating why it&amp;rsquo;s important to begin managing sensitive data even before any sensitive data exists. By establishing security best practices on the left of the SDLC, we give our people the best chance to increase the odds that any future dorking on our software product looks more like this.&lt;/p>
&lt;p>
&lt;img src="https://victoria.dev/blog/hackers-are-googling-your-plain-text-passwords-preventing-sensitive-data-exposure/no_results.png#screenshot" alt="No results found in Google Search" />
&lt;/p>
&lt;p>Another great resource for checking up on the security of our data is Troy Hunt&amp;rsquo;s &lt;a href="https://haveibeenpwned.com/">Have I Been Pwned&lt;/a>, a service that compares your data (such as your email) to data that has been leaked in previous data breaches.&lt;/p>
&lt;p>To learn about more ways we can be proactive with our application security, the &lt;a href="https://www.owasp.org/index.php/OWASP_Proactive_Controls">OWASP Proactive Controls&lt;/a> publication is a great resource. There&amp;rsquo;s also more about creating a push-left approach to security in the upcoming &lt;a href="https://github.com/OWASP/OWASP-Testing-Guide-v5">OWASP Testing Guide&lt;/a>. If these topics interest you, I encourage you to read, learn, and contribute so more people will make it harder for sensitive data to be found.&lt;/p></content:encoded><enclosure url="https://victoria.dev/blog/hackers-are-googling-your-plain-text-passwords-preventing-sensitive-data-exposure/cover_hu3d85b89eb9d0f9ebca0ddd94c26060d4_587474_640x0_resize_box_2.png" type="image/jpg"/></item><item><title>SQL injection and XSS: what white hat hackers know about trusting user input</title><link>https://victoria.dev/blog/sql-injection-and-xss-what-white-hat-hackers-know-about-trusting-user-input/</link><pubDate>Mon, 02 Sep 2019 09:01:23 -0400</pubDate><author>hello@victoria.dev (Victoria Drake)</author><guid>https://victoria.dev/blog/sql-injection-and-xss-what-white-hat-hackers-know-about-trusting-user-input/</guid><description>A primer on SQL injection and cross site scripting, and how to handle user input in software development.</description><content:encoded>
&lt;img src="https://victoria.dev/blog/sql-injection-and-xss-what-white-hat-hackers-know-about-trusting-user-input/cover_huc77b01b4a69883cffc22e79b459adb70_272308_640x0_resize_box_2.png" width="640" height="374"/>
&lt;p>Software developers have a lot on their minds. There are are myriad of questions to ask when it comes to creating a website or application: &lt;em>What technologies will we use? How will the architecture be set up? What functions do we need? What will the UI look like?&lt;/em> Especially in a software market where shipping new apps seems more like a race for reputation than a well-considered process, one of the most important questions often falls to the bottom of the &amp;ldquo;Urgent&amp;rdquo; column: how will our product be secured?&lt;/p>
&lt;p>If you&amp;rsquo;re using a robust, open-source framework for building your product (and if one is applicable and available, why wouldn&amp;rsquo;t you?) then some basic security concerns, like CSRF tokens and password encryption, may already be handled for you. Still, fast-moving developers would be well served to brush up on their knowledge of common threats and pitfalls, if only to avoid some embarrass
ing rookie mistakes. Usually, the weakest point in the security of your software is &lt;em>you.&lt;/em>&lt;/p>
&lt;p>I&amp;rsquo;ve recently become more interested in information security in general, and practicing ethical hacking in particular. An ethical hacker, sometimes called &amp;ldquo;white hat&amp;rdquo; hacker, and sometimes just &amp;ldquo;hacker,&amp;rdquo; is someone who searches for possible security vulnerabilities and responsibly (privately) reports them to project owners. By contrast, a malicious or &amp;ldquo;black hat&amp;rdquo; hacker, also called a &amp;ldquo;cracker,&amp;rdquo; is someone who exploits these vulnerabilities for amusement or personal gain. Both white hat and black hat hackers might use the same tools and resources, and generally try to get into places they aren&amp;rsquo;t supposed to be; however, white hats do this with permission, and with the intention of fortifying defences instead of destroying them. Black hats are the bad guys.&lt;/p>
&lt;p>When it comes to learning how to find security vulnerabilities, it should come as no surprise that I&amp;rsquo;ve been devouring whatever information I can get my hands on; this post is a distillation of some key areas that are specifically helpful to developers when handling user input. These lessons have been collectively gleaned from these excellent resources:&lt;/p>
&lt;ul>
&lt;li>The &lt;a href="https://www.owasp.org/index.php/Main_Page">Open Web Application Security Project&lt;/a> guides&lt;/li>
&lt;li>The Hacker101 playlist from &lt;a href="https://www.youtube.com/channel/UCsgzmECky2Q9lQMWzDwMhYw/">HackerOne&amp;rsquo;s YouTube channel&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://leanpub.com/web-hacking-101">Web Hacking 101&lt;/a> by Peter Yaworski&lt;/li>
&lt;li>&lt;a href="https://brutelogic.com.br/blog/">Brute Logic&amp;rsquo;s blog&lt;/a>&lt;/li>
&lt;li>The &lt;a href="https://www.youtube.com/channel/UC9-y-6csu5WGm29I7JiwpnA">Computerphile&lt;/a> YouTube channel&lt;/li>
&lt;li>Videos featuring Jason Haddix (&lt;a href="https://github.com/jhaddix/">@jhaddix&lt;/a>) and Tom Hudson (&lt;a href="https://github.com/tomnomnom/">@tomnomnom&lt;/a>) (two accomplished ethical hackers with different, but both effective, methodologies)&lt;/li>
&lt;/ul>
&lt;p>You may be familiar with the catchphrase, &amp;ldquo;sanitize your inputs!&amp;rdquo; However, as I hope this post demonstrates, developing an application with robust security isn&amp;rsquo;t quite so straightforward. I suggest an alternate phrase: pay attention to your inputs. Let&amp;rsquo;s elaborate by examining the most common attacks that take advantage of vulnerabilities in this area: SQL injection and cross site scripting.&lt;/p>
&lt;h2 id="sql-injection-attacks" class="anchor-link">&lt;a href="#sql-injection-attacks">SQL injection attacks&lt;/a>&lt;/h2>
&lt;p>If you&amp;rsquo;re not yet familiar with SQL (Structured Query Language) injection attacks, or SQLi, here is a great &lt;a href="https://www.youtube.com/watch?v=_jKylhJtPmI">explain-like-I&amp;rsquo;m-five video on SQLi&lt;/a>. You may already know of this attack from &lt;a href="https://xkcd.com/327/">xkcd&amp;rsquo;s Little Bobby Tables&lt;/a>. Essentially, malicious actors may be able to send SQL commands that affect your application through some input on your site, like a search box that pulls results from your database. Sites coded in PHP can be especially susceptible to these, and a successful SQL attack can be devastating for software that relies on a database (as in, your Users table is now a pot of petunias).&lt;/p>
&lt;figure class="center">
&lt;img src="sqli.png"
alt="A monitor with an SQL Select command that gets all your base"/> &lt;figcaption>
&lt;p>You have no chance to survive make your time.&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;p>You can test your own site to see if you&amp;rsquo;re susceptible to this kind of attack. (Please only test sites that you own, since running SQL injections where you don&amp;rsquo;t have permission to be doing so is, possibly, illegal in your locality; and definitely, universally, not very funny.) The following payloads can be used to test inputs:&lt;/p>
&lt;ul>
&lt;li>&lt;code>' OR 1='1&lt;/code> evaluates to a constant true, and when successful, returns all rows in the table.&lt;/li>
&lt;li>&lt;code>' AND 0='1&lt;/code> evaluates to a constant false, and when successful, returns no rows.&lt;/li>
&lt;/ul>
&lt;p>&lt;a href="https://www.youtube.com/watch?v=ciNHn38EyRc">This video demonstrates the above tests&lt;/a>, and does a great job of showing how impactful an SQL injection attack can be.&lt;/p>
&lt;p>Thankfully, there are ways to mitigate SQL injection attacks, and they all boil down to one basic concept: don&amp;rsquo;t trust user input.&lt;/p>
&lt;h2 id="sql-injection-mitigation" class="anchor-link">&lt;a href="#sql-injection-mitigation">SQL injection mitigation&lt;/a>&lt;/h2>
&lt;p>In order to effectively mitigate SQL injections, developers must prevent users from being able to successfully submit raw SQL commands to any part of the site.&lt;/p>
&lt;p>Some frameworks will do most of the heavy lifting for you. For example, Django implements the concept of &lt;a href="https://en.wikipedia.org/wiki/Object-relational_mapping">Object-Relational Mapping&lt;/a>, or ORM, with its use of &lt;a href="https://docs.djangoproject.com/en/2.2/topics/db/queries/">QuerySets&lt;/a>. We can think of these as wrapper functions that help your application query the database using pre-defined methods that avoid the use of raw SQL.&lt;/p>
&lt;p>Being able to use a framework, however, is never a guarantee. When dealing directly with a database, there are other methods we can use to safely abstract our SQL queries from user input, though they vary in efficacy. These are, by order of most to least preferred, and with links to relevant examples:&lt;/p>
&lt;ol>
&lt;li>Prepared statements with variable binding (or &lt;a href="https://cheatsheetseries.owasp.org/cheatsheets/Query_Parameterization_Cheat_Sheet.html">parameterized queries&lt;/a>),&lt;/li>
&lt;li>&lt;a href="https://cheatsheetseries.owasp.org/cheatsheets/SQL_Injection_Prevention_Cheat_Sheet.html#defense-option-2-stored-procedures">Stored procedures&lt;/a>; and&lt;/li>
&lt;li>&lt;a href="https://cheatsheetseries.owasp.org/cheatsheets/SQL_Injection_Prevention_Cheat_Sheet.html#defense-option-3-whitelist-input-validation">Whitelisting&lt;/a> or &lt;a href="https://cheatsheetseries.owasp.org/cheatsheets/SQL_Injection_Prevention_Cheat_Sheet.html#defense-option-4-escaping-all-user-supplied-input">escaping&lt;/a> user input.&lt;/li>
&lt;/ol>
&lt;p>If you want to implement the above techniques, the linked cheatsheets are a great starting point for digging deeper. Suffice to say, the use of these techniques to obtain data instead of using raw SQL queries helps to minimize the chances that SQL will be processed by any part of your application that takes input from users, thus mitigating SQL injection attacks.&lt;/p>
&lt;p>The battle, however, is only half won&amp;hellip;&lt;/p>
&lt;h2 id="cross-site-scripting-xss-attacks" class="anchor-link">&lt;a href="#cross-site-scripting-xss-attacks">Cross Site Scripting (XSS) attacks&lt;/a>&lt;/h2>
&lt;p>If you&amp;rsquo;re a malicious coder, JavaScript is pretty much your best friend. The right commands will do anything a legitimate user could do (and even some things they aren&amp;rsquo;t supposed to be able to) on a web page, sometimes without any interaction on the part of an actual user. &lt;a href="https://en.wikipedia.org/wiki/Cross-site_scripting">Cross Site Scripting&lt;/a> attacks, or XSS, occur when JavaScript code is injected into a web page and changes that page&amp;rsquo;s behavior. Its effects can range from prank nuisance occurrences to more severe authentication bypasses or credential stealing. &lt;a href="https://blogs.apache.org/infra/entry/apache_org_04_09_2010">This incident report from Apache in 2010&lt;/a> is a good example of how XSS can be chained in a larger attack to take over accounts and machines.&lt;/p>
&lt;figure>
&lt;img src="xss.png"
alt="An HTML dance party with a little JS cutting in"/> &lt;figcaption>
&lt;p>The annual DOM dance-off receives an unexpected guest);&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;p>XSS can occur on the server or on the client side, and generally comes in three flavors: DOM (&lt;a href="https://developer.mozilla.org/en-US/docs/Web/API/Document_Object_Model/Introduction">Document Object Model&lt;/a>) based, stored, and reflected XSS. The differences amount to where the attack payload is injected into the application.&lt;/p>
&lt;h3 id="dom-based-xss" class="anchor-link">&lt;a href="#dom-based-xss">DOM based XSS&lt;/a>&lt;/h3>
&lt;p>&lt;a href="https://www.owasp.org/index.php/DOM_Based_XSS">DOM based XSS&lt;/a> occurs when a JavaScript payload affects the structure, behavior, or content of the web page the user has loaded in their browser. These are most commonly executed through modified URLs, such as in &lt;a href="https://www.owasp.org/index.php/Phishing">phishing emails&lt;/a>.&lt;/p>
&lt;p>To see how easy it would be for injected JavaScript to manipulate a page, we can create a working example with an HTML web page. Try creating a file on your local system called &lt;code>xss-test.html&lt;/code> (or whatever you like) with the following HTML and JavaScript code:&lt;/p>
&lt;div class="highlight">&lt;pre class="chroma">&lt;code class="language-html" data-lang="html">&lt;span class="p">&amp;lt;&lt;/span>&lt;span class="nt">html&lt;/span>&lt;span class="p">&amp;gt;&lt;/span>
&lt;span class="p">&amp;lt;&lt;/span>&lt;span class="nt">head&lt;/span>&lt;span class="p">&amp;gt;&lt;/span>
&lt;span class="p">&amp;lt;&lt;/span>&lt;span class="nt">title&lt;/span>&lt;span class="p">&amp;gt;&lt;/span>My XSS Example&lt;span class="p">&amp;lt;/&lt;/span>&lt;span class="nt">title&lt;/span>&lt;span class="p">&amp;gt;&lt;/span>
&lt;span class="p">&amp;lt;/&lt;/span>&lt;span class="nt">head&lt;/span>&lt;span class="p">&amp;gt;&lt;/span>
&lt;span class="p">&amp;lt;&lt;/span>&lt;span class="nt">body&lt;/span>&lt;span class="p">&amp;gt;&lt;/span>
&lt;span class="p">&amp;lt;&lt;/span>&lt;span class="nt">h1&lt;/span> &lt;span class="na">id&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s">&amp;#34;greeting&amp;#34;&lt;/span>&lt;span class="p">&amp;gt;&lt;/span>Hello there!&lt;span class="p">&amp;lt;/&lt;/span>&lt;span class="nt">h1&lt;/span>&lt;span class="p">&amp;gt;&lt;/span>
&lt;span class="p">&amp;lt;&lt;/span>&lt;span class="nt">script&lt;/span>&lt;span class="p">&amp;gt;&lt;/span>
&lt;span class="kd">var&lt;/span> &lt;span class="nx">name&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="k">new&lt;/span> &lt;span class="nx">URLSearchParams&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nb">document&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">location&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">search&lt;/span>&lt;span class="p">).&lt;/span>&lt;span class="nx">get&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s1">&amp;#39;name&amp;#39;&lt;/span>&lt;span class="p">);&lt;/span>
&lt;span class="k">if&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="nx">name&lt;/span> &lt;span class="o">!==&lt;/span> &lt;span class="s1">&amp;#39;null&amp;#39;&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="nb">document&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">getElementById&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s1">&amp;#39;greeting&amp;#39;&lt;/span>&lt;span class="p">).&lt;/span>&lt;span class="nx">innerHTML&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="s1">&amp;#39;Hello &amp;#39;&lt;/span> &lt;span class="o">+&lt;/span> &lt;span class="nx">name&lt;/span> &lt;span class="o">+&lt;/span> &lt;span class="s1">&amp;#39;!&amp;#39;&lt;/span>&lt;span class="p">;&lt;/span>
&lt;span class="p">}&lt;/span>
&lt;span class="p">&amp;lt;/&lt;/span>&lt;span class="nt">script&lt;/span>&lt;span class="p">&amp;gt;&lt;/span>
&lt;span class="p">&amp;lt;/&lt;/span>&lt;span class="nt">h1&lt;/span>&lt;span class="p">&amp;gt;&lt;/span>
&lt;span class="p">&amp;lt;/&lt;/span>&lt;span class="nt">html&lt;/span>&lt;span class="p">&amp;gt;&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>This web page will display the title &amp;ldquo;Hello there!&amp;rdquo; unless it receives a &lt;a href="https://en.wikipedia.org/wiki/Query_string">URL parameter from a query string&lt;/a> with a value for &lt;code>name&lt;/code>. To see the script work, open the page in a browser with an appended URL parameter, like so:&lt;/p>
&lt;p>&lt;code>file:///path/to/file/xss-test.html?name=Victoria&lt;/code>&lt;/p>
&lt;p>Fun, right? Our insecure (in the safety sense, not the emotional one) page takes the URL parameter value for &lt;code>name&lt;/code> and displays it in the DOM. The page is expecting the value to be a nice friendly string, but what if we change it to something else? Since the page is owned by us and only exists on our local system, we can test it all we like. What happens if we change the &lt;code>name&lt;/code> parameter to, say, &lt;code>&amp;lt;img+src+onerror=alert(&amp;quot;pwned&amp;quot;)&amp;gt;&lt;/code>?&lt;/p>
&lt;p>
&lt;img src="https://victoria.dev/blog/sql-injection-and-xss-what-white-hat-hackers-know-about-trusting-user-input/pwned.png#screenshot" alt="A screenshot of the XSS page example" />
&lt;/p>
&lt;p>This is just one example, largely based on one from &lt;a href="https://brutelogic.com.br/blog/dom-based-xss-the-3-sinks/">Brute&amp;rsquo;s post&lt;/a>, that demonstrates how an XSS attack could be executed. Funny pop-up alerts may be amusing, but JavaScript can do a lot of harm, including helping malicious attackers steal passwords and personal information.&lt;/p>
&lt;h3 id="stored-and-reflected-xss" class="anchor-link">&lt;a href="#stored-and-reflected-xss">Stored and reflected XSS&lt;/a>&lt;/h3>
&lt;p>&lt;a href="https://en.wikipedia.org/wiki/Cross-site_scripting#Persistent_(or_stored)">Stored XSS&lt;/a> occurs when the attack payload is stored on the server, such as in a database. The attack affects a victim whenever that stored data is retrieved and rendered in the browser. For example, instead of using a URL query string, an attacker might update their profile page on a social site to include a hidden script in, say, their &amp;ldquo;About Me&amp;rdquo; section. The script, improperly stored on the site&amp;rsquo;s server, would successfully execute at a later time when another user views the attacker&amp;rsquo;s profile.&lt;/p>
&lt;p>One of the most famous examples of this is the &lt;a href="https://en.wikipedia.org/wiki/Samy_(computer_worm)">Samy worm&lt;/a> that all but took over MySpace in 2005. It propagated by sending HTTP requests that replicated it onto a victim&amp;rsquo;s profile page whenever an infected profile was viewed. Within just 20 hours, it had spread to over a million users.&lt;/p>
&lt;p>&lt;a href="https://en.wikipedia.org/wiki/Cross-site_scripting#Non-persistent_(reflected)">Reflected XSS&lt;/a> similarly occurs when the injected payload travels to the server, however, the malicious code does not end up stored in a database. It is instead immediately returned to the browser by the web application. An attack like this might be executed by luring the victim to click a malicious link that sends a request to the vulnerable website&amp;rsquo;s server. The server would then send a response to the attacker as well as the victim, which may result in the attacker being able to obtain passwords, or perpetrate actions that appear to originate from the victim.&lt;/p>
&lt;h2 id="xss-attack-mitigation" class="anchor-link">&lt;a href="#xss-attack-mitigation">XSS attack mitigation&lt;/a>&lt;/h2>
&lt;p>In all of these cases, XSS attacks can be mitigated with two key strategies: validating form fields, and avoiding the direct injection of user input on the web page.&lt;/p>
&lt;h3 id="validating-form-fields" class="anchor-link">&lt;a href="#validating-form-fields">Validating form fields&lt;/a>&lt;/h3>
&lt;p>Frameworks can again help us out when it comes to making sure that user-submitted forms are on the up-and-up. One example is &lt;a href="https://docs.djangoproject.com/en/2.2/ref/forms/fields/#built-in-field-classes">Django&amp;rsquo;s built-in &lt;code>Field&lt;/code> classes&lt;/a>, which provide fields that validate to some commonly used types and also specify sane defaults. Django&amp;rsquo;s &lt;code>EmailField&lt;/code>, for instance, uses a set of rules to determine if the input provided is a valid email. If the submitted string has characters in it that are not typically present in email addresses, or if it doesn&amp;rsquo;t imitate the common format of an email address, then Django won&amp;rsquo;t consider the field valid and the form will not be submitted.&lt;/p>
&lt;p>If relying on a framework isn&amp;rsquo;t an option, we can implement our own input validation. This can be accomplished with a few different techniques, including &lt;a href="https://en.wikipedia.org/wiki/Type_conversion">type conversion&lt;/a>, for example, ensuring that a number is of type &lt;code>int()&lt;/code>; checking minimum and maximum range values for numbers and lengths for strings; using a pre-defined array of choices that avoids arbitrary input, for example, months of the year; and checking data against strict &lt;a href="https://en.wikipedia.org/wiki/Regular_expression">regular expressions&lt;/a>.&lt;/p>
&lt;p>Thankfully, we needn&amp;rsquo;t start from scratch. Open source resources are available to help, such as the &lt;a href="https://www.owasp.org/index.php/OWASP_Validation_Regex_Repository">OWASP Validation Regex Repository&lt;/a>, which provides patterns to match against for some common forms of data. Many programming languages offer validation libraries specific to their syntax, and we can find &lt;a href="https://github.com/search?q=validation+library">plenty of these on GitHub&lt;/a>. Additionally, the &lt;a href="https://www.owasp.org/index.php/XSS_Filter_Evasion_Cheat_Sheet">XSS Filter Evasion Cheat Sheet&lt;/a> has a couple suggestions for test payloads we can use to test our existing applications.&lt;/p>
&lt;p>While it may seem tedious, properly implemented input validation can protect our application from being susceptible to XSS.&lt;/p>
&lt;h3 id="avoiding-direct-injection" class="anchor-link">&lt;a href="#avoiding-direct-injection">Avoiding direct injection&lt;/a>&lt;/h3>
&lt;p>Elements of an application that directly return user input to the browser may not, on a casual inspection, be obvious. We can determine areas of our application that may be at risk by exploring a few questions:&lt;/p>
&lt;ul>
&lt;li>How does data flow through our application?&lt;/li>
&lt;li>What does a user expect to happen when they interact with this input?&lt;/li>
&lt;li>Where on our page does data appear? Does it become embedded in a string or an attribute?&lt;/li>
&lt;/ul>
&lt;p>Here are some sample payloads that we can play with in order to test inputs on our site (again, only our own site!) courtesy of &lt;a href="https://www.hacker101.com/">Hacker101&lt;/a>. The successful execution of any of these samples can indicate a possible XSS vulnerability due to direct injection.&lt;/p>
&lt;ul>
&lt;li>&lt;code>&amp;quot;&amp;gt;&amp;lt;h1&amp;gt;test&amp;lt;/h1&amp;gt;&lt;/code>&lt;/li>
&lt;li>&lt;code>'+alert(1)+'&lt;/code>&lt;/li>
&lt;li>&lt;code>&amp;quot;onmouserover=&amp;quot;alert(1)&lt;/code>&lt;/li>
&lt;li>&lt;code>http://&amp;quot;onmouseover=&amp;quot;alert(1)&lt;/code>&lt;/li>
&lt;/ul>
&lt;p>As a general rule, if you are able to design around directly injecting input, do so. Alternatively, be sure to completely understand the effect of the methods you choose; for example, using &lt;code>innerText&lt;/code> instead of &lt;code>innerHTML&lt;/code> in JavaScript will ensure that content will be set as plain text instead of (potentially vulnerable) HTML.&lt;/p>
&lt;h2 id="pay-attention-to-your-inputs" class="anchor-link">&lt;a href="#pay-attention-to-your-inputs">Pay attention to your inputs&lt;/a>&lt;/h2>
&lt;p>Software developers are at a marked disadvantage when it comes to competing with black hat, or malicious, hackers. For all the work we do to secure each and every input that could potentially compromise our application, an attacker need only find the one we missed. It&amp;rsquo;s like installing deadbolts on all the doors, but leaving a window open!&lt;/p>
&lt;p>By learning to think along the same lines as an attacker, however, we can better prepare our software to stand up against bad actors. Exciting as it may be to ship features as quickly as possible, we&amp;rsquo;ll avoid racking up a lot of security debt if we take the time beforehand to think through our application&amp;rsquo;s flow, follow the data, and pay attention to our inputs.&lt;/p></content:encoded><enclosure url="https://victoria.dev/blog/sql-injection-and-xss-what-white-hat-hackers-know-about-trusting-user-input/cover_huc77b01b4a69883cffc22e79b459adb70_272308_640x0_resize_box_2.png" type="image/jpg"/></item><item><title>How to set up OpenVPN on AWS EC2 and fix DNS leaks on Ubuntu 18.04 LTS</title><link>https://victoria.dev/blog/how-to-set-up-openvpn-on-aws-ec2-and-fix-dns-leaks-on-ubuntu-18.04-lts/</link><pubDate>Mon, 26 Aug 2019 09:01:23 -0400</pubDate><author>hello@victoria.dev (Victoria Drake)</author><guid>https://victoria.dev/blog/how-to-set-up-openvpn-on-aws-ec2-and-fix-dns-leaks-on-ubuntu-18.04-lts/</guid><description>A guide for setting up your own private VPN service, and understanding and fixing a DNS leak.</description><content:encoded>
&lt;img src="https://victoria.dev/blog/how-to-set-up-openvpn-on-aws-ec2-and-fix-dns-leaks-on-ubuntu-18.04-lts/cover_hudf0a9e712aaa7cfff13d04d6bd5de865_250170_640x0_resize_box_2.png" width="640" height="388"/>
&lt;p>While rolling your own Virtual Private Network (VPN) is far more complicated than choosing a VPN provider from someone&amp;rsquo;s &amp;ldquo;best VPN 2019&amp;rdquo; list, the more I learn about why someone should use a VPN at all, the less appealing the latter option becomes. Besides the dangers of trusting a fake VPN app or falling victim to a lookalike URL, even &lt;em>legit&lt;/em> VPN service providers have pressures and motivations that may not be aligned with the privacy you hope to be purchasing.&lt;/p>
&lt;p>Usually, the point of using a VPN is to gain a layer of privacy by disguising your location. If you aren&amp;rsquo;t currently using one, you can see what the Internet knows about where you are at &lt;a href="https://dnsleaktest.com/">the DNS leak test website&lt;/a>. You&amp;rsquo;ll see a big hello, your IP address, and your location. If that&amp;rsquo;s a little unsettling, know that a VPN can help to shield your location and online activities from wandering eyes and opportunistic advertisers. The former might be a too-curious or even malicious public-WiFi-cafe-goer, but the latter, counterintuitively, might be your own household Internet Service Provider (ISP).&lt;/p>
&lt;p>Using a VPN means that the Internet can&amp;rsquo;t easily see your location, and your ISP can&amp;rsquo;t see your unencrypted web traffic (and neither can your curious coffee shop neighbor). Your ISP &lt;em>can&lt;/em> see the amount of data you&amp;rsquo;re sending, in its encrypted form, and that you&amp;rsquo;re sending it to your VPN server - but that&amp;rsquo;s all.&lt;/p>
&lt;p>Unless you have a &lt;a href="https://dnsleaktest.com/what-is-a-dns-leak.html">DNS leak&lt;/a>.&lt;/p>
&lt;p>If you are still using your ISP&amp;rsquo;s DNS server, they are still able to see all the URLs the server is resolving for you. So they&amp;rsquo;ll know you asked for &lt;code>lastminutebackwax.com&lt;/code>, although they won&amp;rsquo;t be able to decrypt the data that was exchanged with the site. (Is it just me, or does that seem even worse, somehow?)&lt;/p>
&lt;p>Setting up your own instance and VPN service offers some peace of mind over trusting yet another company to do right with your data. Note that a VPN will &lt;em>not&lt;/em> give you complete online anonymity; there are many other ways your Internet presence can be tracked and your location discovered. However, if properly set up, without DNS leaks, you&amp;rsquo;ll have about as much Internet privacy as can be afforded without using &lt;a href="https://en.wikipedia.org/wiki/Tor_(anonymity_network)">Tor&lt;/a>.&lt;/p>
&lt;h2 id="setting-up-our-vpn" class="anchor-link">&lt;a href="#setting-up-our-vpn">Setting up our VPN&lt;/a>&lt;/h2>
&lt;p>This post will cover how to set up the &lt;a href="https://aws.amazon.com/marketplace/pp/B00MI40CAE/">OpenVPN Access Server&lt;/a> product on AWS Marketplace, running on an &lt;a href="https://aws.amazon.com/ec2/">Amazon EC2 instance&lt;/a>. Then, we&amp;rsquo;ll look at how to fix a &lt;a href="https://gitlab.gnome.org/GNOME/NetworkManager-openvpn/issues/10">known NetworkManager bug in Ubuntu 18.04 that might cause DNS leaks&lt;/a>. The whole process should take about fifteen minutes, so grab a  and let&amp;rsquo;s do some adulting.&lt;/p>
&lt;p>&lt;em>Note: IDs and IP addresses shown for demonstration in this tutorial are invalid.&lt;/em>&lt;/p>
&lt;h3 id="1-launch-the-openvpn-access-server-on-aws-marketplace" class="anchor-link">&lt;a href="#1-launch-the-openvpn-access-server-on-aws-marketplace">1. Launch the OpenVPN Access Server on AWS Marketplace&lt;/a>&lt;/h3>
&lt;p>The &lt;a href="https://aws.amazon.com/marketplace/pp/B00MI40CAE">OpenVPN Access Server&lt;/a> is available on AWS Marketplace. The Bring Your Own License (BYOL) model doesn&amp;rsquo;t actually require a license for up to two connected devices; to connect more clients, you can get &lt;a href="https://aws.amazon.com/marketplace/seller-profile/ref=srh_res_product_vendor?ie=UTF8&amp;amp;id=aac3a8a3-2823-483c-b5aa-60022894b89d">bundled billing&lt;/a> for five, ten, or twenty-five clients, or &lt;a href="https://openvpn.net/pricing/">purchase a minimum of ten OpenVPN licenses a la carte&lt;/a> for $15/device/year. For most of us, the two free connected devices will suffice; and if using an EC2 Micro instance, our set up will be &lt;a href="https://aws.amazon.com/free/">AWS Free Tier eligible&lt;/a> as well.&lt;/p>
&lt;p>Start by clicking &amp;ldquo;Continue to Subscribe&amp;rdquo; for the &lt;a href="https://aws.amazon.com/marketplace/pp/B00MI40CAE">OpenVPN Access Server&lt;/a>, which will bring you to a page that looks like this:&lt;/p>
&lt;p>
&lt;img src="https://victoria.dev/blog/how-to-set-up-openvpn-on-aws-ec2-and-fix-dns-leaks-on-ubuntu-18.04-lts/1-subscribe.jpg#screenshot" alt="Subscription details page for OpenVPN Access Server" />
&lt;/p>
&lt;p>Click &amp;ldquo;Continue to Configuration.&amp;rdquo;&lt;/p>
&lt;p>
&lt;img src="https://victoria.dev/blog/how-to-set-up-openvpn-on-aws-ec2-and-fix-dns-leaks-on-ubuntu-18.04-lts/2-configure.jpg#screenshot" alt="Configure this software page for OpenVPN Access Server" />
&lt;/p>
&lt;p>You may notice that the EC2 instance type in the right side bar (and consequently, the Monthly Estimate) isn&amp;rsquo;t the one we want - that&amp;rsquo;s okay, we can change it soon. Just ensure that the &amp;ldquo;Region&amp;rdquo; chosen is where we want the instance to be located. Generally, the closer it is to the physical location of your client (your laptop, in this case), the faster your VPN will be. Click &amp;ldquo;Continue to Launch.&amp;rdquo;&lt;/p>
&lt;p>
&lt;img src="https://victoria.dev/blog/how-to-set-up-openvpn-on-aws-ec2-and-fix-dns-leaks-on-ubuntu-18.04-lts/3-launch.jpg#screenshot" alt="Launch this software page" />
&lt;/p>
&lt;p>On this page, we&amp;rsquo;ll change three things:&lt;/p>
&lt;h4 id="1-the-ec2-instance-type" class="anchor-link">&lt;a href="#1-the-ec2-instance-type">1. The EC2 Instance type&lt;/a>&lt;/h4>
&lt;p>Different types of EC2 (Elastic Compute Cloud) instances will offer us different levels of computing power. If you plan to use your instance for something more than just this VPN, you may want to choose something with higher memory or storage capacity, depending on how you plan to use it. We can view each instance offering on the &lt;a href="https://aws.amazon.com/ec2/instance-types/">Amazon EC2 Instance Types page&lt;/a>.&lt;/p>
&lt;p>For simple VPN use, the &lt;code>t2.nano&lt;/code> or &lt;code>t2.micro&lt;/code> instances are likely sufficient. Only the Micro instance is Free Tier eligible.&lt;/p>
&lt;h4 id="2-the-security-group-settings" class="anchor-link">&lt;a href="#2-the-security-group-settings">2. The Security Group settings&lt;/a>&lt;/h4>
&lt;p>A &lt;a href="https://docs.aws.amazon.com/vpc/latest/userguide/VPC_SecurityGroups.html">Security Group&lt;/a> is a profile, or collection of settings, that Amazon uses to control access to our instance. If you&amp;rsquo;ve set up other AWS products before, you may already have some groups with their own rules defined. We should be careful to understand the reasons for our Security Group settings, as these define how public or private our instance is, and consequently, who has access to it.&lt;/p>
&lt;p>If we click &amp;ldquo;Create New Based on Seller Settings,&amp;rdquo; the OpenVPN server defines some recommended settings for a default Security Group.&lt;/p>
&lt;p>
&lt;img src="https://victoria.dev/blog/how-to-set-up-openvpn-on-aws-ec2-and-fix-dns-leaks-on-ubuntu-18.04-lts/4-security-group.jpg#screenshot" alt="Security group settings" />
&lt;/p>
&lt;p>The default recommended settings are all &lt;code>0.0.0.0/0&lt;/code> for TCP ports 22, 943, 443, and 945, and UDP port 1194. OpenVPN offers an &lt;a href="https://openvpn.net/vpn-server-resources/amazon-web-services-ec2-byol-appliance-quick-start-guide/#Instance_Launch_Options">explanation of how the ports are used&lt;/a> on their website. With the default settings, all these ports are left open to support various features of the OpenVPN server. We may wish to restrict access to these ports to a specific IP address or block of addresses (like that of your own ISP) to increase the security of our instance. However, if your IP address frequently changes (like when you travel and connect to a different WiFi network), restricting the ports may not be as helpful as we hope.&lt;/p>
&lt;p>In any case, our instance will require SSH keys to connect to, and the OpenVPN server will be password protected. Unless you have other specific security goals, it&amp;rsquo;s fine to accept the default settings for now.&lt;/p>
&lt;p>Let&amp;rsquo;s give the Security Group a name and brief description, so we know what it&amp;rsquo;s for. Then click &amp;ldquo;Save.&amp;rdquo;&lt;/p>
&lt;h4 id="3-the-key-pair-settings" class="anchor-link">&lt;a href="#3-the-key-pair-settings">3. The Key Pair settings&lt;/a>&lt;/h4>
&lt;p>The aforementioned SSH keys are access credentials that we&amp;rsquo;ll use to connect to our instance. We can &lt;a href="https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-key-pairs.html#having-ec2-create-your-key-pair">create a key pair&lt;/a> in this section, or you can choose a key pair you may already be using with AWS.&lt;/p>
&lt;p>
&lt;img src="https://victoria.dev/blog/how-to-set-up-openvpn-on-aws-ec2-and-fix-dns-leaks-on-ubuntu-18.04-lts/5-keys.jpg#screenshot" alt="Key Pair Settings link" />
&lt;/p>
&lt;p>To create a new set of access credentials, click &amp;ldquo;Create a key pair in EC2&amp;rdquo; to open a new window. Then, click the &amp;ldquo;Create Key Pair&amp;rdquo; blue button. Once you give your key pair a name, it will be created and the private key will automatically download to your machine. It&amp;rsquo;s a file ending with the extension &lt;code>.pem&lt;/code>. Store this key in a secure place on your computer. We&amp;rsquo;ll need to refer to it when we connect to our new EC2 instance.&lt;/p>
&lt;p>We can return to the previous window to select the key pair we just created. If it doesn&amp;rsquo;t show up, hit the little &amp;ldquo;refresh&amp;rdquo; icon next to the drop-down. Once it&amp;rsquo;s selected, hit the shiny yellow &amp;ldquo;Launch&amp;rdquo; button.&lt;/p>
&lt;p>We should see a message like this:&lt;/p>
&lt;p>
&lt;img src="https://victoria.dev/blog/how-to-set-up-openvpn-on-aws-ec2-and-fix-dns-leaks-on-ubuntu-18.04-lts/6-launched.jpg#screenshot" alt="Launch success message" />
&lt;/p>
&lt;p>Great stuff! Now that our instance exists, let&amp;rsquo;s make sure we can access it and start up our VPN. For a shortcut to the next step, click on the &amp;ldquo;EC2 Console&amp;rdquo; link in the success message.&lt;/p>
&lt;h3 id="2-associate-an-elastic-ip" class="anchor-link">&lt;a href="#2-associate-an-elastic-ip">2. Associate an Elastic IP&lt;/a>&lt;/h3>
&lt;p>Amazon&amp;rsquo;s &lt;a href="https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/elastic-ip-addresses-eip.html">Elastic IP Addresses&lt;/a> provides us with a public IPv4 address controlled by our account, unlike the public IP address tied to our EC2 instance. It&amp;rsquo;s considered a best practice to create one and associate it with our VPN instance. If anything should go wrong with our instance, or if we want to use a new instance for our VPN in the future, the Elastic IP can be disassociated from the current instance and reassociated with our new one. This makes the transition seamless for our connected clients. Think of the Elastic IP like a web domain address that we register - we can point it at whatever we choose.&lt;/p>
&lt;p>We can create a new Elastic IP address on the &lt;a href="https://console.aws.amazon.com/ec2/">Amazon EC2 Console&lt;/a>. If you clicked the link from the success message above, we&amp;rsquo;re already there.&lt;/p>
&lt;p>
&lt;img src="https://victoria.dev/blog/how-to-set-up-openvpn-on-aws-ec2-and-fix-dns-leaks-on-ubuntu-18.04-lts/7-ec2.jpg#screenshot" alt="EC2 console" />
&lt;/p>
&lt;p>If you have more than one instance, take note of the Instance ID of the one we&amp;rsquo;ve just launched.&lt;/p>
&lt;p>In the left sidebar under &amp;ldquo;Network &amp;amp; Security,&amp;rdquo; choose &amp;ldquo;Elastic IPs.&amp;rdquo; Then click the blue &amp;ldquo;Allocate new address&amp;rdquo; button.&lt;/p>
&lt;p>
&lt;img src="https://victoria.dev/blog/how-to-set-up-openvpn-on-aws-ec2-and-fix-dns-leaks-on-ubuntu-18.04-lts/8-elasticip.jpg#screenshot" alt="Allocate new address page" />
&lt;/p>
&lt;p>Choose &amp;ldquo;Amazon Pool,&amp;rdquo; then click &amp;ldquo;Allocate.&amp;rdquo;&lt;/p>
&lt;p>
&lt;img src="https://victoria.dev/blog/how-to-set-up-openvpn-on-aws-ec2-and-fix-dns-leaks-on-ubuntu-18.04-lts/9-elasticip.jpg#screenshot" alt="Allocate elastic IP success message" />
&lt;/p>
&lt;p>Success! We can click &amp;ldquo;Close&amp;rdquo; to return to the Elastic IP console.&lt;/p>
&lt;p>
&lt;img src="https://victoria.dev/blog/how-to-set-up-openvpn-on-aws-ec2-and-fix-dns-leaks-on-ubuntu-18.04-lts/10-associateip.jpg#screenshot" alt="Associate elastic IP" />
&lt;/p>
&lt;p>Now that we have an Elastic IP, let&amp;rsquo;s associate it with our instance. Select the IP address, then click &amp;ldquo;Actions,&amp;rdquo; and choose &amp;ldquo;Associate address.&amp;rdquo;&lt;/p>
&lt;p>
&lt;img src="https://victoria.dev/blog/how-to-set-up-openvpn-on-aws-ec2-and-fix-dns-leaks-on-ubuntu-18.04-lts/11-associateip.jpg#screenshot" alt="Associate elastic IP with instance" />
&lt;/p>
&lt;p>Ensure the &amp;ldquo;Instance&amp;rdquo; option is selected, then click the drop-down menu. We should see our EC2 instance ID there. Select it, then click &amp;ldquo;Associate.&amp;rdquo;&lt;/p>
&lt;p>
&lt;img src="https://victoria.dev/blog/how-to-set-up-openvpn-on-aws-ec2-and-fix-dns-leaks-on-ubuntu-18.04-lts/12-associateip.jpg#screenshot" alt="Associate elastic IP success message" />
&lt;/p>
&lt;p>Success! Now that we&amp;rsquo;ll be able to access our VPN instance, let&amp;rsquo;s get our VPN service up and running.&lt;/p>
&lt;h3 id="3-initialize-openvpn-on-the-ec2-server" class="anchor-link">&lt;a href="#3-initialize-openvpn-on-the-ec2-server">3. Initialize OpenVPN on the EC2 server&lt;/a>&lt;/h3>
&lt;p>First, we&amp;rsquo;ll need to connect to the EC2 instance via our terminal. We&amp;rsquo;ll use the private key we created earlier.&lt;/p>
&lt;p>Open a new terminal window and navigate to the directory containing the private key &lt;code>.pem&lt;/code> file. We&amp;rsquo;ll need to set its permissions with:&lt;/p>
&lt;div class="highlight">&lt;pre class="chroma">&lt;code class="language-sh" data-lang="sh">sudo chmod &lt;span class="m">400&lt;/span> &amp;lt;name&amp;gt;.pem
&lt;/code>&lt;/pre>&lt;/div>&lt;p>Be sure to substitute &lt;code>&amp;lt;name&amp;gt;&lt;/code> with the name of your key.&lt;/p>
&lt;p>This sets the file permissions to &lt;code>-r--------&lt;/code> so that it can only be read by the user (you). It may help to protect the private key from read and write operations by other users, but more pertinently, will prevent AWS from throwing an error when we try to connect to our instance.&lt;/p>
&lt;p>We can now do just that by running:&lt;/p>
&lt;div class="highlight">&lt;pre class="chroma">&lt;code class="language-sh" data-lang="sh">ssh -i &amp;lt;name&amp;gt;.pem openvpnas@&amp;lt;elastic ip&amp;gt;
&lt;/code>&lt;/pre>&lt;/div>&lt;p>The user &lt;code>openvpnas&lt;/code> is set up by the OpenVPN Access Server to allow us to connect to our instance. Replace &lt;code>&amp;lt;elastic ip&amp;gt;&lt;/code> with the Elastic IP address we just associated.&lt;/p>
&lt;p>We may get a message saying that the authenticity of our host can&amp;rsquo;t be established. As long as we&amp;rsquo;ve typed the Elastic IP correctly, we can go ahead and answer &amp;ldquo;yes&amp;rdquo; to the prompt.&lt;/p>
&lt;p>Upon the initial connection to the OpenVPN instance, a set up wizard called &amp;ldquo;Initial Configuration Tool&amp;rdquo; should automatically run. (If, for some reason, it doesn&amp;rsquo;t, or you panic-mashed a button, we can restart it with &lt;code>sudo ovpn-init ec2&lt;/code>.) We&amp;rsquo;ll be asked to accept the agreement, then the wizard will help to walk us through some configuration settings for our VPN server.&lt;/p>
&lt;p>You may generally accept the default settings, however, there are a couple questions you may like to answer knowledgeably. They are:&lt;/p>
&lt;blockquote>
&lt;p>&lt;strong>Should client traffic be routed by default through the VPN?&lt;/strong>
&lt;strong>Should client DNS traffic be routed by default through the VPN?&lt;/strong>
When asked for our &amp;ldquo;OpenVPN-AS license key&amp;rdquo;, we can leave it blank to use the VPN with up to two clients. If you&amp;rsquo;ve purchased a key, enter it here.
Once the configuration wizard finishes running, we should see the message &amp;ldquo;Initial Configuration Complete!&amp;rdquo; Before we move on, we should set a password for our server&amp;rsquo;s administration account. To do this, run:&lt;/p>
&lt;/blockquote>
&lt;div class="highlight">&lt;pre class="chroma">&lt;code class="language-sh" data-lang="sh">sudo passwd openvpn
&lt;/code>&lt;/pre>&lt;/div>&lt;p>Then enter your chosen password twice. Now we&amp;rsquo;re ready to get connected!&lt;/p>
&lt;p>To close the ssh connection, type &lt;code>exit&lt;/code>.&lt;/p>
&lt;h3 id="4-connect-the-client-to-the-vpn" class="anchor-link">&lt;a href="#4-connect-the-client-to-the-vpn">4. Connect the client to the VPN&lt;/a>&lt;/h3>
&lt;p>To connect our client (in this case, our laptop) to the VPN and start reaping the benefits, we&amp;rsquo;ll need to do two things; first, obtain our connection profile; second, install the &lt;code>openvpn&lt;/code> daemon.&lt;/p>
&lt;h4 id="1-get-your-ovpn-connection-profile" class="anchor-link">&lt;a href="#1-get-your-ovpn-connection-profile">1. Get your &lt;code>.ovpn&lt;/code> connection profile&lt;/a>&lt;/h4>
&lt;p>We&amp;rsquo;ll need to download a connection profile for ourselves; this is like a personal configuration file with information, including keys, that the VPN server will need to allow our connection. We can do this by logging in with the password we just set at our Elastic IP address, port 943. This looks like:&lt;/p>
&lt;div class="highlight">&lt;pre class="chroma">&lt;code class="language-sh" data-lang="sh">https://&amp;lt;elastic ip&amp;gt;:943/
&lt;/code>&lt;/pre>&lt;/div>&lt;p>The &lt;code>https&lt;/code> part is important; without it, the instance won&amp;rsquo;t send any data.&lt;/p>
&lt;p>When we go to this URL, we may see a page warning us that this site&amp;rsquo;s certificate issuer is unknown or invalid. As long as we&amp;rsquo;ve typed our Elastic IP correctly, it&amp;rsquo;s safe to proceed. If you&amp;rsquo;re using Firefox, click &amp;ldquo;Advanced,&amp;rdquo; and then &amp;ldquo;Accept the Risk and Continue.&amp;rdquo; In Chrome, click &amp;ldquo;Advanced,&amp;rdquo; then &amp;ldquo;Proceed to &amp;hellip;&amp;rdquo; the elastic IP.&lt;/p>
&lt;p>
&lt;img src="https://victoria.dev/blog/how-to-set-up-openvpn-on-aws-ec2-and-fix-dns-leaks-on-ubuntu-18.04-lts/13-warning.jpg#screenshot" alt="Security warning page" />
&lt;/p>
&lt;p>Log in with the username &lt;code>openvpn&lt;/code> and the password we just set. We&amp;rsquo;ll now be presented with a link to download our user-locked connection profile:&lt;/p>
&lt;p>
&lt;img src="https://victoria.dev/blog/how-to-set-up-openvpn-on-aws-ec2-and-fix-dns-leaks-on-ubuntu-18.04-lts/14-profile.jpg#screenshot" alt="Connection profile download page" />
&lt;/p>
&lt;p>When we click the link, a file named &lt;code>client.ovpn&lt;/code> will download.&lt;/p>
&lt;h4 id="2-install-and-start-openvpn-on-your-ubuntu-1804-client" class="anchor-link">&lt;a href="#2-install-and-start-openvpn-on-your-ubuntu-1804-client">2. Install and start &lt;code>openvpn&lt;/code> on your Ubuntu 18.04 client&lt;/a>&lt;/h4>
&lt;p>The &lt;code>openvpn&lt;/code> daemon will allow our client to connect to our VPN server. It can be installed through the default Ubuntu repositories. Run:&lt;/p>
&lt;div class="highlight">&lt;pre class="chroma">&lt;code class="language-sh" data-lang="sh">sudo apt install openvpn
&lt;/code>&lt;/pre>&lt;/div>&lt;p>In order for OpenVPN to automatically start when we boot up our computer, we&amp;rsquo;ll need to rename and move the connection profile file. I suggest using a &lt;a href="https://en.wikipedia.org/wiki/Symbolic_link">symlink&lt;/a> to accomplish this, as it leaves our original file more easily accessible for editing, and allows us to store it in any directory we choose. We can create a symlink by running this command in the directory where our file is located:&lt;/p>
&lt;div class="highlight">&lt;pre class="chroma">&lt;code class="language-sh" data-lang="sh">sudo ln -s client.ovpn /etc/openvpn/&amp;lt;name&amp;gt;.conf
&lt;/code>&lt;/pre>&lt;/div>&lt;p>This creates a symbolic link for the connection profile in the appropriate folder for &lt;code>systemd&lt;/code> to find it. The &lt;code>&amp;lt;name&amp;gt;&lt;/code> can be anything. When the Linux kernel has booted, &lt;code>systemd&lt;/code> is used to initialize the services and daemons that the user has set up to run; one of these will now be OpenVPN. Renaming the file with the extension &lt;code>.conf&lt;/code> will let the &lt;code>openvpn&lt;/code> daemon know to use it as our connection file.&lt;/p>
&lt;p>For now, we can manually start and connect to OpenVPN by running:&lt;/p>
&lt;div class="highlight">&lt;pre class="chroma">&lt;code class="language-sh" data-lang="sh">sudo openvpn --config client.ovpn
&lt;/code>&lt;/pre>&lt;/div>&lt;p>We&amp;rsquo;ll be asked for a username and password, which will be the same credentials we used before. Once the service finishes starting up, we&amp;rsquo;ll see &amp;ldquo;Initialization Sequence Complete.&amp;rdquo; If we now visit &lt;a href="https://www.dnsleaktest.com/">the DNS leak test website&lt;/a>, we should see the Elastic IP and the location of our EC2 server. Yay!&lt;/p>
&lt;p>If you&amp;rsquo;re on a later version of Ubuntu, you may check for DNS leaks by clicking on one of the &amp;ldquo;test&amp;rdquo; buttons. If all the ISPs shown are Amazon and none are your own service provider&amp;rsquo;s, congratulations! No leaks! You can move on to &lt;a href="#3-set-up-openvpn-as-networkmanager-system-connection">Step 3 in the second section&lt;/a> below, after which, you&amp;rsquo;ll be finished.&lt;/p>
&lt;p>If you&amp;rsquo;re using Ubuntu 18.04 LTS, however, we&amp;rsquo;re not yet done.&lt;/p>
&lt;h2 id="what-a-dns-leak-looks-like" class="anchor-link">&lt;a href="#what-a-dns-leak-looks-like">What a DNS leak looks like&lt;/a>&lt;/h2>
&lt;p>To see what a DNS leak looks like, click on one of the &amp;ldquo;test&amp;rdquo; buttons on the &lt;a href="https://www.dnsleaktest.com/">the DNS leak test page&lt;/a>. When we do, we&amp;rsquo;ll see not only our Amazon.com IP addresses, but also our own ISP and location.&lt;/p>
&lt;p>We can also see the leak by running &lt;code>systemd-resolve --status&lt;/code> in our terminal. Our results will contain two lines under different interfaces that both have entries for DNS Servers. It&amp;rsquo;ll look something like this:&lt;/p>
&lt;div class="highlight">&lt;pre class="chroma">&lt;code class="language-sh" data-lang="sh">Link &lt;span class="m">7&lt;/span> &lt;span class="o">(&lt;/span>tun0&lt;span class="o">)&lt;/span>
Current Scopes: DNS
LLMNR setting: yes
MulticastDNS setting: no
DNSSEC setting: no
DNSSEC supported: no
DNS Servers: 172.31.0.2
DNS Domain: ~.
Link &lt;span class="m">3&lt;/span> &lt;span class="o">(&lt;/span>wlp4s0&lt;span class="o">)&lt;/span>
Current Scopes: none
LLMNR setting: yes
MulticastDNS setting: no
DNSSEC setting: no
DNSSEC supported: no
DNS Servers: 192.168.0.1
DNS Domain: ~.
&lt;/code>&lt;/pre>&lt;/div>&lt;p>The &lt;a href="https://unix.stackexchange.com/questions/434916/how-to-fix-openvpn-dns-leak">DNS leak problem in Ubuntu 18.04&lt;/a> stems from Ubuntu&amp;rsquo;s DNS resolver, &lt;code>systemd-resolved&lt;/code>, failing to properly handle our OpenVPN configuration. In order to try and be a good, efficient DNS resolver, &lt;code>systemd-resolved&lt;/code> will send DNS lookup requests in parallel to each interface that has a DNS server configuration, and then utilizes the fastest response. In our case, we only want to use our VPN&amp;rsquo;s DNS servers. Sorry, &lt;code>systemd-resolved&lt;/code>. You tried.&lt;/p>
&lt;h2 id="how-to-fix-openvpn-dns-leak-on-ubuntu-1804" class="anchor-link">&lt;a href="#how-to-fix-openvpn-dns-leak-on-ubuntu-1804">How to fix OpenVPN DNS leak on Ubuntu 18.04&lt;/a>&lt;/h2>
&lt;p>Luckily, there is a fix that we can implement. We&amp;rsquo;ll need to install a few helpers from the Ubuntu repositories, update our configuration file, then set up OpenVPN using NetworkManager. Let&amp;rsquo;s do it!&lt;/p>
&lt;h3 id="1-install-some-helpers" class="anchor-link">&lt;a href="#1-install-some-helpers">1. Install some helpers&lt;/a>&lt;/h3>
&lt;p>To properly integrate OpenVPN with &lt;code>systemd-resolved&lt;/code>, we&amp;rsquo;ll need a bit more help. In a terminal, run:&lt;/p>
&lt;div class="highlight">&lt;pre class="chroma">&lt;code class="language-sh" data-lang="sh">sudo apt install -y openvpn-systemd-resolved network-manager-openvpn network-manager-openvpn-gnome
&lt;/code>&lt;/pre>&lt;/div>&lt;p>This will install a helper script that integrates OpenVPN and &lt;code>systemd-resolved&lt;/code>, a NetworkManager plugin for OpenVPN, and its GUI counterpart for GNOME desktop environment.&lt;/p>
&lt;h3 id="2-add-dns-implementation-to-your-connection-profile" class="anchor-link">&lt;a href="#2-add-dns-implementation-to-your-connection-profile">2. Add DNS implementation to your connection profile&lt;/a>&lt;/h3>
&lt;p>We&amp;rsquo;ll need to edit the connection profile file we downloaded earlier. Since it&amp;rsquo;s symbolically linked, we can accomplish this by changing the &lt;code>.ovpn&lt;/code> file, wherever it&amp;rsquo;s stored. Run &lt;code>vim &amp;lt;name&amp;gt;.ovpn&lt;/code> to open it in Vim, then add the following lines at the bottom. Explanation in the comments:&lt;/p>
&lt;div class="highlight">&lt;pre class="chroma">&lt;code class="language-sh" data-lang="sh">&lt;span class="c1"># Allow OpenVPN to call user-defined scripts&lt;/span>
script-security &lt;span class="m">2&lt;/span>
&lt;span class="c1"># Tell systemd-resolved to send all DNS queries over the VPN&lt;/span>
dhcp-option DOMAIN-ROUTE .
&lt;span class="c1"># Use the update-systemd-resolved script when TUN/TAP device is opened,&lt;/span>
&lt;span class="c1"># and also run the script on restarts and before the TUN/TAP device is closed&lt;/span>
up /etc/openvpn/update-systemd-resolved
up-restart
down /etc/openvpn/update-systemd-resolved
down-pre
&lt;/code>&lt;/pre>&lt;/div>&lt;p>For the full list of OpenVPN options, see &lt;a href="https://openvpn.net/community-resources/reference-manual-for-openvpn-2-1/">OpenVPN Scripting and Environment Variables&lt;/a>. You may also like &lt;a href="https://en.wikipedia.org/wiki/TUN/TAP">more information about TUN/TAP&lt;/a>.&lt;/p>
&lt;h3 id="3-set-up-openvpn-as-networkmanager-system-connection" class="anchor-link">&lt;a href="#3-set-up-openvpn-as-networkmanager-system-connection">3. Set up OpenVPN as NetworkManager system connection&lt;/a>&lt;/h3>
&lt;p>We&amp;rsquo;ll use the GUI to set up our VPN with NetworkManager. Open up Network Settings, which should look something like this:&lt;/p>
&lt;p>
&lt;img src="https://victoria.dev/blog/how-to-set-up-openvpn-on-aws-ec2-and-fix-dns-leaks-on-ubuntu-18.04-lts/15-networksettings.png#screenshot" alt="Network Settings window on Ubuntu 18.04" />
&lt;/p>
&lt;p>Then click the &amp;ldquo;+&amp;rdquo; button. On the window that pops up, counterintuitively, choose &amp;ldquo;Import from file&amp;hellip;&amp;rdquo; instead of the OpenVPN option.&lt;/p>
&lt;p>
&lt;img src="https://victoria.dev/blog/how-to-set-up-openvpn-on-aws-ec2-and-fix-dns-leaks-on-ubuntu-18.04-lts/16-importvpn.jpg#screenshot" alt="Add VPN window" />
&lt;/p>
&lt;p>Navigate to, and then select, your &lt;code>.ovpn&lt;/code> file. We should now see something like this:&lt;/p>
&lt;p>
&lt;img src="https://victoria.dev/blog/how-to-set-up-openvpn-on-aws-ec2-and-fix-dns-leaks-on-ubuntu-18.04-lts/17-vpnsettings.png#screenshot" alt="The filled VPN connection settings" />
&lt;/p>
&lt;p>Add your username and password for the server (&lt;code>openvpn&lt;/code> and the password we set in &lt;a href="#3-initialize-openvpn-on-the-ec2-server">the first section&amp;rsquo;s Step 3&lt;/a>), and your user key password (the same one again, if you&amp;rsquo;ve followed this tutorial), then click the &amp;ldquo;Add&amp;rdquo; button.&lt;/p>
&lt;h3 id="4-edit-your-openvpn-networkmanager-configuration" class="anchor-link">&lt;a href="#4-edit-your-openvpn-networkmanager-configuration">4. Edit your OpenVPN NetworkManager configuration&lt;/a>&lt;/h3>
&lt;p>Nearly there! Now that we&amp;rsquo;ve added the VPN as a NetworkManager connection, we&amp;rsquo;ll need to make a quick change to it. We can see a list of NetworkManager connections by running:&lt;/p>
&lt;div class="highlight">&lt;pre class="chroma">&lt;code class="language-sh" data-lang="sh">ls -la /etc/NetworkManager/system-connections/*
&lt;/code>&lt;/pre>&lt;/div>&lt;p>The one for our VPN is probably called &lt;code>openvpn&lt;/code>, so let&amp;rsquo;s edit it by running:&lt;/p>
&lt;div class="highlight">&lt;pre class="chroma">&lt;code class="language-sh" data-lang="sh">sudo vim /etc/NetworkManager/system-connections/openvpn
&lt;/code>&lt;/pre>&lt;/div>&lt;p>Under &lt;code>[ipv4]&lt;/code>, we&amp;rsquo;ll need to add the line &lt;code>dns-priority=-42&lt;/code>. It should end up looking like this:&lt;/p>
&lt;p>
&lt;img src="https://victoria.dev/blog/how-to-set-up-openvpn-on-aws-ec2-and-fix-dns-leaks-on-ubuntu-18.04-lts/18-connsettings.jpg#screenshot" alt="Connection settings for ipv4" />
&lt;/p>
&lt;p>Setting a negative number is a workaround that prioritizes this DNS server. The actual number is arbitrary (&lt;code>-1&lt;/code> should also work) but I like 42. \_()_/&lt;/p>
&lt;h3 id="5-restart-connect-profit" class="anchor-link">&lt;a href="#5-restart-connect-profit">5. Restart, connect, profit&lt;/a>&lt;/h3>
&lt;p>In a terminal, run:&lt;/p>
&lt;div class="highlight">&lt;pre class="chroma">&lt;code class="language-sh" data-lang="sh">sudo service network-manager restart
&lt;/code>&lt;/pre>&lt;/div>&lt;p>Then in the Network Settings, click the magic button that turns on the VPN:&lt;/p>
&lt;p>
&lt;img src="https://victoria.dev/blog/how-to-set-up-openvpn-on-aws-ec2-and-fix-dns-leaks-on-ubuntu-18.04-lts/19-vpnon.jpg#screenshot" alt="Network Settings window" />
&lt;/p>
&lt;p>Finally, visit &lt;a href="https://www.dnsleaktest.com/">the DNS leak test website&lt;/a> and click on &amp;ldquo;Extended test&amp;rdquo; to verify the fix. If everything&amp;rsquo;s working properly, we should now see a list containing only our VPN ISP.&lt;/p>
&lt;p>
&lt;img src="https://victoria.dev/blog/how-to-set-up-openvpn-on-aws-ec2-and-fix-dns-leaks-on-ubuntu-18.04-lts/20-noleaks.png#screenshot" alt="Successful DNS leak test results" />
&lt;/p>
&lt;p>And we&amp;rsquo;re done! Congratulations on rolling your very own VPN server and stopping DNS leaks with OpenVPN. Enjoy surfing in (relative) privacy. Now your only worry at the local coffeeshop is who&amp;rsquo;s watching you surf from the seat behind you.&lt;/p></content:encoded><enclosure url="https://victoria.dev/blog/how-to-set-up-openvpn-on-aws-ec2-and-fix-dns-leaks-on-ubuntu-18.04-lts/cover_hudf0a9e712aaa7cfff13d04d6bd5de865_250170_640x0_resize_box_2.png" type="image/jpg"/></item><item><title>How to do twice as much with half the keystrokes using `.bashrc`</title><link>https://victoria.dev/blog/how-to-do-twice-as-much-with-half-the-keystrokes-using-.bashrc/</link><pubDate>Wed, 21 Aug 2019 09:17:02 -0400</pubDate><author>hello@victoria.dev (Victoria Drake)</author><guid>https://victoria.dev/blog/how-to-do-twice-as-much-with-half-the-keystrokes-using-.bashrc/</guid><description>An overview of time-saving aliases, functions, and creating a useful Bash prompt.</description><content:encoded>
&lt;img src="https://victoria.dev/blog/how-to-do-twice-as-much-with-half-the-keystrokes-using-.bashrc/cover_huc91640f9694e31ff03eab28f9c840023_19597_640x0_resize_box_2.png" width="640" height="245"/>
&lt;p>In my &lt;a href="https://victoria.dev/blog/how-to-set-up-a-fresh-ubuntu-desktop-using-only-dotfiles-and-bash-scripts/">recent post about setting up Ubuntu with Bash scripts&lt;/a>, I briefly alluded to the magic of &lt;code>.bashrc&lt;/code>. This didn&amp;rsquo;t really do it justice, so here&amp;rsquo;s a quick post that offers a bit more detail about what the Bash configuration file can do.&lt;/p>
&lt;p>My current configuration hugely improves my workflow, and saves me well over 50% of the keystrokes I would have to employ without it! Let&amp;rsquo;s look at some examples of aliases, functions, and prompt configurations that can improve our workflow by helping us be more efficient with fewer key presses.&lt;/p>
&lt;h2 id="bash-aliases" class="anchor-link">&lt;a href="#bash-aliases">Bash aliases&lt;/a>&lt;/h2>
&lt;p>A smartly written &lt;code>.bashrc&lt;/code> can save a whole lot of keystrokes. We can take advantage of this in the literal sense by using &lt;a href="https://www.gnu.org/software/bash/manual/html_node/Aliases.html">bash aliases&lt;/a>, or strings that expand to larger commands. For an indicative example, here is a Bash alias for copying files in the terminal:&lt;/p>
&lt;div class="highlight">&lt;pre class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="c1"># Always copy contents of directories (r)ecursively and explain (v) what was done&lt;/span>
&lt;span class="nb">alias&lt;/span> &lt;span class="nv">cp&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s1">&amp;#39;cp -rv&amp;#39;&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>The &lt;code>alias&lt;/code> command defines the string we&amp;rsquo;ll type, followed by what that string will expand to. We can override existing commands like &lt;code>cp&lt;/code> above. On its own, the &lt;code>cp&lt;/code> command will only copy files, not directories, and succeeds silently. With this alias, we need not remember to pass those two flags, nor &lt;code>cd&lt;/code> or &lt;code>ls&lt;/code> the location of our copied file to confirm that it&amp;rsquo;s there! Now, just those two key presses (for &lt;code>c&lt;/code> and &lt;code>d&lt;/code>) will do all of that for us.&lt;/p>
&lt;p>Here are a few more &lt;code>.bashrc&lt;/code> aliases for passing flags with common functions.&lt;/p>
&lt;div class="highlight">&lt;pre class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="c1"># List contents with colors for file types, (A)lmost all hidden files (without . and ..), in (C)olumns, with class indicators (F)&lt;/span>
&lt;span class="nb">alias&lt;/span> &lt;span class="nv">ls&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s1">&amp;#39;ls --color=auto -ACF&amp;#39;&lt;/span>
&lt;span class="c1"># List contents with colors for file types, (a)ll hidden entries (including . and ..), use (l)ong listing format, with class indicators (F)&lt;/span>
&lt;span class="nb">alias&lt;/span> &lt;span class="nv">ll&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s1">&amp;#39;ls --color=auto -alF&amp;#39;&lt;/span>
&lt;span class="c1"># Explain (v) what was done when moving a file&lt;/span>
&lt;span class="nb">alias&lt;/span> &lt;span class="nv">mv&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s1">&amp;#39;mv -v&amp;#39;&lt;/span>
&lt;span class="c1"># Create any non-existent (p)arent directories and explain (v) what was done&lt;/span>
&lt;span class="nb">alias&lt;/span> &lt;span class="nv">mkdir&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s1">&amp;#39;mkdir -pv&amp;#39;&lt;/span>
&lt;span class="c1"># Always try to (c)ontinue getting a partially-downloaded file&lt;/span>
&lt;span class="nb">alias&lt;/span> &lt;span class="nv">wget&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s1">&amp;#39;wget -c&amp;#39;&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>Aliases come in handy when we want to avoid typing long commands, too. Here are a few I use when working with Python environments:&lt;/p>
&lt;div class="highlight">&lt;pre class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="nb">alias&lt;/span> &lt;span class="nv">pym&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s1">&amp;#39;python3 manage.py&amp;#39;&lt;/span>
&lt;span class="nb">alias&lt;/span> &lt;span class="nv">mkenv&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s1">&amp;#39;python3 -m venv env&amp;#39;&lt;/span>
&lt;span class="nb">alias&lt;/span> &lt;span class="nv">startenv&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s1">&amp;#39;source env/bin/activate &amp;amp;&amp;amp; which python3&amp;#39;&lt;/span>
&lt;span class="nb">alias&lt;/span> &lt;span class="nv">stopenv&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s1">&amp;#39;deactivate&amp;#39;&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>For further inspiration on ways Bash aliases can save time, I highly recommend &lt;a href="https://www.digitalocean.com/community/tutorials/an-introduction-to-useful-bash-aliases-and-functions">the examples in this article&lt;/a>.&lt;/p>
&lt;h2 id="bash-functions" class="anchor-link">&lt;a href="#bash-functions">Bash functions&lt;/a>&lt;/h2>
&lt;p>One downside of the aliases above is that they&amp;rsquo;re rather static - they&amp;rsquo;ll always expand to exactly the text declared. For a Bash alias that takes arguments, we&amp;rsquo;ll need to create a function. We can do this like so:&lt;/p>
&lt;div class="highlight">&lt;pre class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="c1"># Show contents of the directory after changing to it&lt;/span>
&lt;span class="k">function&lt;/span> &lt;span class="nb">cd&lt;/span> &lt;span class="o">()&lt;/span> &lt;span class="o">{&lt;/span>
&lt;span class="nb">builtin&lt;/span> &lt;span class="nb">cd&lt;/span> &lt;span class="s2">&amp;#34;&lt;/span>&lt;span class="nv">$1&lt;/span>&lt;span class="s2">&amp;#34;&lt;/span>
ls -ACF
&lt;span class="o">}&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>I can&amp;rsquo;t begin to tally how many times I&amp;rsquo;ve typed &lt;code>cd&lt;/code> and then &lt;code>ls&lt;/code> immediately after to see the contents of the directory I&amp;rsquo;m now in. With this function set up, it all happens with just those two letters! The function takes the first argument, &lt;code>$1&lt;/code>, as the location to change directory to, then prints the contents of that directory in nicely formatted columns with file type indicators. The &lt;code>builtin&lt;/code> part is necessary to get Bash to allow us to override this default command.&lt;/p>
&lt;p>Bash functions are very useful when it comes to downloading or upgrading software, too. I previously spent at least a few minutes every couple weeks downloading the new extended version of the &lt;a href="https://gohugo.io/categories/releases">static site generator Hugo&lt;/a>, thanks to their excellent shipping frequency. With a function, I only need to pass in the version, and the upgrade happens in a few seconds.&lt;/p>
&lt;div class="highlight">&lt;pre class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="c1"># Hugo install or upgrade&lt;/span>
&lt;span class="k">function&lt;/span> gethugo &lt;span class="o">()&lt;/span> &lt;span class="o">{&lt;/span>
wget -q -P tmp/ https://github.com/gohugoio/hugo/releases/download/v&lt;span class="s2">&amp;#34;&lt;/span>&lt;span class="nv">$@&lt;/span>&lt;span class="s2">&amp;#34;&lt;/span>/hugo_extended_&lt;span class="s2">&amp;#34;&lt;/span>&lt;span class="nv">$@&lt;/span>&lt;span class="s2">&amp;#34;&lt;/span>_Linux-64bit.tar.gz
tar xf tmp/hugo_extended_&lt;span class="s2">&amp;#34;&lt;/span>&lt;span class="nv">$@&lt;/span>&lt;span class="s2">&amp;#34;&lt;/span>_Linux-64bit.tar.gz -C tmp/
sudo mv -f tmp/hugo /usr/local/bin/
rm -rf tmp/
hugo version
&lt;span class="o">}&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>The &lt;code>$@&lt;/code> notation simply takes all the arguments given, replacing its spot in the function. To run the above function and download Hugo version 0.57.2, we use the command &lt;code>gethugo 0.57.2&lt;/code>.&lt;/p>
&lt;p>I&amp;rsquo;ve got one for &lt;a href="https://golang.org/">Golang&lt;/a>, too:&lt;/p>
&lt;div class="highlight">&lt;pre class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="k">function&lt;/span> getgolang &lt;span class="o">()&lt;/span> &lt;span class="o">{&lt;/span>
sudo rm -rf /usr/local/go
wget -q -P tmp/ https://dl.google.com/go/go&lt;span class="s2">&amp;#34;&lt;/span>&lt;span class="nv">$@&lt;/span>&lt;span class="s2">&amp;#34;&lt;/span>.linux-amd64.tar.gz
sudo tar -C /usr/local -xzf tmp/go&lt;span class="s2">&amp;#34;&lt;/span>&lt;span class="nv">$@&lt;/span>&lt;span class="s2">&amp;#34;&lt;/span>.linux-amd64.tar.gz
rm -rf tmp/
go version
&lt;span class="o">}&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>Or how about a function that adds a remote origin URL for GitLab to the current repository?&lt;/p>
&lt;div class="highlight">&lt;pre class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="k">function&lt;/span> glab &lt;span class="o">()&lt;/span> &lt;span class="o">{&lt;/span>
git remote set-url origin --add git@gitlab.com:&lt;span class="s2">&amp;#34;&lt;/span>&lt;span class="nv">$@&lt;/span>&lt;span class="s2">&amp;#34;&lt;/span>/&lt;span class="s2">&amp;#34;&lt;/span>&lt;span class="si">${&lt;/span>&lt;span class="nv">PWD&lt;/span>&lt;span class="p">##*/&lt;/span>&lt;span class="si">}&lt;/span>&lt;span class="s2">&amp;#34;&lt;/span>.git
git remote -v
&lt;span class="o">}&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>With &lt;code>glab username&lt;/code>, we can create a new &lt;code>origin&lt;/code> URL for the current Git repository with our &lt;code>username&lt;/code> on GitLab.com. Pushing to a new remote URL &lt;a href="https://victoria.dev/blog/how-to-write-bash-one-liners-for-cloning-and-managing-github-and-gitlab-repositories/#a-bash-one-liner-to-create-and-push-many-repositories-on-gitlab">automatically creates a new private GitLab repository&lt;/a>, so this is a useful shortcut for creating backups!&lt;/p>
&lt;p>Bash functions are really only limited by the possibilities of scripting, of which there are, practically, few limits. If there&amp;rsquo;s anything we do on a frequent basis that requires typing a few lines into a terminal, we can probably create a Bash function for it!&lt;/p>
&lt;h2 id="bash-prompt" class="anchor-link">&lt;a href="#bash-prompt">Bash prompt&lt;/a>&lt;/h2>
&lt;p>Besides directory contents, it&amp;rsquo;s also useful to see the full path of the directory we&amp;rsquo;re in. The Bash prompt can show us this path, along with other useful information like our current Git branch. To make it more readable, we can define colours for each part of the prompt. Here&amp;rsquo;s how we can set up our prompt in &lt;code>.bashrc&lt;/code> to accomplish this:&lt;/p>
&lt;div class="highlight">&lt;pre class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="c1"># Colour codes are cumbersome, so let&amp;#39;s name them&lt;/span>
&lt;span class="nv">txtcyn&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s1">&amp;#39;\[\e[0;96m\]&amp;#39;&lt;/span> &lt;span class="c1"># Cyan&lt;/span>
&lt;span class="nv">txtpur&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s1">&amp;#39;\[\e[0;35m\]&amp;#39;&lt;/span> &lt;span class="c1"># Purple&lt;/span>
&lt;span class="nv">txtwht&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s1">&amp;#39;\[\e[0;37m\]&amp;#39;&lt;/span> &lt;span class="c1"># White&lt;/span>
&lt;span class="nv">txtrst&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s1">&amp;#39;\[\e[0m\]&amp;#39;&lt;/span> &lt;span class="c1"># Text Reset&lt;/span>
&lt;span class="c1"># Which (C)olour for what part of the prompt?&lt;/span>
&lt;span class="nv">pathC&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s2">&amp;#34;&lt;/span>&lt;span class="si">${&lt;/span>&lt;span class="nv">txtcyn&lt;/span>&lt;span class="si">}&lt;/span>&lt;span class="s2">&amp;#34;&lt;/span>
&lt;span class="nv">gitC&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s2">&amp;#34;&lt;/span>&lt;span class="si">${&lt;/span>&lt;span class="nv">txtpur&lt;/span>&lt;span class="si">}&lt;/span>&lt;span class="s2">&amp;#34;&lt;/span>
&lt;span class="nv">pointerC&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s2">&amp;#34;&lt;/span>&lt;span class="si">${&lt;/span>&lt;span class="nv">txtwht&lt;/span>&lt;span class="si">}&lt;/span>&lt;span class="s2">&amp;#34;&lt;/span>
&lt;span class="nv">normalC&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s2">&amp;#34;&lt;/span>&lt;span class="si">${&lt;/span>&lt;span class="nv">txtrst&lt;/span>&lt;span class="si">}&lt;/span>&lt;span class="s2">&amp;#34;&lt;/span>
&lt;span class="c1"># Get the name of our branch and put parenthesis around it&lt;/span>
gitBranch&lt;span class="o">()&lt;/span> &lt;span class="o">{&lt;/span>
git branch 2&amp;gt; /dev/null &lt;span class="p">|&lt;/span> sed -e &lt;span class="s1">&amp;#39;/^[^*]/d&amp;#39;&lt;/span> -e &lt;span class="s1">&amp;#39;s/* \(.*\)/(\1)/&amp;#39;&lt;/span>
&lt;span class="o">}&lt;/span>
&lt;span class="c1"># Build the prompt&lt;/span>
&lt;span class="nb">export&lt;/span> &lt;span class="nv">PS1&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s2">&amp;#34;&lt;/span>&lt;span class="si">${&lt;/span>&lt;span class="nv">pathC&lt;/span>&lt;span class="si">}&lt;/span>&lt;span class="s2">\w &lt;/span>&lt;span class="si">${&lt;/span>&lt;span class="nv">gitC&lt;/span>&lt;span class="si">}&lt;/span>&lt;span class="s2">\$(gitBranch) &lt;/span>&lt;span class="si">${&lt;/span>&lt;span class="nv">pointerC&lt;/span>&lt;span class="si">}&lt;/span>&lt;span class="s2">\$&lt;/span>&lt;span class="si">${&lt;/span>&lt;span class="nv">normalC&lt;/span>&lt;span class="si">}&lt;/span>&lt;span class="s2"> &amp;#34;&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>Result:&lt;/p>
&lt;div class="highlight">&lt;pre class="chroma">&lt;code class="language-bash" data-lang="bash">~/github/myrepo &lt;span class="o">(&lt;/span>master&lt;span class="o">)&lt;/span> $
&lt;/code>&lt;/pre>&lt;/div>&lt;p>Naming the colours helps to easily identify where one colour starts and stops, and where the next one begins. The prompt that we see in our terminal is defined by the string following &lt;code>export PS1&lt;/code>, with each component of the prompt set with an &lt;a href="https://www.tldp.org/HOWTO/Bash-Prompt-HOWTO/bash-prompt-escape-sequences.html">escape sequence&lt;/a>. Let&amp;rsquo;s break that down:&lt;/p>
&lt;ul>
&lt;li>&lt;code>\w&lt;/code> displays the current working directory,&lt;/li>
&lt;li>&lt;code>\$(gitBranch)&lt;/code> calls the &lt;code>gitBranch&lt;/code> function defined above, which displays the current Git branch,&lt;/li>
&lt;li>&lt;code>\$&lt;/code> will display a &amp;ldquo;$&amp;rdquo; if you are a normal user or in normal user mode, and a &amp;ldquo;#&amp;rdquo; if you are root.&lt;/li>
&lt;/ul>
&lt;p>The &lt;a href="https://www.gnu.org/software/bash/manual/html_node/Controlling-the-Prompt.html">full list of Bash escape sequences&lt;/a> can help us display many more bits of information, including even the time and date! Bash prompts are highly customizable and individual, so feel free to set it up any way you please.&lt;/p>
&lt;p>Here are a few options that put information front and centre and can help us to work more efficiently.&lt;/p>
&lt;h3 id="for-the-procrastination-averse" class="anchor-link">&lt;a href="#for-the-procrastination-averse">For the procrastination-averse&lt;/a>&lt;/h3>
&lt;p>Username and current time with seconds, in 24-hour HH:MM:SS format:&lt;/p>
&lt;div class="highlight">&lt;pre class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="nb">export&lt;/span> &lt;span class="nv">PS1&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s2">&amp;#34;&lt;/span>&lt;span class="si">${&lt;/span>&lt;span class="nv">userC&lt;/span>&lt;span class="si">}&lt;/span>&lt;span class="s2">\u &lt;/span>&lt;span class="si">${&lt;/span>&lt;span class="nv">normalC&lt;/span>&lt;span class="si">}&lt;/span>&lt;span class="s2">at \t &amp;gt;&amp;#34;&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre class="chroma">&lt;code class="language-bash" data-lang="bash">user at 09:35:55 &amp;gt;
&lt;/code>&lt;/pre>&lt;/div>
&lt;h3 id="for-those-who-always-like-to-know-where-they-stand" class="anchor-link">&lt;a href="#for-those-who-always-like-to-know-where-they-stand">For those who always like to know where they stand&lt;/a>&lt;/h3>
&lt;p>Full file path on a separate line, and username:&lt;/p>
&lt;div class="highlight">&lt;pre class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="nb">export&lt;/span> &lt;span class="nv">PS1&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s2">&amp;#34;&lt;/span>&lt;span class="si">${&lt;/span>&lt;span class="nv">pathC&lt;/span>&lt;span class="si">}&lt;/span>&lt;span class="s2">\w&lt;/span>&lt;span class="si">${&lt;/span>&lt;span class="nv">normalC&lt;/span>&lt;span class="si">}&lt;/span>&lt;span class="s2">\n\u:&amp;#34;&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre class="chroma">&lt;code class="language-bash" data-lang="bash">~/github/myrepo
user:
&lt;/code>&lt;/pre>&lt;/div>
&lt;h3 id="for-the-minimalist" class="anchor-link">&lt;a href="#for-the-minimalist">For the minimalist&lt;/a>&lt;/h3>
&lt;div class="highlight">&lt;pre class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="nb">export&lt;/span> &lt;span class="nv">PS1&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s2">&amp;#34;&amp;gt;&amp;#34;&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre class="chroma">&lt;code class="language-bash" data-lang="bash">&amp;gt;
&lt;/code>&lt;/pre>&lt;/div>&lt;p>We can build many practical prompts with just the basic escape sequences; once we start to integrate functions with prompts, as in the Git branch example, things can get really complicated. Whether this amount of complication is an addition or a detriment to your productivity, only you can know for sure!&lt;/p>
&lt;p>Many fancy Bash prompts are possible with programs readily available with a quick search. I&amp;rsquo;ve intentionally not provided samples here because, well, if you can tend to get as excited about this stuff as I can, it might be a couple hours before you get back to what you were doing before you started reading this post, and I just can&amp;rsquo;t have that on my conscience. &lt;/p>
&lt;p>We&amp;rsquo;ve hopefully struck a nice balance now between time invested and usefulness gained from our Bash configuration file! I hope you use your newly-recovered keystroke capacity for good.&lt;/p></content:encoded><enclosure url="https://victoria.dev/blog/how-to-do-twice-as-much-with-half-the-keystrokes-using-.bashrc/cover_huc91640f9694e31ff03eab28f9c840023_19597_640x0_resize_box_2.png" type="image/jpg"/></item><item><title>How to set up a fresh Ubuntu desktop using only dotfiles and bash scripts</title><link>https://victoria.dev/blog/how-to-set-up-a-fresh-ubuntu-desktop-using-only-dotfiles-and-bash-scripts/</link><pubDate>Mon, 19 Aug 2019 07:58:18 -0400</pubDate><author>hello@victoria.dev (Victoria Drake)</author><guid>https://victoria.dev/blog/how-to-set-up-a-fresh-ubuntu-desktop-using-only-dotfiles-and-bash-scripts/</guid><description>Configure settings, install programs, and customize your desktop environment with a single bash command.</description><content:encoded>
&lt;img src="https://victoria.dev/blog/how-to-set-up-a-fresh-ubuntu-desktop-using-only-dotfiles-and-bash-scripts/cover_hu7503ff9e94bb9ad2ad596a79338ed3ec_587274_640x0_resize_q75_box.jpg" width="640" height="354"/>
&lt;p>One of my most favorite things about open source files on GitHub is the ability to see how others do (what some people might call) mundane things, like set up their &lt;code>.bashrc&lt;/code> and other dotfiles. While I&amp;rsquo;m not as enthusiastic about ricing as I was when I first came to the Linux side, I still get pretty excited when I find a config setting that makes things prettier and faster, and thus, better.&lt;/p>
&lt;p>I recently came across a few such things, particularly in &lt;a href="https://github.com/tomnomnom">Tom Hudson&amp;rsquo;s&lt;/a> dotfiles. Tom seems to like to script things, and some of those things include automatically setting up symlinks, and installing Ubuntu repository applications and other programs. This got me thinking. Could I automate the set up of a new machine to replicate my current one?&lt;/p>
&lt;p>Being someone generally inclined to take things apart in order to see how they work, I know I&amp;rsquo;ve messed up my laptop on occasion. (Usually when I&amp;rsquo;m away from home, and my backup hard drive isn&amp;rsquo;t.) On those rare but really inconvenient situations when my computer becomes a shell of its former self, (ba-dum-ching) it&amp;rsquo;d be quite nice to have a fast, simple way of putting Humpty Dumpty back together again, just the way I like.&lt;/p>
&lt;p>In contrast to creating a &lt;a href="https://askubuntu.com/questions/19901/how-to-make-a-disk-image-and-restore-from-it-later">disk image and restoring it later&lt;/a>, a collection of bash scripts is easier to create, maintain, and move around. They require no special utilities, only an external transportation method. It&amp;rsquo;s like passing along the recipe, instead of the whole bundt cake. (Mmm, cake.)&lt;/p>
&lt;p>Additionally, functionality like this would be super useful when setting up a virtual machine, or VM, or even just a virtual private server, or VPS. (Both of which, now that I write this, would probably make more forgiving targets for my more destructive experiments&amp;hellip; live and learn!)&lt;/p>
&lt;p>Well, after some grepping and Googling and digging around, I now have a suite of scripts that can do this:&lt;/p>
&lt;video controls="controls" poster="cover.jpg">
&lt;source src="setup.mp4" type="video/mp4" />
&lt;/video>
&lt;p>This is the tail end of a test run of the set up scripts on a fresh Ubuntu desktop, loaded off a bootable USB. It had all my programs and settings restored in under three minutes!&lt;/p>
&lt;p>This post will cover how to achieve the automatic set up of a computer running Ubuntu Desktop using bash scripts. This exact process was last used on Ubuntu 19.10; see my &lt;a href="https://github.com/victoriadrake/dotfiles">dotfiles master branch&lt;/a> for the latest configuration. The majority of the information covered is applicable to all the Linux desktop flavours, though some syntax may differ. The bash scripts cover three main areas: linking dotfiles, installing software from Ubuntu and elsewhere, and setting up the desktop environment. We&amp;rsquo;ll cover each of these areas and go over the important bits so that you can begin to craft your own scripts.&lt;/p>
&lt;h2 id="dotfiles" class="anchor-link">&lt;a href="#dotfiles">Dotfiles&lt;/a>&lt;/h2>
&lt;p>Dotfiles are what most Linux enthusiasts call configuration files. They typically live in the user&amp;rsquo;s home directory (denoted in bash scripts with the &lt;a href="https://www.tldp.org/LDP/abs/html/internal.html#BUILTINREF">builtin&lt;/a> variable &lt;code>$HOME&lt;/code>) and control the appearance and behavior of all kinds of programs. The file names begin with &lt;code>.&lt;/code>, which denotes hidden files in Linux (hence &amp;ldquo;dot&amp;rdquo; files). Here are some common dotfiles and ways in which they&amp;rsquo;re useful.&lt;/p>
&lt;h3 id="bashrc" class="anchor-link">&lt;a href="#bashrc">&lt;code>.bashrc&lt;/code>&lt;/a>&lt;/h3>
&lt;p>The &lt;code>.bashrc&lt;/code> file is a list of commands executed at startup by interactive, non-login shells. &lt;a href="https://www.tldp.org/LDP/abs/html/intandnonint.html">Interactive vs non-interactive shells&lt;/a> can be a little confusing, but aren&amp;rsquo;t necessary for us to worry about here. For our purposes, any time you open a new terminal, see a prompt, and can type commands into it, your &lt;code>.bashrc&lt;/code> was executed.&lt;/p>
&lt;p>Lines in this file can help improve your workflow by creating aliases that reduce keystrokes, or by displaying a helpful prompt with useful information. It can even run user-created programs, like &lt;a href="https://github.com/victoriadrake/eddie-terminal">Eddie&lt;/a>. For more ideas, you can have a look at &lt;a href="https://github.com/victoriadrake/dotfiles/blob/ubuntu-19.10/.bashrc">my &lt;code>.bashrc&lt;/code> file on GitHub&lt;/a>.&lt;/p>
&lt;h3 id="vimrc" class="anchor-link">&lt;a href="#vimrc">&lt;code>.vimrc&lt;/code>&lt;/a>&lt;/h3>
&lt;p>The &lt;code>.vimrc&lt;/code> dotfile configures the champion of all text editors, &lt;a href="https://www.vim.org/about.php">Vim&lt;/a>. (If you haven&amp;rsquo;t yet wielded the powers of the keyboard shortcuts, I highly recommend &lt;a href="https://vim-adventures.com/">a fun game to learn Vim with&lt;/a>.)&lt;/p>
&lt;p>In &lt;code>.vimrc&lt;/code>, we can set editor preferences such as display settings, colours, and custom keyboard shortcuts. You can take a look at &lt;a href="https://github.com/victoriadrake/dotfiles/blob/ubuntu-19.10/.vimrc">my &lt;code>.vimrc&lt;/code> on GitHub&lt;/a>.&lt;/p>
&lt;p>Other dotfiles may be useful depending on the programs you use, such as &lt;code>.gitconfig&lt;/code> or &lt;code>.tmux.conf&lt;/code>. Exploring dotfiles on GitHub is a great way to get a sense of what&amp;rsquo;s available and useful to you!&lt;/p>
&lt;h2 id="linking-dotfiles" class="anchor-link">&lt;a href="#linking-dotfiles">Linking dotfiles&lt;/a>&lt;/h2>
&lt;p>We can use a script to create symbolic links, or &lt;a href="https://en.wikipedia.org/wiki/Symbolic_link#POSIX_and_Unix-like_operating_systems">symlinks&lt;/a> for all our dotfiles. This allows us to keep all the files in a central repository, where they can easily be managed, while also providing a sort of placeholder in the spot that our programs expect the configuration file to be found. This is typically, but not always, the user home directory. For example, since I store my dotfiles on GitHub, I keep them in a directory with a path like &lt;code>~/github/dotfiles/&lt;/code> while the files themselves are symlinked, resulting in a path like &lt;code>~/.vimrc&lt;/code>.&lt;/p>
&lt;p>To programmatically check for and handle any existing files and symlinks, then create new ones, we can use &lt;a href="https://github.com/victoriadrake/dotfiles/blob/ubuntu-19.10/scripts/symlink.sh">this elegant shell script&lt;/a>. I compliment it only because I blatantly stole the core of it from &lt;a href="https://github.com/tomnomnom/dotfiles/blob/master/setup.sh">Tom&amp;rsquo;s setup script&lt;/a>, so I can&amp;rsquo;t take the credit for how lovely it is.&lt;/p>
&lt;p>The &lt;code>symlink.sh&lt;/code> script works by attempting to create symlinks for each dotfile in our &lt;code>$HOME&lt;/code>. It first checks to see if a symlink already exists, or if a regular file or directory with the same name exists. In the former case, the symlink is removed and remade; in the latter, the file or directory is renamed, then the symlink is made.&lt;/p>
&lt;h2 id="installing-software" class="anchor-link">&lt;a href="#installing-software">Installing software&lt;/a>&lt;/h2>
&lt;p>One of the beautiful things about exploring shell scripts is discovering how much can be achieved using only the command line. As someone whose first exposure to computers was through a graphical operating system, I find working in the terminal to be refreshingly fast.&lt;/p>
&lt;p>With Ubuntu, most programs we likely require are available through the default Ubuntu software repositories. We typically search for these with the command &lt;code>apt search &amp;lt;program&amp;gt;&lt;/code> and install them with &lt;code>sudo apt install &amp;lt;program&amp;gt;&lt;/code>. Some software we&amp;rsquo;d like may not be in the default repositories, or may not be offered there in the most current version. In these cases, we can still install these programs in Ubuntu using a &lt;a href="https://en.wikipedia.org/wiki/Ubuntu#Package_Archives">PPA, or Personal Package Archive&lt;/a>. We&amp;rsquo;ll just have to be careful that the PPAs we choose are from the official sources.&lt;/p>
&lt;p>If a program we&amp;rsquo;d like doesn&amp;rsquo;t appear in the default repositories or doesn&amp;rsquo;t seem to have a PPA, we may still be able to install it via command line. A quick search for &amp;ldquo;&lt;program> installation command line&amp;rdquo; should get some answers.&lt;/p>
&lt;p>Since bash scripts are just a collection of commands that we could run individually in the terminal, creating a script to install all our desired programs is as straightforward as putting all the commands into a script file. I chose to organize my installation scripts between the default repositories, which are installed by &lt;a href="https://github.com/victoriadrake/dotfiles/blob/ubuntu-19.10/scripts/aptinstall.sh">my &lt;code>aptinstall.sh&lt;/code> script&lt;/a>, and programs that involve external sources, handled with &lt;a href="https://github.com/victoriadrake/dotfiles/blob/ubuntu-19.10/scripts/programs.sh">my &lt;code>programs.sh&lt;/code> script&lt;/a>.&lt;/p>
&lt;h2 id="setting-up-the-desktop-environment" class="anchor-link">&lt;a href="#setting-up-the-desktop-environment">Setting up the desktop environment&lt;/a>&lt;/h2>
&lt;p>On the recent occasions when I&amp;rsquo;ve gotten a fresh desktop (intentionally or otherwise) I always seem to forget how long it takes to remember, find, and then change all the desktop environment settings. Keyboard shortcuts, workspaces, sound settings, night mode&amp;hellip; it adds up!&lt;/p>
&lt;p>Thankfully, all these settings have to be stored somewhere in a non-graphical format, which means that if we can discover how that&amp;rsquo;s done, we can likely find a way to easily manipulate the settings with a bash script. Lo and behold the terminal command, &lt;code>gsettings list-recursively&lt;/code>.&lt;/p>
&lt;p>There are a heck of a lot of settings for GNOME desktop environment. We can make the list easier to scroll through (if, like me, you&amp;rsquo;re sometimes the type of person to say &amp;ldquo;Just let me look at everything and figure out what I want!&amp;quot;) by piping to &lt;code>less&lt;/code>: &lt;code>gsettings list-recursively | less&lt;/code>. Alternatively, if we have an inkling as to what we might be looking for, we can use &lt;code>grep&lt;/code>: &lt;code>gsettings list-recursively | grep 'keyboard'&lt;/code>.&lt;/p>
&lt;p>We can manipulate our settings with the &lt;code>gsettings set&lt;/code> command. It can sometimes be difficult to find the syntax for the setting we want, so when we&amp;rsquo;re first building our script, I recommend using the GUI to make the changes, then finding the &lt;code>gsettings&lt;/code> line we changed and recording its value.&lt;/p>
&lt;p>For some inspiration, you can view &lt;a href="https://github.com/victoriadrake/dotfiles/blob/ubuntu-19.10/scripts/desktop.sh">my &lt;code>desktop.sh&lt;/code> settings script on GitHub&lt;/a>.&lt;/p>
&lt;h2 id="putting-it-all-together" class="anchor-link">&lt;a href="#putting-it-all-together">Putting it all together&lt;/a>&lt;/h2>
&lt;p>Having modular scripts (one for symlinks, two for installing programs, another for desktop settings) is useful for both keeping things organized and for being able to run some but not all of the automated set up. For instance, if I were to set up a VPS in which I only use the command line, I wouldn&amp;rsquo;t need to bother with installing graphical programs or desktop settings.&lt;/p>
&lt;p>In cases where I do want to run all the scripts, however, doing so one-by-one is a little tedious. Thankfully, since bash scripts can themselves be run by terminal commands, we can simply write another master script to run them all!&lt;/p>
&lt;p>Here&amp;rsquo;s my master script to handle the set up of a new Ubuntu desktop machine:&lt;/p>
&lt;div class="highlight">&lt;pre class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="cp">#!/bin/bash
&lt;/span>&lt;span class="cp">&lt;/span>
./symlink.sh
./aptinstall.sh
./programs.sh
./desktop.sh
&lt;span class="c1">## Get all upgrades&lt;/span>
sudo apt upgrade -y
&lt;span class="c1">## See our bash changes&lt;/span>
&lt;span class="nb">source&lt;/span> ~/.bashrc
&lt;span class="c1">## Fun hello&lt;/span>
figlet &lt;span class="s2">&amp;#34;... and we&amp;#39;re back!&amp;#34;&lt;/span> &lt;span class="p">|&lt;/span> lolcat
&lt;/code>&lt;/pre>&lt;/div>&lt;p>I threw in the upgrade line for good measure. It will make sure that the programs installed on our fresh desktop have the latest updates. Now a simple, single bash command will take care of everything!&lt;/p>
&lt;p>You may have noticed that, while our desktop now looks and runs familiarly, these scripts don&amp;rsquo;t cover one very important area: our files. Hopefully, you have a back up method for those that involves some form of reliable external hardware. If not, and if you tend to put your work in external repository hosts like GitHub or GitLab, I do have a way to &lt;a href="https://victoria.dev/blog/how-to-write-bash-one-liners-for-cloning-and-managing-github-and-gitlab-repositories/">automatically clone and back up your GitHub repositories with bash one-liners&lt;/a>.&lt;/p>
&lt;p>Relying on external repository hosts doesn&amp;rsquo;t offer 100% coverage, however. Files that you wouldn&amp;rsquo;t put in an externally hosted repository (private or otherwise) consequently can&amp;rsquo;t be pulled. Git ignored objects that can&amp;rsquo;t be generated from included files, like private keys and secrets, will not be recreated. Those files, however, are likely small enough that you could fit a whole bunch on a couple encrypted USB flash drives (and if you don&amp;rsquo;t have private key backups, maybe you ought to do that first?).&lt;/p>
&lt;p>That said, I hope this post has given you at least some inspiration as to how dotfiles and bash scripts can help to automate setting up a fresh desktop. If you come up with some settings you find useful, please help others discover them by sharing your dotfiles, too!&lt;/p></content:encoded><enclosure url="https://victoria.dev/blog/how-to-set-up-a-fresh-ubuntu-desktop-using-only-dotfiles-and-bash-scripts/cover_hu7503ff9e94bb9ad2ad596a79338ed3ec_587274_640x0_resize_q75_box.jpg" type="image/jpg"/></item><item><title>How to write Bash one-liners for cloning and managing GitHub and GitLab repositories</title><link>https://victoria.dev/blog/how-to-write-bash-one-liners-for-cloning-and-managing-github-and-gitlab-repositories/</link><pubDate>Tue, 06 Aug 2019 10:55:19 -0400</pubDate><author>hello@victoria.dev (Victoria Drake)</author><guid>https://victoria.dev/blog/how-to-write-bash-one-liners-for-cloning-and-managing-github-and-gitlab-repositories/</guid><description>Using xargs and awk in Bash to automate managing remote-hosted repositories.</description><content:encoded>
&lt;img src="https://victoria.dev/blog/how-to-write-bash-one-liners-for-cloning-and-managing-github-and-gitlab-repositories/cover_hue964d861d1f646dadaea936b29727a7c_1082491_640x0_resize_box_2.png" width="640" height="343"/>
&lt;p>Few things are more satisfying to me than one elegant line of Bash that automates hours of tedious work. As part of some recent explorations into &lt;a href="https://victoria.dev/blog/how-to-set-up-a-fresh-ubuntu-desktop-using-only-dotfiles-and-bash-scripts/">automatically re-creating my laptop with Bash scripts&lt;/a>, I wanted to find a way to easily clone my GitHub-hosted repositories to a new machine. After a bit of digging around, I wrote a one-liner that did just that. Then, in the spirit of not putting all our eggs in the same basket, I wrote another one-liner to automatically create and push to GitLab-hosted backups as well. Here they are.&lt;/p>
&lt;h2 id="a-bash-one-liner-to-clone-all-your-github-repositories" class="anchor-link">&lt;a href="#a-bash-one-liner-to-clone-all-your-github-repositories">A Bash one-liner to clone all your GitHub repositories&lt;/a>&lt;/h2>
&lt;p>Caveat: you&amp;rsquo;ll need a list of the GitHub repositories you want to clone. The good thing about that is it gives you full agency to choose just the repositories you want on your machine, instead of going in whole-hog.&lt;/p>
&lt;p>You can easily clone GitHub repositories without entering your password each time by using HTTPS with your &lt;a href="https://help.github.com/en/articles/caching-your-github-password-in-git">15-minute cached credentials&lt;/a> or, my preferred method, by &lt;a href="https://help.github.com/en/articles/connecting-to-github-with-ssh">connecting to GitHub with SSH&lt;/a>. For brevity I&amp;rsquo;ll assume we&amp;rsquo;re going with the latter, and our SSH keys are set up.&lt;/p>
&lt;p>Given a list of GitHub URLs in the file &lt;code>gh-repos.txt&lt;/code>, like this:&lt;/p>
&lt;div class="highlight">&lt;pre class="chroma">&lt;code class="language-txt" data-lang="txt">git@github.com:username/first-repository.git
git@github.com:username/second-repository.git
git@github.com:username/third-repository.git
&lt;/code>&lt;/pre>&lt;/div>&lt;p>We run:&lt;/p>
&lt;div class="highlight">&lt;pre class="chroma">&lt;code class="language-bash" data-lang="bash">xargs -n1 git clone &amp;lt; gh-repos.txt
&lt;/code>&lt;/pre>&lt;/div>&lt;p>This clones all the repositories on the list into the current folder. This same one-liner works for GitLab repositories as well, if you substitute the appropriate URLs.&lt;/p>
&lt;h3 id="whats-going-on-here" class="anchor-link">&lt;a href="#whats-going-on-here">What&amp;rsquo;s going on here&lt;/a>&lt;/h3>
&lt;p>There are two halves to this one-liner: the input, counterintuitively on the right side, and the part that makes stuff happen, on the left. We could make the order of these parts more intuitive (maybe?) by writing the same command like this:&lt;/p>
&lt;div class="highlight">&lt;pre class="chroma">&lt;code class="language-bash" data-lang="bash">&amp;lt;gh-repos.txt xargs -n1 git clone
&lt;/code>&lt;/pre>&lt;/div>&lt;p>To run a command for each line of our input, &lt;code>gh-repos.txt&lt;/code>, we use &lt;code>xargs -n1&lt;/code>. The tool &lt;code>xargs&lt;/code> reads items from input and executes any commands it finds (it will &lt;code>echo&lt;/code> if it doesn&amp;rsquo;t find any). By default, it assumes that items are separated by spaces; new lines also works and makes our list easier to read. The flag &lt;code>-n1&lt;/code> tells &lt;code>xargs&lt;/code> to use &lt;code>1&lt;/code> argument, or in our case, one line, per command. We build our command with &lt;code>git clone&lt;/code>, which &lt;code>xargs&lt;/code> then executes for each line. Ta-da.&lt;/p>
&lt;h2 id="a-bash-one-liner-to-create-and-push-many-repositories-on-gitlab" class="anchor-link">&lt;a href="#a-bash-one-liner-to-create-and-push-many-repositories-on-gitlab">A Bash one-liner to create and push many repositories on GitLab&lt;/a>&lt;/h2>
&lt;p>GitLab, unlike GitHub, lets us do this nifty thing where we don&amp;rsquo;t have to use the website to make a new repository first. We can &lt;a href="https://gitlab.com/help/gitlab-basics/create-project#push-to-create-a-new-project">create a new GitLab repository from our terminal&lt;/a>. The newly created repository defaults to being set as Private, so if we want to make it Public on GitLab, we&amp;rsquo;ll have to do that manually later.&lt;/p>
&lt;p>The GitLab docs tell us to push to create a new project using &lt;code>git push --set-upstream&lt;/code>, but I don&amp;rsquo;t find this to be very convenient for using GitLab as a backup. As I work with my repositories in the future, I&amp;rsquo;d like to run one command that pushes to both GitHub &lt;em>and&lt;/em> GitLab without additional effort on my part.&lt;/p>
&lt;p>To make this Bash one-liner work, we&amp;rsquo;ll also need a list of repository URLs for GitLab (ones that don&amp;rsquo;t exist yet). We can easily do this by copying our GitHub repository list, opening it up with Vim, and doing a &lt;a href="https://vim.fandom.com/wiki/Search_and_replace">search-and-replace&lt;/a>:&lt;/p>
&lt;div class="highlight">&lt;pre class="chroma">&lt;code class="language-bash" data-lang="bash">cp gh-repos.txt gl-repos.txt
vim gl-repos.txt
:%s/&lt;span class="se">\&amp;lt;&lt;/span>github&lt;span class="se">\&amp;gt;&lt;/span>/gitlab/g
:wq
&lt;/code>&lt;/pre>&lt;/div>&lt;p>This produces &lt;code>gl-repos.txt&lt;/code>, which looks like:&lt;/p>
&lt;div class="highlight">&lt;pre class="chroma">&lt;code class="language-txt" data-lang="txt">git@gitlab.com:username/first-repository.git
git@gitlab.com:username/second-repository.git
git@gitlab.com:username/third-repository.git
&lt;/code>&lt;/pre>&lt;/div>&lt;p>We can create these repositories on GitLab, add the URLs as remotes, and push our code to the new repositories by running:&lt;/p>
&lt;div class="highlight">&lt;pre class="chroma">&lt;code class="language-bash" data-lang="bash">awk -F&lt;span class="s1">&amp;#39;\/|(\.git)&amp;#39;&lt;/span> &lt;span class="s1">&amp;#39;{system(&amp;#34;cd ~/FULL/PATH/&amp;#34; $2 &amp;#34; &amp;amp;&amp;amp; git remote set-url origin --add &amp;#34; $0 &amp;#34; &amp;amp;&amp;amp; git push&amp;#34;)}&amp;#39;&lt;/span> gl-repos.txt
&lt;/code>&lt;/pre>&lt;/div>&lt;p>Hang tight and I&amp;rsquo;ll explain it; for now, take note that &lt;code>~/FULL/PATH/&lt;/code> should be the full path to the directory containing our GitHub repositories.&lt;/p>
&lt;p>We do have to make note of a couple assumptions:&lt;/p>
&lt;ol>
&lt;li>The name of the directory on your local machine that contains the repository is the same as the name of the repository in the URL (this will be the case if it was cloned with the one-liner above);&lt;/li>
&lt;li>Each repository is currently checked out to the branch you want pushed, ie. &lt;code>master&lt;/code>.&lt;/li>
&lt;/ol>
&lt;p>The one-liner could be expanded to handle these assumptions, but it is the humble opinion of the author that at that point, we really ought to be writing a Bash script.&lt;/p>
&lt;h3 id="whats-going-on-here-1" class="anchor-link">&lt;a href="#whats-going-on-here-1">What&amp;rsquo;s going on here&lt;/a>&lt;/h3>
&lt;p>Our Bash one-liner uses each line (or URL) in the &lt;code>gl-repos.txt&lt;/code> file as input. With &lt;code>awk&lt;/code>, it splits off the name of the directory containing the repository on our local machine, and uses these pieces of information to build our larger command. If we were to &lt;code>print&lt;/code> the output of &lt;code>awk&lt;/code>, we&amp;rsquo;d see:&lt;/p>
&lt;div class="highlight">&lt;pre class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="nb">cd&lt;/span> ~/FULL/PATH/first-repository &lt;span class="o">&amp;amp;&amp;amp;&lt;/span> git remote set-url origin --add git@gitlab.com:username/first-repository.git &lt;span class="o">&amp;amp;&amp;amp;&lt;/span> git push
&lt;span class="nb">cd&lt;/span> ~/FULL/PATH/second-repository &lt;span class="o">&amp;amp;&amp;amp;&lt;/span> git remote set-url origin --add git@gitlab.com:username/second-repository.git &lt;span class="o">&amp;amp;&amp;amp;&lt;/span> git push
&lt;span class="nb">cd&lt;/span> ~/FULL/PATH/third-repository &lt;span class="o">&amp;amp;&amp;amp;&lt;/span> git remote set-url origin --add git@gitlab.com:username/third-repository.git &lt;span class="o">&amp;amp;&amp;amp;&lt;/span> git push
&lt;/code>&lt;/pre>&lt;/div>&lt;p>Let&amp;rsquo;s look at how we build this command.&lt;/p>
&lt;h4 id="splitting-strings-with-awk" class="anchor-link">&lt;a href="#splitting-strings-with-awk">Splitting strings with &lt;code>awk&lt;/code>&lt;/a>&lt;/h4>
&lt;p>The tool &lt;code>awk&lt;/code> can split input based on &lt;a href="https://www.gnu.org/software/gawk/manual/html_node/Command-Line-Field-Separator.html">field separators&lt;/a>. The default separator is a whitespace character, but we can change this by passing the &lt;code>-F&lt;/code> flag. Besides single characters, we can also use a &lt;a href="https://www.gnu.org/software/gawk/manual/html_node/Regexp-Field-Splitting.html#Regexp-Field-Splitting">regular expression field separator&lt;/a>. Since our repository URLs have a set format, we can grab the repository names by asking for the substring between the slash character &lt;code>/&lt;/code> and the end of the URL, &lt;code>.git&lt;/code>.&lt;/p>
&lt;p>One way to accomplish this is with our regex &lt;code>\/|(\.git)&lt;/code>:&lt;/p>
&lt;ul>
&lt;li>&lt;code>\/&lt;/code> is an escaped &lt;code>/&lt;/code> character;&lt;/li>
&lt;li>&lt;code>|&lt;/code> means &amp;ldquo;or&amp;rdquo;, telling awk to match either expression;&lt;/li>
&lt;li>&lt;code>(\.git)&lt;/code> is the capture group at the end of our URL that matches &amp;ldquo;.git&amp;rdquo;, with an escaped &lt;code>.&lt;/code> character. This is a bit of a cheat, as &amp;ldquo;.git&amp;rdquo; isn&amp;rsquo;t strictly splitting anything (there&amp;rsquo;s nothing on the other side) but it&amp;rsquo;s an easy way for us to take this bit off.&lt;/li>
&lt;/ul>
&lt;p>Once we&amp;rsquo;ve told &lt;code>awk&lt;/code> where to split, we can grab the right substring with the &lt;a href="https://www.gnu.org/software/gawk/manual/html_node/Fields.html#index-_0024-_0028dollar-sign_0029_002c-_0024-field-operator">field operator&lt;/a>. We refer to our fields with a &lt;code>$&lt;/code> character, then by the field&amp;rsquo;s column number. In our example, we want the second field, &lt;code>$2&lt;/code>. Here&amp;rsquo;s what all the substrings look like:&lt;/p>
&lt;div class="highlight">&lt;pre class="chroma">&lt;code class="language-bash" data-lang="bash">1: git@gitlab.com:username
2: first-repository
&lt;/code>&lt;/pre>&lt;/div>&lt;p>To use the whole string, or in our case, the whole URL, we use the field operator &lt;code>$0&lt;/code>. To write the command, we just substitute the field operators for the repository name and URL. Running this with &lt;code>print&lt;/code> as we&amp;rsquo;re building it can help to make sure we&amp;rsquo;ve got all the spaces right.&lt;/p>
&lt;div class="highlight">&lt;pre class="chroma">&lt;code class="language-bash" data-lang="bash">awk -F&lt;span class="s1">&amp;#39;\/|(\.git)&amp;#39;&lt;/span> &lt;span class="s1">&amp;#39;{print &amp;#34;cd ~/FULL/PATH/&amp;#34; $2 &amp;#34; &amp;amp;&amp;amp; git remote set-url origin --add &amp;#34; $0 &amp;#34; &amp;amp;&amp;amp; git push&amp;#34;}&amp;#39;&lt;/span> gl-repos.txt
&lt;/code>&lt;/pre>&lt;/div>
&lt;h4 id="running-the-command" class="anchor-link">&lt;a href="#running-the-command">Running the command&lt;/a>&lt;/h4>
&lt;p>We build our command inside the parenthesis of &lt;code>system()&lt;/code>. By using this as the output of &lt;code>awk&lt;/code>, each command will run as soon as it is built and output. The &lt;code>system()&lt;/code> function creates a &lt;a href="https://en.wikipedia.org/wiki/Child_process">child process&lt;/a> that executes our command, then returns once the command is completed. In plain English, this lets us perform the Git commands on each repository, one-by-one, without breaking from our main process in which &lt;code>awk&lt;/code> is doing things with our input file. Here&amp;rsquo;s our final command again, all put together.&lt;/p>
&lt;div class="highlight">&lt;pre class="chroma">&lt;code class="language-bash" data-lang="bash">awk -F&lt;span class="s1">&amp;#39;\/|(\.git)&amp;#39;&lt;/span> &lt;span class="s1">&amp;#39;{system(&amp;#34;cd ~/FULL/PATH/&amp;#34; $2 &amp;#34; &amp;amp;&amp;amp; git remote set-url origin --add &amp;#34; $0 &amp;#34; &amp;amp;&amp;amp; git push&amp;#34;)}&amp;#39;&lt;/span> gl-repos.txt
&lt;/code>&lt;/pre>&lt;/div>
&lt;h4 id="using-our-backups" class="anchor-link">&lt;a href="#using-our-backups">Using our backups&lt;/a>&lt;/h4>
&lt;p>By adding the GitLab URLs as remotes, we&amp;rsquo;ve simplified the process of pushing to both externally hosted repositories. If we run &lt;code>git remote -v&lt;/code> in one of our repository directories, we&amp;rsquo;ll see:&lt;/p>
&lt;div class="highlight">&lt;pre class="chroma">&lt;code class="language-bash" data-lang="bash">origin git@github.com:username/first-repository.git &lt;span class="o">(&lt;/span>fetch&lt;span class="o">)&lt;/span>
origin git@github.com:username/first-repository.git &lt;span class="o">(&lt;/span>push&lt;span class="o">)&lt;/span>
origin git@gitlab.com:username/first-repository.git &lt;span class="o">(&lt;/span>push&lt;span class="o">)&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>Now, simply running &lt;code>git push&lt;/code> without arguments will push the current branch to both remote repositories.&lt;/p>
&lt;p>We should also note that &lt;code>git pull&lt;/code> will generally only try to pull from the remote repository you originally cloned from (the URL marked &lt;code>(fetch)&lt;/code> in our example above). Pulling from multiple Git repositories at the same time is possible, but complicated, and beyond the scope of this post. Here&amp;rsquo;s an &lt;a href="https://astrofloyd.wordpress.com/2015/05/05/git-pushing-to-and-pulling-from-multiple-remote-locations-remote-url-and-pushurl/">explanation of pushing and pulling to multiple remotes&lt;/a> to help get you started, if you&amp;rsquo;re curious. The &lt;a href="https://git-scm.com/book/en/v2/Git-Basics-Working-with-Remotes">Git documentation on remotes&lt;/a> may also be helpful.&lt;/p>
&lt;h2 id="to-elaborate-on-the-succinctness-of-bash-one-liners" class="anchor-link">&lt;a href="#to-elaborate-on-the-succinctness-of-bash-one-liners">To elaborate on the succinctness of Bash one-liners&lt;/a>&lt;/h2>
&lt;p>Bash one-liners, when understood, can be fun and handy shortcuts. At the very least, being aware of tools like &lt;code>xargs&lt;/code> and &lt;code>awk&lt;/code> can help to automate and alleviate a lot of tediousness in our work. However, there are some downsides.&lt;/p>
&lt;p>In terms of an easy-to-understand, maintainable, and approachable tool, Bash one-liners suck. They&amp;rsquo;re usually more complicated to write than a Bash script using &lt;code>if&lt;/code> or &lt;code>while&lt;/code> loops, and certainly more complicated to read. It&amp;rsquo;s likely that when we write them, we&amp;rsquo;ll miss a single quote or closing parenthesis somewhere; and as I hope this post demonstrates, they can take quite a bit of explaining, too. So why use them?&lt;/p>
&lt;p>Imagine reading a recipe for baking a cake, step by step. You understand the methods and ingredients, and gather your supplies. Then, as you think about it, you begin to realize that if you just throw all the ingredients at the oven in precisely the right order, a cake will instantly materialize. You try it, and it works!&lt;/p>
&lt;p>That would be pretty satisfying, wouldn&amp;rsquo;t it?&lt;/p></content:encoded><enclosure url="https://victoria.dev/blog/how-to-write-bash-one-liners-for-cloning-and-managing-github-and-gitlab-repositories/cover_hue964d861d1f646dadaea936b29727a7c_1082491_640x0_resize_box_2.png" type="image/jpg"/></item><item><title>A quick guide to changing your GitHub username</title><link>https://victoria.dev/blog/a-quick-guide-to-changing-your-github-username/</link><pubDate>Sun, 28 Jul 2019 15:19:13 -0400</pubDate><author>hello@victoria.dev (Victoria Drake)</author><guid>https://victoria.dev/blog/a-quick-guide-to-changing-your-github-username/</guid><description>Some additional steps to consider after making a change to your username on GitHub.</description><content:encoded>
&lt;img src="https://victoria.dev/blog/a-quick-guide-to-changing-your-github-username/cover_hu7812c3e32a841cc1ab09568139e9132c_71747_640x0_resize_box_2.png" width="640" height="421"/>
&lt;p>This being the 2,38947234th and probably last time I&amp;rsquo;ll change my username, (marriage is permanent, right?) I thought I&amp;rsquo;d better write a quick post on how this transition can be achieved as smoothly as possible. You can read &lt;a href="https://help.github.com/en/articles/changing-your-github-username">official instructions on how to change your GitHub username&lt;/a> here, and they will tell you how to do it and what happens. The following is a quick guide to some things to consider &lt;em>afterwards.&lt;/em>&lt;/p>
&lt;h2 id="where-to-make-changes" class="anchor-link">&lt;a href="#where-to-make-changes">Where to make changes&lt;/a>&lt;/h2>
&lt;ol>
&lt;li>Change username in &lt;a href="https://github.com/settings/admin">GitHub account settings.&lt;/a>&lt;/li>
&lt;li>If using GitHub Pages, change name of your &amp;ldquo;username.github.io&amp;rdquo; repository.&lt;/li>
&lt;li>If using other services that point to your &amp;ldquo;username.github.io&amp;rdquo; repository address, update them.&lt;/li>
&lt;li>If using Netlify, you &lt;em>may&lt;/em> want to sign in and reconnect your repositories. (Mine still worked, but due to a possibly unrelated issue, I&amp;rsquo;m not positive.)&lt;/li>
&lt;li>Sign in to Travis CI and other integrations (find them in your repository Settings tab -&amp;gt; Integrations &amp;amp; services). This will update your username there.&lt;/li>
&lt;li>Update your local files and repository links with &lt;em>very carefully executed&lt;/em> &lt;code>find&lt;/code> and &lt;code>sed&lt;/code> commands, and push back changes to GitHub.&lt;/li>
&lt;li>Redeploy any websites you may have with your updated GitHub link.&lt;/li>
&lt;li>Fix any links around the web to your profile, your repositories, or Gists you may have shared.&lt;/li>
&lt;/ol>
&lt;h2 id="local-file-updates" class="anchor-link">&lt;a href="#local-file-updates">Local file updates&lt;/a>&lt;/h2>
&lt;p>Here are some suggestions for strings to search and replace your username in.&lt;/p>
&lt;ul>
&lt;li>&lt;code>github.com/username&lt;/code> (References to your GitHub page in READMEs or in website copy)&lt;/li>
&lt;li>&lt;code>username.github.io&lt;/code> (Links to your GitHub Page)&lt;/li>
&lt;li>&lt;code>git@github.com:username&lt;/code> (Git config remote ssh urls)&lt;/li>
&lt;li>&lt;code>travis-ci.com/username&lt;/code> (Travis badges in READMEs)&lt;/li>
&lt;li>&lt;code>shields.io/github/.../username&lt;/code> (Shields badges in READMEs, types include &lt;code>contributors&lt;/code>, &lt;code>stars&lt;/code>, &lt;code>tags&lt;/code>, and more)&lt;/li>
&lt;/ul>
&lt;p>You can quickly identify where the above strings are located using this command for each string:&lt;/p>
&lt;p>&lt;code>grep -rnw -e 'foobar'&lt;/code>&lt;/p>
&lt;p>This will recursively (&lt;code>r&lt;/code>) search all files for strings matching the whole (&lt;code>w&lt;/code>) pattern (&lt;code>e&lt;/code>) provided and prefix results with the line numbers (&lt;code>n&lt;/code>) so you can easily find them.&lt;/p>
&lt;p>Using &lt;code>find&lt;/code> and &lt;code>sed&lt;/code> can make these changes much faster. See &lt;a href="https://victoria.dev/blog/how-to-replace-a-string-in-a-dozen-old-blog-posts-with-one-sed-terminal-command/">this article on search and replace&lt;/a>.&lt;/p>
&lt;p>Enjoy your new handle! (I hope it sticks.)&lt;/p></content:encoded><enclosure url="https://victoria.dev/blog/a-quick-guide-to-changing-your-github-username/cover_hu7812c3e32a841cc1ab09568139e9132c_71747_640x0_resize_box_2.png" type="image/jpg"/></item><item><title>Two ways to deploy a public GitHub Pages site from a private Hugo repository</title><link>https://victoria.dev/blog/two-ways-to-deploy-a-public-github-pages-site-from-a-private-hugo-repository/</link><pubDate>Mon, 22 Apr 2019 10:05:15 -0400</pubDate><author>hello@victoria.dev (Victoria Drake)</author><guid>https://victoria.dev/blog/two-ways-to-deploy-a-public-github-pages-site-from-a-private-hugo-repository/</guid><description>Keep your drafts out of the public eye by making use of continuous deployment tools to publish your public GitHub Pages site - from a separate private repository.</description><content:encoded>
&lt;img src="https://victoria.dev/blog/two-ways-to-deploy-a-public-github-pages-site-from-a-private-hugo-repository/cover_hua0c104d819921f3f45be661545f8932d_2244173_640x0_resize_box_2.png" width="640" height="370"/>
&lt;p>Tools like Travis CI and Netlify offer some pretty nifty features, like seamlessly deploying your GitHub Pages site when changes are pushed to its repository. Along with a static site generator like Hugo, keeping a blog up to date is pretty painless.&lt;/p>
&lt;p>I&amp;rsquo;ve used Hugo to build my site for years, but until this past week I&amp;rsquo;d never hooked up my Pages repository to any deployment service. Why? Because using a tool that built my site before deploying it seemed to require having the whole recipe in one place - and if you&amp;rsquo;re using GitHub Pages with the free version of GitHub, &lt;a href="https://help.github.com/en/articles/configuring-a-publishing-source-for-github-pages">that place is public&lt;/a>. That means that all my three-in-the-morning bright ideas and messy unfinished (and unfunny) drafts would be publicly available - and no amount of continuous convenience was going to convince me to do that.&lt;/p>
&lt;p>So I kept things separated, with Hugo&amp;rsquo;s messy behind-the-scenes stuff in a local Git repository, and the generated &lt;code>public/&lt;/code> folder pushing to my GitHub Pages remote repository. Each time I wanted to deploy my site, I&amp;rsquo;d have to get on my laptop and &lt;code>hugo&lt;/code> to build my site, then &lt;code>cd public/ &amp;amp;&amp;amp; git add . &amp;amp;&amp;amp; git commit&lt;/code>&amp;hellip; etc etc. And all was well, except for the nagging feeling that there was a better way to do this.&lt;/p>
&lt;p>I wrote another article a little while back about &lt;a href="https://victoria.dev/blog/a-remote-sync-solution-for-ios-and-linux-git-and-working-copy/">using GitHub and Working Copy&lt;/a> to make changes to my repositories on my iPad whenever I&amp;rsquo;m out and about. It seemed off to me that I could do everything except deploy my site from my iPad, so I set out to change that.&lt;/p>
&lt;p>A couple three-in-the-morning bright ideas and a revoked access token later (oops), I now have not one but &lt;em>two&lt;/em> ways to deploy to my public GitHub Pages repository from an entirely separated, private GitHub repository. In this post, I&amp;rsquo;ll take you through achieving this with &lt;a href="https://travis-ci.com/">Travis CI&lt;/a> or using &lt;a href="http://netlify.com/">Netlify&lt;/a> and &lt;a href="https://www.gnu.org/software/make/">Make&lt;/a>.&lt;/p>
&lt;p>There&amp;rsquo;s nothing hackish about it - my public GitHub Pages repository still looks the same as it does when I pushed to it locally from my terminal. Only now, I&amp;rsquo;m able to take advantage of a couple great deployment tools to have the site update whenever I push to my private repo, whether I&amp;rsquo;m on my laptop or out and about with my iPad.&lt;/p>
&lt;figure>
&lt;img src="im-on-a-bridge.jpg"
alt="Hashtag: you did not push from there"/> &lt;figcaption>
&lt;p>#YouDidNotPushFromThere&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;p>This article assumes you have working knowledge of Git and GitHub Pages. If not, you may like to spin off some browser tabs from my articles on &lt;a href="https://victoria.dev/blog/a-remote-sync-solution-for-ios-and-linux-git-and-working-copy/">using GitHub and Working Copy&lt;/a> and &lt;a href="https://victoria.dev/blog/how-i-ditched-wordpress-and-set-up-my-custom-domain-https-site-for-almost-free/">building a site with Hugo and GitHub Pages&lt;/a> first.&lt;/p>
&lt;p>Let&amp;rsquo;s do it!&lt;/p>
&lt;h2 id="private-to-public-github-pages-deployment-with-travis-ci" class="anchor-link">&lt;a href="#private-to-public-github-pages-deployment-with-travis-ci">Private-to-public GitHub Pages deployment with Travis CI&lt;/a>&lt;/h2>
&lt;p>Travis CI has the built-in ability () to &lt;a href="https://docs.travis-ci.com/user/deployment/pages/">deploy to GitHub Pages&lt;/a> following a successful build. They do a decent job in the docs of explaining how to add this feature, especially if you&amp;rsquo;ve used Travis CI before&amp;hellip; which I haven&amp;rsquo;t. Don&amp;rsquo;t worry, I did the bulk of the figuring-things-out for you.&lt;/p>
&lt;ul>
&lt;li>Travis CI gets all its instructions from a configuration file in the root of your repository called &lt;code>.travis.yml&lt;/code>&lt;/li>
&lt;li>You need to provide a &lt;a href="https://help.github.com/en/articles/creating-a-personal-access-token-for-the-command-line">GitHub personal access token&lt;/a> as a secure encrypted variable, which you can generate using &lt;code>travis&lt;/code> on the command line&lt;/li>
&lt;li>Once your script successfully finishes doing what you&amp;rsquo;ve told it to do (not necessarily what you &lt;em>want&lt;/em> it to do but that&amp;rsquo;s a whole other blog post), Travis will deploy your build directory to a repository you can specify with the &lt;code>repo&lt;/code> configuration variable.&lt;/li>
&lt;/ul>
&lt;h3 id="setting-up-the-travis-configuration-file" class="anchor-link">&lt;a href="#setting-up-the-travis-configuration-file">Setting up the Travis configuration file&lt;/a>&lt;/h3>
&lt;p>Create a new configuration file for Travis with the filename &lt;code>.travis.yml&lt;/code> (note the leading &amp;ldquo;.&amp;quot;). These scripts are very customizable and I struggled to find a relevant example to use as a starting point - luckily, you don&amp;rsquo;t have that problem!&lt;/p>
&lt;p>Here&amp;rsquo;s my basic &lt;code>.travis.yml&lt;/code>:&lt;/p>
&lt;div class="highlight">&lt;pre class="chroma">&lt;code class="language-yml" data-lang="yml">&lt;span class="nt">git&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nt">depth&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="kc">false&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w">&lt;/span>&lt;span class="nt">env&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nt">global&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>- &lt;span class="l">HUGO_VERSION=&amp;#34;0.54.0&amp;#34;&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nt">matrix&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>- &lt;span class="l">YOUR_ENCRYPTED_VARIABLE&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w">&lt;/span>&lt;span class="nt">install&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>- &lt;span class="l">wget -q https://github.com/gohugoio/hugo/releases/download/v${HUGO_VERSION}/hugo_${HUGO_VERSION}_Linux-64bit.tar.gz&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>- &lt;span class="l">tar xf hugo_${HUGO_VERSION}_Linux-64bit.tar.gz&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>- &lt;span class="l">mv hugo ~/bin/&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w">&lt;/span>&lt;span class="nt">script&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>- &lt;span class="l">hugo --gc --minify&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w">&lt;/span>&lt;span class="nt">deploy&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nt">provider&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">pages&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nt">skip-cleanup&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="kc">true&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nt">github-token&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">$GITHUB_TOKEN&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nt">keep-history&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="kc">true&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nt">local-dir&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">public&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nt">repo&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">gh-username/gh-username.github.io&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nt">target-branch&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">master&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nt">verbose&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="kc">true&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nt">on&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w">
&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="nt">branch&lt;/span>&lt;span class="p">:&lt;/span>&lt;span class="w"> &lt;/span>&lt;span class="l">master&lt;/span>&lt;span class="w">
&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>This script downloads and installs Hugo, builds the site with the garbage collection and minify &lt;a href="https://gohugo.io/commands/hugo/#synopsis">flags&lt;/a>, then deploys the &lt;code>public/&lt;/code> directory to the specified &lt;code>repo&lt;/code> - in this example, your public GitHub Pages repository. You can read about each of the &lt;code>deploy&lt;/code> configuration options &lt;a href="https://docs.travis-ci.com/user/deployment/pages/#further-configuration">here&lt;/a>.&lt;/p>
&lt;p>To &lt;a href="https://docs.travis-ci.com/user/environment-variables#defining-encrypted-variables-in-travisyml">add the GitHub personal access token as an encrypted variable&lt;/a>, you don&amp;rsquo;t need to manually edit your &lt;code>.travis.yml&lt;/code>. The &lt;code>travis&lt;/code> gem commands below will encrypt and add the variable for you when you run them in your repository directory.&lt;/p>
&lt;p>First, install &lt;code>travis&lt;/code> with &lt;code>sudo gem install travis&lt;/code>.&lt;/p>
&lt;p>Then &lt;a href="https://help.github.com/en/articles/creating-a-personal-access-token-for-the-command-line">generate your GitHub personal access token&lt;/a>, copy it (it only shows up once!) and run the commands below in your repository root, substituting your token for the kisses:&lt;/p>
&lt;div class="highlight">&lt;pre class="chroma">&lt;code class="language-sh" data-lang="sh">travis login --pro --github-token xxxxxxxxxxxxxxxxxxxxxxxxxxx
travis encrypt &lt;span class="nv">GITHUB_TOKEN&lt;/span>&lt;span class="o">=&lt;/span>xxxxxxxxxxxxxxxxxxxxxxxxxxx --add env.matrix
&lt;/code>&lt;/pre>&lt;/div>&lt;p>Your encrypted token magically appears in the file. Once you&amp;rsquo;ve committed &lt;code>.travis.yml&lt;/code> to your private Hugo repository, Travis CI will run the script and if the build succeeds, will deploy your site to your public GitHub Pages repo. Magic!&lt;/p>
&lt;p>Travis will always run a build each time you push to your private repository. If you don&amp;rsquo;t want to trigger this behavior with a particular commit, &lt;a href="https://docs.travis-ci.com/user/customizing-the-build/#skipping-a-build">add the &lt;code>skip&lt;/code> command to your commit message&lt;/a>.&lt;/p>
&lt;p>&lt;em>Yo that&amp;rsquo;s cool but I like Netlify.&lt;/em>&lt;/p>
&lt;p>Okay fine.&lt;/p>
&lt;h2 id="deploying-to-a-separate-repository-with-netlify-and-make" class="anchor-link">&lt;a href="#deploying-to-a-separate-repository-with-netlify-and-make">Deploying to a separate repository with Netlify and Make&lt;/a>&lt;/h2>
&lt;p>We can get Netlify to do our bidding by using a Makefile, which we&amp;rsquo;ll run with Netlify&amp;rsquo;s build command.&lt;/p>
&lt;p>Here&amp;rsquo;s what our &lt;code>Makefile&lt;/code> looks like:&lt;/p>
&lt;div class="highlight">&lt;pre class="chroma">&lt;code class="language-makefile" data-lang="makefile">&lt;span class="nv">SHELL&lt;/span>&lt;span class="o">:=&lt;/span>/bin/bash
&lt;span class="nv">BASEDIR&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="k">$(&lt;/span>CURDIR&lt;span class="k">)&lt;/span>
&lt;span class="nv">OUTPUTDIR&lt;/span>&lt;span class="o">=&lt;/span>public
&lt;span class="nf">.PHONY&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="n">all&lt;/span>
&lt;span class="nf">all&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="n">clean&lt;/span> &lt;span class="n">get_repository&lt;/span> &lt;span class="n">build&lt;/span> &lt;span class="n">deploy&lt;/span>
&lt;span class="nf">.PHONY&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="n">clean&lt;/span>
&lt;span class="nf">clean&lt;/span>&lt;span class="o">:&lt;/span>
@echo &lt;span class="s2">&amp;#34;Removing public directory&amp;#34;&lt;/span>
rm -rf &lt;span class="k">$(&lt;/span>BASEDIR&lt;span class="k">)&lt;/span>/&lt;span class="k">$(&lt;/span>OUTPUTDIR&lt;span class="k">)&lt;/span>
&lt;span class="nf">.PHONY&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="n">get_repository&lt;/span>
&lt;span class="nf">get_repository&lt;/span>&lt;span class="o">:&lt;/span>
@echo &lt;span class="s2">&amp;#34;Getting public repository&amp;#34;&lt;/span>
git clone https://github.com/gh-username/gh-username.github.io.git public
&lt;span class="nf">.PHONY&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="n">build&lt;/span>
&lt;span class="nf">build&lt;/span>&lt;span class="o">:&lt;/span>
@echo &lt;span class="s2">&amp;#34;Generating site&amp;#34;&lt;/span>
hugo --gc --minify
&lt;span class="nf">.PHONY&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="n">deploy&lt;/span>
&lt;span class="nf">deploy&lt;/span>&lt;span class="o">:&lt;/span>
@echo &lt;span class="s2">&amp;#34;Preparing commit&amp;#34;&lt;/span>
@cd &lt;span class="k">$(&lt;/span>OUTPUTDIR&lt;span class="k">)&lt;/span> &lt;span class="se">\
&lt;/span>&lt;span class="se">&lt;/span> &lt;span class="o">&amp;amp;&amp;amp;&lt;/span> git config user.email &lt;span class="s2">&amp;#34;you@youremail.com&amp;#34;&lt;/span> &lt;span class="se">\
&lt;/span>&lt;span class="se">&lt;/span> &lt;span class="o">&amp;amp;&amp;amp;&lt;/span> git config user.name &lt;span class="s2">&amp;#34;Your Name&amp;#34;&lt;/span> &lt;span class="se">\
&lt;/span>&lt;span class="se">&lt;/span> &lt;span class="o">&amp;amp;&amp;amp;&lt;/span> git add . &lt;span class="se">\
&lt;/span>&lt;span class="se">&lt;/span> &lt;span class="o">&amp;amp;&amp;amp;&lt;/span> git status &lt;span class="se">\
&lt;/span>&lt;span class="se">&lt;/span> &lt;span class="o">&amp;amp;&amp;amp;&lt;/span> git commit -m &lt;span class="s2">&amp;#34;Deploy via Makefile&amp;#34;&lt;/span> &lt;span class="se">\
&lt;/span>&lt;span class="se">&lt;/span> &lt;span class="o">&amp;amp;&amp;amp;&lt;/span> git push -f -q https://&lt;span class="k">$(&lt;/span>GITHUB_TOKEN&lt;span class="k">)&lt;/span>@github.com/gh-username/gh-username.github.io.git master
@echo &lt;span class="s2">&amp;#34;Pushed to remote&amp;#34;&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>To preserve the Git history of our separate GitHub Pages repository, we&amp;rsquo;ll first clone it, build our new Hugo site to it, and then push it back to the Pages repository. This script first removes any existing &lt;code>public/&lt;/code> folder that might contain files or a Git history. It then clones our Pages repository to &lt;code>public/&lt;/code>, builds our Hugo site (essentially updating the files in &lt;code>public/&lt;/code>), then takes care of committing the new site to the Pages repository.&lt;/p>
&lt;p>In the &lt;code>deploy&lt;/code> section, you&amp;rsquo;ll notice lines starting with &lt;code>&amp;amp;&amp;amp;&lt;/code>. These are chained commands. Since Make &lt;a href="https://www.gnu.org/software/make/manual/html_node/Execution.html#Execution">invokes a new sub-shell for each line&lt;/a>, it starts over with every new line from our root directory. To get our &lt;code>cd&lt;/code> to stick and avoid running our Git commands in the project root directory, we&amp;rsquo;re chaining the commands and using the backslash character to &lt;a href="http://clarkgrubb.com/makefile-style-guide#breaking-long-lines">break long lines&lt;/a> for readability.&lt;/p>
&lt;p>By chaining our commands, we&amp;rsquo;re able to &lt;a href="https://stackoverflow.com/questions/6116548/how-to-tell-git-to-use-the-correct-identity-name-and-email-for-a-given-project">configure our Git identity&lt;/a>, add all our updated files, and create a commit for our Pages repository.&lt;/p>
&lt;p>Similarly to using Travis CI, we&amp;rsquo;ll need to pass in a &lt;a href="https://github.com/settings/tokens">GitHub personal access token&lt;/a> to push to our public GitHub Pages repository - only Netlify doesn&amp;rsquo;t provide a straightforward way to encrypt the token in our Makefile.&lt;/p>
&lt;p>Instead, we&amp;rsquo;ll use Netlify&amp;rsquo;s &lt;a href="https://www.netlify.com/docs/continuous-deployment/#build-environment-variables">Build Environment Variables&lt;/a>, which live safely in our site settings in the Netlify app. We can then call our token variable in the Makefile. We use it to push (quietly, to avoid printing the token in logs) to our Pages repository by &lt;a href="https://stackoverflow.com/questions/44773415/how-to-push-a-commit-to-github-from-a-circleci-build-using-a-personal-access-tok">passing it in the remote URL&lt;/a>.&lt;/p>
&lt;p>To avoid printing the token in Netlify&amp;rsquo;s logs, we suppress &lt;a href="https://www.gnu.org/software/make/manual/html_node/Echoing.html#Echoing">recipe echoing&lt;/a> for that line with the leading &lt;code>@&lt;/code> character.&lt;/p>
&lt;p>With your Makefile in the root of your private GitHub repository, you can set up Netlify to run it for you.&lt;/p>
&lt;h3 id="setting-up-netlify" class="anchor-link">&lt;a href="#setting-up-netlify">Setting up Netlify&lt;/a>&lt;/h3>
&lt;p>Getting set up with Netlify via the &lt;a href="https://app.netlify.com/">web UI&lt;/a> is straightforward. Once you sign in with GitHub, choose the private GitHub repository where your Hugo site lives. The next page Netlify takes you to lets you enter deploy settings:&lt;/p>
&lt;p>
&lt;img src="https://victoria.dev/blog/two-ways-to-deploy-a-public-github-pages-site-from-a-private-hugo-repository/netlify-new-site.png" alt="Create a new site page" />
&lt;/p>
&lt;p>You can specify the build command that will run your Makefile (&lt;code>make all&lt;/code> for this example). The branch to deploy and the publish directory don&amp;rsquo;t matter too much in our specific case, since we&amp;rsquo;re only concerned with pushing to a separate repository. You can enter the typical &lt;code>master&lt;/code> deploy branch and &lt;code>public&lt;/code> publish directory.&lt;/p>
&lt;p>Under &amp;ldquo;Advanced build settings&amp;rdquo; click &amp;ldquo;New variable&amp;rdquo; to add your GitHub personal access token as a Build Environment Variable. In our example, the variable name is &lt;code>GITHUB_TOKEN&lt;/code>. Click &amp;ldquo;Deploy site&amp;rdquo; to make the magic happen.&lt;/p>
&lt;p>If you&amp;rsquo;ve already previously set up your repository with Netlify, find the settings for Continuous Deployment under Settings &amp;gt; Build &amp;amp; deploy.&lt;/p>
&lt;p>Netlify will build your site each time you push to the private repository. If you don&amp;rsquo;t want a particular commit to trigger a build, &lt;a href="https://www.netlify.com/docs/continuous-deployment/#skipping-a-deploy">add &lt;code>[skip ci]&lt;/code> in your Git commit message&lt;/a>.&lt;/p>
&lt;h3 id="same-same-but-different" class="anchor-link">&lt;a href="#same-same-but-different">Same same but different&lt;/a>&lt;/h3>
&lt;p>One effect of using Netlify this way is that your site will be built in two places: one is the separate, public GitHub Pages repository that the Makefile pushes to, and the other is your Netlify site that deploys on their CDN from your linked private GitHub repository. The latter is useful if you&amp;rsquo;re going to play with &lt;a href="https://www.netlify.com/blog/2016/07/20/introducing-deploy-previews-in-netlify/">Deploy Previews&lt;/a> and other Netlify features, but those are outside the scope of this post.&lt;/p>
&lt;p>The main point is that your GitHub Pages site is now updated in your public repo. Yay!&lt;/p>
&lt;h2 id="go-forth-and-deploy-fearlessly" class="anchor-link">&lt;a href="#go-forth-and-deploy-fearlessly">Go forth and deploy fearlessly&lt;/a>&lt;/h2>
&lt;p>I hope the effect of this new information is that you feel more able to update your sites, wherever you happen to be. The possibilities are endless - at home on your couch with your laptop, out cafe-hopping with your iPad, or in the middle of a first date on your phone. Endless!&lt;/p>
&lt;figure>
&lt;img src="date-deploy.png"
alt="Don&amp;#39;t update your site from your phone on a date"/> &lt;figcaption>
&lt;p>Don&amp;rsquo;t do stuff on your phone when you&amp;rsquo;re on a date. Not if you want a second one, anyway.&lt;/p>
&lt;/figcaption>
&lt;/figure></content:encoded><enclosure url="https://victoria.dev/blog/two-ways-to-deploy-a-public-github-pages-site-from-a-private-hugo-repository/cover_hua0c104d819921f3f45be661545f8932d_2244173_640x0_resize_box_2.png" type="image/jpg"/></item><item><title>A remote sync solution for iOS and Linux: Git and Working Copy</title><link>https://victoria.dev/blog/a-remote-sync-solution-for-ios-and-linux-git-and-working-copy/</link><pubDate>Fri, 15 Mar 2019 11:55:28 -0400</pubDate><author>hello@victoria.dev (Victoria Drake)</author><guid>https://victoria.dev/blog/a-remote-sync-solution-for-ios-and-linux-git-and-working-copy/</guid><description>How to set up a cross-platform cloud sync solution for working anywhere using Git on iOS.</description><content:encoded>
&lt;img src="https://victoria.dev/blog/a-remote-sync-solution-for-ios-and-linux-git-and-working-copy/cover_remote-sync_hu1984111f2d75b603219adcc3d215dc57_618766_640x0_resize_box_2.png" width="640" height="418"/>
&lt;p>I previously wrote about a (hackish) way to use a &lt;a href="https://victoria.dev/blog/how-i-set-up-a-single-dropbox-folder-on-my-dual-boot-windows-and-linux-system/">single Dropbox folder on a dual-boot Windows and Linux machine&lt;/a>. I&amp;rsquo;ve since &lt;del>gained some sense&lt;/del> gone full Linux with Ubuntu 18.04 LTS, but the Dropbox set up seems to have stopped being an option in any case. Fortunately, I&amp;rsquo;ve since found a much better (far less hackish) way to remote-sync files across different file systems. Reflecting my current set up, I&amp;rsquo;m talking about iOS (iPad and iPhone) and my Linux machine.&lt;/p>
&lt;p>The new sync system is based on Git, very customizable, and conveniently extensible. Beyond text files, you can sync anything that Git can (which is almost everything - if you want to edit your &lt;code>.gitignore&lt;/code>d files on the go I&amp;rsquo;m not sure I can help). If you&amp;rsquo;re already familiar with Git, getting set up will be a walk in the park. If Git is new to you, I think these tools help make the concepts of Git cloning, pulling, and pushing straightforward to understand.&lt;/p>
&lt;h2 id="components" class="anchor-link">&lt;a href="#components">Components&lt;/a>&lt;/h2>
&lt;ul>
&lt;li>&lt;a href="https://workingcopy.app">Working Copy app&lt;/a> ($15.99 one-time pro-unlock and well worth it, iOS only)&lt;/li>
&lt;li>&lt;a href="https://ia.net/writer">iA Writer app&lt;/a> ($8.99 one-time purchase for iOS, also available on Mac, Windows, and Android)&lt;/li>
&lt;li>GitHub repositories (&lt;a href="https://github.blog/2019-01-07-new-year-new-github/">private&lt;/a> or public, both free)&lt;/li>
&lt;/ul>
&lt;p>I was inspired by &lt;a href="https://www.macstories.net/ios/my-markdown-writing-and-collaboration-workflow-powered-by-working-copy-3-6-icloud-drive-and-github/">this article&lt;/a> as well as &lt;a href="http://blog.joncairns.com/2011/10/how-to-use-git-submodules/">this one&lt;/a>.&lt;/p>
&lt;h2 id="get-set-up" class="anchor-link">&lt;a href="#get-set-up">Get set up&lt;/a>&lt;/h2>
&lt;p>Here are the steps to setting up that I&amp;rsquo;ll walk you through in this article.&lt;/p>
&lt;ol>
&lt;li>Create your remote repository&lt;/li>
&lt;li>Clone repository to iPad with Working Copy&lt;/li>
&lt;li>Open and edit files with iA Writer&lt;/li>
&lt;li>Push changes back to remote&lt;/li>
&lt;li>Pull changes from repository on your computer&lt;/li>
&lt;/ol>
&lt;p>This system is straightforward to set up whether you&amp;rsquo;re a command line whiz or just getting into Git. Let&amp;rsquo;s do it!&lt;/p>
&lt;h3 id="create-your-remote-repository" class="anchor-link">&lt;a href="#create-your-remote-repository">Create your remote repository&lt;/a>&lt;/h3>
&lt;p>GitHub now offers free &lt;a href="https://github.blog/2019-01-07-new-year-new-github/">private repositories&lt;/a> for up to three collaborators. Choose &amp;ldquo;Private&amp;rdquo; on GitHub&amp;rsquo;s repository creation page:&lt;/p>
&lt;p>
&lt;img src="https://victoria.dev/blog/a-remote-sync-solution-for-ios-and-linux-git-and-working-copy/github-private-repo.png#screenshot" alt="Selection options for public and private repository" />
&lt;/p>
&lt;p>Create the repository. If you&amp;rsquo;d like to, you can follow GitHub&amp;rsquo;s instructions to push some files to it from your computer, or you can add files later from your iPad.&lt;/p>
&lt;h3 id="clone-repository-to-ipad-with-working-copy" class="anchor-link">&lt;a href="#clone-repository-to-ipad-with-working-copy">Clone repository to iPad with Working Copy&lt;/a>&lt;/h3>
&lt;p>Download &lt;a href="https://workingcopy.app">Working Copy&lt;/a> from the App Store. It&amp;rsquo;s one of the more expensive apps I&amp;rsquo;ve purchased, but I think it&amp;rsquo;s well worth it. Developer &lt;a href="https://twitter.com/palmin">Anders Borum&lt;/a> has a steady track record of frequent updates and incorporating the latest features for iOS apps, like &lt;a href="https://workingcopy.app/manual/dragdrop">drag and drop&lt;/a> on iPad. I think he&amp;rsquo;s fairly priced his product in light of the work he puts into maintaining and enhancing it.&lt;/p>
&lt;p>In Working Copy, find the gear icon in the top left corner and touch to open Settings.&lt;/p>
&lt;p>
&lt;img src="https://victoria.dev/blog/a-remote-sync-solution-for-ios-and-linux-git-and-working-copy/workingcopy-settings.png#screenshot" alt="Settings menu in Working Copy" />
&lt;/p>
&lt;p>Tap on SSH Keys, and you&amp;rsquo;ll see this screen:&lt;/p>
&lt;p>
&lt;img src="https://victoria.dev/blog/a-remote-sync-solution-for-ios-and-linux-git-and-working-copy/workingcopy-ssh.png#screenshot" alt="SSH Key for Working Copy on iPad" />
&lt;/p>
&lt;p>SSH keys, or Secure Shell keys, are access credentials used in the &lt;a href="https://en.wikipedia.org/wiki/Secure_Shell">SSH protocol&lt;/a>. Your key is a password that your device will use to securely connect with your remote repository host - GitHub, in our example. Since anyone with your SSH keys can potentially pretend to be you and gain access to your files, it&amp;rsquo;s important not to share them accidentally, like in a screenshot on a blog post.&lt;/p>
&lt;p>Tap on the second line that looks like &amp;ldquo;WorkingCopy@iPad-xxxxxxxx&amp;rdquo; to get this screen:&lt;/p>
&lt;p>
&lt;img src="https://victoria.dev/blog/a-remote-sync-solution-for-ios-and-linux-git-and-working-copy/workingcopy-ssh-connect.png#screenshot" alt="Connect to GitHub or Bitbucket in Working Copy" />
&lt;/p>
&lt;p>Working Copy supports easy connection to both BitBucket and GitHub. Tap &amp;ldquo;Connect With GitHub&amp;rdquo; or BitBucket to bring up some familiar sign-in screens that will authorize Working Copy to access your account(s).&lt;/p>
&lt;p>Once connected, tap the &amp;ldquo;+&amp;rdquo; symbol in the top right of the side bar to add a new repository. Choose &amp;ldquo;Clone repository&amp;rdquo; to bring up this screen:&lt;/p>
&lt;p>
&lt;img src="https://victoria.dev/blog/a-remote-sync-solution-for-ios-and-linux-git-and-working-copy/workingcopy-read-repos.png#screenshot" alt="Loading repositories from remote" />
&lt;/p>
&lt;p>Here, you can either manually input the remote URL, or simply choose from the list of repositories that Working Copy fetches from your connected account. When you make your choice, the app clones the repository to your iPad and it will show up in the sidebar. You&amp;rsquo;re connected!&lt;/p>
&lt;h3 id="open-and-edit-files-with-ia-writer" class="anchor-link">&lt;a href="#open-and-edit-files-with-ia-writer">Open and edit files with iA Writer&lt;/a>&lt;/h3>
&lt;p>One of the (many) reasons I adore &lt;a href="https://ia.net/writer">iA Writer&lt;/a> is its ability to select your freshly cloned remote repository as a Library Location. To do this in the iA Writer app:&lt;/p>
&lt;ol>
&lt;li>From the main Library list, in the top right of the sidebar, tap &amp;ldquo;Edit&amp;rdquo;&lt;/li>
&lt;li>Tap &amp;ldquo;Add Location&amp;hellip;&amp;rdquo;&lt;/li>
&lt;li>A helpful popup appears. Tap OK.&lt;/li>
&lt;li>From the Working Copy location, tap &amp;ldquo;Select&amp;rdquo; in the top right, then choose the repository folder.&lt;/li>
&lt;li>Tap &amp;ldquo;Open&amp;rdquo;, then &amp;ldquo;Done&amp;rdquo;&lt;/li>
&lt;/ol>
&lt;p>Your remote repository now appears as a Location in the sidebar. Tap on it to work within this directory.&lt;/p>
&lt;p>While inside this location, new files you create (by tapping the pencil-and-paper icon in the top right corner) will be saved to this folder locally. As you work, iA Writer automatically saves your progress. Next, we&amp;rsquo;ll look at pushing those files and changes back to your remote.&lt;/p>
&lt;h3 id="push-changes-back-to-remote" class="anchor-link">&lt;a href="#push-changes-back-to-remote">Push changes back to remote&lt;/a>&lt;/h3>
&lt;p>Once you&amp;rsquo;ve made changes to your files, open Working Copy again. You should see a yellow dot on your changed repository.&lt;/p>
&lt;p>
&lt;img src="https://victoria.dev/blog/a-remote-sync-solution-for-ios-and-linux-git-and-working-copy/workingcopy-changed-repo.png#screenshot" alt="Yellow dot indicating changes to repository" />
&lt;/p>
&lt;p>Tap on your repository name, then on &amp;ldquo;Repository Status and Configuration&amp;rdquo; at the top of the sidebar. Your changed files will be indicated by yellow dots or green &amp;ldquo;+&amp;rdquo; symbols. These mean that you&amp;rsquo;ve modified or added files, respectively.&lt;/p>
&lt;p>Working Copy is a sweet iOS Git client, and you can tap on your files to see additional information including a comparison of changes (&amp;ldquo;diff&amp;rdquo;) as well as status and Git history. You can even edit files right within the app, with &lt;a href="https://workingcopyapp.com/manual/edit">syntax highlighting&lt;/a> for its many supported languages. For now, we&amp;rsquo;ll look at how to push your changed work to your remote repository.&lt;/p>
&lt;p>
&lt;img src="https://victoria.dev/blog/a-remote-sync-solution-for-ios-and-linux-git-and-working-copy/workingcopy-changes-to-commit.png#screenshot" alt="Changes to commit" />
&lt;/p>
&lt;p>On the &amp;ldquo;Repository Status and Configuration&amp;rdquo; page, you&amp;rsquo;ll see right at the top that there are changes to be committed. If you&amp;rsquo;re new to Git, this is like &amp;ldquo;saving your changes&amp;rdquo; to your Git history, something typically done with the terminal command &lt;a href="https://git-scm.com/docs/git-commit">&lt;code>git commit&lt;/code>&lt;/a>. You can think of this as saving the files that we&amp;rsquo;ll want to send to the GitHub repository. Tap &amp;ldquo;Commit changes.&amp;rdquo;&lt;/p>
&lt;p>
&lt;img src="https://victoria.dev/blog/a-remote-sync-solution-for-ios-and-linux-git-and-working-copy/workingcopy-commit-changes.png#screenshot" alt="Add a commit message and select files to commit" />
&lt;/p>
&lt;p>Enter your commit message, and select the files you want to add. Turn on the &amp;ldquo;Push&amp;rdquo; switch to send everything to your remote repository when you commit the files. Then tap &amp;ldquo;Commit.&amp;rdquo;&lt;/p>
&lt;p>You&amp;rsquo;ll see a progress bar as your files are uploaded, and then a confirmation message on the status screen.&lt;/p>
&lt;p>
&lt;img src="https://victoria.dev/blog/a-remote-sync-solution-for-ios-and-linux-git-and-working-copy/workingcopy-commit-success.png#screenshot" alt="Commit success message" />
&lt;/p>
&lt;p>Congratulations! Your changes are now present in your remote repository on GitHub. You&amp;rsquo;ve successfully synced your files remotely!&lt;/p>
&lt;h3 id="pull-changes-from-repository-on-your-computer" class="anchor-link">&lt;a href="#pull-changes-from-repository-on-your-computer">Pull changes from repository on your computer&lt;/a>&lt;/h3>
&lt;p>To bring your updated files full circle to your computer, you pull them from the GitHub repository. I prefer to use the terminal for this as it&amp;rsquo;s quick and easy, but GitHub also offers a &lt;a href="https://help.github.com/en/desktop/getting-started-with-github-desktop">graphical client&lt;/a> if terminal commands seem a little alien for now.&lt;/p>
&lt;p>If you started with the GitHub repository, you can clone it to a folder on your computer by following &lt;a href="https://help.github.com/en/articles/cloning-a-repository">these instructions&lt;/a>.&lt;/p>
&lt;h3 id="staying-in-sync" class="anchor-link">&lt;a href="#staying-in-sync">Staying in sync&lt;/a>&lt;/h3>
&lt;p>When you update your work on your computer, you&amp;rsquo;ll use Git to push your changes to the remote repository. To do this, you can use GitHub&amp;rsquo;s &lt;a href="https://help.github.com/en/desktop/getting-started-with-github-desktop">graphical client&lt;/a>, or follow &lt;a href="https://help.github.com/en/articles/adding-an-existing-project-to-github-using-the-command-line">these instructions&lt;/a>.&lt;/p>
&lt;p>On your iOS device, Working Copy makes pulling and pushing as simple as a single tap. On the Repository Status and Configuration page, tap on the remote name under &amp;ldquo;Remotes&amp;rdquo;.&lt;/p>
&lt;p>
&lt;img src="https://victoria.dev/blog/a-remote-sync-solution-for-ios-and-linux-git-and-working-copy/workingcopy-git-remote.png#screenshot" alt="List of Remotes in Working Copy" />
&lt;/p>
&lt;p>Then tap &amp;ldquo;Synchronize&amp;rdquo;. Working Copy will take care of the details of pushing your committed changes and/or pulling any new changes it finds from the remote repository.&lt;/p>
&lt;h2 id="not-bad-right" class="anchor-link">&lt;a href="#not-bad-right">Not bad, right&lt;/a>&lt;/h2>
&lt;p>For a Git-based developer and work-anywhere-aholic like me, this set up couldn&amp;rsquo;t be more convenient. Working Copy really makes staying in sync with my remote repositories seamless, nevermind the ability to work with any of my GitHub repos on the go.&lt;/p>
&lt;p>For editing on the go, here&amp;rsquo;s a useful tip. Use &lt;code>.gitignore&lt;/code> in your sync repository if you don&amp;rsquo;t need to move large files, like images, around with you. This will stop the ignored files from being pushed to GitHub and pulled to your iOS device - they&amp;rsquo;ll only remain on your computer&amp;rsquo;s larger hard drive. The &lt;code>.gitignore&lt;/code> file of one of my sync repositories looks like this:&lt;/p>
&lt;div class="highlight">&lt;pre class="chroma">&lt;code class="language-text" data-lang="text">*.png
*.jpeg
*.jpg
*.mp4
*.gif
&lt;/code>&lt;/pre>&lt;/div>&lt;p>This means all the media files stay on my computer, and I can pull just the text file content to my iPad from GitHub to work on while I&amp;rsquo;m out and about.&lt;/p>
&lt;p>I most recently used this set up to get some writing done while hanging out in the atrium of Washington DC&amp;rsquo;s National Portrait Gallery, which is pleasantly photogenic.&lt;/p>
&lt;p>
&lt;img src="https://victoria.dev/blog/a-remote-sync-solution-for-ios-and-linux-git-and-working-copy/washington-portrait-gallery.jpg" alt="The atrium of the National Portrait Gallery" />
&lt;/p>
&lt;p>&lt;a href="https://twitter.com/victoriadotdev">I&amp;rsquo;d love to hear&lt;/a> how this set up works for you and how you use it. In the meantime, happy working!&lt;/p></content:encoded><enclosure url="https://victoria.dev/blog/a-remote-sync-solution-for-ios-and-linux-git-and-working-copy/cover_remote-sync_hu1984111f2d75b603219adcc3d215dc57_618766_640x0_resize_box_2.png" type="image/jpg"/></item><item><title>On doing great things</title><link>https://victoria.dev/blog/on-doing-great-things/</link><pubDate>Fri, 08 Mar 2019 18:36:15 -0500</pubDate><author>hello@victoria.dev (Victoria Drake)</author><guid>https://victoria.dev/blog/on-doing-great-things/</guid><description>Some thoughts inspired by International Women's Day, Grace Hopper, and making contributions to the world of tech.</description><content:encoded>
&lt;img src="https://victoria.dev/blog/on-doing-great-things/grace-murray-hopper-park_hu2bbff2aa9b6171d9361d3e244239fc60_166728_640x0_resize_q75_box.jpeg" width="640" height="480"/>
&lt;p>It&amp;rsquo;s International Women&amp;rsquo;s Day, and I&amp;rsquo;m thinking about Grace Hopper.&lt;/p>
&lt;p>&lt;a href="https://en.m.wikipedia.org/wiki/Grace_Hopper">Grace Hopper&lt;/a> was an amazing lady who did great things. She envisioned and helped create programming languages that translate English terms into machine code. She persevered in her intention to join the US Navy from the time she was rejected at 34 years old, to being sworn in to the US Navy Reserve three years later, to retiring with the rank of commander at age 60&amp;hellip; then was recalled (twice) and promoted to the rank of captain at the age of 67. She advocated for distributed networks and developed computer testing standards we use today, among other achievements too numerous to list here.&lt;/p>
&lt;p>By my read, throughout her life, she kept her focus on her work. She did great things because she could do them, and felt some duty to do them. Her work speaks for itself.&lt;/p>
&lt;p>I recently came across a sizeable rock denoting a rather small, quiet park. It looks like this:&lt;/p>
&lt;p>
&lt;img src="https://victoria.dev/blog/on-doing-great-things/grace-murray-hopper-park.jpeg#center" alt="Signage on a rock denoting Grace Murray Hopper Park" />
&lt;/p>
&lt;p>When I first saw this park, I thought it in no way did this great lady justice. But upon some reflection, its lack of assumption and grandeur grew on me. And today, it drew to the forefront something that&amp;rsquo;s been on my mind.&lt;/p>
&lt;p>I try and contribute regularly to the wide world of technology, usually through building things, writing, and mentorship. I sometimes get asked to participate in female-focused tech events. I hear things like, &amp;ldquo;too few developers are women,&amp;rdquo; or &amp;ldquo;we need more women in blockchain,&amp;rdquo; or &amp;ldquo;we need more female coders.&amp;rdquo;&lt;/p>
&lt;p>For some time I haven&amp;rsquo;t been sure how to respond, because while my answer isn&amp;rsquo;t &amp;ldquo;yes,&amp;rdquo; it&amp;rsquo;s not exactly &amp;ldquo;no,&amp;rdquo; either. It&amp;rsquo;s really, &amp;ldquo;no, because&amp;hellip;&amp;rdquo; and it&amp;rsquo;s because I&amp;rsquo;m afraid. I&amp;rsquo;m afraid of misrepresenting myself, my values, and my goals.&lt;/p>
&lt;p>Discrimination and racism are real things. They exist in the minds and attitudes of a very small percentage of very loud people, as they always will. These people aren&amp;rsquo;t, however, the majority. They are small.&lt;/p>
&lt;p>I think that on the infrequent occasions when we encounter these people, we should do our best to lead by example. We should have open minds, tell our stories, listen to theirs. Try and learn something. That&amp;rsquo;s all.&lt;/p>
&lt;p>When I present myself, I don&amp;rsquo;t point out that I&amp;rsquo;m a woman. I don&amp;rsquo;t align myself with &amp;ldquo;women in tech&amp;rdquo; or seek to represent them. I don&amp;rsquo;t go to women-only meetings or support organizations that discriminate against men, or anyone at all. It&amp;rsquo;s not because I&amp;rsquo;m insecure as a woman, or ashamed that I&amp;rsquo;m a woman, or some other inflammatory adjective that lately shows up in conjunction with being female. It&amp;rsquo;s because I&amp;rsquo;ve no reason to point out my gender, any more than needing to point out that my hair is black, or that I&amp;rsquo;m short. It&amp;rsquo;s obvious and simultaneously irrelevant.&lt;/p>
&lt;p>When I identify with a group, I talk about the go-getters who wake up at 0500 every day and go work out - no matter the weather, or whether they feel like it. I tell stories about the people I met in different countries around the world, who left home, struck out on their own, and had an adventure, because they saw value in the experience. I identify with people who constantly build things, try things, design and make things, and then share those things with the world, because they love to do so. This is how I see myself. This is what matters to me.&lt;/p>
&lt;p>Like the unassuming park named after an amazing woman, when truly great things are done, they are done relatively quietly. Not done for the fanfare of announcing them to the world, but for the love of the thing itself. So go do great things, please. The world still needs them.&lt;/p></content:encoded><enclosure url="https://victoria.dev/blog/on-doing-great-things/grace-murray-hopper-park_hu2bbff2aa9b6171d9361d3e244239fc60_166728_640x0_resize_q75_box.jpeg" type="image/jpg"/></item><item><title>Git commit practices your future self will thank you for</title><link>https://victoria.dev/blog/git-commit-practices-your-future-self-will-thank-you-for/</link><pubDate>Mon, 06 Aug 2018 08:54:56 -0400</pubDate><author>hello@victoria.dev (Victoria Drake)</author><guid>https://victoria.dev/blog/git-commit-practices-your-future-self-will-thank-you-for/</guid><description>How squash commits, vimrc, and git tags can help you make great Git commits.</description><content:encoded>
&lt;img src="https://victoria.dev/blog/git-commit-practices-your-future-self-will-thank-you-for/cover_git-commit-art_hu3c5d7a1ac69b5f3a44f90a6688078cc1_89530_640x0_resize_box_2.png" width="640" height="320"/>
&lt;p>A history of clean commits can be evidence of a lot of things: attention to detail, good work ethic, and genuine investment in the project. What do your Git commits say about you?&lt;/p>
&lt;p>If, like me, there &lt;em>might&lt;/em> be one or two less than stellar ones, well, we&amp;rsquo;re only human. A nice part of being human is having the ability to learn new and complex things fairly quickly, and continuously improve ourselves. In that spirit, I&amp;rsquo;d like to share some things I&amp;rsquo;ve learned about creating clean, useful, and responsible Git commits.&lt;/p>
&lt;h2 id="what-does-it-mean-to-commit-responsibly" class="anchor-link">&lt;a href="#what-does-it-mean-to-commit-responsibly">What does it mean to commit responsibly&lt;/a>&lt;/h2>
&lt;p>Whether our code will be seen by the entire open source community or just future versions of ourselves, either one will be grateful if we commit responsibly today. Being responsible can mean a lot of things to different people, so I enlisted some of &lt;a href="https://mastodon.technology/@victoria/">mastodon.technology&lt;/a> and &lt;a href="https://dev.to/victoria/what-does-it-mean-to-commit-responsibly-22mi">dev.to&lt;/a> to help round out my list. From those (really great) threads, I distilled these main points:&lt;/p>
&lt;blockquote>
&lt;p>&lt;strong>Committing responsibly&lt;/strong>&lt;/p>
&lt;ol>
&lt;li>Provide and/or use tests to avoid committing bugs or broken builds&lt;/li>
&lt;li>Write clean code that meets style specifications&lt;/li>
&lt;li>Use descriptive commit messages that reference related discussion&lt;/li>
&lt;li>Make only one change per commit and avoid including unrelated changes&lt;/li>
&lt;/ol>
&lt;/blockquote>
&lt;p>Some of the above is achieved through maintaining a short feedback loop that helps you improve your code quality while staying accountable to yourself. &lt;a href="https://victoria.dev/blog/how-to-set-up-a-short-feedback-loop-as-a-solo-coder/">I wrote another article&lt;/a> that discusses this in detail, especially the part about &lt;a href="https://victoria.dev/blog/how-to-set-up-a-short-feedback-loop-as-a-solo-coder/#block-out-time-for-code-review">code review&lt;/a>. Other items on this list have to do specifically with making commits in Git. There are some features of Git that can benefit us in these areas, as can harnessing tools like Vim. I&amp;rsquo;ll cover those topics here.&lt;/p>
&lt;p>If the majority of your Git commits so far have been created with something like &lt;code>git commit -m &amp;quot;Bug fixes&amp;quot;&lt;/code> then this is the article for you!&lt;/p>
&lt;h2 id="write-great-git-commit-messages-with-a-template" class="anchor-link">&lt;a href="#write-great-git-commit-messages-with-a-template">Write great Git commit messages with a template&lt;/a>&lt;/h2>
&lt;p>I think &lt;a href="https://github.com/torvalds/subsurface-for-dirk/commit/b6590150d68df528efd40c889ba6eea476b39873">Linus&lt;/a> would be very happy if we didn&amp;rsquo;t use &lt;code>git commit -m &amp;quot;Fix bug&amp;quot;&lt;/code> in a public repository ever again. As very well put in &lt;a href="https://tbaggery.com/2008/04/19/a-note-about-git-commit-messages.html">this classic post&lt;/a> and &lt;a href="https://chris.beams.io/posts/git-commit/">the seven rules of a great Git commit message&lt;/a>:&lt;/p>
&lt;blockquote>
&lt;p>A properly formed Git commit subject line should always be able to complete the following sentence:&lt;/p>
&lt;p>If applied, this commit will &lt;em>your subject line here&lt;/em>&lt;/p>
&lt;/blockquote>
&lt;p>&lt;a href="http://who-t.blogspot.com/2009/12/on-commit-messages.html">This other classic post&lt;/a> also discusses three questions that the body of the commit message should answer:&lt;/p>
&lt;blockquote>
&lt;p>Why is it necessary?
How does it address the issue?
What effects does the patch have?&lt;/p>
&lt;/blockquote>
&lt;p>This can be a lot to remember to cover, but there&amp;rsquo;s a slick way to have these prompts at hand right when you need it. You can set up a commit message template by using the &lt;code>commit.template&lt;/code> &lt;a href="https://git-scm.com/book/en/v2/Customizing-Git-Git-Configuration">configuration value&lt;/a>.&lt;/p>
&lt;p>To set it, configure Git to use a template file (for example, &lt;code>.gitmessage&lt;/code> in your home directory), then create the template file with Vim:&lt;/p>
&lt;div class="highlight">&lt;pre class="chroma">&lt;code class="language-sh" data-lang="sh">git config --global commit.template ~/.gitmessage
vim ~/.gitmessage
&lt;/code>&lt;/pre>&lt;/div>&lt;p>When we run &lt;code>git commit&lt;/code> without the &lt;code>-m&lt;/code> message flag, the editor will open with our helpful template ready to go. Here&amp;rsquo;s my commit message template:&lt;/p>
&lt;pre>&lt;code class="language-console" data-lang="console">## If applied, this commit will...
## [Add/Fix/Remove/Update/Refactor/Document] [issue #id] [summary]
## Why is it necessary? (Bug fix, feature, improvements?)
-
## How does the change address the issue?
-
## What side effects does this change have?
-
&lt;/code>&lt;/pre>&lt;p>I&amp;rsquo;m a fan of this format because commented lines are not included in the final message. I can simply fill in the blank lines with text and bullet points under the prompts, and it comes out looking something like this:&lt;/p>
&lt;div class="highlight">&lt;pre class="chroma">&lt;code class="language-txt" data-lang="txt">Fix #16 missing CSS variables
- Fix for unstyled elements
- Add background color, height for code blocks
- Only affects highlight class
&lt;/code>&lt;/pre>&lt;/div>
&lt;h3 id="reference-related-discussion" class="anchor-link">&lt;a href="#reference-related-discussion">Reference related discussion&lt;/a>&lt;/h3>
&lt;p>Issue trackers in &lt;a href="https://help.github.com/articles/closing-issues-using-keywords/">GitHub&lt;/a> and &lt;a href="https://confluence.atlassian.com/bitbucket/resolve-issues-automatically-when-users-push-code-221451126.html">Bitbucket&lt;/a> both recognize the keywords &lt;code>close&lt;/code>, &lt;code>fix&lt;/code>, and &lt;code>resolve&lt;/code> followed immediately by the issue or pull request number. These keywords conveniently help us close the referenced issue or pull request, and this helps maintain a clear trail of changes. &lt;a href="https://docs.gitlab.com/ee/user/project/issues/crosslinking_issues.html">GitLab&lt;/a>, and issue trackers like &lt;a href="https://confluence.atlassian.com/jirasoftwarecloud/referencing-issues-in-your-development-work-777002789.html">Jira&lt;/a> offer similar functionalities.&lt;/p>
&lt;h3 id="use-helpful-vim-settings-for-git-commit-messages" class="anchor-link">&lt;a href="#use-helpful-vim-settings-for-git-commit-messages">Use helpful Vim settings for git commit messages&lt;/a>&lt;/h3>
&lt;p>By adding a few lines to our Vim configuration, we can make writing great git commit messages easy. We can add these lines to &lt;code>~/.vimrc&lt;/code> to turn on syntax highlighting in general, and spell check and text wrapping for commit messages in particular:&lt;/p>
&lt;div class="highlight">&lt;pre class="chroma">&lt;code class="language-vimrc" data-lang="vimrc">&lt;span class="c">&amp;#34; Filetype detection, plugins, and indent rules&lt;/span>&lt;span class="err">
&lt;/span>&lt;span class="err">&lt;/span>&lt;span class="nx">filetype&lt;/span> &lt;span class="nx">plugin&lt;/span> &lt;span class="nx">indent&lt;/span> &lt;span class="nx">on&lt;/span>&lt;span class="err">
&lt;/span>&lt;span class="err">&lt;/span>&lt;span class="c">
&lt;/span>&lt;span class="c">&amp;#34; Syntax highlighting&lt;/span>&lt;span class="err">
&lt;/span>&lt;span class="err">&lt;/span>&lt;span class="nx">syntax&lt;/span> &lt;span class="nx">on&lt;/span>&lt;span class="err">
&lt;/span>&lt;span class="err">&lt;/span>&lt;span class="c">
&lt;/span>&lt;span class="c">&amp;#34; Spell check and line wrap just for git commit messages&lt;/span>&lt;span class="err">
&lt;/span>&lt;span class="err">&lt;/span>&lt;span class="nx">autocmd&lt;/span> &lt;span class="nx">Filetype&lt;/span> &lt;span class="nx">gitcommit&lt;/span> &lt;span class="nx">setlocal&lt;/span> &lt;span class="nx">spell&lt;/span> &lt;span class="nx">textwidth&lt;/span>&lt;span class="p">=&lt;/span>&lt;span class="m">72&lt;/span>&lt;span class="err">
&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>If you&amp;rsquo;re curious, you can find my full &lt;code>~/.vimrc&lt;/code> in my &lt;a href="https://github.com/victoriadrake/dotfiles">dotfiles&lt;/a>.&lt;/p>
&lt;p>Other editors have settings that can help us out as well. I came across &lt;a href="https://dev.to/shreyasminocha/how-i-do-my-git-commits-34d">these for Sublime Text 3&lt;/a> and &lt;a href="https://github.com/Microsoft/vscode-docs/blob/master/docs/getstarted/tips-and-tricks.md#language-specific-settings">language specific settings for VS Code&lt;/a>.&lt;/p>
&lt;h2 id="one-change-per-commit-how-to-squash-git-commits" class="anchor-link">&lt;a href="#one-change-per-commit-how-to-squash-git-commits">One change per commit: how to squash Git commits&lt;/a>&lt;/h2>
&lt;figure>
&lt;img src="git-commit-squash.png"
alt="A doodle of squash"/> &lt;figcaption>
&lt;p>Still life Git&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;p>Let&amp;rsquo;s get one thing out of the way first: rewriting Git history just for the sake of having a pretty tree, especially with public repositories, is generally not advisable. It&amp;rsquo;s kind of like going back in time, where changes you make to your version of the project cause it to look completely different from a version that someone else forked from a point in history that you&amp;rsquo;ve now erased - I mean, haven&amp;rsquo;t you seen &lt;em>Back to the Future Part II&lt;/em>? (If you&amp;rsquo;d rather maintain that only one &lt;em>Back to the Future&lt;/em> movie was ever made, thus sparing your future self from having to watch the sequels, I get it.)&lt;/p>
&lt;p>Here&amp;rsquo;s the main point. If you&amp;rsquo;ve pushed messy commits to a public repository, I say go right ahead and leave them be, instead of complicating things further. (We all learn from our embarrassments, especially the public ones - I&amp;rsquo;m looking at you, past-Vicky.) If your messy commits currently only exist on your local version, great! We can tidy them up into one clean, well-described commit that we&amp;rsquo;ll be proud to push, and no one will be the wiser.&lt;/p>
&lt;p>There are a couple different ways to squash commits, and choosing the appropriate one depends on what we need to achieve.&lt;/p>
&lt;p>The following examples are illustrated using &lt;code>git log --graph&lt;/code>, with some options for brevity. We can set a handy alias to see this log format in our terminal with:&lt;/p>
&lt;div class="highlight">&lt;pre class="chroma">&lt;code class="language-sh" data-lang="sh">git config --global alias.plog &lt;span class="s2">&amp;#34;log --graph --pretty=format:&amp;#39;%h -%d %s %n&amp;#39; --abbrev-commit --date=relative --branches&amp;#34;&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>Then we just do &lt;code>git plog&lt;/code> to see the pretty log.&lt;/p>
&lt;h3 id="method-1-one-commit-to-rule-the-master-branch" class="anchor-link">&lt;a href="#method-1-one-commit-to-rule-the-master-branch">Method #1: one commit to rule the master branch&lt;/a>&lt;/h3>
&lt;p>This is appropriate when:&lt;/p>
&lt;ul>
&lt;li>We&amp;rsquo;re committing directly to master&lt;/li>
&lt;li>We don&amp;rsquo;t intend to open a pull request to merge a feature&lt;/li>
&lt;li>We don&amp;rsquo;t want to preserve history of branches or changes we haven&amp;rsquo;t yet pushed&lt;/li>
&lt;/ul>
&lt;p>This method takes a Git tree that looks like this:&lt;/p>
&lt;pre>&lt;code class="language-console" data-lang="console">* 3e8fd79 - (HEAD -&amp;gt; master) Fix a thing
|
* 4f0d387 - Tweak something
|
* 0a6b8b3 - Merge branch 'new-article'
|\
| * 33b5509 - (new-article) Update article again again
| |
| * 1782e63 - Update article again
| |
| * 3c5b6a8 - Update article
| |
* | f790737 - (master) Tweak unrelated article
|/
|
* 65af7e7 Add social media link
|
* 0e3fa32 (origin/master, origin/HEAD) Update theme
&lt;/code>&lt;/pre>&lt;p>And makes it look like this:&lt;/p>
&lt;pre>&lt;code class="language-console" data-lang="console">* 7f9a127 - (HEAD -&amp;gt; master) Add new article
|
* 0e3fa32 - (origin/master, origin/HEAD) Update theme
&lt;/code>&lt;/pre>&lt;p>Here&amp;rsquo;s how to do it - hold on to your hoverboards, it&amp;rsquo;s super complicated:&lt;/p>
&lt;div class="highlight">&lt;pre class="chroma">&lt;code class="language-sh" data-lang="sh">git reset --soft origin/master
git commit
&lt;/code>&lt;/pre>&lt;/div>&lt;p>Yup that&amp;rsquo;s all. We can delete the unwanted branch with &lt;code>git branch -D new-article&lt;/code>.&lt;/p>
&lt;h3 id="method-2-not-_that_-much" class="anchor-link">&lt;a href="#method-2-not-_that_-much">Method #2: not &lt;em>that&lt;/em> much&lt;/a>&lt;/h3>
&lt;p>This is appropriate when:&lt;/p>
&lt;ul>
&lt;li>We want to squash the last &lt;em>x&lt;/em> commits but not &lt;em>all&lt;/em> commits since &lt;code>origin/master&lt;/code>&lt;/li>
&lt;li>We want to open a pull request to merge a branch&lt;/li>
&lt;/ul>
&lt;p>This method takes a Git tree that looks like this:&lt;/p>
&lt;pre>&lt;code class="language-console" data-lang="console">* 13a070f - (HEAD -&amp;gt; new-article) Finish new article
|
* 78e728a - Edit article draft
|
* d62603c - Add example
|
* 1aeb20e - Update draft
|
* 5a8442a - Add new article draft
|
| * 65af7e7 - (master) Add social media link
|/
|
* 0e3fa32 - (origin/master, origin/HEAD) Update theme
&lt;/code>&lt;/pre>&lt;p>And makes it look like this:&lt;/p>
&lt;pre>&lt;code class="language-console" data-lang="console">* 90da69a - (HEAD -&amp;gt; new-article) Add new article
|
| * 65af7e7 - (master) Add social media link
|/
|
* 0e3fa32 - (origin/master, origin/HEAD) Update theme
&lt;/code>&lt;/pre>&lt;p>To squash the last five commits on branch &lt;code>new-article&lt;/code> into one, we use:&lt;/p>
&lt;div class="highlight">&lt;pre class="chroma">&lt;code class="language-sh" data-lang="sh">git reset --soft HEAD~5
git commit -m &lt;span class="s2">&amp;#34;New message for the combined commit&amp;#34;&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>Where &lt;code>--soft&lt;/code> leaves our files untouched and staged, and &lt;code>5&lt;/code> can be thought of as &amp;ldquo;the number of previous commits I want to combine.&amp;rdquo;&lt;/p>
&lt;p>We can then do &lt;code>git merge master&lt;/code> and create our pull request.&lt;/p>
&lt;h3 id="method-3-getting-picky" class="anchor-link">&lt;a href="#method-3-getting-picky">Method #3: getting picky&lt;/a>&lt;/h3>
&lt;p>Say we had a really confusing afternoon and our Git tree looks like this:&lt;/p>
&lt;pre>&lt;code class="language-console" data-lang="console">* dc89918 - (HEAD -&amp;gt; master) Add link
|
* 9b6780f - Update image asset
|
* 6379956 - Fix CSS bug
|
* 16ee1f3 - Merge master into branch
|\
| |
| * ccec365 - Update list page
| |
* | 033dee7 - Fix typo
| |
* | 90da69a - Add new article
|/
|
* 0e3fa32 - (origin/master, origin/HEAD) Update theme
&lt;/code>&lt;/pre>&lt;p>We want to retain some of this history, but clean up the commits. We also want to change the messages for some of the commits. To achieve this, we&amp;rsquo;ll use &lt;code>git rebase&lt;/code>.&lt;/p>
&lt;p>This is appropriate when:&lt;/p>
&lt;ul>
&lt;li>We want to squash only some commits&lt;/li>
&lt;li>We want to edit previous commit messages&lt;/li>
&lt;li>We want to delete or reorder specific commits&lt;/li>
&lt;/ul>
&lt;p>Git &lt;code>rebase&lt;/code> is a powerful tool, and handy once we&amp;rsquo;ve got the hang of it. To change all the commits since &lt;code>origin/master&lt;/code>, we do:&lt;/p>
&lt;div class="highlight">&lt;pre class="chroma">&lt;code class="language-sh" data-lang="sh">git rebase -i origin/master
&lt;/code>&lt;/pre>&lt;/div>&lt;p>Or, we can do:&lt;/p>
&lt;div class="highlight">&lt;pre class="chroma">&lt;code class="language-sh" data-lang="sh">git rebase -i 0e3fa32
&lt;/code>&lt;/pre>&lt;/div>&lt;p>Where the commit hash is the last commit we want to retain as-is.&lt;/p>
&lt;p>The &lt;code>-i&lt;/code> option lets us run the interactive rebase tool, which launches our editor with, essentially, a script for us to modify. We&amp;rsquo;ll see a list of our commits in reverse order to the git log, with the oldest at the top:&lt;/p>
&lt;pre>&lt;code class="language-console" data-lang="console">pick 90da69a Add new article
pick 033dee7 Fix typo
pick ccec365 Update list page
pick 6379956 Fix CSS bug
pick 9b6780f Update image asset
pick dc89918 Add link
# Rebase 0e3fa32..dc89918 onto 0e3fa32 (6 commands)
#
# Commands:
# p, pick = use commit
# r, reword = use commit, but edit the commit message
# e, edit = use commit, but stop for amending
# s, squash = use commit, but meld into previous commit
# f, fixup = like &amp;quot;squash&amp;quot;, but discard this commit's log message
# x, exec = run command (the rest of the line) using shell
# d, drop = remove commit
#
# These lines can be re-ordered; they are executed from top to bottom.
#
# If you remove a line here THAT COMMIT WILL BE LOST.
#
# However, if you remove everything, the rebase will be aborted.
#
# Note that empty commits are commented out
#
~
&lt;/code>&lt;/pre>&lt;p>The comments give us a handy guide as to what we&amp;rsquo;re able to do. For now, let&amp;rsquo;s squash the commits with small changes into the more significant commits. In our editor, we change the script to look like this:&lt;/p>
&lt;pre>&lt;code class="language-console" data-lang="console">pick 90da69a Add new article
squash 033dee7 Fix typo
pick ccec365 Update list page
squash 6379956 Fix CSS bug
squash 9b6780f Update image asset
squash dc89918 Add link
&lt;/code>&lt;/pre>&lt;p>Once we save the changes, the interactive tool continues to run. It will execute our instructions in sequence. In this case, we see the editor again with the following:&lt;/p>
&lt;pre>&lt;code class="language-console" data-lang="console"># This is a combination of 2 commits.
# This is the 1st commit message:
Add new article
# This is the commit message #2:
Fix typo
# Please enter the commit message for your changes. Lines starting
# with '#' will be ignored, and an empty message aborts the commit.
#
# interactive rebase in progress; onto 0e3fa32
# Last commands done (2 commands done):
# pick 90da69a Add new article
# squash 033dee7 Fix typo
# Next commands to do (4 remaining commands):
# pick ccec365 Update list page
# squash 6379956 Fix CSS bug
# You are currently rebasing branch 'master' on '0e3fa32'.
#
# Changes to be committed:
# modified: ...
#
~
&lt;/code>&lt;/pre>&lt;p>Here&amp;rsquo;s our chance to create a new commit message for this first squash, if we want to. Once we save it, the interactive tool will go on to the next instructions. Unless&amp;hellip;&lt;/p>
&lt;pre>&lt;code class="language-console" data-lang="console">[detached HEAD 3cbad01] Add new article
1 file changed, 129 insertions(+), 19 deletions(-)
Auto-merging content/dir/file.md
CONFLICT (content): Merge conflict in content/dir/file.md
error: could not apply ccec365... Update list page
Resolve all conflicts manually, mark them as resolved with
&amp;quot;git add/rm &amp;lt;conflicted_files&amp;gt;&amp;quot;, then run &amp;quot;git rebase --continue&amp;quot;.
You can instead skip this commit: run &amp;quot;git rebase --skip&amp;quot;.
To abort and get back to the state before &amp;quot;git rebase&amp;quot;, run &amp;quot;git rebase --abort&amp;quot;.
Could not apply ccec365... Update list page
&lt;/code>&lt;/pre>&lt;p>Again, the tool offers some very helpful instructions. Once we fix the merge conflict, we can resume the process with &lt;code>git rebase --continue&lt;/code>. Our interactive rebase picks up where it left off.&lt;/p>
&lt;p>Once all the squashing is done, our Git tree looks like this:&lt;/p>
&lt;pre>&lt;code class="language-console" data-lang="console">* 3564b8c - (HEAD -&amp;gt; master) Update list page
|
* 3cbad01 - Add new article
|
* 0e3fa32 - (origin/master, origin/HEAD) Update theme
&lt;/code>&lt;/pre>&lt;p>Phew, much better.&lt;/p>
&lt;h2 id="git-stash" class="anchor-link">&lt;a href="#git-stash">Git stash&lt;/a>&lt;/h2>
&lt;p>If we&amp;rsquo;re in the middle of some work and it&amp;rsquo;s not a good time to commit, but we need to switch branches, &lt;a href="https://git-scm.com/book/en/v1/Git-Tools-Stashing">stashing&lt;/a> can be a good option. Stashing lets us save our unfinished work without needing to create a half-assed commit. It&amp;rsquo;s like that pile of paper on your desk representing all the stuff you&amp;rsquo;ve been in the middle of doing since two weeks ago. Yup, that one.&lt;/p>
&lt;p>It&amp;rsquo;s as easy as typing &lt;code>git stash&lt;/code>:&lt;/p>
&lt;pre>&lt;code class="language-console" data-lang="console">Saved working directory and index state WIP on master: 3564b8c Update list page
&lt;/code>&lt;/pre>&lt;p>The dirty work we&amp;rsquo;re in the midst of is safely tucked away, and our working directory is clean - just as it was after our last commit. To see what&amp;rsquo;s in our stash stack, we do &lt;code>git stash list&lt;/code>:&lt;/p>
&lt;pre>&lt;code class="language-console" data-lang="console">stash@{0}: WIP on master: 3564b8c Update list page
stash@{1}: WIP on master: 90da69a Add new article
stash@{2}: WIP on cleanup: 0e3fa32 Update theme
&lt;/code>&lt;/pre>&lt;p>To restore our work in progress, we use &lt;code>git stash apply&lt;/code>. Git will try and apply our most recent stashed work. To apply an older stash, we use &lt;code>git stash apply stash@{1}&lt;/code> where &lt;code>1&lt;/code> is the stash to apply. If changes since stashing our work prevent the stash from reapplying cleanly, Git will give us a merge conflict to resolve.&lt;/p>
&lt;p>Applying a stash doesn&amp;rsquo;t remove it from our list. To remove a stash from our stack, we do &lt;code>git stash drop stash@{0}&lt;/code> where &lt;code>0&lt;/code> is the one we want to remove.&lt;/p>
&lt;p>We can also use &lt;code>git stash pop&lt;/code> to apply the most recent stash and then immediately remove it from the stack.&lt;/p>
&lt;h2 id="tag-release-versions-using-annotated-git-tags" class="anchor-link">&lt;a href="#tag-release-versions-using-annotated-git-tags">Tag release versions using annotated Git tags&lt;/a>&lt;/h2>
&lt;p>In the spirit of having a beautiful, clean Git history, there&amp;rsquo;s one more thing we can do to help make our commit log inspire infinite joy in its viewers. If you&amp;rsquo;ve never heard of &lt;code>git tag&lt;/code>, your master branch history might look like this&amp;hellip;&lt;/p>
&lt;pre>&lt;code class="language-console" data-lang="console">* 0377782 - Update theme
|
* ecf8128 - Add about page (#25)
|
* 33e432f - Fix #23 navigation bug
|
* 08b853b - Create blog section
|
* 63d18b4 - Add theme (#12)
|
* 233e23f - Add main content (#6)
&lt;/code>&lt;/pre>&lt;p>Wouldn&amp;rsquo;t it be nice if it looked like this instead?&lt;/p>
&lt;pre>&lt;code class="language-console" data-lang="console">* 0377782 - (tag: v2.1.0) Update theme
|
* ecf8128 - Add about page (#25)
|
* 33e432f - Fix #23 navigation bug
|
* 08b853b - (tag: v2.0.0) Create blog section
|
* 63d18b4 - Add theme (#12)
|
* 233e23f - (tag: v1.1.0) Add main content (#6)
&lt;/code>&lt;/pre>&lt;p>We can tag Git commits with anything, but tags are especially helpful for semantic versioning of releases. Sites like &lt;a href="https://help.github.com/articles/creating-releases/">GitHub&lt;/a> and &lt;a href="https://docs.gitlab.com/ee/user/project/releases/">GitLab&lt;/a> have pages for repositories that list tags, letting viewers of our project browse the release versions. This can be helpful for public projects to differentiate major releases, updates with bug fixes, or beta versions.&lt;/p>
&lt;p>There are two types of Git tags: lightweight and annotated. For adding a version tag to commits, we use annotated Git tags.&lt;/p>
&lt;p>The &lt;a href="https://git-scm.com/docs/git-tag">Git tag documentation&lt;/a> explains it this way:&lt;/p>
&lt;blockquote>
&lt;p>Tag objects (created with -a, -s, or -u) are called &amp;ldquo;annotated&amp;rdquo; tags; they contain a creation date, the tagger name and e-mail, a tagging message, and an optional GnuPG signature. Whereas a &amp;ldquo;lightweight&amp;rdquo; tag is simply a name for an object (usually a commit object).&lt;/p>
&lt;p>Annotated tags are meant for release while lightweight tags are meant for private or temporary object labels. For this reason, some git commands for naming objects (like git describe) will ignore lightweight tags by default.&lt;/p>
&lt;/blockquote>
&lt;p>We can think of lightweight tags as bookmarks, and annotated tags as signed releases.&lt;/p>
&lt;p>For public repositories, annotated tags allow us to:&lt;/p>
&lt;ul>
&lt;li>See who tagged the commit, which may differ from the commit author&lt;/li>
&lt;li>See all the tags with &lt;code>git describe&lt;/code>&lt;/li>
&lt;li>Avoid conflicting tag names&lt;/li>
&lt;/ul>
&lt;p>To create an annotated Git tag and attach it to our current (last) commit, we do:&lt;/p>
&lt;div class="highlight">&lt;pre class="chroma">&lt;code class="language-sh" data-lang="sh">git tag -a v1.2.0 -m &lt;span class="s2">&amp;#34;Clever release title&amp;#34;&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>This tags the commit on our local repository. To push all annotated tags to the remote, we do:&lt;/p>
&lt;div class="highlight">&lt;pre class="chroma">&lt;code class="language-sh" data-lang="sh">git push --follow-tags
&lt;/code>&lt;/pre>&lt;/div>&lt;p>We can also set our Git configuration to push our annotated tags by default:&lt;/p>
&lt;div class="highlight">&lt;pre class="chroma">&lt;code class="language-sh" data-lang="sh">git config --global push.followTags &lt;span class="nb">true&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>If we then want to skip pushing tags this time, we pass &lt;code>--no-follow-tags&lt;/code>.&lt;/p>
&lt;h2 id="practice-responsible-commits" class="anchor-link">&lt;a href="#practice-responsible-commits">Practice responsible commits&lt;/a>&lt;/h2>
&lt;p>A little time invested in getting familiar with these tools and practices can make your commits even more useful and well-crafted. With a little practice, these processes will become second nature. You can make it even easier by creating a personal commit checklist on paper to keep handy while you work - or if that isn&amp;rsquo;t fun enough, &lt;a href="https://victoria.dev/blog/an-automatic-interactive-pre-commit-checklist-in-the-style-of-infomercials/">make it an interactive pre-commit hook.&lt;/a>&lt;/p>
&lt;p>Creating clean, useful, and responsible Git commits says a lot about you. Especially in the current climate of remote work, Git commits may be a primary way that people interact with you over projects. With a little practice and effort, you can make your commit habits an even better reflection of your best work - work that is evidently created with care and pride.&lt;/p>
&lt;h2 id="reference-links" class="anchor-link">&lt;a href="#reference-links">Reference links&lt;/a>&lt;/h2>
&lt;p>&lt;a href="https://git-scm.com/book/en/v2/Git-Tools-Rewriting-History">Git Tools - Rewriting History&lt;/a>
&lt;a href="https://semver.org/">Semantic Versioning 2.0.0&lt;/a>
&lt;a href="https://git-scm.com/docs/git-describe">git-describe&lt;/a>
&lt;a href="https://git-scm.com/book/en/v2/Git-Tools-Signing-Your-Work">Git Tools - Signing Your Work&lt;/a>
&lt;a href="https://git-scm.com/book/en/v2/Customizing-Git-Git-Configuration">Customizing Git - Git Configuration&lt;/a>
&lt;a href="https://git-scm.com/book/en/v1/Git-Tools-Stashing">Git Tools - Stashing&lt;/a>
&lt;a href="https://git-scm.com/book/en/v2/Git-Basics-Tagging">Git Basics - Tagging&lt;/a>&lt;/p></content:encoded><enclosure url="https://victoria.dev/blog/git-commit-practices-your-future-self-will-thank-you-for/cover_git-commit-art_hu3c5d7a1ac69b5f3a44f90a6688078cc1_89530_640x0_resize_box_2.png" type="image/jpg"/></item><item><title>An automatic interactive pre-commit checklist, in the style of infomercials</title><link>https://victoria.dev/blog/an-automatic-interactive-pre-commit-checklist-in-the-style-of-infomercials/</link><pubDate>Mon, 23 Jul 2018 09:38:09 -0400</pubDate><author>hello@victoria.dev (Victoria Drake)</author><guid>https://victoria.dev/blog/an-automatic-interactive-pre-commit-checklist-in-the-style-of-infomercials/</guid><description>How to set up an interactive checklist using a Git pre-commit hook script.</description><content:encoded>
&lt;img src="https://victoria.dev/blog/an-automatic-interactive-pre-commit-checklist-in-the-style-of-infomercials/precommit-infomercial_hu3f89b2526dd77ee153311b13b3651634_84493_640x0_resize_box_2.png" width="640" height="320"/>
&lt;p>What&amp;rsquo;s that, you say? You&amp;rsquo;ve become tired of regular old boring &lt;em>paper checklists?&lt;/em> Well, my friend, today is your lucky day! You, yes, &lt;em>you,&lt;/em> can become the proud owner of a brand-spanking-new &lt;em>automatic interactive pre-commit hook checklist!&lt;/em> You&amp;rsquo;re gonna love this! Your life will be so much easier! Just wait until your friends see you.&lt;/p>
&lt;h2 id="whats-a-pre-commit-hook" class="anchor-link">&lt;a href="#whats-a-pre-commit-hook">What&amp;rsquo;s a pre-commit hook&lt;/a>&lt;/h2>
&lt;p>Did you know that nearly &lt;em>1 out of 5 coders&lt;/em> are too embarrassed to ask this question? Don&amp;rsquo;t worry, it&amp;rsquo;s perfectly normal. In the next 60 seconds we&amp;rsquo;ll tell you all you need to know to pre-commit with confidence.&lt;/p>
&lt;p>A &lt;a href="https://git-scm.com/book/en/v2/Customizing-Git-Git-Hooks">Git hook&lt;/a> is a feature of Git that triggers custom scripts at useful moments. They can be used for all kinds of reasons to help you automate your work, and best of all, you already have them! In every repository that you initialize with &lt;code>git init&lt;/code>, you&amp;rsquo;ll have a set of example scripts living in &lt;code>.git/hooks&lt;/code>. They all end with &lt;code>.sample&lt;/code> and activating them is as easy as renaming the file to remove the &lt;code>.sample&lt;/code> part.&lt;/p>
&lt;p>Git hooks are not copied when a repository is cloned, so you can make them as personal as you like.&lt;/p>
&lt;p>The useful moment in particular that we&amp;rsquo;ll talk about today is the &lt;em>pre-commit&lt;/em>. This hook is run after you do &lt;code>git commit&lt;/code>, and before you write a commit message. Exiting this hook with a non-zero status will abort the commit, which makes it extremely useful for last-minute quality checks. Or, a bit of fun. Why not both!&lt;/p>
&lt;h2 id="how-do-i-get-a-pre-commit-checklist" class="anchor-link">&lt;a href="#how-do-i-get-a-pre-commit-checklist">How do I get a pre-commit checklist&lt;/a>&lt;/h2>
&lt;p>I only want the best for my family and my commits, and that&amp;rsquo;s why I choose an interactive pre-commit checklist. Not only is it fun to use, it helps to keep my projects safe from unexpected off-spec mistakes!&lt;/p>
&lt;p>It&amp;rsquo;s so easy! I just write a bash script that can read user input, and plop it into &lt;code>.git/hooks&lt;/code> as a file named &lt;code>pre-commit&lt;/code>. Then I do &lt;code>chmod +x .git/hooks/pre-commit&lt;/code> to make it executable, and I&amp;rsquo;m done!&lt;/p>
&lt;p>Oh look, here comes an example bash script now!&lt;/p>
&lt;div class="highlight">&lt;pre class="chroma">&lt;code class="language-sh" data-lang="sh">&lt;span class="cp">#!/bin/sh
&lt;/span>&lt;span class="cp">&lt;/span>
&lt;span class="nb">echo&lt;/span> &lt;span class="s2">&amp;#34;Would you like to play a game?&amp;#34;&lt;/span>
&lt;span class="c1"># Read user input, assign stdin to keyboard&lt;/span>
&lt;span class="nb">exec&lt;/span> &amp;lt; /dev/tty
&lt;span class="k">while&lt;/span> &lt;span class="nb">read&lt;/span> -p &lt;span class="s2">&amp;#34;Have you double checked that only relevant files were added? (Y/n) &amp;#34;&lt;/span> yn&lt;span class="p">;&lt;/span> &lt;span class="k">do&lt;/span>
&lt;span class="k">case&lt;/span> &lt;span class="nv">$yn&lt;/span> in
&lt;span class="o">[&lt;/span>Yy&lt;span class="o">]&lt;/span> &lt;span class="o">)&lt;/span> break&lt;span class="p">;;&lt;/span>
&lt;span class="o">[&lt;/span>Nn&lt;span class="o">]&lt;/span> &lt;span class="o">)&lt;/span> &lt;span class="nb">echo&lt;/span> &lt;span class="s2">&amp;#34;Please ensure the right files were added!&amp;#34;&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="nb">exit&lt;/span> 1&lt;span class="p">;;&lt;/span>
* &lt;span class="o">)&lt;/span> &lt;span class="nb">echo&lt;/span> &lt;span class="s2">&amp;#34;Please answer y (yes) or n (no):&amp;#34;&lt;/span> &lt;span class="o">&amp;amp;&amp;amp;&lt;/span> &lt;span class="k">continue&lt;/span>&lt;span class="p">;&lt;/span>
&lt;span class="k">esac&lt;/span>
&lt;span class="k">done&lt;/span>
&lt;span class="k">while&lt;/span> &lt;span class="nb">read&lt;/span> -p &lt;span class="s2">&amp;#34;Has the documentation been updated? (Y/n) &amp;#34;&lt;/span> yn&lt;span class="p">;&lt;/span> &lt;span class="k">do&lt;/span>
&lt;span class="k">case&lt;/span> &lt;span class="nv">$yn&lt;/span> in
&lt;span class="o">[&lt;/span>Yy&lt;span class="o">]&lt;/span> &lt;span class="o">)&lt;/span> break&lt;span class="p">;;&lt;/span>
&lt;span class="o">[&lt;/span>Nn&lt;span class="o">]&lt;/span> &lt;span class="o">)&lt;/span> &lt;span class="nb">echo&lt;/span> &lt;span class="s2">&amp;#34;Please add or update the docs!&amp;#34;&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="nb">exit&lt;/span> 1&lt;span class="p">;;&lt;/span>
* &lt;span class="o">)&lt;/span> &lt;span class="nb">echo&lt;/span> &lt;span class="s2">&amp;#34;Please answer y (yes) or n (no):&amp;#34;&lt;/span> &lt;span class="o">&amp;amp;&amp;amp;&lt;/span> &lt;span class="k">continue&lt;/span>&lt;span class="p">;&lt;/span>
&lt;span class="k">esac&lt;/span>
&lt;span class="k">done&lt;/span>
&lt;span class="k">while&lt;/span> &lt;span class="nb">read&lt;/span> -p &lt;span class="s2">&amp;#34;Do you know which issue or PR numbers to reference? (Y/n) &amp;#34;&lt;/span> yn&lt;span class="p">;&lt;/span> &lt;span class="k">do&lt;/span>
&lt;span class="k">case&lt;/span> &lt;span class="nv">$yn&lt;/span> in
&lt;span class="o">[&lt;/span>Yy&lt;span class="o">]&lt;/span> &lt;span class="o">)&lt;/span> break&lt;span class="p">;;&lt;/span>
&lt;span class="o">[&lt;/span>Nn&lt;span class="o">]&lt;/span> &lt;span class="o">)&lt;/span> &lt;span class="nb">echo&lt;/span> &lt;span class="s2">&amp;#34;Better go check those tracking numbers!&amp;#34;&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="nb">exit&lt;/span> 1&lt;span class="p">;;&lt;/span>
* &lt;span class="o">)&lt;/span> &lt;span class="nb">echo&lt;/span> &lt;span class="s2">&amp;#34;Please answer y (yes) or n (no):&amp;#34;&lt;/span> &lt;span class="o">&amp;amp;&amp;amp;&lt;/span> &lt;span class="k">continue&lt;/span>&lt;span class="p">;&lt;/span>
&lt;span class="k">esac&lt;/span>
&lt;span class="k">done&lt;/span>
&lt;span class="nb">exec&lt;/span> &amp;lt;&lt;span class="p">&amp;amp;&lt;/span>-
&lt;/code>&lt;/pre>&lt;/div>
&lt;h2 id="take-my-money" class="anchor-link">&lt;a href="#take-my-money">Take my money&lt;/a>&lt;/h2>
&lt;p>Don&amp;rsquo;t delay! Take advantage &lt;em>right now&lt;/em> of this generous &lt;em>one-time offer!&lt;/em> An interactive pre-commit hook checklist can be yours, today, for the low, low price of&amp;hellip; free? Wait, who wrote this script?&lt;/p></content:encoded><enclosure url="https://victoria.dev/blog/an-automatic-interactive-pre-commit-checklist-in-the-style-of-infomercials/precommit-infomercial_hu3f89b2526dd77ee153311b13b3651634_84493_640x0_resize_box_2.png" type="image/jpg"/></item><item><title>How to set up a short feedback loop as a solo coder</title><link>https://victoria.dev/blog/how-to-set-up-a-short-feedback-loop-as-a-solo-coder/</link><pubDate>Mon, 02 Jul 2018 10:08:41 -0400</pubDate><author>hello@victoria.dev (Victoria Drake)</author><guid>https://victoria.dev/blog/how-to-set-up-a-short-feedback-loop-as-a-solo-coder/</guid><description>Strategies for continuous improvement when you're a freelance developer.</description><content:encoded>
&lt;img src="https://victoria.dev/blog/how-to-set-up-a-short-feedback-loop-as-a-solo-coder/cover_feedback-pbjreview_hu8e37b70b3728865778c1f4fe4adf7fff_53513_640x0_resize_box_2.png" width="640" height="288"/>
&lt;p>I&amp;rsquo;ve spent the last couple years as a solo freelance developer. Comparing this experience to previously working in companies, I&amp;rsquo;ve noticed that those of us who work alone can have fewer iterative opportunities for improvement than developers who work on teams. Integral to having opportunities to improve is the concept of a short feedback loop: a process of incorporating new learning from observation and previous experience continuously over a short period of time. This process has to be &lt;em>manufactured&lt;/em> by people working mostly alone, instead of, as is often the case, &lt;em>adopted&lt;/em> when you join a team.&lt;/p>
&lt;p>In this post I hope to share what I&amp;rsquo;ve learned about setting yourself up to improve quickly and continuously as a solo coder.&lt;/p>
&lt;h2 id="about-feedback-loops" class="anchor-link">&lt;a href="#about-feedback-loops">About feedback loops&lt;/a>&lt;/h2>
&lt;p>United States Air Force Colonel John Boyd developed the concept of the &lt;a href="https://en.wikipedia.org/wiki/OODA_loop">OODA loop&lt;/a>, OODA being an acronym for &lt;em>observe, orient, decide, act&lt;/em>. In military operations, this illustrates a process of decision-making based on the constant ingestion of new information:&lt;/p>
&lt;p>&lt;strong>Observe:&lt;/strong> Obtain raw information about unfolding circumstances and the current environment.
&lt;strong>Orient:&lt;/strong> Put raw observations in context. Consider such things as relevancy to the current situation and previously gained knowledge and expertise.
&lt;strong>Decide:&lt;/strong> Make a plan for moving towards your goal.
&lt;strong>Act:&lt;/strong> Execute the plan.&lt;/p>
&lt;p>Since it&amp;rsquo;s a loop, the &lt;em>act&lt;/em> stage leads directly back into the &lt;em>observe&lt;/em> stage. This is the critical &amp;ldquo;feed back&amp;rdquo; concept that enables increasingly successful iterations. It&amp;rsquo;s widely applicable beyond military operations - you may recognize it as the origin of the &lt;a href="https://en.wikipedia.org/wiki/PDCA">PDCA&lt;/a> (plan-do-check-act) method.&lt;/p>
&lt;p>I like the OODA loop for being a succinct illustration of a general feedback loop. Many concepts and working methods build on the idea of feedback loops, including &lt;a href="https://en.wikipedia.org/wiki/DevOps">DevOps&lt;/a> and &lt;a href="https://en.wikipedia.org/wiki/Agile_software_development">Agile software development&lt;/a> methods.&lt;/p>
&lt;h3 id="development-team-feedback-loop" class="anchor-link">&lt;a href="#development-team-feedback-loop">Development team feedback loop&lt;/a>&lt;/h3>
&lt;p>Let&amp;rsquo;s look at what some components of a feedback loop for a developer on a team might look like:&lt;/p>
&lt;ol>
&lt;li>Direction from product owners or reviews from users&lt;/li>
&lt;li>Daily scrum/standup with whole team&lt;/li>
&lt;li>Prioritization with developer team&lt;/li>
&lt;li>Individual coding and testing&lt;/li>
&lt;li>Peer code review&lt;/li>
&lt;li>Deployment and performance monitoring&lt;/li>
&lt;/ol>
&lt;p>Implicit in these steps is the support of co-workers and management - in other words, someone to answer to. How can a solo freelance developer create a similar environment of accountability?&lt;/p>
&lt;h3 id="solo-developer-feedback-loop" class="anchor-link">&lt;a href="#solo-developer-feedback-loop">Solo developer feedback loop&lt;/a>&lt;/h3>
&lt;p>Here are some possible steps that an individual freelance developer can implement to create a short feedback loop:&lt;/p>
&lt;ol>
&lt;li>Build discipline&lt;/li>
&lt;li>Clarify concrete top-level goals&lt;/li>
&lt;li>Prioritize and plan mid-level and low-level goals&lt;/li>
&lt;li>Automate your work&lt;/li>
&lt;li>Block out time for code review&lt;/li>
&lt;li>Block out time for process review&lt;/li>
&lt;li>Update your goals and processes with the results of your reviews&lt;/li>
&lt;/ol>
&lt;p>I&amp;rsquo;ll cover each of these stages in detail below.&lt;/p>
&lt;h2 id="build-discipline" class="anchor-link">&lt;a href="#build-discipline">Build discipline&lt;/a>&lt;/h2>
&lt;p>More of a prerequisite than a stage in itself, building discipline is what enables our short feedback loop to work. Nothing else in this article will be helpful unless we have the skill to do something we don&amp;rsquo;t want to do. Discipline is most certainly a skill. It can be learned, trained, and improved just like any other.&lt;/p>
&lt;p>Why is discipline so important? Because when we&amp;rsquo;re crunching to get a project completed this Friday evening, we&amp;rsquo;re not going to want to write a good commit message. We&amp;rsquo;re not going to want to clean up the code comments. We just want to see the darn thing go, &lt;em>Hello, git push -f&lt;/em>. It&amp;rsquo;s in those moments that discipline enables us to not miss an opportunity to practice, learn, and improve our work process. Discipline helps us avoid Friday night commits that turn into Monday morning &lt;code>git reset --hard&lt;/code>s.&lt;/p>
&lt;h2 id="clarify-concrete-top-level-goals" class="anchor-link">&lt;a href="#clarify-concrete-top-level-goals">Clarify concrete top-level goals&lt;/a>&lt;/h2>
&lt;p>
&lt;img src="https://victoria.dev/blog/how-to-set-up-a-short-feedback-loop-as-a-solo-coder/feedback-topgoal.png" alt="Envisioning a peanut butter and jelly sandwich" />
&lt;/p>
&lt;p>Whether working for a client or bootstrapping our own best-new-app-ever, we won&amp;rsquo;t be able to measure any progress or improvements without something to measure them against.&lt;/p>
&lt;p>When I&amp;rsquo;m discussing a new project with a client, I always speak in terms of concrete achievements. This could take the form of accomplishing a specific feature by a certain date, or deciding what the MVP looks like to a user. This is as much to my benefit as my client&amp;rsquo;s. By agreeing, in writing, &lt;em>what&lt;/em> will be achieved and &lt;em>when&lt;/em>, my client and I have clearly defined top-level goals and can both assess how the project is progressing. When I&amp;rsquo;m working for myself, I treat myself as I would a client. I make a commitment, in writing, describing what will be achieved, and when. This can be something as simple as a goals list for the week, or as detailed as a kanban board.&lt;/p>
&lt;p>The point of having a concrete goal, however, is not to stick to it at all costs. It&amp;rsquo;s important to set an expectation, with ourselves and with our clients, that the goals will be revisited at mutually-agreeable dates over the course of the project. This enables the all-important &amp;ldquo;feed back&amp;rdquo; part of the loop.&lt;/p>
&lt;h2 id="prioritize-and-plan-mid-level-and-low-level-goals" class="anchor-link">&lt;a href="#prioritize-and-plan-mid-level-and-low-level-goals">Prioritize and plan mid-level and low-level goals&lt;/a>&lt;/h2>
&lt;p>
&lt;img src="https://victoria.dev/blog/how-to-set-up-a-short-feedback-loop-as-a-solo-coder/feedback-stepgoals.png" alt="The components of a peanut butter and jelly sandwich" />
&lt;/p>
&lt;p>Few goals are achieved all in one step. Even the simple process of making a peanut butter and jelly sandwich (a favourite computer programming &lt;a href="https://www.youtube.com/watch?v=y62zj9ozPOM&amp;amp;t=1016s">teaching example&lt;/a>) can be broken down into successively smaller, more precise instructions. While we humans may not require the granularity that a computer program does, goals that are chunked into time-boxed, achievable steps are much more easily digested. &lt;/p>
&lt;p>Start with the mid-level goals, and make each step concrete. If the goal is to release a new open source web app, for example, the steps might look like this:&lt;/p>
&lt;ol>
&lt;li>Complete app JavaScript&lt;/li>
&lt;li>Create front end and stylesheet&lt;/li>
&lt;li>Do local tests&lt;/li>
&lt;li>Set up cloud server&lt;/li>
&lt;li>Deploy app to cloud&lt;/li>
&lt;li>Do tests&lt;/li>
&lt;li>Add repository to GitHub&lt;/li>
&lt;li>Post on Hacker News&lt;/li>
&lt;li>Profit!!!&lt;/li>
&lt;/ol>
&lt;p>Each of the above examples encapsulates many smaller, low-level goals - we can think of these as our to-do list items. For example, &amp;ldquo;Set up cloud server&amp;rdquo; might involve:&lt;/p>
&lt;ol>
&lt;li>Research cloud providers&lt;/li>
&lt;li>Decide on service and sign up&lt;/li>
&lt;li>Set up server/instance&lt;/li>
&lt;li>Add integrations&lt;/li>
&lt;li>Test deployment&lt;/li>
&lt;/ol>
&lt;p>Our parameters for chunk sizes and what constitutes a &amp;ldquo;step&amp;rdquo; may be different from one another, and will likely change from project to project. If your mid-level and low-level steps clearly define a concrete path for achieving the top-level goals you set, then you&amp;rsquo;re in good shape. Later on, evaluating the decision process that brought us to these mid-level and low-level goals enables us to bring our feedback loop full circle.&lt;/p>
&lt;h2 id="automate-your-work" class="anchor-link">&lt;a href="#automate-your-work">Automate your work&lt;/a>&lt;/h2>
&lt;p>
&lt;img src="https://victoria.dev/blog/how-to-set-up-a-short-feedback-loop-as-a-solo-coder/feedback-autorobot.png" alt="Peanut butter and jelly sandwich robot" />
&lt;/p>
&lt;p>I recently read a great article entitled &lt;a href="https://queue.acm.org/detail.cfm?id=3197520">Manual Work is a Bug&lt;/a>. It discusses a process by which successful developers document and eventually automate their work. The beauty of this idea is in its simplicity. By writing down the things we do manually, we&amp;rsquo;re able to correct and refine our processes. By refining our processes, we can more easily translate them into code snippets and scripts. With a collection of scripts that we can string together, we can automate our work.&lt;/p>
&lt;p>Automating work isn&amp;rsquo;t only about saving time. It reduces haven&amp;rsquo;t-had-my-coffee-yet errors, minimizes cognitive load allowing more room for creativity, and allows our processes to be repeatable across collaborators and projects. It help shorten our feedback loop by ensuring we aren&amp;rsquo;t doing the same thing three times in three different ways.&lt;/p>
&lt;p>We can begin to automate by starting our own personal wiki. If we build a habit of writing down every manual thing we do, no matter how basic it may seem at the time, we give ourselves more opportunities to spot patterns, and thus possible integrations and improvements.&lt;/p>
&lt;p>The first time we do something manually, we write out the steps. The second time, we follow the steps. This gives us the opportunity to correct and refine them based on what we&amp;rsquo;ve learned since the first time. Over successive iterations, we might replace parts of manual commands with variables; we might find handy snippets of bash scripts that automate just a part of our task. As long as we keep revising and improving our personal wiki, we&amp;rsquo;re moving towards automation.&lt;/p>
&lt;h2 id="block-out-time-for-code-review" class="anchor-link">&lt;a href="#block-out-time-for-code-review">Block out time for code review&lt;/a>&lt;/h2>
&lt;p>
&lt;img src="https://victoria.dev/blog/how-to-set-up-a-short-feedback-loop-as-a-solo-coder/cover_feedback-pbjreview.png" alt="Reviewing a peanut butter and jelly sandwich with a clipboard" />
&lt;/p>
&lt;p>It&amp;rsquo;s all too easy to commit messy code when we work alone. We think, &lt;em>who&amp;rsquo;s going to see it? I&amp;rsquo;ll fix it later.&lt;/em> Each time that happens, though, we&amp;rsquo;re building a habit. It&amp;rsquo;s a bad one.&lt;/p>
&lt;p>Working alone means there&amp;rsquo;s no one likely to give feedback on our commits when we&amp;rsquo;re doing something that doesn&amp;rsquo;t make sense, or that could be improved. Instead, we have to actively seek out opportunities to improve. Open source communities are amazing for this. There&amp;rsquo;s a wealth of information available to us in terms of coding styles, examples of refactored code, and a smorgasbord of snippets that achieve that-thing-we-were-trying-to-do but in fewer lines. We can learn all we please, if we just block out the time to do it.&lt;/p>
&lt;p>Schedule your own code review at a time that makes sense for you and the project you&amp;rsquo;re working on. This might be each time you finish a fix or feature, or at regular intervals daily or weekly. If you have someone who can help, book them. There are also &lt;a href="https://victoria.dev/blog/top-free-resources-for-developing-coding-superpowers/">chatrooms full of people&lt;/a> happy to lend a hand.&lt;/p>
&lt;p>Do some research on basic best practices for what you&amp;rsquo;re working on. Set yourself a time limit though, and take what you read with a grain of salt. There&amp;rsquo;s a lot of rabbit holes in that field. As a starting point, I&amp;rsquo;d recommend learning about DRY code, and watching &lt;a href="https://www.youtube.com/watch?v=p0O1VVqRSK0&amp;amp;feature=youtu.be&amp;amp;t=330">Uncle Bob demand professionalism in software development&lt;/a>.&lt;/p>
&lt;h3 id="code-review-checklist" class="anchor-link">&lt;a href="#code-review-checklist">Code review checklist&lt;/a>&lt;/h3>
&lt;p>Here&amp;rsquo;s my personal code review checklist, based off some general best practices. Feel free to use it as a starting point for your own!&lt;/p>
&lt;blockquote>
&lt;p>&lt;strong>Victoria&amp;rsquo;s Code Review Extravaganza!&lt;/strong>&lt;/p>
&lt;ul>
&lt;li>&lt;input disabled="" type="checkbox"> This solves a high-priority item.&lt;/li>
&lt;li>&lt;input disabled="" type="checkbox"> This is a complete implementation that follows the specification.&lt;/li>
&lt;li>&lt;input disabled="" type="checkbox"> Off-topic changes were not included and have been added to backlog.&lt;/li>
&lt;li>&lt;input disabled="" type="checkbox"> Variable names are meaningful and there are no magic numbers.&lt;/li>
&lt;li>&lt;input disabled="" type="checkbox"> Correct and useful error messages are returned at every opportunity.&lt;/li>
&lt;li>&lt;input disabled="" type="checkbox"> No debugging print statements were left in.&lt;/li>
&lt;li>&lt;input disabled="" type="checkbox"> This code is DRY and modular.&lt;/li>
&lt;li>&lt;input disabled="" type="checkbox"> This code is secure. Private and public code are well separated.&lt;/li>
&lt;li>&lt;input disabled="" type="checkbox"> This code is its own documentation, or the documentation is up to date.&lt;/li>
&lt;li>&lt;input disabled="" type="checkbox"> A five-year-old could follow this, seriously it&amp;rsquo;s that readable.&lt;/li>
&lt;li>&lt;input disabled="" type="checkbox"> Unit tests successfully pass.&lt;/li>
&lt;li>&lt;input disabled="" type="checkbox"> Master was merged into the branch and tested.&lt;/li>
&lt;li>&lt;input disabled="" type="checkbox"> Formatting follows style guidelines.&lt;/li>
&lt;li>&lt;input disabled="" type="checkbox"> I cannot find any further edge cases or known defects.&lt;/li>
&lt;li>&lt;input disabled="" type="checkbox"> I would be happy if this code was publicly attributed to me.&lt;/li>
&lt;li>&lt;input disabled="" type="checkbox"> I fully understand what the code does and the impact of the changes I made.&lt;/li>
&lt;li>&lt;input disabled="" type="checkbox"> I actually verified that it actually does what I said it does.&lt;/li>
&lt;/ul>
&lt;/blockquote>
&lt;p>&lt;a href="https://dev.to/gonedark/writing-clean-code">Here is an excellent example&lt;/a> of cleaning up code with some of the above points in mind.&lt;/p>
&lt;h2 id="block-out-time-for-process-review" class="anchor-link">&lt;a href="#block-out-time-for-process-review">Block out time for process review&lt;/a>&lt;/h2>
&lt;p>
&lt;img src="https://victoria.dev/blog/how-to-set-up-a-short-feedback-loop-as-a-solo-coder/feedback-robotreview.png" alt="Reviewing sandwich making robot with clipboard" />
&lt;/p>
&lt;p>Just as we learn from reviewing our code, we refine our processes by reviewing them as well. Process review is most beneficial when visited at regular intervals throughout the project, not just after the project&amp;rsquo;s completion. For short-term projects, a good starting point for scheduling process reviews is at each half-mark - once midway through, and again after completion. Long-term projects may have reviews at each quarter-mark.&lt;/p>
&lt;h3 id="process-review-questions" class="anchor-link">&lt;a href="#process-review-questions">Process review questions&lt;/a>&lt;/h3>
&lt;p>Process review can be as simple as a short list of questions:&lt;/p>
&lt;ol>
&lt;li>What were my top-level goals for this period? Did I meet them?&lt;/li>
&lt;li>What were my mid-level and low-level goals for this period? Did I meet them?&lt;/li>
&lt;li>Would I have been better served with different or more specific goals? Why?&lt;/li>
&lt;li>Did I successfully remove or automate obstacles?&lt;/li>
&lt;li>Did I stick to my code review schedule? Why or why not?&lt;/li>
&lt;li>How might I remove obstacles next time?&lt;/li>
&lt;/ol>
&lt;p>Setting aside dedicated time for our process review can help us to answer questions like these thoughtfully and honestly. This allows us to squeeze out every bit of learning we can from our review, helping to shorten our feedback loop.&lt;/p>
&lt;h2 id="update-your-goals-and-processes-with-the-results-of-your-reviews" class="anchor-link">&lt;a href="#update-your-goals-and-processes-with-the-results-of-your-reviews">Update your goals and processes with the results of your reviews&lt;/a>&lt;/h2>
&lt;p>
&lt;img src="https://victoria.dev/blog/how-to-set-up-a-short-feedback-loop-as-a-solo-coder/feedback-updategoals.png" alt="Adding additional arms to robot while envisioning a multi-layer PB&amp;amp;amp;J" />
&lt;/p>
&lt;p>All the performance data in the world is no good to us if we don&amp;rsquo;t put it into practice. With each successive code review, we can refine and add to our checklist. With what we learn from each process review, we can fine tune and improve our processes. The more we can invent concrete and observable ways to implement our learning, the more success we&amp;rsquo;ll have.&lt;/p>
&lt;p>Making a conscious effort to utilize and practice the things we&amp;rsquo;ve learned is the final, vital, component of our feedback loop. The more often we incorporate new learning, the shorter our loop becomes, allowing us to improve that much faster.&lt;/p></content:encoded><enclosure url="https://victoria.dev/blog/how-to-set-up-a-short-feedback-loop-as-a-solo-coder/cover_feedback-pbjreview_hu8e37b70b3728865778c1f4fe4adf7fff_53513_640x0_resize_box_2.png" type="image/jpg"/></item><item><title>Adorable bookmarklets want to help delete your social media data</title><link>https://victoria.dev/blog/adorable-bookmarklets-want-to-help-delete-your-social-media-data/</link><pubDate>Thu, 14 Jun 2018 13:12:02 -0400</pubDate><author>hello@victoria.dev (Victoria Drake)</author><guid>https://victoria.dev/blog/adorable-bookmarklets-want-to-help-delete-your-social-media-data/</guid><description>Bookmarklets you can use in your browser to help clean up your social media data.</description><content:encoded>
&lt;img src="https://victoria.dev/blog/adorable-bookmarklets-want-to-help-delete-your-social-media-data/cover_bookmarklet-card_huf77dc50c841330e47b423811f322d666_99199_640x0_resize_box_2.png" width="640" height="320"/>
&lt;p>A little while ago I wrote about &lt;a href="https://victoria.dev/blog/why-im-automatically-deleting-my-old-tweets-using-aws-lambda/">a Lambda function I called ephemeral&lt;/a> for deleting my old tweets. While it&amp;rsquo;s a great project for someone familiar with or wanting to learn to use Lambda, it isn&amp;rsquo;t simple for a non-technical person to set up. There are services out there that will delete your tweets for you, but require your access credentials. There didn&amp;rsquo;t seem to be anything that provided convenience without also requiring authentication.&lt;/p>
&lt;p>So, I went oldschool and created the ephemeral bookmarklet.&lt;/p>
&lt;p>If that didn&amp;rsquo;t make you instantly nostalgic, a &lt;a href="https://en.wikipedia.org/wiki/Bookmarklet">bookmarklet&lt;/a> is a little application that lives as a bookmark in your web browser. You &amp;ldquo;install&amp;rdquo; it by dragging the link to your bookmarks toolbar, or right-clicking on the link and choosing &amp;ldquo;Bookmark this link&amp;rdquo; (Firefox). You click it to execute the program on the current page.&lt;/p>
&lt;p>Here&amp;rsquo;s what the ephemeral bookmarklet will do:&lt;/p>
&lt;video width="600px" controls="controls" poster="bookmarklet-card.png">
&lt;source src="ephemeralbookmarklet.mp4" type="video/mp4" />
&lt;/video>
&lt;p>The ephemeral bookmarklet is part of a new suite of tools for personal data management that I&amp;rsquo;m co-creating with Adam Drake. You can &lt;a href="https://adamdrake.github.io/pdmtools/">get all the bookmarklets on this page&lt;/a>, and they&amp;rsquo;re also open source &lt;a href="https://github.com/adamdrake/pdmtools">on GitHub&lt;/a>.&lt;/p>
&lt;p>There are currently bookmarklets for managing your data on LinkedIn and Twitter. We&amp;rsquo;re looking for testers and contributors to help make this a comprehensive toolset for your social media data management. If you write code, I invite you to contribute and help this toolset grow.&lt;/p>
&lt;p>{} &amp;ndash; Bookmarklet says hi!&lt;/p></content:encoded><enclosure url="https://victoria.dev/blog/adorable-bookmarklets-want-to-help-delete-your-social-media-data/cover_bookmarklet-card_huf77dc50c841330e47b423811f322d666_99199_640x0_resize_box_2.png" type="image/jpg"/></item><item><title>A coffee-break introduction to time complexity of algorithms</title><link>https://victoria.dev/blog/a-coffee-break-introduction-to-time-complexity-of-algorithms/</link><pubDate>Wed, 30 May 2018 14:08:28 -0400</pubDate><author>hello@victoria.dev (Victoria Drake)</author><guid>https://victoria.dev/blog/a-coffee-break-introduction-to-time-complexity-of-algorithms/</guid><description>A groundwork understanding of algorithm time complexity in about fifteen minutes.</description><content:encoded>
&lt;img src="https://victoria.dev/blog/a-coffee-break-introduction-to-time-complexity-of-algorithms/cover_wibbly_hu64a4c7ed5bb41a17b8b90ed2af9d238b_2572713_640x0_resize_box_2.png" width="640" height="320"/>
&lt;p>Just like writing your very first &lt;code>for&lt;/code> loop, understanding time complexity is an integral milestone to learning how to write efficient complex programs. Think of it as having a superpower that allows you to know exactly what type of program might be the most efficient in a particular situation - before even running a single line of code.&lt;/p>
&lt;p>The fundamental concepts of complexity analysis are well worth studying. You&amp;rsquo;ll be able to better understand how the code you&amp;rsquo;re writing will interact with the program&amp;rsquo;s input, and as a result, you&amp;rsquo;ll spend a lot less wasted time writing slow and problematic code. It won&amp;rsquo;t take long to go over all you need to know in order to start writing more efficient programs - in fact, we can do it in about fifteen minutes. You can go grab a coffee right now (or tea, if that&amp;rsquo;s your thing) and I&amp;rsquo;ll take you through it before your coffee break is over. Go ahead, I&amp;rsquo;ll wait.&lt;/p>
&lt;p>All set? Let&amp;rsquo;s do it!&lt;/p>
&lt;h2 id="what-is-time-complexity-anyway" class="anchor-link">&lt;a href="#what-is-time-complexity-anyway">What is &amp;ldquo;time complexity&amp;rdquo; anyway&lt;/a>&lt;/h2>
&lt;p>The time complexity of an algorithm is an &lt;strong>approximation&lt;/strong> of how long that algorithm will take to process some input. It describes the efficiency of the algorithm by the magnitude of its operations. This is different than the number of times an operation repeats; I&amp;rsquo;ll expand on that later. Generally, the fewer operations the algorithm has, the faster it will be.&lt;/p>
&lt;p>We write about time complexity using &lt;a href="https://en.wikipedia.org/wiki/Big_O_notation">Big O notation&lt;/a>, which looks something like &lt;em>O&lt;/em>(&lt;em>n&lt;/em>). There&amp;rsquo;s rather a lot of math involved in its formal definition, but informally we can say that Big O notation gives us our algorithm&amp;rsquo;s approximate run time in the &lt;strong>worst case&lt;/strong>, or in other words, its upper bound.&lt;sup>[&lt;a href="#sources">2&lt;/a>]&lt;/sup> It is inherently relative and comparative.&lt;sup>[&lt;a href="#sources">3&lt;/a>]&lt;/sup> We&amp;rsquo;re describing the algorithm&amp;rsquo;s efficiency relative to the increasing size of its input data, &lt;em>n&lt;/em>. If the input is a string, then &lt;em>n&lt;/em> is the length of the string. If it&amp;rsquo;s a list of integers, &lt;em>n&lt;/em> is the length of the list.&lt;/p>
&lt;p>It&amp;rsquo;s easiest to picture what Big O notation represents with a graph:&lt;/p>
&lt;figure class="screenshot">
&lt;img src="graph.png"
alt="A graph showing different classes of time complexity"/> &lt;figcaption>
&lt;p>Lines made with the very excellent Desmos graph calculator. You can &lt;a href="https://www.desmos.com/calculator/xpfyjl1lbn">play with this graph here&lt;/a>.&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;p>Here are the main important points to remember as you read the rest of this article:&lt;/p>
&lt;ul>
&lt;li>Time complexity is an approximation&lt;/li>
&lt;li>An algorithm&amp;rsquo;s time complexity approximates its worst case run time&lt;/li>
&lt;/ul>
&lt;h2 id="determining-time-complexity" class="anchor-link">&lt;a href="#determining-time-complexity">Determining time complexity&lt;/a>&lt;/h2>
&lt;p>There are different classes of complexity that we can use to quickly understand an algorithm. I&amp;rsquo;ll illustrate some of these classes using nested loops and other examples.&lt;/p>
&lt;h2 id="polynomial-time-complexity" class="anchor-link">&lt;a href="#polynomial-time-complexity">Polynomial time complexity&lt;/a>&lt;/h2>
&lt;p>A &lt;strong>polynomial&lt;/strong>, from the Greek &lt;em>poly&lt;/em> meaning &amp;ldquo;many,&amp;rdquo; and Latin &lt;em>nomen&lt;/em> meaning &amp;ldquo;name,&amp;rdquo; describes an expression comprised of constant variables, and addition, multiplication, and exponentiation to a non-negative integer power.&lt;sup>[&lt;a href="#sources">4&lt;/a>]&lt;/sup> That&amp;rsquo;s a super math-y way to say that it contains variables usually denoted by letters, and symbols that look like these:&lt;/p>
&lt;p>
&lt;img src="https://victoria.dev/blog/a-coffee-break-introduction-to-time-complexity-of-algorithms/polynomial.png" alt="A polynomial example" />
&lt;/p>
&lt;p>The below classes describe polynomial algorithms. Some have food examples.&lt;/p>
&lt;h3 id="constant" class="anchor-link">&lt;a href="#constant">Constant&lt;/a>&lt;/h3>
&lt;p>A &lt;strong>constant time&lt;/strong> algorithm doesn&amp;rsquo;t change its running time in response to the input data. No matter the size of the data it receives, the algorithm takes the same amount of time to run. We denote this as a time complexity of &lt;em>O&lt;/em>(1).&lt;/p>
&lt;figure class="screenshot">
&lt;img src="graph%281%29.png"
alt="A graph showing constant time complexity."/>
&lt;/figure>
&lt;p>Here&amp;rsquo;s one example of a constant algorithm that takes the first item in a slice.&lt;/p>
&lt;div class="highlight">&lt;pre class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="kd">func&lt;/span> &lt;span class="nf">takeCupcake&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">cupcakes&lt;/span> &lt;span class="p">[]&lt;/span>&lt;span class="kt">int&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="kt">int&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="k">return&lt;/span> &lt;span class="nx">cupcakes&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="mi">0&lt;/span>&lt;span class="p">]&lt;/span>
&lt;span class="p">}&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;figure>
&lt;img src="cupcakes.png"
alt="Types of cupcakes"/> &lt;figcaption>
&lt;p>Choice of flavours are: vanilla cupcake, strawberry cupcake, mint chocolate cupcake, lemon cupcake, and wibbly wobbly, timey wimey cupcake.&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;p>With this constant-time algorithm, no matter how many cupcakes are on offer, you just get the first one. Oh well. Flavours are overrated anyway.&lt;/p>
&lt;h3 id="linear" class="anchor-link">&lt;a href="#linear">Linear&lt;/a>&lt;/h3>
&lt;p>The running duration of a &lt;strong>linear&lt;/strong> algorithm is constant. It will process the input in &lt;em>n&lt;/em> number of operations. This is often the best possible (most efficient) case for time complexity where all the data must be examined.&lt;/p>
&lt;figure class="screenshot">
&lt;img src="graph%28n%29.png"
alt="A graph showing linear time complexity."/>
&lt;/figure>
&lt;p>Here&amp;rsquo;s an example of code with time complexity of &lt;em>O&lt;/em>(&lt;em>n&lt;/em>):&lt;/p>
&lt;div class="highlight">&lt;pre class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="kd">func&lt;/span> &lt;span class="nf">eatChips&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">bowlOfChips&lt;/span> &lt;span class="kt">int&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="k">for&lt;/span> &lt;span class="nx">chip&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="nx">chip&lt;/span> &lt;span class="o">&amp;lt;=&lt;/span> &lt;span class="nx">bowlOfChips&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="nx">chip&lt;/span>&lt;span class="o">++&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="c1">// dip chip
&lt;/span>&lt;span class="c1">&lt;/span> &lt;span class="p">}&lt;/span>
&lt;span class="p">}&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>Here&amp;rsquo;s another example of code with time complexity of &lt;em>O&lt;/em>(&lt;em>n&lt;/em>):&lt;/p>
&lt;div class="highlight">&lt;pre class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="kd">func&lt;/span> &lt;span class="nf">eatChips&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">bowlOfChips&lt;/span> &lt;span class="kt">int&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="k">for&lt;/span> &lt;span class="nx">chip&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="nx">chip&lt;/span> &lt;span class="o">&amp;lt;=&lt;/span> &lt;span class="nx">bowlOfChips&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="nx">chip&lt;/span>&lt;span class="o">++&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="c1">// double dip chip
&lt;/span>&lt;span class="c1">&lt;/span> &lt;span class="p">}&lt;/span>
&lt;span class="p">}&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>It doesn&amp;rsquo;t matter whether the code inside the loop executes once, twice, or any number of times. Both these loops process the input by a constant factor of &lt;em>n&lt;/em>, and thus can be described as linear.&lt;/p>
&lt;figure>
&lt;img src="dip.png"
alt="Lifeguard MIQ the chip says no double dipping"/> &lt;figcaption>
&lt;p>Don&amp;rsquo;t double dip in a shared bowl.&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;h3 id="quadratic" class="anchor-link">&lt;a href="#quadratic">Quadratic&lt;/a>&lt;/h3>
&lt;figure class="screenshot">
&lt;img src="graph%28n2%29.png"
alt="A graph showing quadratic time complexity"/>
&lt;/figure>
&lt;p>Now here&amp;rsquo;s an example of code with time complexity of &lt;em>O&lt;/em>(&lt;em>n&lt;/em>&lt;sup>2&lt;/sup>):&lt;/p>
&lt;div class="highlight">&lt;pre class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="kd">func&lt;/span> &lt;span class="nf">pizzaDelivery&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">pizzas&lt;/span> &lt;span class="kt">int&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="k">for&lt;/span> &lt;span class="nx">pizza&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="nx">pizza&lt;/span> &lt;span class="o">&amp;lt;=&lt;/span> &lt;span class="nx">pizzas&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="nx">pizza&lt;/span>&lt;span class="o">++&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="c1">// slice pizza
&lt;/span>&lt;span class="c1">&lt;/span> &lt;span class="k">for&lt;/span> &lt;span class="nx">slice&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="nx">slice&lt;/span> &lt;span class="o">&amp;lt;=&lt;/span> &lt;span class="nx">pizza&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="nx">slice&lt;/span>&lt;span class="o">++&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="c1">// eat slice of pizza
&lt;/span>&lt;span class="c1">&lt;/span> &lt;span class="p">}&lt;/span>
&lt;span class="p">}&lt;/span>
&lt;span class="p">}&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>Because there are two nested loops, or nested linear operations, the algorithm process the input &lt;em>n&lt;/em>&lt;sup>2&lt;/sup> times.&lt;/p>
&lt;h3 id="cubic" class="anchor-link">&lt;a href="#cubic">Cubic&lt;/a>&lt;/h3>
&lt;figure class="screenshot">
&lt;img src="graph%28n3%29.png"
alt="A graph showing cubic time complexity"/>
&lt;/figure>
&lt;p>Extending on the previous example, this code with three nested loops has time complexity of &lt;em>O&lt;/em>(&lt;em>n&lt;/em>&lt;sup>3&lt;/sup>):&lt;/p>
&lt;div class="highlight">&lt;pre class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="kd">func&lt;/span> &lt;span class="nf">pizzaDelivery&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">boxesDelivered&lt;/span> &lt;span class="kt">int&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="k">for&lt;/span> &lt;span class="nx">pizzaBox&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="nx">pizzaBox&lt;/span> &lt;span class="o">&amp;lt;=&lt;/span> &lt;span class="nx">boxesDelivered&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="nx">pizzaBox&lt;/span>&lt;span class="o">++&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="c1">// open box
&lt;/span>&lt;span class="c1">&lt;/span> &lt;span class="k">for&lt;/span> &lt;span class="nx">pizza&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="nx">pizza&lt;/span> &lt;span class="o">&amp;lt;=&lt;/span> &lt;span class="nx">pizzaBox&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="nx">pizza&lt;/span>&lt;span class="o">++&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="c1">// slice pizza
&lt;/span>&lt;span class="c1">&lt;/span> &lt;span class="k">for&lt;/span> &lt;span class="nx">slice&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="nx">slice&lt;/span> &lt;span class="o">&amp;lt;=&lt;/span> &lt;span class="nx">pizza&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="nx">slice&lt;/span>&lt;span class="o">++&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="c1">// eat slice of pizza
&lt;/span>&lt;span class="c1">&lt;/span> &lt;span class="p">}&lt;/span>
&lt;span class="p">}&lt;/span>
&lt;span class="p">}&lt;/span>
&lt;span class="p">}&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;figure>
&lt;img src="unsliced.png"
alt="A pizza pie in a box with a pizza slicer dependency"/> &lt;figcaption>
&lt;p>Seriously though, who delivers unsliced pizza??&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;h3 id="logarithmic" class="anchor-link">&lt;a href="#logarithmic">Logarithmic&lt;/a>&lt;/h3>
&lt;p>A &lt;strong>logarithmic&lt;/strong> algorithm is one that reduces the size of the input at every step.
We denote this time complexity as &lt;em>O&lt;/em>(log &lt;em>n&lt;/em>), where &lt;strong>log&lt;/strong>, the logarithm function, is this shape:&lt;/p>
&lt;figure class="screenshot">
&lt;img src="graph%28logn%29.png"
alt="A graph showing logarithmic time complexity"/>
&lt;/figure>
&lt;p>One example of this is a &lt;a href="https://en.wikipedia.org/wiki/Binary_search_algorithm">binary search algorithm&lt;/a> that finds the position of an element within a sorted array. Here&amp;rsquo;s how it would work, assuming we&amp;rsquo;re trying to find the element &lt;em>x&lt;/em>:&lt;/p>
&lt;ol>
&lt;li>If &lt;em>x&lt;/em> matches the middle element &lt;em>m&lt;/em> of the array, return the position of &lt;em>m&lt;/em>&lt;/li>
&lt;li>If &lt;em>x&lt;/em> doesn&amp;rsquo;t match &lt;em>m&lt;/em>, see if &lt;em>m&lt;/em> is larger or smaller than &lt;em>x&lt;/em>
&lt;ul>
&lt;li>If larger, discard all array items greater than &lt;em>m&lt;/em>&lt;/li>
&lt;li>If smaller, discard all array items smaller than &lt;em>m&lt;/em>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>Continue by repeating steps 1 and 2 on the remaining array until &lt;em>x&lt;/em> is found&lt;/li>
&lt;/ol>
&lt;p>I find the clearest analogy for understanding binary search is imagining the process of locating a book in a bookstore aisle. If the books are organized by author&amp;rsquo;s last name and you want to find &amp;ldquo;Terry Pratchett,&amp;rdquo; you know you need to look for the &amp;ldquo;P&amp;rdquo; section.&lt;/p>
&lt;p>You can approach the shelf at any point along the aisle and look at the author&amp;rsquo;s last name there. If you&amp;rsquo;re looking at a book by Neil Gaiman, you know you can ignore all the rest of the books to your left, since no letters that come before &amp;ldquo;G&amp;rdquo; in the alphabet happen to be &amp;ldquo;P.&amp;rdquo; You would then move down the aisle to the right any amount, and repeat this process until you&amp;rsquo;ve found the Terry Pratchett section, which should be rather sizable if you&amp;rsquo;re at any decent bookstore because wow did he write a lot of books.&lt;/p>
&lt;h3 id="quasilinear" class="anchor-link">&lt;a href="#quasilinear">Quasilinear&lt;/a>&lt;/h3>
&lt;figure class="screenshot">
&lt;img src="graph%28nlogn%29.png"
alt="A graph showing quasilinear time complexity"/>
&lt;/figure>
&lt;p>Often seen with sorting algorithms, the time complexity &lt;em>O&lt;/em>(&lt;em>n&lt;/em> log &lt;em>n&lt;/em>) can describe a data structure where each operation takes &lt;em>O&lt;/em>(log &lt;em>n&lt;/em>) time. One example of this is &lt;a href="https://en.wikipedia.org/wiki/Quicksort">quick sort&lt;/a>, a divide-and-conquer algorithm.&lt;/p>
&lt;p>Quick sort works by dividing up an unsorted array into smaller chunks that are easier to process. It sorts the sub-arrays, and thus the whole array. Think about it like trying to put a deck of cards in order. It&amp;rsquo;s faster if you split up the cards and get five friends to help you.&lt;/p>
&lt;h3 id="non-polynomial-time-complexity" class="anchor-link">&lt;a href="#non-polynomial-time-complexity">Non-polynomial time complexity&lt;/a>&lt;/h3>
&lt;p>The below classes of algorithms are non-polynomial.&lt;/p>
&lt;h3 id="factorial" class="anchor-link">&lt;a href="#factorial">Factorial&lt;/a>&lt;/h3>
&lt;figure class="screenshot">
&lt;img src="graph%28nfac%29.png"
alt="A graph showing factorial time complexity"/>
&lt;/figure>
&lt;p>An algorithm with time complexity &lt;em>O&lt;/em>(&lt;em>n&lt;/em>!) often iterates through all permutations of the input elements. One common example is a &lt;a href="https://en.wikipedia.org/wiki/Brute-force_search">brute-force search&lt;/a> seen in the &lt;a href="https://en.wikipedia.org/wiki/Travelling_salesman_problem#Computing_a_solution">travelling salesman problem&lt;/a>. It tries to find the least costly path between a number of points by enumerating all possible permutations and finding the ones with the lowest cost.&lt;/p>
&lt;h3 id="exponential" class="anchor-link">&lt;a href="#exponential">Exponential&lt;/a>&lt;/h3>
&lt;p>An &lt;strong>exponential&lt;/strong> algorithm often also iterates through all subsets of the input elements. It is denoted &lt;em>O&lt;/em>(2&lt;sup>&lt;em>n&lt;/em>&lt;/sup>) and is often seen in brute-force algorithms. It is similar to factorial time except in its rate of growth, which as you may not be surprised to hear, is exponential. The larger the data set, the more steep the curve becomes.&lt;/p>
&lt;figure class="screenshot">
&lt;img src="graph%282n%29.png"
alt="A graph showing exponential time complexity"/>
&lt;/figure>
&lt;p>In cryptography, a brute-force attack may systematically check all possible elements of a password by iterating through subsets. Using an exponential algorithm to do this, it becomes incredibly resource-expensive to brute-force crack a long password versus a shorter one. This is one reason that a long password is considered more secure than a shorter one.&lt;/p>
&lt;p>There are further time complexity classes less commonly seen that I won&amp;rsquo;t cover here, but you can read about these and find examples in &lt;a href="https://en.wikipedia.org/wiki/Time_complexity#Table_of_common_time_complexities">this handy table&lt;/a>.&lt;/p>
&lt;h3 id="recursion-time-complexity" class="anchor-link">&lt;a href="#recursion-time-complexity">Recursion time complexity&lt;/a>&lt;/h3>
&lt;p>As I described in my article &lt;a href="https://victoria.dev/blog/understanding-array.prototype.reduce-and-recursion-using-apple-pie/">explaining recursion using apple pie&lt;/a>, a recursive function calls itself under specified conditions. Its time complexity depends on how many times the function is called and the time complexity of a single function call. In other words, it&amp;rsquo;s the product of the number of times the function runs and a single execution&amp;rsquo;s time complexity.&lt;/p>
&lt;p>Here&amp;rsquo;s a recursive function that eats pies until no pies are left:&lt;/p>
&lt;div class="highlight">&lt;pre class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="kd">func&lt;/span> &lt;span class="nf">eatPies&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">pies&lt;/span> &lt;span class="kt">int&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="kt">int&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="k">if&lt;/span> &lt;span class="nx">pies&lt;/span> &lt;span class="o">==&lt;/span> &lt;span class="mi">0&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="k">return&lt;/span> &lt;span class="nx">pies&lt;/span>
&lt;span class="p">}&lt;/span>
&lt;span class="k">return&lt;/span> &lt;span class="nf">eatPies&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">pies&lt;/span> &lt;span class="o">-&lt;/span> &lt;span class="mi">1&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="p">}&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>The time complexity of a single execution is constant. No matter how many pies are input, the program will do the same thing: check to see if the input is 0. If so, return, and if not, call itself with one fewer pie.&lt;/p>
&lt;p>The initial number of pies could be any number, and we need to process all of them, so we can describe the input as &lt;em>n&lt;/em>. Thus, the time complexity of this recursive function is the product &lt;em>O&lt;/em>(&lt;em>n&lt;/em>).&lt;/p>
&lt;figure>
&lt;img src="piespile.png"
alt="A pile of pizza boxes with pies to be eaten"/> &lt;figcaption>
&lt;p>This function&amp;rsquo;s return value is zero, plus some indigestion.&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;h3 id="worst-case-time-complexity" class="anchor-link">&lt;a href="#worst-case-time-complexity">Worst case time complexity&lt;/a>&lt;/h3>
&lt;p>So far, we&amp;rsquo;ve talked about the time complexity of a few nested loops and some code examples. Most algorithms, however, are built from many combinations of these. How do we determine the time complexity of an algorithm containing many of these elements strung together?&lt;/p>
&lt;p>Easy. We can describe the total time complexity of the algorithm by finding the largest complexity among all of its parts. This is because the slowest part of the code is the bottleneck, and time complexity is concerned with describing the worst case for the algorithm&amp;rsquo;s run time.&lt;/p>
&lt;p>Say we have a program for an office party. If our program looks like this:&lt;/p>
&lt;div class="highlight">&lt;pre class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="kn">package&lt;/span> &lt;span class="nx">main&lt;/span>
&lt;span class="kn">import&lt;/span> &lt;span class="s">&amp;#34;fmt&amp;#34;&lt;/span>
&lt;span class="kd">func&lt;/span> &lt;span class="nf">takeCupcake&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">cupcakes&lt;/span> &lt;span class="p">[]&lt;/span>&lt;span class="kt">int&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="kt">int&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="nx">fmt&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Println&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;Have cupcake number&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="nx">cupcakes&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="mi">0&lt;/span>&lt;span class="p">])&lt;/span>
&lt;span class="k">return&lt;/span> &lt;span class="nx">cupcakes&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="mi">0&lt;/span>&lt;span class="p">]&lt;/span>
&lt;span class="p">}&lt;/span>
&lt;span class="kd">func&lt;/span> &lt;span class="nf">eatChips&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">bowlOfChips&lt;/span> &lt;span class="kt">int&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="nx">fmt&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Println&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;Have some chips!&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="k">for&lt;/span> &lt;span class="nx">chip&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="nx">chip&lt;/span> &lt;span class="o">&amp;lt;=&lt;/span> &lt;span class="nx">bowlOfChips&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="nx">chip&lt;/span>&lt;span class="o">++&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="c1">// dip chip
&lt;/span>&lt;span class="c1">&lt;/span> &lt;span class="p">}&lt;/span>
&lt;span class="nx">fmt&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Println&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;No more chips.&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="p">}&lt;/span>
&lt;span class="kd">func&lt;/span> &lt;span class="nf">pizzaDelivery&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">boxesDelivered&lt;/span> &lt;span class="kt">int&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="nx">fmt&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Println&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;Pizza is here!&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="k">for&lt;/span> &lt;span class="nx">pizzaBox&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="nx">pizzaBox&lt;/span> &lt;span class="o">&amp;lt;=&lt;/span> &lt;span class="nx">boxesDelivered&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="nx">pizzaBox&lt;/span>&lt;span class="o">++&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="c1">// open box
&lt;/span>&lt;span class="c1">&lt;/span> &lt;span class="k">for&lt;/span> &lt;span class="nx">pizza&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="nx">pizza&lt;/span> &lt;span class="o">&amp;lt;=&lt;/span> &lt;span class="nx">pizzaBox&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="nx">pizza&lt;/span>&lt;span class="o">++&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="c1">// slice pizza
&lt;/span>&lt;span class="c1">&lt;/span> &lt;span class="k">for&lt;/span> &lt;span class="nx">slice&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="nx">slice&lt;/span> &lt;span class="o">&amp;lt;=&lt;/span> &lt;span class="nx">pizza&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="nx">slice&lt;/span>&lt;span class="o">++&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="c1">// eat slice of pizza
&lt;/span>&lt;span class="c1">&lt;/span> &lt;span class="p">}&lt;/span>
&lt;span class="p">}&lt;/span>
&lt;span class="p">}&lt;/span>
&lt;span class="nx">fmt&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Println&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;Pizza is gone.&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="p">}&lt;/span>
&lt;span class="kd">func&lt;/span> &lt;span class="nf">eatPies&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">pies&lt;/span> &lt;span class="kt">int&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="kt">int&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="k">if&lt;/span> &lt;span class="nx">pies&lt;/span> &lt;span class="o">==&lt;/span> &lt;span class="mi">0&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="nx">fmt&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Println&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;Someone ate all the pies!&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="k">return&lt;/span> &lt;span class="nx">pies&lt;/span>
&lt;span class="p">}&lt;/span>
&lt;span class="nx">fmt&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Println&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;Eating pie...&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="k">return&lt;/span> &lt;span class="nf">eatPies&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">pies&lt;/span> &lt;span class="o">-&lt;/span> &lt;span class="mi">1&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="p">}&lt;/span>
&lt;span class="kd">func&lt;/span> &lt;span class="nf">main&lt;/span>&lt;span class="p">()&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="nf">takeCupcake&lt;/span>&lt;span class="p">([]&lt;/span>&lt;span class="kt">int&lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">2&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">3&lt;/span>&lt;span class="p">})&lt;/span>
&lt;span class="nf">eatChips&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mi">23&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="nf">pizzaDelivery&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mi">3&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="nf">eatPies&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mi">3&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="nx">fmt&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Println&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;Food gone. Back to work!&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="p">}&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>We can describe the time complexity of all the code by the complexity of its most complex part. This program is made up of functions we&amp;rsquo;ve already seen, with the following time complexity classes:&lt;/p>
&lt;table>
&lt;thead>
&lt;tr>
&lt;th>Function&lt;/th>
&lt;th>Class&lt;/th>
&lt;th>Big O&lt;/th>
&lt;/tr>
&lt;/thead>
&lt;tbody>
&lt;tr>
&lt;td>&lt;code>takeCupcake&lt;/code>&lt;/td>
&lt;td>constant&lt;/td>
&lt;td>&lt;em>O&lt;/em>(1)&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;code>eatChips&lt;/code>&lt;/td>
&lt;td>linear&lt;/td>
&lt;td>&lt;em>O&lt;/em>(&lt;em>n&lt;/em>)&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;code>pizzaDelivery&lt;/code>&lt;/td>
&lt;td>cubic&lt;/td>
&lt;td>&lt;em>O&lt;/em>(&lt;em>n&lt;/em>&lt;sup>3&lt;/sup>)&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;code>eatPies&lt;/code>&lt;/td>
&lt;td>linear (recursive)&lt;/td>
&lt;td>&lt;em>O&lt;/em>(&lt;em>n&lt;/em>)&lt;/td>
&lt;/tr>
&lt;/tbody>
&lt;/table>
&lt;p>To describe the time complexity of the entire office party program, we choose the worst case. This program would have the time complexity &lt;em>O&lt;/em>(&lt;em>n&lt;/em>&lt;sup>3&lt;/sup>).&lt;/p>
&lt;p>Here&amp;rsquo;s the office party soundtrack, just for fun.&lt;/p>
&lt;div class="highlight">&lt;pre class="chroma">&lt;code class="language-bash" data-lang="bash">Have cupcake number &lt;span class="m">1&lt;/span>
Have some chips!
No more chips.
Pizza is here!
Pizza is gone.
Eating pie...
Eating pie...
Eating pie...
Someone ate all the pies!
Food gone. Back to work!
&lt;/code>&lt;/pre>&lt;/div>
&lt;h2 id="p-vs-np-np-complete-and-np-hard" class="anchor-link">&lt;a href="#p-vs-np-np-complete-and-np-hard">P vs NP, NP-complete, and NP-hard&lt;/a>&lt;/h2>
&lt;p>You may come across these terms in your explorations of time complexity. Informally, &lt;strong>P&lt;/strong> (for Polynomial time), is a class of problems that is quick to solve. &lt;strong>NP&lt;/strong>, for Nondeterministic Polynomial time, is a class of problems where the answer can be quickly verified in polynomial time. NP encompasses P, but also another class of problems called &lt;strong>NP-complete&lt;/strong>, for which no fast solution is known.&lt;sup>[&lt;a href="#sources">5&lt;/a>]&lt;/sup> Outside of NP but still including NP-complete is yet another class called &lt;strong>NP-hard&lt;/strong>, which includes problems that no one has been able to verifiably solve with polynomial algorithms.&lt;sup>[&lt;a href="#sources">6&lt;/a>]&lt;/sup>&lt;/p>
&lt;figure class="screenshot">
&lt;img src="pnpeuler.svg"
alt="Euler diagram"/> &lt;figcaption>
&lt;p>P vs NP Euler diagram, &lt;a href="https://commons.wikimedia.org/w/index.php?curid=3532181">by Behnam Esfahbod, CC BY-SA 3.0&lt;/a>&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;p>&lt;a href="https://en.wikipedia.org/wiki/P_versus_NP_problem">P versus NP&lt;/a> is an unsolved, open question in computer science.&lt;/p>
&lt;p>Anyway, you don&amp;rsquo;t generally need to know about NP and NP-hard problems to begin taking advantage of understanding time complexity. They&amp;rsquo;re a whole other Pandora&amp;rsquo;s box.&lt;/p>
&lt;h2 id="approximate-the-efficiency-of-an-algorithm-before-you-write-the-code" class="anchor-link">&lt;a href="#approximate-the-efficiency-of-an-algorithm-before-you-write-the-code">Approximate the efficiency of an algorithm before you write the code&lt;/a>&lt;/h2>
&lt;p>So far, we&amp;rsquo;ve identified some different time complexity classes and how we might determine which one an algorithm falls into. So how does this help us before we&amp;rsquo;ve written any code to evaluate?&lt;/p>
&lt;p>By combining a little knowledge of time complexity with an awareness of the size of our input data, we can take a guess at an efficient algorithm for processing our data within a given time constraint. We can base our estimation on the fact that a modern computer can perform some hundreds of millions of operations in a second.&lt;sup>[&lt;a href="#sources">1&lt;/a>]&lt;/sup> The following table from the &lt;a href="#sources">Competitive Programmer&amp;rsquo;s Handbook&lt;/a> offers some estimates on required time complexity to process the respective input size in a time limit of one second.&lt;/p>
&lt;table>
&lt;thead>
&lt;tr>
&lt;th>Input size&lt;/th>
&lt;th>Required time complexity for 1s processing time&lt;/th>
&lt;/tr>
&lt;/thead>
&lt;tbody>
&lt;tr>
&lt;td>n  10&lt;/td>
&lt;td>&lt;em>O&lt;/em>(&lt;em>n&lt;/em>!)&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>n  20&lt;/td>
&lt;td>&lt;em>O&lt;/em>(2&lt;sup>&lt;em>n&lt;/em>&lt;/sup>)&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>n  500&lt;/td>
&lt;td>&lt;em>O&lt;/em>(&lt;em>n&lt;/em>&lt;sup>3&lt;/sup>)&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>n  5000&lt;/td>
&lt;td>&lt;em>O&lt;/em>(&lt;em>n&lt;/em>&lt;sup>2&lt;/sup>)&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>n  10&lt;sup>6&lt;/sup>&lt;/td>
&lt;td>&lt;em>O&lt;/em>(&lt;em>n&lt;/em> log &lt;em>n&lt;/em>) or &lt;em>O&lt;/em>(&lt;em>n&lt;/em>)&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>n is large&lt;/td>
&lt;td>&lt;em>O&lt;/em>(1) or &lt;em>O&lt;/em>(log &lt;em>n&lt;/em>)&lt;/td>
&lt;/tr>
&lt;/tbody>
&lt;/table>
&lt;p>Keep in mind that time complexity is an approximation, and not a guarantee. We can save a lot of time and effort by immediately ruling out algorithm designs that are unlikely to suit our constraints, but we must also consider that Big O notation doesn&amp;rsquo;t account for &lt;strong>constant factors&lt;/strong>. Here&amp;rsquo;s some code to illustrate.&lt;/p>
&lt;p>The following two algorithms both have &lt;em>O&lt;/em>(&lt;em>n&lt;/em>) time complexity.&lt;/p>
&lt;div class="highlight">&lt;pre class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="kd">func&lt;/span> &lt;span class="nf">makeCoffee&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">scoops&lt;/span> &lt;span class="kt">int&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="k">for&lt;/span> &lt;span class="nx">scoop&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="nx">scoop&lt;/span> &lt;span class="o">&amp;lt;=&lt;/span> &lt;span class="nx">scoops&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="nx">scoop&lt;/span>&lt;span class="o">++&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="c1">// add instant coffee
&lt;/span>&lt;span class="c1">&lt;/span> &lt;span class="p">}&lt;/span>
&lt;span class="p">}&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="kd">func&lt;/span> &lt;span class="nf">makeStrongCoffee&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">scoops&lt;/span> &lt;span class="kt">int&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="k">for&lt;/span> &lt;span class="nx">scoop&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="nx">scoop&lt;/span> &lt;span class="o">&amp;lt;=&lt;/span> &lt;span class="mi">3&lt;/span>&lt;span class="o">*&lt;/span>&lt;span class="nx">scoops&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="nx">scoop&lt;/span>&lt;span class="o">++&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="c1">// add instant coffee
&lt;/span>&lt;span class="c1">&lt;/span> &lt;span class="p">}&lt;/span>
&lt;span class="p">}&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>The first function makes a cup of coffee with the number of scoops we ask for. The second function also makes a cup of coffee, but it triples the number of scoops we ask for. To see an illustrative example, let&amp;rsquo;s ask both these functions for a cup of coffee with a million scoops.&lt;/p>
&lt;p>Here&amp;rsquo;s the output of the Go test:&lt;/p>
&lt;div class="highlight">&lt;pre class="chroma">&lt;code class="language-sh" data-lang="sh">Benchmark_makeCoffee-4 &lt;span class="m">1000000000&lt;/span> 0.29 ns/op
Benchmark_makeStrongCoffee-4 &lt;span class="m">1000000000&lt;/span> 0.86 ns/op
&lt;/code>&lt;/pre>&lt;/div>&lt;p>Our first function, &lt;code>makeCoffee&lt;/code>, completed in an average 0.29 nanoseconds. Our second function, &lt;code>makeStrongCoffee&lt;/code>, completed in an average of 0.86 nanoseconds. While those may both seem like pretty small numbers, consider that the stronger coffee took near three times longer to make. This should make sense intuitively, since we asked it to triple the scoops. Big O notation alone wouldn&amp;rsquo;t tell you this, since the constant factor of the tripled scoops isn&amp;rsquo;t accounted for.&lt;/p>
&lt;h2 id="improve-time-complexity-of-existing-code" class="anchor-link">&lt;a href="#improve-time-complexity-of-existing-code">Improve time complexity of existing code&lt;/a>&lt;/h2>
&lt;p>Becoming familiar with time complexity gives us the opportunity to write code, or refactor code, to be more efficient. To illustrate, I&amp;rsquo;ll give a concrete example of one way we can refactor a bit of code to improve its time complexity.&lt;/p>
&lt;p>Let&amp;rsquo;s say a bunch of people at the office want some pie. Some people want pie more than others. The amount that everyone wants some pie is represented by an &lt;code>int&lt;/code> &amp;gt; 0:&lt;/p>
&lt;div class="highlight">&lt;pre class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="nx">diners&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="p">[]&lt;/span>&lt;span class="kt">int&lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="mi">2&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">88&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">87&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">16&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">42&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">10&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">34&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">1&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">43&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">56&lt;/span>&lt;span class="p">}&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>Unfortunately, we&amp;rsquo;re bootstrapped and there are only three forks to go around. Since we&amp;rsquo;re a cooperative bunch, the three people who want pie the most will receive the forks to eat it with. Even though they&amp;rsquo;ve all agreed on this, no one seems to want to sort themselves out and line up in an orderly fashion, so we&amp;rsquo;ll have to make do with everybody jumbled about.&lt;/p>
&lt;p>Without sorting the list of diners, return the three largest integers in the slice.&lt;/p>
&lt;p>Here&amp;rsquo;s a function that solves this problem and has &lt;em>O&lt;/em>(&lt;em>n&lt;/em>&lt;sup>2&lt;/sup>) time complexity:&lt;/p>
&lt;div class="highlight">&lt;pre class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="kd">func&lt;/span> &lt;span class="nf">giveForks&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">diners&lt;/span> &lt;span class="p">[]&lt;/span>&lt;span class="kt">int&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">[]&lt;/span>&lt;span class="kt">int&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="c1">// make a slice to store diners who will receive forks
&lt;/span>&lt;span class="c1">&lt;/span> &lt;span class="kd">var&lt;/span> &lt;span class="nx">withForks&lt;/span> &lt;span class="p">[]&lt;/span>&lt;span class="kt">int&lt;/span>
&lt;span class="c1">// loop over three forks
&lt;/span>&lt;span class="c1">&lt;/span> &lt;span class="k">for&lt;/span> &lt;span class="nx">i&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="mi">1&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="nx">i&lt;/span> &lt;span class="o">&amp;lt;=&lt;/span> &lt;span class="mi">3&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="nx">i&lt;/span>&lt;span class="o">++&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="c1">// variables to keep track of the highest integer and where it is
&lt;/span>&lt;span class="c1">&lt;/span> &lt;span class="kd">var&lt;/span> &lt;span class="nx">max&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">maxIndex&lt;/span> &lt;span class="kt">int&lt;/span>
&lt;span class="c1">// loop over the diners slice
&lt;/span>&lt;span class="c1">&lt;/span> &lt;span class="k">for&lt;/span> &lt;span class="nx">n&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="k">range&lt;/span> &lt;span class="nx">diners&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="c1">// if this integer is higher than max, update max and maxIndex
&lt;/span>&lt;span class="c1">&lt;/span> &lt;span class="k">if&lt;/span> &lt;span class="nx">diners&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="nx">n&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="p">&amp;gt;&lt;/span> &lt;span class="nx">max&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="nx">max&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="nx">diners&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="nx">n&lt;/span>&lt;span class="p">]&lt;/span>
&lt;span class="nx">maxIndex&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="nx">n&lt;/span>
&lt;span class="p">}&lt;/span>
&lt;span class="p">}&lt;/span>
&lt;span class="c1">// remove the highest integer from the diners slice for the next loop
&lt;/span>&lt;span class="c1">&lt;/span> &lt;span class="nx">diners&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="nb">append&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">diners&lt;/span>&lt;span class="p">[:&lt;/span>&lt;span class="nx">maxIndex&lt;/span>&lt;span class="p">],&lt;/span> &lt;span class="nx">diners&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="nx">maxIndex&lt;/span>&lt;span class="o">+&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">:]&lt;/span>&lt;span class="o">...&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="c1">// keep track of who gets a fork
&lt;/span>&lt;span class="c1">&lt;/span> &lt;span class="nx">withForks&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="nb">append&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">withForks&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">max&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="p">}&lt;/span>
&lt;span class="k">return&lt;/span> &lt;span class="nx">withForks&lt;/span>
&lt;span class="p">}&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>This program works, and eventually returns diners &lt;code>[88 87 56]&lt;/code>. Everyone gets a little impatient while it&amp;rsquo;s running though, since it takes rather a long time (about 120 nanoseconds) just to hand out three forks, and the pie&amp;rsquo;s getting cold. How could we improve it?&lt;/p>
&lt;p>By thinking about our approach in a slightly different way, we can refactor this program to have &lt;em>O&lt;/em>(&lt;em>n&lt;/em>) time complexity:&lt;/p>
&lt;div class="highlight">&lt;pre class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="kd">func&lt;/span> &lt;span class="nf">giveForks&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">diners&lt;/span> &lt;span class="p">[]&lt;/span>&lt;span class="kt">int&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">[]&lt;/span>&lt;span class="kt">int&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="c1">// make a slice to store diners who will receive forks
&lt;/span>&lt;span class="c1">&lt;/span> &lt;span class="kd">var&lt;/span> &lt;span class="nx">withForks&lt;/span> &lt;span class="p">[]&lt;/span>&lt;span class="kt">int&lt;/span>
&lt;span class="c1">// create variables for each fork
&lt;/span>&lt;span class="c1">&lt;/span> &lt;span class="kd">var&lt;/span> &lt;span class="nx">first&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">second&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">third&lt;/span> &lt;span class="kt">int&lt;/span>
&lt;span class="c1">// loop over the diners
&lt;/span>&lt;span class="c1">&lt;/span> &lt;span class="k">for&lt;/span> &lt;span class="nx">i&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="k">range&lt;/span> &lt;span class="nx">diners&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="c1">// assign the forks
&lt;/span>&lt;span class="c1">&lt;/span> &lt;span class="k">if&lt;/span> &lt;span class="nx">diners&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="nx">i&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="p">&amp;gt;&lt;/span> &lt;span class="nx">first&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="nx">third&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="nx">second&lt;/span>
&lt;span class="nx">second&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="nx">first&lt;/span>
&lt;span class="nx">first&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="nx">diners&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="nx">i&lt;/span>&lt;span class="p">]&lt;/span>
&lt;span class="p">}&lt;/span> &lt;span class="k">else&lt;/span> &lt;span class="k">if&lt;/span> &lt;span class="nx">diners&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="nx">i&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="p">&amp;gt;&lt;/span> &lt;span class="nx">second&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="nx">third&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="nx">second&lt;/span>
&lt;span class="nx">second&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="nx">diners&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="nx">i&lt;/span>&lt;span class="p">]&lt;/span>
&lt;span class="p">}&lt;/span> &lt;span class="k">else&lt;/span> &lt;span class="k">if&lt;/span> &lt;span class="nx">diners&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="nx">i&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="p">&amp;gt;&lt;/span> &lt;span class="nx">third&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="nx">third&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="nx">diners&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="nx">i&lt;/span>&lt;span class="p">]&lt;/span>
&lt;span class="p">}&lt;/span>
&lt;span class="p">}&lt;/span>
&lt;span class="c1">// list the final result of who gets a fork
&lt;/span>&lt;span class="c1">&lt;/span> &lt;span class="nx">withForks&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="nb">append&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">withForks&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">first&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">second&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">third&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="k">return&lt;/span> &lt;span class="nx">withForks&lt;/span>
&lt;span class="p">}&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>Here&amp;rsquo;s how the new program works:&lt;/p>
&lt;p>Initially, diner &lt;code>2&lt;/code> (the first in the list) is assigned the &lt;code>first&lt;/code> fork. The other forks remain unassigned.&lt;/p>
&lt;p>Then, diner &lt;code>88&lt;/code> is assigned the first fork instead. Diner &lt;code>2&lt;/code> gets the &lt;code>second&lt;/code> one.&lt;/p>
&lt;p>Diner &lt;code>87&lt;/code> isn&amp;rsquo;t greater than &lt;code>first&lt;/code> which is currently &lt;code>88&lt;/code>, but it is greater than &lt;code>2&lt;/code> who has the &lt;code>second&lt;/code> fork. So, the &lt;code>second&lt;/code> fork goes to &lt;code>87&lt;/code>. Diner &lt;code>2&lt;/code> gets the &lt;code>third&lt;/code> fork.&lt;/p>
&lt;p>Continuing in this violent and rapid fork exchange, diner &lt;code>16&lt;/code> is then assigned the &lt;code>third&lt;/code> fork instead of &lt;code>2&lt;/code>, and so on.&lt;/p>
&lt;p>We can add a print statement in the loop to see how the fork assignments play out:&lt;/p>
&lt;div class="highlight">&lt;pre class="chroma">&lt;code class="language-sh" data-lang="sh">&lt;span class="m">0&lt;/span> &lt;span class="m">0&lt;/span> &lt;span class="m">0&lt;/span>
&lt;span class="m">2&lt;/span> &lt;span class="m">0&lt;/span> &lt;span class="m">0&lt;/span>
&lt;span class="m">88&lt;/span> &lt;span class="m">2&lt;/span> &lt;span class="m">0&lt;/span>
&lt;span class="m">88&lt;/span> &lt;span class="m">87&lt;/span> &lt;span class="m">2&lt;/span>
&lt;span class="m">88&lt;/span> &lt;span class="m">87&lt;/span> &lt;span class="m">16&lt;/span>
&lt;span class="m">88&lt;/span> &lt;span class="m">87&lt;/span> &lt;span class="m">42&lt;/span>
&lt;span class="m">88&lt;/span> &lt;span class="m">87&lt;/span> &lt;span class="m">42&lt;/span>
&lt;span class="m">88&lt;/span> &lt;span class="m">87&lt;/span> &lt;span class="m">42&lt;/span>
&lt;span class="m">88&lt;/span> &lt;span class="m">87&lt;/span> &lt;span class="m">42&lt;/span>
&lt;span class="m">88&lt;/span> &lt;span class="m">87&lt;/span> &lt;span class="m">43&lt;/span>
&lt;span class="o">[&lt;/span>&lt;span class="m">88&lt;/span> &lt;span class="m">87&lt;/span> 56&lt;span class="o">]&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>This program is much faster, and the whole epic struggle for fork domination is over in 47 nanoseconds.&lt;/p>
&lt;p>As you can see, with a little change in perspective and some refactoring, we&amp;rsquo;ve made this simple bit of code faster and more efficient.&lt;/p>
&lt;p>Well, it looks like our fifteen minute coffee break is up! I hope I&amp;rsquo;ve given you a comprehensive introduction to calculating time complexity. Time to get back to work, hopefully applying your new knowledge to write more effective code! Or maybe just sound smart at your next office party. :)&lt;/p>
&lt;h2 id="sources" class="anchor-link">&lt;a href="#sources">Sources&lt;/a>&lt;/h2>
&lt;p>&amp;ldquo;If I have seen further it is by standing on the shoulders of Giants.&amp;rdquo; &amp;ndash;Isaac Newton, 1675&lt;/p>
&lt;ol>
&lt;li>Antti Laaksonen. &lt;em>&lt;a href="https://cses.fi/book.pdf">Competitive Programmer&amp;rsquo;s Handbook (pdf)&lt;/a>,&lt;/em> 2017&lt;/li>
&lt;li>Wikipedia: &lt;a href="https://en.wikipedia.org/wiki/Big_O_notation">Big O notation&lt;/a>&lt;/li>
&lt;li>StackOverflow: &lt;a href="https://stackoverflow.com/a/487278">What is a plain English explanation of Big O notation?&lt;/a>&lt;/li>
&lt;li>Wikipedia: &lt;a href="https://en.wikipedia.org/wiki/Polynomial">Polynomial&lt;/a>&lt;/li>
&lt;li>Wikipedia: &lt;a href="https://en.wikipedia.org/wiki/NP-completeness">NP-completeness&lt;/a>&lt;/li>
&lt;li>Wikipedia: &lt;a href="https://en.wikipedia.org/wiki/NP-hardness">NP-hardness&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://www.desmos.com/">Desmos graph calculator&lt;/a>&lt;/li>
&lt;/ol></content:encoded><enclosure url="https://victoria.dev/blog/a-coffee-break-introduction-to-time-complexity-of-algorithms/cover_wibbly_hu64a4c7ed5bb41a17b8b90ed2af9d238b_2572713_640x0_resize_box_2.png" type="image/jpg"/></item><item><title>Knapsack problem algorithms for my real-life carry-on knapsack</title><link>https://victoria.dev/blog/knapsack-problem-algorithms-for-my-real-life-carry-on-knapsack/</link><pubDate>Wed, 09 May 2018 21:00:35 -0400</pubDate><author>hello@victoria.dev (Victoria Drake)</author><guid>https://victoria.dev/blog/knapsack-problem-algorithms-for-my-real-life-carry-on-knapsack/</guid><description>Using a greedy algorithm and dynamic programming to pack my full-time nomad travel bag.</description><content:encoded>
&lt;img src="https://victoria.dev/blog/knapsack-problem-algorithms-for-my-real-life-carry-on-knapsack/cover_knapsack-doodle_hu7070e09a25cc0b4f24775e27e4fe15a9_203336_640x0_resize_box_2.png" width="640" height="320"/>
&lt;p>I&amp;rsquo;m a nomad and live out of one carry-on bag. This means that the total weight of all my worldly possessions must fall under airline cabin baggage weight limits - usually 10kg. On some smaller airlines, however, this weight limit drops to 7kg. Occasionally, I have to decide not to bring something with me to adjust to the smaller weight limit.&lt;/p>
&lt;p>As a practical exercise, deciding what to leave behind (or get rid of altogether) entails laying out all my things and choosing which ones to keep. That decision is based on the item&amp;rsquo;s usefulness to me (its worth) and its weight.&lt;/p>
&lt;figure>
&lt;img src="knapsack-stuff.jpeg"
alt="All my stuff, laid out flat"/> &lt;figcaption>
&lt;p>This is all my stuff, and my Minaal Carry-on bag.&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;p>Being a programmer, I&amp;rsquo;m aware that decisions like this could be made more efficiently by a computer. It&amp;rsquo;s done so frequently and so ubiquitously, in fact, that many will recognize this scenario as the classic &lt;em>packing problem&lt;/em> or &lt;em>knapsack problem.&lt;/em> How do I go about telling a computer to put as many important items in my bag as possible while coming in at or under a weight limit of 7kg? With algorithms! Yay!&lt;/p>
&lt;p>I&amp;rsquo;ll discuss two common approaches to solving the knapsack problem: one called a &lt;em>greedy algorithm,&lt;/em> and another called &lt;em>dynamic programming&lt;/em> (a little harder, but better, faster, stronger&amp;hellip;).&lt;/p>
&lt;p>Let&amp;rsquo;s get to it.&lt;/p>
&lt;h2 id="the-set-up" class="anchor-link">&lt;a href="#the-set-up">The set up&lt;/a>&lt;/h2>
&lt;p>I prepared my data in the form of a CSV file with three columns: the item&amp;rsquo;s name (a string), a representation of its worth (an integer), and its weight in grams (an integer). There are 40 items in total. I represented worth by ranking each item from 40 to 1, with 40 being the most important and 1 equating with something like &amp;ldquo;why do I even have this again?&amp;rdquo; (If you&amp;rsquo;ve never listed out all your possessions and ranked them by order of how useful they are to you, I highly recommend you try it. It can be a very revealing exercise.)&lt;/p>
&lt;p>&lt;strong>Total weight of all items and bag:&lt;/strong> 9003g&lt;/p>
&lt;p>&lt;strong>Bag weight:&lt;/strong> 1415g&lt;/p>
&lt;p>&lt;strong>Airline limit:&lt;/strong> 7000g&lt;/p>
&lt;p>&lt;strong>Maximum weight of items I can pack:&lt;/strong> 5585g&lt;/p>
&lt;p>&lt;strong>Total possible worth of items:&lt;/strong> 820&lt;/p>
&lt;p>&lt;strong>The challenge:&lt;/strong> Pack as many items as the limit allows while maximizing the total worth.&lt;/p>
&lt;h2 id="data-structures" class="anchor-link">&lt;a href="#data-structures">Data structures&lt;/a>&lt;/h2>
&lt;h3 id="reading-in-a-file" class="anchor-link">&lt;a href="#reading-in-a-file">Reading in a file&lt;/a>&lt;/h3>
&lt;p>Before we can begin thinking about how to solve the knapsack problem, we have to solve the problem of reading in and storing our data. Thankfully, the Go standard library&amp;rsquo;s &lt;code>io/ioutil&lt;/code> package makes the first part straightforward.&lt;/p>
&lt;div class="highlight">&lt;pre class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="kn">package&lt;/span> &lt;span class="nx">main&lt;/span>
&lt;span class="kn">import&lt;/span> &lt;span class="p">(&lt;/span>
&lt;span class="s">&amp;#34;fmt&amp;#34;&lt;/span>
&lt;span class="s">&amp;#34;io/ioutil&amp;#34;&lt;/span>
&lt;span class="p">)&lt;/span>
&lt;span class="kd">func&lt;/span> &lt;span class="nf">check&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">e&lt;/span> &lt;span class="kt">error&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="k">if&lt;/span> &lt;span class="nx">e&lt;/span> &lt;span class="o">!=&lt;/span> &lt;span class="kc">nil&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="nb">panic&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">e&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="p">}&lt;/span>
&lt;span class="p">}&lt;/span>
&lt;span class="kd">func&lt;/span> &lt;span class="nf">readItems&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">path&lt;/span> &lt;span class="kt">string&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="nx">dat&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">err&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="nx">ioutil&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">ReadFile&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">path&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="nf">check&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">err&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="nx">fmt&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Print&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nb">string&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">dat&lt;/span>&lt;span class="p">))&lt;/span>
&lt;span class="p">}&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>The &lt;code>ReadFile()&lt;/code> function takes a file path and returns the file&amp;rsquo;s contents and an error (&lt;code>nil&lt;/code> if the call is successful) so we&amp;rsquo;ve also created a &lt;code>check()&lt;/code> function to handle any errors that might be returned. In a real-world application we probably would want to do something more sophisticated than &lt;code>panic&lt;/code>, but that&amp;rsquo;s not important right now.&lt;/p>
&lt;h3 id="creating-a-struct" class="anchor-link">&lt;a href="#creating-a-struct">Creating a struct&lt;/a>&lt;/h3>
&lt;p>Now that we&amp;rsquo;ve got our data, we should probably do something with it. Since we&amp;rsquo;re working with real-life items and a real-life bag, let&amp;rsquo;s create some types to represent them and make it easier to conceptualize our program. A &lt;code>struct&lt;/code> in Go is a typed collection of fields. Here are our two types:&lt;/p>
&lt;div class="highlight">&lt;pre class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="kd">type&lt;/span> &lt;span class="nx">item&lt;/span> &lt;span class="kd">struct&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="nx">name&lt;/span> &lt;span class="kt">string&lt;/span>
&lt;span class="nx">worth&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">weight&lt;/span> &lt;span class="kt">int&lt;/span>
&lt;span class="p">}&lt;/span>
&lt;span class="kd">type&lt;/span> &lt;span class="nx">bag&lt;/span> &lt;span class="kd">struct&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="nx">bagWeight&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">currItemsWeight&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">maxItemsWeight&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">totalWeight&lt;/span> &lt;span class="kt">int&lt;/span>
&lt;span class="nx">items&lt;/span> &lt;span class="p">[]&lt;/span>&lt;span class="nx">item&lt;/span>
&lt;span class="p">}&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>It is helpful to use field names that are very descriptive. You can see that the structs are set up just as we&amp;rsquo;ve described the things they represent. An &lt;code>item&lt;/code> has a &lt;code>name&lt;/code> (string), and a &lt;code>worth&lt;/code> and &lt;code>weight&lt;/code> (integers). A &lt;code>bag&lt;/code> has several fields of type &lt;code>int&lt;/code> representing its attributes, and also has the ability to hold &lt;code>items&lt;/code>, represented in the struct as a slice of &lt;code>item&lt;/code> type thingamabobbers.&lt;/p>
&lt;h3 id="parsing-and-storing-our-data" class="anchor-link">&lt;a href="#parsing-and-storing-our-data">Parsing and storing our data&lt;/a>&lt;/h3>
&lt;p>Several comprehensive Go packages exist that we could use to parse our CSV data&amp;hellip; but where&amp;rsquo;s the fun in that? Let&amp;rsquo;s go basic with some string splitting and a for loop. Here&amp;rsquo;s our updated &lt;code>readItems()&lt;/code> function:&lt;/p>
&lt;div class="highlight">&lt;pre class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="kd">func&lt;/span> &lt;span class="nf">readItems&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">path&lt;/span> &lt;span class="kt">string&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">[]&lt;/span>&lt;span class="nx">item&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="nx">dat&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">err&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="nx">ioutil&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">ReadFile&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">path&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="nf">check&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">err&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="nx">lines&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="nx">strings&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Split&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nb">string&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">dat&lt;/span>&lt;span class="p">),&lt;/span> &lt;span class="s">&amp;#34;\n&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="nx">itemList&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="nb">make&lt;/span>&lt;span class="p">([]&lt;/span>&lt;span class="nx">item&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="k">for&lt;/span> &lt;span class="nx">i&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">v&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="k">range&lt;/span> &lt;span class="nx">lines&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="k">if&lt;/span> &lt;span class="nx">i&lt;/span> &lt;span class="o">==&lt;/span> &lt;span class="mi">0&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="k">continue&lt;/span>
&lt;span class="p">}&lt;/span>
&lt;span class="nx">s&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="nx">strings&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Split&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">v&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s">&amp;#34;,&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="nx">newItemWorth&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">_&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="nx">strconv&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Atoi&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">s&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">])&lt;/span>
&lt;span class="nx">newItemWeight&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">_&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="nx">strconv&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Atoi&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">s&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="mi">2&lt;/span>&lt;span class="p">])&lt;/span>
&lt;span class="nx">newItem&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="nx">item&lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="nx">name&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="nx">s&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="mi">0&lt;/span>&lt;span class="p">],&lt;/span> &lt;span class="nx">worth&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="nx">newItemWorth&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">weight&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="nx">newItemWeight&lt;/span>&lt;span class="p">}&lt;/span>
&lt;span class="nx">itemList&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="nb">append&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">itemList&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">newItem&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="p">}&lt;/span>
&lt;span class="k">return&lt;/span> &lt;span class="nx">itemList&lt;/span>
&lt;span class="p">}&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>Using &lt;code>strings.Split&lt;/code>, we split our &lt;code>dat&lt;/code> on newlines. We then create an empty &lt;code>itemList&lt;/code> to hold our items.&lt;/p>
&lt;p>In our for loop, we skip the first line of our CSV file (the headers) then iterate over each line. We use &lt;code>strconv.Atoi&lt;/code> (read &amp;ldquo;A to i&amp;rdquo;) to convert the values for each item&amp;rsquo;s worth and weight into integers. We then create a &lt;code>newItem&lt;/code> with these field values and append it to the &lt;code>itemList&lt;/code>. Finally, we return &lt;code>itemList&lt;/code>.&lt;/p>
&lt;p>Here&amp;rsquo;s what our set up looks like so far:&lt;/p>
&lt;div class="highlight">&lt;pre class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="kn">package&lt;/span> &lt;span class="nx">main&lt;/span>
&lt;span class="kn">import&lt;/span> &lt;span class="p">(&lt;/span>
&lt;span class="s">&amp;#34;io/ioutil&amp;#34;&lt;/span>
&lt;span class="s">&amp;#34;strconv&amp;#34;&lt;/span>
&lt;span class="s">&amp;#34;strings&amp;#34;&lt;/span>
&lt;span class="p">)&lt;/span>
&lt;span class="kd">type&lt;/span> &lt;span class="nx">item&lt;/span> &lt;span class="kd">struct&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="nx">name&lt;/span> &lt;span class="kt">string&lt;/span>
&lt;span class="nx">worth&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">weight&lt;/span> &lt;span class="kt">int&lt;/span>
&lt;span class="p">}&lt;/span>
&lt;span class="kd">type&lt;/span> &lt;span class="nx">bag&lt;/span> &lt;span class="kd">struct&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="nx">bagWeight&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">currItemsWeight&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">maxItemsWeight&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">totalWeight&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">totalWorth&lt;/span> &lt;span class="kt">int&lt;/span>
&lt;span class="nx">items&lt;/span> &lt;span class="p">[]&lt;/span>&lt;span class="nx">item&lt;/span>
&lt;span class="p">}&lt;/span>
&lt;span class="kd">func&lt;/span> &lt;span class="nf">check&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">e&lt;/span> &lt;span class="kt">error&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="k">if&lt;/span> &lt;span class="nx">e&lt;/span> &lt;span class="o">!=&lt;/span> &lt;span class="kc">nil&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="nb">panic&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">e&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="p">}&lt;/span>
&lt;span class="p">}&lt;/span>
&lt;span class="kd">func&lt;/span> &lt;span class="nf">readItems&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">path&lt;/span> &lt;span class="kt">string&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">[]&lt;/span>&lt;span class="nx">item&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="nx">dat&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">err&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="nx">ioutil&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">ReadFile&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">path&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="nf">check&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">err&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="nx">lines&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="nx">strings&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Split&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nb">string&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">dat&lt;/span>&lt;span class="p">),&lt;/span> &lt;span class="s">&amp;#34;\n&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="nx">itemList&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="nb">make&lt;/span>&lt;span class="p">([]&lt;/span>&lt;span class="nx">item&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="k">for&lt;/span> &lt;span class="nx">i&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">v&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="k">range&lt;/span> &lt;span class="nx">lines&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="k">if&lt;/span> &lt;span class="nx">i&lt;/span> &lt;span class="o">==&lt;/span> &lt;span class="mi">0&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="k">continue&lt;/span> &lt;span class="c1">// skip the headers on the first line
&lt;/span>&lt;span class="c1">&lt;/span> &lt;span class="p">}&lt;/span>
&lt;span class="nx">s&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="nx">strings&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Split&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">v&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s">&amp;#34;,&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="nx">newItemWorth&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">_&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="nx">strconv&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Atoi&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">s&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">])&lt;/span>
&lt;span class="nx">newItemWeight&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">_&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="nx">strconv&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Atoi&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">s&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="mi">2&lt;/span>&lt;span class="p">])&lt;/span>
&lt;span class="nx">newItem&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="nx">item&lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="nx">name&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="nx">s&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="mi">0&lt;/span>&lt;span class="p">],&lt;/span> &lt;span class="nx">worth&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="nx">newItemWorth&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">weight&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="nx">newItemWeight&lt;/span>&lt;span class="p">}&lt;/span>
&lt;span class="nx">itemList&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="nb">append&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">itemList&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">newItem&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="p">}&lt;/span>
&lt;span class="k">return&lt;/span> &lt;span class="nx">itemList&lt;/span>
&lt;span class="p">}&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>Now that we&amp;rsquo;ve got our data structures set up, let&amp;rsquo;s get packing () on the first approach.&lt;/p>
&lt;h2 id="greedy-algorithm" class="anchor-link">&lt;a href="#greedy-algorithm">Greedy algorithm&lt;/a>&lt;/h2>
&lt;p>A greedy algorithm is the most straightforward approach to solving the knapsack problem, in that it is a one-pass algorithm that constructs a single final solution. At each stage of the problem, the greedy algorithm picks the option that is locally optimal, meaning it looks like the most suitable option right now. It does not revise its previous choices as it progresses through our data set.&lt;/p>
&lt;h3 id="building-our-greedy-algorithm" class="anchor-link">&lt;a href="#building-our-greedy-algorithm">Building our greedy algorithm&lt;/a>&lt;/h3>
&lt;p>The steps of the algorithm we&amp;rsquo;ll use to solve our knapsack problem are:&lt;/p>
&lt;ol>
&lt;li>Sort items by worth, in descending order.&lt;/li>
&lt;li>Start with the highest worth item. Put items into the bag until the next item on the list cannot fit.&lt;/li>
&lt;li>Try to fill any remaining capacity with the next item on the list that can fit.&lt;/li>
&lt;/ol>
&lt;p>If you read my &lt;a href="https://victoria.dev/blog/how-to-code-a-satellite-algorithm-and-cook-paella-from-scratch/">article about solving problems and making paella&lt;/a>, you&amp;rsquo;ll know that I always start by figuring out what the next most important question is. In this case, there are three main operations we need to figure out how to do:&lt;/p>
&lt;ul>
&lt;li>Sort items by worth.&lt;/li>
&lt;li>Put an item in the bag.&lt;/li>
&lt;li>Check to see if the bag is full.&lt;/li>
&lt;/ul>
&lt;p>The first one is just a docs lookup away. Here&amp;rsquo;s how we sort a slice in Go:&lt;/p>
&lt;div class="highlight">&lt;pre class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="nx">sort&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Slice&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">is&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="kd">func&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">i&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">j&lt;/span> &lt;span class="kt">int&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="kt">bool&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="k">return&lt;/span> &lt;span class="nx">is&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="nx">i&lt;/span>&lt;span class="p">].&lt;/span>&lt;span class="nx">worth&lt;/span> &lt;span class="p">&amp;gt;&lt;/span> &lt;span class="nx">is&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="nx">j&lt;/span>&lt;span class="p">].&lt;/span>&lt;span class="nx">worth&lt;/span>
&lt;span class="p">})&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>The &lt;code>sort.Slice()&lt;/code> function orders our items according to the less function we provide. In this case, it will order the highest worth items before the lowest worth items.&lt;/p>
&lt;p>Given that we don&amp;rsquo;t want to put an item in the bag if it doesn&amp;rsquo;t fit, we&amp;rsquo;ll complete the last two tasks in reverse. First, we&amp;rsquo;ll check to see if the item fits. If so, it goes in the bag.&lt;/p>
&lt;div class="highlight">&lt;pre class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="kd">func&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="nx">b&lt;/span> &lt;span class="o">*&lt;/span>&lt;span class="nx">bag&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="nf">addItem&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">i&lt;/span> &lt;span class="nx">item&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="kt">error&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="k">if&lt;/span> &lt;span class="nx">b&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">currItemsWeight&lt;/span>&lt;span class="o">+&lt;/span>&lt;span class="nx">i&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">weight&lt;/span> &lt;span class="o">&amp;lt;=&lt;/span> &lt;span class="nx">b&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">maxItemsWeight&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="nx">b&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">currItemsWeight&lt;/span> &lt;span class="o">+=&lt;/span> &lt;span class="nx">i&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">weight&lt;/span>
&lt;span class="nx">b&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">items&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="nb">append&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">b&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">items&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">i&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="k">return&lt;/span> &lt;span class="kc">nil&lt;/span>
&lt;span class="p">}&lt;/span>
&lt;span class="k">return&lt;/span> &lt;span class="nx">errors&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">New&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;could not fit item&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="p">}&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>Notice the &lt;code>*&lt;/code> in our first line there. That indicates that &lt;code>bag&lt;/code> is a pointer receiver (as opposed to a value receiver). It&amp;rsquo;s a concept that can be slightly confusing if you&amp;rsquo;re new to Go. Here are &lt;a href="https://github.com/golang/go/wiki/CodeReviewComments#receiver-type">some things to consider&lt;/a> that might help you decide when to use a value receiver and when to use a pointer receiver. For the purposes of our &lt;code>addItem()&lt;/code> function, this case applies:&lt;/p>
&lt;blockquote>
&lt;p>If the method needs to mutate the receiver, the receiver must be a pointer.&lt;/p>
&lt;/blockquote>
&lt;p>Our use of a pointer receiver tells our function we want to operate on &lt;em>this specific bag in particular&lt;/em>, not a new bag. It&amp;rsquo;s important because without it, every item would always fit in a newly created bag! A little detail like this can make the difference between code that works and code that keeps you up until 4am chugging Red Bull and muttering to yourself. (Go to bed on time even if your code doesn&amp;rsquo;t work - you&amp;rsquo;ll thank me later.)&lt;/p>
&lt;p>Now that we&amp;rsquo;ve got our components, let&amp;rsquo;s put together our greedy algorithm:&lt;/p>
&lt;div class="highlight">&lt;pre class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="kd">func&lt;/span> &lt;span class="nf">greedy&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">is&lt;/span> &lt;span class="p">[]&lt;/span>&lt;span class="nx">item&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">b&lt;/span> &lt;span class="nx">bag&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="nx">sort&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Slice&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">is&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="kd">func&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">i&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">j&lt;/span> &lt;span class="kt">int&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="kt">bool&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="k">return&lt;/span> &lt;span class="nx">is&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="nx">i&lt;/span>&lt;span class="p">].&lt;/span>&lt;span class="nx">worth&lt;/span> &lt;span class="p">&amp;gt;&lt;/span> &lt;span class="nx">is&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="nx">j&lt;/span>&lt;span class="p">].&lt;/span>&lt;span class="nx">worth&lt;/span>
&lt;span class="p">})&lt;/span>
&lt;span class="k">for&lt;/span> &lt;span class="nx">i&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="k">range&lt;/span> &lt;span class="nx">is&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="nx">b&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">addItem&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">is&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="nx">i&lt;/span>&lt;span class="p">])&lt;/span>
&lt;span class="p">}&lt;/span>
&lt;span class="nx">b&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">totalWeight&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="nx">b&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">bagWeight&lt;/span> &lt;span class="o">+&lt;/span> &lt;span class="nx">b&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">currItemsWeight&lt;/span>
&lt;span class="k">for&lt;/span> &lt;span class="nx">_&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">v&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="k">range&lt;/span> &lt;span class="nx">b&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">items&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="nx">b&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">totalWorth&lt;/span> &lt;span class="o">+=&lt;/span> &lt;span class="nx">v&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">worth&lt;/span>
&lt;span class="p">}&lt;/span>
&lt;span class="p">}&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>Then in our &lt;code>main()&lt;/code> function, we&amp;rsquo;ll create our bag, read in our data, and call our greedy algorithm. Here&amp;rsquo;s what it looks like, all set up and ready to go:&lt;/p>
&lt;div class="highlight">&lt;pre class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="kd">func&lt;/span> &lt;span class="nf">main&lt;/span>&lt;span class="p">()&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="nx">minaal&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="nx">bag&lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="nx">bagWeight&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="mi">1415&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">currItemsWeight&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">maxItemsWeight&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="mi">5585&lt;/span>&lt;span class="p">}&lt;/span>
&lt;span class="nx">itemList&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="nf">readItems&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;objects.csv&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="nf">greedy&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">itemList&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">minaal&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="p">}&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>
&lt;h3 id="greedy-algorithm-results" class="anchor-link">&lt;a href="#greedy-algorithm-results">Greedy algorithm results&lt;/a>&lt;/h3>
&lt;p>So how does this algorithm do when it comes to efficiently packing our bag to maximize its total worth? Here&amp;rsquo;s the result:&lt;/p>
&lt;p>&lt;strong>Total weight of bag and items:&lt;/strong> 6987g&lt;/p>
&lt;p>&lt;strong>Total worth of packed items:&lt;/strong> 716&lt;/p>
&lt;p>Here are the items our greedy algorithm chose, sorted by worth:&lt;/p>
&lt;table>
&lt;thead>
&lt;tr>
&lt;th>Item&lt;/th>
&lt;th>Worth&lt;/th>
&lt;th>Weight&lt;/th>
&lt;/tr>
&lt;/thead>
&lt;tbody>
&lt;tr>
&lt;td>Lenovo X1 Carbon (5th Gen)&lt;/td>
&lt;td>40&lt;/td>
&lt;td>112&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>10 pairs thongs&lt;/td>
&lt;td>39&lt;/td>
&lt;td>80&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>5 Underarmour Strappy&lt;/td>
&lt;td>38&lt;/td>
&lt;td>305&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>1 pair Uniqlo leggings&lt;/td>
&lt;td>37&lt;/td>
&lt;td>185&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>2 Lululemon Cool Racerback&lt;/td>
&lt;td>36&lt;/td>
&lt;td>174&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>Chargers and cables in Mini Bomber Travel Kit&lt;/td>
&lt;td>35&lt;/td>
&lt;td>665&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>The Roost Stand&lt;/td>
&lt;td>34&lt;/td>
&lt;td>170&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>ThinkPad Compact Bluetooth Keyboard with trackpoint&lt;/td>
&lt;td>33&lt;/td>
&lt;td>460&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>Seagate Backup PlusSlim&lt;/td>
&lt;td>32&lt;/td>
&lt;td>159&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>1 pair black denim shorts&lt;/td>
&lt;td>31&lt;/td>
&lt;td>197&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>2 pairs Nike Pro shorts&lt;/td>
&lt;td>30&lt;/td>
&lt;td>112&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>2 pairs Lululemon shorts&lt;/td>
&lt;td>29&lt;/td>
&lt;td>184&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>Isabella T-Strap Croc sandals&lt;/td>
&lt;td>28&lt;/td>
&lt;td>200&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>2 Underarmour HeatGear CoolSwitch tank tops&lt;/td>
&lt;td>27&lt;/td>
&lt;td>138&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>5 pairs black socks&lt;/td>
&lt;td>26&lt;/td>
&lt;td>95&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>2 pairs Injinji Women&amp;rsquo;s Run Lightweight No-Show Toe Socks&lt;/td>
&lt;td>25&lt;/td>
&lt;td>54&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>1 fancy tank top&lt;/td>
&lt;td>24&lt;/td>
&lt;td>71&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>1 light and stretchylong-sleeve shirt (Gap Fit)&lt;/td>
&lt;td>23&lt;/td>
&lt;td>147&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>Uniqlo Ultralight Down insulating jacket&lt;/td>
&lt;td>22&lt;/td>
&lt;td>235&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>Patagonia Torrentshell&lt;/td>
&lt;td>21&lt;/td>
&lt;td>301&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>Lightweight Merino Wool Buff&lt;/td>
&lt;td>20&lt;/td>
&lt;td>50&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>1 LBD (H&amp;amp;M)&lt;/td>
&lt;td>19&lt;/td>
&lt;td>174&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>Field Notes Pitch Black Memo Book Dot-Graph&lt;/td>
&lt;td>18&lt;/td>
&lt;td>68&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>Innergie PocketCell USB-C 6000mAh power bank&lt;/td>
&lt;td>17&lt;/td>
&lt;td>14&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>JBL Reflect Mini Bluetooth Sport Headphones&lt;/td>
&lt;td>13&lt;/td>
&lt;td>14&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>Oakley Latch Sunglasses&lt;/td>
&lt;td>11&lt;/td>
&lt;td>30&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>Petzl E+LITE Emergency Headlamp&lt;/td>
&lt;td>8&lt;/td>
&lt;td>27&lt;/td>
&lt;/tr>
&lt;/tbody>
&lt;/table>
&lt;p>It&amp;rsquo;s clear that the greedy algorithm is a straightforward way to quickly find a feasible solution. For small data sets, it will probably be close to the optimal solution. The algorithm packed a total item worth of 716 (104 points less than the maximum possible value), while filling the bag with just 13g left over.&lt;/p>
&lt;p>As we learned earlier, the greedy algorithm doesn&amp;rsquo;t improve upon the solution it returns. It simply adds the next highest worth item it can to the bag.&lt;/p>
&lt;p>Let&amp;rsquo;s look at another method for solving the knapsack problem that will give us the optimal solution - the highest possible total worth under the weight limit.&lt;/p>
&lt;h2 id="dynamic-programming" class="anchor-link">&lt;a href="#dynamic-programming">Dynamic programming&lt;/a>&lt;/h2>
&lt;p>The name &amp;ldquo;dynamic programming&amp;rdquo; can be a bit misleading. It&amp;rsquo;s not a style of programming, as the name might cause you to infer, but simply another approach.&lt;/p>
&lt;p>Dynamic programming differs from the straightforward greedy algorithm in a few key ways. Firstly, a dynamic programming bag packing solution enumerates the entire solution space with all possibilities of item combinations that could be used to pack our bag. Where a greedy algorithm chooses the most optimal &lt;em>local&lt;/em> solution, dynamic programming algorithms are able to find the most optimal &lt;em>global&lt;/em> solution.&lt;/p>
&lt;p>Secondly, dynamic programming uses memoization to store the results of previously computed operations and returns the cached result when the operation occurs again. This allows it to &amp;ldquo;remember&amp;rdquo; previous combinations. This takes less time than it would to re-compute the answer again.&lt;/p>
&lt;h3 id="building-our-dynamic-programming-algorithm" class="anchor-link">&lt;a href="#building-our-dynamic-programming-algorithm">Building our dynamic programming algorithm&lt;/a>&lt;/h3>
&lt;p>To use dynamic programming to find the optimal recipe for packing our bag, we&amp;rsquo;ll need to:&lt;/p>
&lt;ol>
&lt;li>Create a matrix representing all subsets of the items (the solution space) with rows representing items and columns representing the bag&amp;rsquo;s remaining weight capacity&lt;/li>
&lt;li>Loop through the matrix and calculate the worth that can be obtained by each combination of items at each stage of the bag&amp;rsquo;s capacity&lt;/li>
&lt;li>Examine the completed matrix to determine which items to add to the bag in order to produce the maximum possible worth for the bag in total&lt;/li>
&lt;/ol>
&lt;p>It will be most helpful to visualize our solution space. Here&amp;rsquo;s a representation of what we&amp;rsquo;re building with our code:&lt;/p>
&lt;figure>
&lt;img src="knapsack-matrix.jpg"
alt="A sketch of the matrix with rows for items and columns for grams of weight."/> &lt;figcaption>
&lt;p>The empty knapsackian multiverse.&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;p>In Go, we can create this matrix as a slice of slices.&lt;/p>
&lt;div class="highlight">&lt;pre class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="nx">matrix&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="nb">make&lt;/span>&lt;span class="p">([][]&lt;/span>&lt;span class="kt">int&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">numItems&lt;/span>&lt;span class="o">+&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="c1">// rows representing items
&lt;/span>&lt;span class="c1">&lt;/span>&lt;span class="k">for&lt;/span> &lt;span class="nx">i&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="k">range&lt;/span> &lt;span class="nx">matrix&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="nx">matrix&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="nx">i&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="nb">make&lt;/span>&lt;span class="p">([]&lt;/span>&lt;span class="kt">int&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">capacity&lt;/span>&lt;span class="o">+&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="c1">// columns representing grams of weight
&lt;/span>&lt;span class="c1">&lt;/span>&lt;span class="p">}&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>We&amp;rsquo;ve padded the rows and columns by &lt;code>1&lt;/code> so that the indicies match the item and weight numbers.&lt;/p>
&lt;p>Now that we&amp;rsquo;ve created our matrix, we&amp;rsquo;ll fill it by looping over the rows and the columns:&lt;/p>
&lt;div class="highlight">&lt;pre class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="c1">// loop through table rows
&lt;/span>&lt;span class="c1">&lt;/span>&lt;span class="k">for&lt;/span> &lt;span class="nx">i&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="mi">1&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="nx">i&lt;/span> &lt;span class="o">&amp;lt;=&lt;/span> &lt;span class="nx">numItems&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="nx">i&lt;/span>&lt;span class="o">++&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="c1">// loop through table columns
&lt;/span>&lt;span class="c1">&lt;/span> &lt;span class="k">for&lt;/span> &lt;span class="nx">w&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="mi">1&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="nx">w&lt;/span> &lt;span class="o">&amp;lt;=&lt;/span> &lt;span class="nx">capacity&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="nx">w&lt;/span>&lt;span class="o">++&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="c1">// do stuff in each element
&lt;/span>&lt;span class="c1">&lt;/span> &lt;span class="p">}&lt;/span>
&lt;span class="p">}&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>Then for each element, we&amp;rsquo;ll calculate the worth value to ascribe to it. We do this with code that represents the following:&lt;/p>
&lt;blockquote>
&lt;p>If the item at the index matching the current row fits within the weight capacity represented by the current column, take the maximum of either:
In other words, as our algorithm considers one of the items, we&amp;rsquo;re asking it to decide whether this item added to the bag would produce a higher total worth than the last item it added to the bag, at the bag&amp;rsquo;s current total weight. If this current item is a better choice, put it in - if not, leave it out.&lt;/p>
&lt;/blockquote>
&lt;p>Here&amp;rsquo;s the code that accomplishes this:&lt;/p>
&lt;div class="highlight">&lt;pre class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="c1">// if weight of item matching this index can fit at the current capacity column...
&lt;/span>&lt;span class="c1">&lt;/span>&lt;span class="k">if&lt;/span> &lt;span class="nx">is&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="nx">i&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">].&lt;/span>&lt;span class="nx">weight&lt;/span> &lt;span class="o">&amp;lt;=&lt;/span> &lt;span class="nx">w&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="c1">// worth of this subset without this item
&lt;/span>&lt;span class="c1">&lt;/span> &lt;span class="nx">valueOne&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="nb">float64&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">matrix&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="nx">i&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">][&lt;/span>&lt;span class="nx">w&lt;/span>&lt;span class="p">])&lt;/span>
&lt;span class="c1">// worth of this subset without the previous item, and this item instead
&lt;/span>&lt;span class="c1">&lt;/span> &lt;span class="nx">valueTwo&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="nb">float64&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">is&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="nx">i&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">].&lt;/span>&lt;span class="nx">worth&lt;/span> &lt;span class="o">+&lt;/span> &lt;span class="nx">matrix&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="nx">i&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">][&lt;/span>&lt;span class="nx">w&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="nx">is&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="nx">i&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">].&lt;/span>&lt;span class="nx">weight&lt;/span>&lt;span class="p">])&lt;/span>
&lt;span class="c1">// take maximum of either valueOne or valueTwo
&lt;/span>&lt;span class="c1">&lt;/span> &lt;span class="nx">matrix&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="nx">i&lt;/span>&lt;span class="p">][&lt;/span>&lt;span class="nx">w&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="nb">int&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">math&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Max&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">valueOne&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">valueTwo&lt;/span>&lt;span class="p">))&lt;/span>
&lt;span class="o">/&lt;/span> &lt;span class="k">if&lt;/span> &lt;span class="nx">the&lt;/span> &lt;span class="nx">new&lt;/span> &lt;span class="nx">worth&lt;/span> &lt;span class="nx">is&lt;/span> &lt;span class="nx">not&lt;/span> &lt;span class="nx">more&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">carry&lt;/span> &lt;span class="nx">over&lt;/span> &lt;span class="nx">the&lt;/span> &lt;span class="nx">previous&lt;/span> &lt;span class="nx">worth&lt;/span>
&lt;span class="k">else&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="nx">matrix&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="nx">i&lt;/span>&lt;span class="p">][&lt;/span>&lt;span class="nx">w&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="nx">matrix&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="nx">i&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">][&lt;/span>&lt;span class="nx">w&lt;/span>&lt;span class="p">]&lt;/span>
&lt;span class="s">``&lt;/span>
&lt;span class="nx">This&lt;/span> &lt;span class="nx">process&lt;/span> &lt;span class="nx">of&lt;/span> &lt;span class="nx">comparing&lt;/span> &lt;span class="nx">item&lt;/span> &lt;span class="nx">combinations&lt;/span> &lt;span class="nx">will&lt;/span> &lt;span class="k">continue&lt;/span> &lt;span class="nx">until&lt;/span> &lt;span class="nx">every&lt;/span> &lt;span class="nx">item&lt;/span> &lt;span class="nx">has&lt;/span> &lt;span class="nx">been&lt;/span> &lt;span class="nx">considered&lt;/span> &lt;span class="nx">at&lt;/span> &lt;span class="nx">every&lt;/span> &lt;span class="nx">possible&lt;/span> &lt;span class="nx">stage&lt;/span> &lt;span class="nx">of&lt;/span> &lt;span class="nx">the&lt;/span> &lt;span class="nx">bag&lt;/span>&lt;span class="err">&amp;#39;&lt;/span>&lt;span class="nx">s&lt;/span> &lt;span class="nx">increasing&lt;/span> &lt;span class="nx">total&lt;/span> &lt;span class="nx">weight&lt;/span>&lt;span class="p">.&lt;/span> &lt;span class="nx">When&lt;/span> &lt;span class="nx">all&lt;/span> &lt;span class="nx">the&lt;/span> &lt;span class="nx">above&lt;/span> &lt;span class="nx">have&lt;/span> &lt;span class="nx">been&lt;/span> &lt;span class="nx">considered&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">we&lt;/span>&lt;span class="err">&amp;#39;&lt;/span>&lt;span class="nx">ll&lt;/span> &lt;span class="nx">have&lt;/span> &lt;span class="nx">enumerated&lt;/span> &lt;span class="nx">the&lt;/span> &lt;span class="nx">solution&lt;/span> &lt;span class="nx">space&lt;/span> &lt;span class="o">-&lt;/span> &lt;span class="nx">filled&lt;/span> &lt;span class="nx">the&lt;/span> &lt;span class="nx">matrix&lt;/span> &lt;span class="o">-&lt;/span> &lt;span class="nx">with&lt;/span> &lt;span class="nx">all&lt;/span> &lt;span class="nx">possible&lt;/span> &lt;span class="nx">total&lt;/span> &lt;span class="nx">worth&lt;/span> &lt;span class="nx">values&lt;/span>&lt;span class="p">.&lt;/span>
&lt;span class="nx">We&lt;/span>&lt;span class="err">&amp;#39;&lt;/span>&lt;span class="nx">ll&lt;/span> &lt;span class="nx">have&lt;/span> &lt;span class="nx">a&lt;/span> &lt;span class="nx">big&lt;/span> &lt;span class="nx">chart&lt;/span> &lt;span class="nx">of&lt;/span> &lt;span class="nx">numbers&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">and&lt;/span> &lt;span class="nx">in&lt;/span> &lt;span class="nx">the&lt;/span> &lt;span class="nx">last&lt;/span> &lt;span class="nx">column&lt;/span> &lt;span class="nx">at&lt;/span> &lt;span class="nx">the&lt;/span> &lt;span class="nx">last&lt;/span> &lt;span class="nx">row&lt;/span> &lt;span class="nx">we&lt;/span>&lt;span class="err">&amp;#39;&lt;/span>&lt;span class="nx">ll&lt;/span> &lt;span class="nx">have&lt;/span> &lt;span class="nx">our&lt;/span> &lt;span class="nx">highest&lt;/span> &lt;span class="nx">possible&lt;/span> &lt;span class="nx">value&lt;/span>&lt;span class="p">.&lt;/span>
&lt;span class="nx">&lt;/span>
&lt;span class="nx">That&lt;/span>&lt;span class="err">&amp;#39;&lt;/span>&lt;span class="nx">s&lt;/span> &lt;span class="nx">great&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">but&lt;/span> &lt;span class="nx">how&lt;/span> &lt;span class="nx">do&lt;/span> &lt;span class="nx">we&lt;/span> &lt;span class="nx">find&lt;/span> &lt;span class="nx">out&lt;/span> &lt;span class="nx">which&lt;/span> &lt;span class="nx">combination&lt;/span> &lt;span class="nx">of&lt;/span> &lt;span class="nx">items&lt;/span> &lt;span class="nx">were&lt;/span> &lt;span class="nx">put&lt;/span> &lt;span class="nx">in&lt;/span> &lt;span class="nx">the&lt;/span> &lt;span class="nx">bag&lt;/span> &lt;span class="nx">to&lt;/span> &lt;span class="nx">achieve&lt;/span> &lt;span class="nx">that&lt;/span> &lt;span class="nx">worth&lt;/span>&lt;span class="err">?&lt;/span>
&lt;span class="err">###&lt;/span> &lt;span class="nx">Getting&lt;/span> &lt;span class="nx">our&lt;/span> &lt;span class="nx">optimized&lt;/span> &lt;span class="nx">item&lt;/span> &lt;span class="nx">list&lt;/span>
&lt;span class="nx">To&lt;/span> &lt;span class="nx">see&lt;/span> &lt;span class="nx">which&lt;/span> &lt;span class="nx">items&lt;/span> &lt;span class="nx">combine&lt;/span> &lt;span class="nx">to&lt;/span> &lt;span class="nx">create&lt;/span> &lt;span class="nx">our&lt;/span> &lt;span class="nx">optimal&lt;/span> &lt;span class="nx">packing&lt;/span> &lt;span class="nx">list&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">we&lt;/span>&lt;span class="err">&amp;#39;&lt;/span>&lt;span class="nx">ll&lt;/span> &lt;span class="nx">need&lt;/span> &lt;span class="nx">to&lt;/span> &lt;span class="nx">examine&lt;/span> &lt;span class="nx">our&lt;/span> &lt;span class="nx">matrix&lt;/span> &lt;span class="nx">in&lt;/span> &lt;span class="nx">reverse&lt;/span> &lt;span class="nx">to&lt;/span> &lt;span class="nx">the&lt;/span> &lt;span class="nx">way&lt;/span> &lt;span class="nx">we&lt;/span> &lt;span class="nx">created&lt;/span> &lt;span class="nx">it&lt;/span>&lt;span class="p">.&lt;/span> &lt;span class="nx">Since&lt;/span> &lt;span class="nx">we&lt;/span> &lt;span class="nx">know&lt;/span> &lt;span class="nx">the&lt;/span> &lt;span class="nx">highest&lt;/span> &lt;span class="nx">possible&lt;/span> &lt;span class="nx">value&lt;/span> &lt;span class="nx">is&lt;/span> &lt;span class="nx">in&lt;/span> &lt;span class="nx">the&lt;/span> &lt;span class="nx">last&lt;/span> &lt;span class="nx">row&lt;/span> &lt;span class="nx">in&lt;/span> &lt;span class="nx">the&lt;/span> &lt;span class="nx">last&lt;/span> &lt;span class="nx">column&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">we&lt;/span>&lt;span class="err">&amp;#39;&lt;/span>&lt;span class="nx">ll&lt;/span> &lt;span class="nx">start&lt;/span> &lt;span class="nx">there&lt;/span>&lt;span class="p">.&lt;/span> &lt;span class="nx">To&lt;/span> &lt;span class="nx">find&lt;/span> &lt;span class="nx">the&lt;/span> &lt;span class="nx">items&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">we&lt;/span>&lt;span class="p">:&lt;/span>
&lt;span class="mf">1.&lt;/span> &lt;span class="nx">Get&lt;/span> &lt;span class="nx">the&lt;/span> &lt;span class="nx">value&lt;/span> &lt;span class="nx">of&lt;/span> &lt;span class="nx">the&lt;/span> &lt;span class="nx">current&lt;/span> &lt;span class="nx">cell&lt;/span>
&lt;span class="mf">1.&lt;/span> &lt;span class="nx">Compare&lt;/span> &lt;span class="nx">the&lt;/span> &lt;span class="nx">value&lt;/span> &lt;span class="nx">of&lt;/span> &lt;span class="nx">the&lt;/span> &lt;span class="nx">current&lt;/span> &lt;span class="nx">cell&lt;/span> &lt;span class="nx">to&lt;/span> &lt;span class="nx">the&lt;/span> &lt;span class="nx">value&lt;/span> &lt;span class="nx">in&lt;/span> &lt;span class="nx">the&lt;/span> &lt;span class="nx">cell&lt;/span> &lt;span class="nx">directly&lt;/span> &lt;span class="nx">above&lt;/span> &lt;span class="nx">it&lt;/span>
&lt;span class="mf">1.&lt;/span> &lt;span class="nx">If&lt;/span> &lt;span class="nx">the&lt;/span> &lt;span class="nx">values&lt;/span> &lt;span class="nx">differ&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">there&lt;/span> &lt;span class="nx">was&lt;/span> &lt;span class="nx">a&lt;/span> &lt;span class="nx">change&lt;/span> &lt;span class="nx">to&lt;/span> &lt;span class="nx">the&lt;/span> &lt;span class="nx">bag&lt;/span> &lt;span class="nx">items&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="nx">find&lt;/span> &lt;span class="nx">the&lt;/span> &lt;span class="nx">next&lt;/span> &lt;span class="nx">cell&lt;/span> &lt;span class="nx">to&lt;/span> &lt;span class="nx">examine&lt;/span> &lt;span class="nx">by&lt;/span> &lt;span class="nx">moving&lt;/span> &lt;span class="nx">backwards&lt;/span> &lt;span class="nx">through&lt;/span> &lt;span class="nx">the&lt;/span> &lt;span class="nx">columns&lt;/span> &lt;span class="nx">according&lt;/span> &lt;span class="nx">to&lt;/span> &lt;span class="nx">the&lt;/span> &lt;span class="nx">current&lt;/span> &lt;span class="nx">item&lt;/span>&lt;span class="err">&amp;#39;&lt;/span>&lt;span class="nx">s&lt;/span> &lt;span class="nf">weight&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="nx">find&lt;/span> &lt;span class="nx">the&lt;/span> &lt;span class="nx">value&lt;/span> &lt;span class="nx">of&lt;/span> &lt;span class="nx">the&lt;/span> &lt;span class="nx">bag&lt;/span> &lt;span class="nx">before&lt;/span> &lt;span class="nx">this&lt;/span> &lt;span class="nx">current&lt;/span> &lt;span class="nx">item&lt;/span> &lt;span class="nx">was&lt;/span> &lt;span class="nx">added&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="mf">1.&lt;/span> &lt;span class="nx">If&lt;/span> &lt;span class="nx">the&lt;/span> &lt;span class="nx">values&lt;/span> &lt;span class="nx">match&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">there&lt;/span> &lt;span class="nx">was&lt;/span> &lt;span class="nx">no&lt;/span> &lt;span class="nx">change&lt;/span> &lt;span class="nx">to&lt;/span> &lt;span class="nx">the&lt;/span> &lt;span class="nx">bag&lt;/span> &lt;span class="nx">items&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="nx">move&lt;/span> &lt;span class="nx">up&lt;/span> &lt;span class="nx">to&lt;/span> &lt;span class="nx">the&lt;/span> &lt;span class="nx">cell&lt;/span> &lt;span class="nx">in&lt;/span> &lt;span class="nx">the&lt;/span> &lt;span class="nx">row&lt;/span> &lt;span class="nx">above&lt;/span> &lt;span class="nx">and&lt;/span> &lt;span class="nx">repeat&lt;/span>
&lt;span class="nx">The&lt;/span> &lt;span class="nx">nature&lt;/span> &lt;span class="nx">of&lt;/span> &lt;span class="nx">the&lt;/span> &lt;span class="nx">action&lt;/span> &lt;span class="nx">we&lt;/span>&lt;span class="err">&amp;#39;&lt;/span>&lt;span class="nx">re&lt;/span> &lt;span class="nx">trying&lt;/span> &lt;span class="nx">to&lt;/span> &lt;span class="nx">achieve&lt;/span> &lt;span class="nx">lends&lt;/span> &lt;span class="nx">itself&lt;/span> &lt;span class="nx">well&lt;/span> &lt;span class="nx">to&lt;/span> &lt;span class="nx">a&lt;/span> &lt;span class="nx">recursive&lt;/span> &lt;span class="nx">function&lt;/span>&lt;span class="p">.&lt;/span> &lt;span class="nx">If&lt;/span> &lt;span class="nx">you&lt;/span> &lt;span class="nx">recall&lt;/span> &lt;span class="nx">from&lt;/span> &lt;span class="p">[&lt;/span>&lt;span class="nx">my&lt;/span> &lt;span class="nx">previous&lt;/span> &lt;span class="nx">article&lt;/span> &lt;span class="nx">about&lt;/span> &lt;span class="nx">making&lt;/span> &lt;span class="nx">apple&lt;/span> &lt;span class="nx">pie&lt;/span>&lt;span class="p">](&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">blog&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">understanding&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="nx">array&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">prototype&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">reduce&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="nx">and&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="nx">recursion&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="nx">using&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="nx">apple&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="nx">pie&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="p">),&lt;/span> &lt;span class="nx">recursive&lt;/span> &lt;span class="nx">functions&lt;/span> &lt;span class="nx">are&lt;/span> &lt;span class="nx">simply&lt;/span> &lt;span class="nx">functions&lt;/span> &lt;span class="nx">that&lt;/span> &lt;span class="nx">call&lt;/span> &lt;span class="nx">themselves&lt;/span> &lt;span class="nx">under&lt;/span> &lt;span class="nx">certain&lt;/span> &lt;span class="nx">conditions&lt;/span>&lt;span class="p">.&lt;/span> &lt;span class="nx">Here&lt;/span>&lt;span class="err">&amp;#39;&lt;/span>&lt;span class="nx">s&lt;/span> &lt;span class="nx">what&lt;/span> &lt;span class="nx">it&lt;/span> &lt;span class="nx">looks&lt;/span> &lt;span class="nx">like&lt;/span>&lt;span class="p">:&lt;/span>
&lt;span class="s">```go
&lt;/span>&lt;span class="s">func checkItem(b *bag, i int, w int, is []item, matrix [][]int) {
&lt;/span>&lt;span class="s"> if i &amp;lt;= 0 || w &amp;lt;= 0 {
&lt;/span>&lt;span class="s"> return
&lt;/span>&lt;span class="s">
&lt;/span>&lt;span class="s">
&lt;/span>&lt;span class="s"> ick := matrix[i][w]
&lt;/span>&lt;span class="s"> if pick != matrix[i-1][w] {
&lt;/span>&lt;span class="s"> b.addItem(is[i-1])
&lt;/span>&lt;span class="s"> checkItem(b, i-1, w-is[i-1].weight, is, matrix)
&lt;/span>&lt;span class="s"> else {
&lt;/span>&lt;span class="s"> checkItem(b, i-1, w, is, matrix)
&lt;/span>&lt;span class="s">
&lt;/span>&lt;span class="s">
&lt;/span>&lt;span class="s"> `&lt;/span>
&lt;span class="nx">Our&lt;/span> &lt;span class="s">`checkItem()`&lt;/span> &lt;span class="nx">function&lt;/span> &lt;span class="nx">calls&lt;/span> &lt;span class="nx">itself&lt;/span> &lt;span class="k">if&lt;/span> &lt;span class="nx">the&lt;/span> &lt;span class="nx">condition&lt;/span> &lt;span class="nx">we&lt;/span> &lt;span class="nx">described&lt;/span> &lt;span class="nx">in&lt;/span> &lt;span class="nx">step&lt;/span> &lt;span class="mi">4&lt;/span> &lt;span class="nx">is&lt;/span> &lt;span class="kc">true&lt;/span>&lt;span class="p">.&lt;/span> &lt;span class="nx">If&lt;/span> &lt;span class="nx">step&lt;/span> &lt;span class="mi">3&lt;/span> &lt;span class="nx">is&lt;/span> &lt;span class="kc">true&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">it&lt;/span> &lt;span class="nx">also&lt;/span> &lt;span class="nx">calls&lt;/span> &lt;span class="nx">itself&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">but&lt;/span> &lt;span class="nx">with&lt;/span> &lt;span class="nx">different&lt;/span> &lt;span class="nx">arguments&lt;/span>&lt;span class="p">.&lt;/span>
&lt;span class="nx">Recursive&lt;/span> &lt;span class="nx">functions&lt;/span> &lt;span class="nx">require&lt;/span> &lt;span class="nx">a&lt;/span> &lt;span class="nx">base&lt;/span> &lt;span class="k">case&lt;/span>&lt;span class="p">.&lt;/span> &lt;span class="nx">In&lt;/span> &lt;span class="nx">this&lt;/span> &lt;span class="nx">example&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">we&lt;/span> &lt;span class="nx">want&lt;/span> &lt;span class="nx">the&lt;/span> &lt;span class="nx">function&lt;/span> &lt;span class="nx">to&lt;/span> &lt;span class="nx">stop&lt;/span> &lt;span class="nx">once&lt;/span> &lt;span class="nx">we&lt;/span> &lt;span class="nx">run&lt;/span> &lt;span class="nx">out&lt;/span> &lt;span class="nx">of&lt;/span> &lt;span class="nx">values&lt;/span> &lt;span class="nx">of&lt;/span> &lt;span class="nx">worth&lt;/span> &lt;span class="nx">to&lt;/span> &lt;span class="nx">compare&lt;/span>&lt;span class="p">.&lt;/span> &lt;span class="nx">Thus&lt;/span> &lt;span class="nx">our&lt;/span> &lt;span class="nx">base&lt;/span> &lt;span class="k">case&lt;/span> &lt;span class="nx">is&lt;/span> &lt;span class="nx">when&lt;/span> &lt;span class="nx">either&lt;/span> &lt;span class="s">`i`&lt;/span> &lt;span class="nx">or&lt;/span> &lt;span class="s">`w`&lt;/span> &lt;span class="nx">are&lt;/span> &lt;span class="s">`0`&lt;/span>&lt;span class="p">.&lt;/span>
&lt;span class="nx">Here&lt;/span>&lt;span class="err">&amp;#39;&lt;/span>&lt;span class="nx">s&lt;/span> &lt;span class="nx">how&lt;/span> &lt;span class="nx">the&lt;/span> &lt;span class="nx">dynamic&lt;/span> &lt;span class="nx">programming&lt;/span> &lt;span class="nx">approach&lt;/span> &lt;span class="nx">looks&lt;/span> &lt;span class="nx">when&lt;/span> &lt;span class="nx">it&lt;/span>&lt;span class="err">&amp;#39;&lt;/span>&lt;span class="nx">s&lt;/span> &lt;span class="nx">all&lt;/span> &lt;span class="nx">put&lt;/span> &lt;span class="nx">together&lt;/span>&lt;span class="p">:&lt;/span>
&lt;span class="s">```go
&lt;/span>&lt;span class="s">func checkItem(b *bag, i int, w int, is []item, matrix [][]int) {
&lt;/span>&lt;span class="s"> if i &amp;lt;= 0 || w &amp;lt;= 0 {
&lt;/span>&lt;span class="s"> return
&lt;/span>&lt;span class="s">
&lt;/span>&lt;span class="s">
&lt;/span>&lt;span class="s"> ick := matrix[i][w]
&lt;/span>&lt;span class="s"> if pick != matrix[i-1][w] {
&lt;/span>&lt;span class="s"> b.addItem(is[i-1])
&lt;/span>&lt;span class="s"> checkItem(b, i-1, w-is[i-1].weight, is, matrix)
&lt;/span>&lt;span class="s"> else {
&lt;/span>&lt;span class="s"> checkItem(b, i-1, w, is, matrix)
&lt;/span>&lt;span class="s">
&lt;/span>&lt;span class="s">
&lt;/span>&lt;span class="s">
&lt;/span>&lt;span class="s"> unc dynamic(is []item, b *bag) *bag {
&lt;/span>&lt;span class="s"> numItems := len(is) // number of items in knapsack
&lt;/span>&lt;span class="s"> capacity := b.maxItemsWeight // capacity of knapsack
&lt;/span>&lt;span class="s">
&lt;/span>&lt;span class="s"> // create the empty matrix
&lt;/span>&lt;span class="s"> matrix := make([][]int, numItems+1) // rows representing items
&lt;/span>&lt;span class="s"> for i := range matrix {
&lt;/span>&lt;span class="s"> matrix[i] = make([]int, capacity+1) // columns representing grams of weight
&lt;/span>&lt;span class="s">
&lt;/span>&lt;span class="s">
&lt;/span>&lt;span class="s"> / loop through table rows
&lt;/span>&lt;span class="s"> for i := 1; i &amp;lt;= numItems; i++ {
&lt;/span>&lt;span class="s"> // loop through table columns
&lt;/span>&lt;span class="s"> for w := 1; w &amp;lt;= capacity; w++ {
&lt;/span>&lt;span class="s">
&lt;/span>&lt;span class="s"> // if weight of item matching this index can fit at the current capacity column...
&lt;/span>&lt;span class="s"> if is[i-1].weight &amp;lt;= w {
&lt;/span>&lt;span class="s"> // worth of this subset without this item
&lt;/span>&lt;span class="s"> valueOne := float64(matrix[i-1][w])
&lt;/span>&lt;span class="s"> // worth of this subset without the previous item, and this item instead
&lt;/span>&lt;span class="s"> valueTwo := float64(is[i-1].worth + matrix[i-1][w-is[i-1].weight])
&lt;/span>&lt;span class="s"> // take maximum of either valueOne or valueTwo
&lt;/span>&lt;span class="s"> matrix[i][w] = int(math.Max(valueOne, valueTwo))
&lt;/span>&lt;span class="s"> / if the new worth is not more, carry over the previous worth
&lt;/span>&lt;span class="s"> else {
&lt;/span>&lt;span class="s"> matrix[i][w] = matrix[i-1][w]
&lt;/span>&lt;span class="s">
&lt;/span>&lt;span class="s">
&lt;/span>&lt;span class="s">
&lt;/span>&lt;span class="s">
&lt;/span>&lt;span class="s"> heckItem(b, numItems, capacity, is, matrix)
&lt;/span>&lt;span class="s">
&lt;/span>&lt;span class="s"> // add other statistics to the bag
&lt;/span>&lt;span class="s"> b.totalWorth = matrix[numItems][capacity]
&lt;/span>&lt;span class="s"> b.totalWeight = b.bagWeight + b.currItemsWeight
&lt;/span>&lt;span class="s">
&lt;/span>&lt;span class="s"> return b
&lt;/span>&lt;span class="s">
&lt;/span>&lt;span class="s"> ``
&lt;/span>&lt;span class="s">
&lt;/span>&lt;span class="s">### Dynamic programming results
&lt;/span>&lt;span class="s">
&lt;/span>&lt;span class="s">We expect that the dynamic programming approach will give us a more optimized solution than the greedy algorithm. So did it? Here are the results:
&lt;/span>&lt;span class="s">
&lt;/span>&lt;span class="s">**Total weight of bag and items:** 6982g
&lt;/span>&lt;span class="s">
&lt;/span>&lt;span class="s">**Total worth of packed items:** 757
&lt;/span>&lt;span class="s">
&lt;/span>&lt;span class="s">Here are the items our dynamic programming algorithm chose, sorted by worth:
&lt;/span>&lt;span class="s">
&lt;/span>&lt;span class="s">| Item | Worth | Weight |
&lt;/span>&lt;span class="s">| --------------------------------------------------------- | ----- | ------ |
&lt;/span>&lt;span class="s">| 10 pairs thongs | 39 | 80 |
&lt;/span>&lt;span class="s">| 5 Underarmour Strappy | 38 | 305 |
&lt;/span>&lt;span class="s">| 1 pair Uniqlo leggings | 37 | 185 |
&lt;/span>&lt;span class="s">| 2 Lululemon Cool Racerback | 36 | 174 |
&lt;/span>&lt;span class="s">| Chargers and cables in Mini Bomber Travel Kit | 35 | 665 |
&lt;/span>&lt;span class="s">| The Roost Stand | 34 | 170 |
&lt;/span>&lt;span class="s">| ThinkPad Compact Bluetooth Keyboard with trackpoint | 33 | 460 |
&lt;/span>&lt;span class="s">| Seagate Backup Plus Slim | 32 | 159 |
&lt;/span>&lt;span class="s">| 1 pair black denim shorts | 31 | 197 |
&lt;/span>&lt;span class="s">| 2 pairs Nike Pro shorts | 30 | 112 |
&lt;/span>&lt;span class="s">| 2 pairs Lululemon shorts | 29 | 184 |
&lt;/span>&lt;span class="s">| Isabella T-Strap Croc sandals | 28 | 200 |
&lt;/span>&lt;span class="s">| 2 Underarmour HeatGear CoolSwitch tank tops | 27 | 138 |
&lt;/span>&lt;span class="s">| 5 pairs black socks | 26 | 95 |
&lt;/span>&lt;span class="s">| 2 pairs Injinji Women&amp;#39;s Run Lightweight No-Show Toe Socks | 25 | 54 |
&lt;/span>&lt;span class="s">| 1 fancy tank top | 24 | 71 |
&lt;/span>&lt;span class="s">| 1 light and stretchy long-sleeve shirt (Gap Fit) | 23 | 147 |
&lt;/span>&lt;span class="s">| Uniqlo Ultralight Down insulating jacket | 22 | 235 |
&lt;/span>&lt;span class="s">| Patagonia Torrentshell | 21 | 301 |
&lt;/span>&lt;span class="s">| Lightweight Merino Wool Buff | 20 | 50 |
&lt;/span>&lt;span class="s">| 1 LBD (H&amp;amp;M) | 19 | 174 |
&lt;/span>&lt;span class="s">| Field Notes Pitch Black Memo Book Dot-Graph | 18 | 68 |
&lt;/span>&lt;span class="s">| Innergie PocketCell USB-C 6000mAh power bank | 17 | 148 |
&lt;/span>&lt;span class="s">| Important papers | 16 | 228 |
&lt;/span>&lt;span class="s">| Deuter First Aid Kit Active | 15 | 144 |
&lt;/span>&lt;span class="s">| Stanley Classic Vacuum Camp Mug 16oz | 14 | 454 |
&lt;/span>&lt;span class="s">| JBL Reflect Mini Bluetooth Sport Headphones | 13 | 14 |
&lt;/span>&lt;span class="s">| Anker SoundCore nano Bluetooth Speaker | 12 | 80 |
&lt;/span>&lt;span class="s">| Oakley Latch Sunglasses | 11 | 30 |
&lt;/span>&lt;span class="s">| Ray Ban Wayfarer Classic | 10 | 45 |
&lt;/span>&lt;span class="s">| Petzl E+LITE Emergency Headlamp | 8 | 27 |
&lt;/span>&lt;span class="s">| Peak Design Cuff Camera Wrist Strap | 6 | 26 |
&lt;/span>&lt;span class="s">| Travelon Micro Scale | 5 | 125 |
&lt;/span>&lt;span class="s">| Humangear GoBites Duo | 3 | 22 |
&lt;/span>&lt;span class="s">
&lt;/span>&lt;span class="s">There&amp;#39;s an obvious improvement to our dynamic programming solution over what the greedy algorithm gave us. Our total worth of 757 is 41 points greater than the greedy algorithm&amp;#39;s solution of 716, and for a few grams less weight too!
&lt;/span>&lt;span class="s">
&lt;/span>&lt;span class="s">### Input sort order
&lt;/span>&lt;span class="s">
&lt;/span>&lt;span class="s">While testing my dynamic programming solution, I implemented the [Fisher-Yates shuffle algorithm](https://en.wikipedia.org/wiki/Fisher%E2%80%93Yates_shuffle) on the input before passing it into my function, just to ensure that the answer wasn&amp;#39;t somehow dependent on the sort order of the input. Here&amp;#39;s what the shuffle looks like in Go:
&lt;/span>&lt;span class="s">
&lt;/span>&lt;span class="s">```&lt;/span>&lt;span class="k">go&lt;/span>
&lt;span class="nx">rand&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Seed&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">time&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Now&lt;/span>&lt;span class="p">().&lt;/span>&lt;span class="nf">UnixNano&lt;/span>&lt;span class="p">())&lt;/span>
&lt;span class="k">for&lt;/span> &lt;span class="nx">i&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="k">range&lt;/span> &lt;span class="nx">itemList&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="nx">j&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="nx">rand&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Intn&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">i&lt;/span> &lt;span class="o">+&lt;/span> &lt;span class="mi">1&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="nx">itemList&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="nx">i&lt;/span>&lt;span class="p">],&lt;/span> &lt;span class="nx">itemList&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="nx">j&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="nx">itemList&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="nx">j&lt;/span>&lt;span class="p">],&lt;/span> &lt;span class="nx">itemList&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="nx">i&lt;/span>&lt;span class="p">]&lt;/span>
&lt;span class="s">``&lt;/span>
&lt;span class="nx">Of&lt;/span> &lt;span class="nx">course&lt;/span> &lt;span class="nx">I&lt;/span> &lt;span class="nx">then&lt;/span> &lt;span class="nx">realized&lt;/span> &lt;span class="nx">that&lt;/span> &lt;span class="nx">Go&lt;/span> &lt;span class="mf">1.10&lt;/span> &lt;span class="nx">now&lt;/span> &lt;span class="nx">has&lt;/span> &lt;span class="nx">a&lt;/span> &lt;span class="nx">built&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="nx">in&lt;/span> &lt;span class="nx">shuffle&lt;/span>&lt;span class="o">...&lt;/span> &lt;span class="nx">it&lt;/span> &lt;span class="nx">works&lt;/span> &lt;span class="nx">precisely&lt;/span> &lt;span class="nx">the&lt;/span> &lt;span class="nx">same&lt;/span> &lt;span class="nx">way&lt;/span> &lt;span class="nx">and&lt;/span> &lt;span class="nx">looks&lt;/span> &lt;span class="nx">like&lt;/span> &lt;span class="nx">this&lt;/span>&lt;span class="p">:&lt;/span>
&lt;span class="s">```go
&lt;/span>&lt;span class="s">rand.Shuffle(len(itemList), func(i, j int) {
&lt;/span>&lt;span class="s"> itemList[i], itemList[j] = itemList[j], itemList[i]
&lt;/span>&lt;span class="s"> )
&lt;/span>&lt;span class="s"> ``
&lt;/span>&lt;span class="s">
&lt;/span>&lt;span class="s">So did the order in which the items were processed affect the outcome? Well...
&lt;/span>&lt;span class="s">
&lt;/span>&lt;span class="s">#### Suddenly... a rogue weight appears
&lt;/span>&lt;span class="s">
&lt;/span>&lt;span class="s">As it turns out, in a way, the answer dd depend on the order of the input. When I ran my dynamic programming algorithm several times, I sometimes saw a different total weight for the bag, though the total worth remained at 757. I initially thought this was a bug before examining the two sets of items that accompanied the two different total weight values. Everything was the same except for a few changes that collectively added up to a different item subset accounting for 14 of the 757 worth points.
&lt;/span>&lt;span class="s">
&lt;/span>&lt;span class="s">In this case, there were two equally optimal solutions based only on the success metric of the highest total possible worth. Shuffling the input seemed to affect the placement of the items in the matrix and thus, the path that the `&lt;/span>&lt;span class="nf">checkItem&lt;/span>&lt;span class="p">()&lt;/span>&lt;span class="s">` function took as it went through the matrix to find the chosen items. Since the success metric of having the highest possible worth was the same in both item sets, we don&amp;#39;t have a single unique solution - there&amp;#39;s two!
&lt;/span>&lt;span class="s">
&lt;/span>&lt;span class="s">As an academic exercise, both these sets of items are correct answers. We may choose to optimize further by another metric, say, the total weight of all the items. The highest possible worth at the least possible weight could be seen as an ideal solution.
&lt;/span>&lt;span class="s">
&lt;/span>&lt;span class="s">Here&amp;#39;s the second, lighter, dynamic programming result:
&lt;/span>&lt;span class="s">
&lt;/span>&lt;span class="s">**Total weight of bag and items:** 6955g
&lt;/span>&lt;span class="s">
&lt;/span>&lt;span class="s">**Total worth of packed items:** 757
&lt;/span>&lt;span class="s">
&lt;/span>&lt;span class="s">| Item | Worth | Weight |
&lt;/span>&lt;span class="s">| --------------------------------------------------------- | ----- | ------ |
&lt;/span>&lt;span class="s">| 10 pairs thongs | 39 | 80 |
&lt;/span>&lt;span class="s">| 5 Underarmour Strappy | 38 | 305 |
&lt;/span>&lt;span class="s">| 1 pair Uniqlo leggings | 37 | 185 |
&lt;/span>&lt;span class="s">| 2 Lululemon Cool Racerback | 36 | 174 |
&lt;/span>&lt;span class="s">| Chargers and cables in Mini Bomber Travel Kit | 35 | 665 |
&lt;/span>&lt;span class="s">| The Roost Stand | 34 | 170 |
&lt;/span>&lt;span class="s">| ThinkPad Compact Bluetooth Keyboard with trackpoint | 33 | 460 |
&lt;/span>&lt;span class="s">| Seagate Backup Plus Slim | 32 | 159 |
&lt;/span>&lt;span class="s">| 1 pair black denim shorts | 31 | 197 |
&lt;/span>&lt;span class="s">| 2 pairs Nike Pro shorts | 30 | 112 |
&lt;/span>&lt;span class="s">| 2 pairs Lululemon shorts | 29 | 184 |
&lt;/span>&lt;span class="s">| Isabella T-Strap Croc sandals | 28 | 200 |
&lt;/span>&lt;span class="s">| 2 Underarmour HeatGear CoolSwitch tank tops | 27 | 138 |
&lt;/span>&lt;span class="s">| 5 pairs black socks | 26 | 95 |
&lt;/span>&lt;span class="s">| 2 pairs Injinji Women&amp;#39;s Run Lightweight No-Show Toe Socks | 25 | 54 |
&lt;/span>&lt;span class="s">| 1 fancy tank top | 24 | 71 |
&lt;/span>&lt;span class="s">| 1 light and stretchy long-sleeve shirt (Gap Fit) | 23 | 147 |
&lt;/span>&lt;span class="s">| Uniqlo Ultralight Down insulating jacket | 22 | 235 |
&lt;/span>&lt;span class="s">| Patagonia Torrentshell | 21 | 301 |
&lt;/span>&lt;span class="s">| Lightweight Merino Wool Buff | 20 | 50 |
&lt;/span>&lt;span class="s">| 1 LBD (H&amp;amp;M) | 19 | 174 |
&lt;/span>&lt;span class="s">| Field Notes Pitch Black Memo Book Dot-Graph | 18 | 68 |
&lt;/span>&lt;span class="s">| Innergie PocketCell USB-C 6000mAh power bank | 17 | 148 |
&lt;/span>&lt;span class="s">| Important papers | 16 | 228 |
&lt;/span>&lt;span class="s">| Deuter First Aid Kit Active | 15 | 144 |
&lt;/span>&lt;span class="s">| JBL Reflect Mini Bluetooth Sport Headphones | 13 | 14 |
&lt;/span>&lt;span class="s">| Anker SoundCore nano Bluetooth Speaker | 12 | 80 |
&lt;/span>&lt;span class="s">| Oakley Latch Sunglasses | 11 | 30 |
&lt;/span>&lt;span class="s">| Ray Ban Wayfarer Classic | 10 | 45 |
&lt;/span>&lt;span class="s">| Zip bag of toiletries | 9 | 236 |
&lt;/span>&lt;span class="s">| Petzl E+LITE Emergency Headlamp | 8 | 27 |
&lt;/span>&lt;span class="s">| Peak Design Cuff Camera Wrist Strap | 6 | 26 |
&lt;/span>&lt;span class="s">| Travelon Micro Scale | 5 | 125 |
&lt;/span>&lt;span class="s">| BlitzWolf Bluetooth Tripod/Monopod | 4 | 150 |
&lt;/span>&lt;span class="s">| Humangear GoBites Duo | 3 | 22 |
&lt;/span>&lt;span class="s">| Vapur Bottle 1L | 1 | 41 |
&lt;/span>&lt;span class="s">
&lt;/span>&lt;span class="s">## Which approach is better
&lt;/span>&lt;span class="s">
&lt;/span>&lt;span class="s">### Go benchmarking
&lt;/span>&lt;span class="s">
&lt;/span>&lt;span class="s">The Go standard library&amp;#39;s `&lt;/span>&lt;span class="nx">testing&lt;/span>&lt;span class="s">` package makes it straightforward for us to [benchmark](https://golang.org/pkg/testing/#hdr-Benchmarks) these two approaches. We can find out how long it takes each algorithm to run, and how much memory each uses. Here&amp;#39;s a simple `&lt;/span>&lt;span class="nx">main_test&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="k">go&lt;/span>&lt;span class="s">` file:
&lt;/span>&lt;span class="s">
&lt;/span>&lt;span class="s">```&lt;/span>&lt;span class="k">go&lt;/span>
&lt;span class="kn">package&lt;/span> &lt;span class="nx">main&lt;/span>
&lt;span class="kn">import&lt;/span> &lt;span class="p">(&lt;/span>
&lt;span class="s">&amp;#34;testing&amp;#34;&lt;/span>
&lt;span class="nx">unc&lt;/span> &lt;span class="nf">Benchmark_greedy&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">b&lt;/span> &lt;span class="o">*&lt;/span>&lt;span class="nx">testing&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">B&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="nx">itemList&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="nf">readItems&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;objects.csv&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="k">for&lt;/span> &lt;span class="nx">i&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="nx">i&lt;/span> &lt;span class="p">&amp;lt;&lt;/span> &lt;span class="nx">b&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">N&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="nx">i&lt;/span>&lt;span class="o">++&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="nx">minaal&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="nx">bag&lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="nx">bagWeight&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="mi">1415&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">currItemsWeight&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">maxItemsWeight&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="mi">5585&lt;/span>&lt;span class="p">}&lt;/span>
&lt;span class="nf">greedy&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">itemList&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">minaal&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="nx">unc&lt;/span> &lt;span class="nf">Benchmark_dynamic&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">b&lt;/span> &lt;span class="o">*&lt;/span>&lt;span class="nx">testing&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">B&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="nx">itemList&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="nf">readItems&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;objects.csv&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="k">for&lt;/span> &lt;span class="nx">i&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="nx">i&lt;/span> &lt;span class="p">&amp;lt;&lt;/span> &lt;span class="nx">b&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">N&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="nx">i&lt;/span>&lt;span class="o">++&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="nx">minaal&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="nx">bag&lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="nx">bagWeight&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="mi">1415&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">currItemsWeight&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">maxItemsWeight&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="mi">5585&lt;/span>&lt;span class="p">}&lt;/span>
&lt;span class="nf">dynamic&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">itemList&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="o">&amp;amp;&lt;/span>&lt;span class="nx">minaal&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="s">`
&lt;/span>&lt;span class="s">
&lt;/span>&lt;span class="s">We can run `&lt;/span>&lt;span class="k">go&lt;/span> &lt;span class="nx">test&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="nx">bench&lt;/span>&lt;span class="p">=.&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="nx">benchmem&lt;/span>&lt;span class="s">` to see these results:
&lt;/span>&lt;span class="s">
&lt;/span>&lt;span class="s">```&lt;/span>&lt;span class="nx">sh&lt;/span>
&lt;span class="nx">Benchmark_greedy&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">4&lt;/span> &lt;span class="mi">1000000&lt;/span> &lt;span class="mi">1619&lt;/span> &lt;span class="nx">ns&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">op&lt;/span> &lt;span class="mi">2128&lt;/span> &lt;span class="nx">B&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">op&lt;/span> &lt;span class="mi">9&lt;/span> &lt;span class="nx">allocs&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">op&lt;/span>
&lt;span class="nx">Benchmark_dynamic&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">4&lt;/span> &lt;span class="mi">1000&lt;/span> &lt;span class="mi">1545322&lt;/span> &lt;span class="nx">ns&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">op&lt;/span> &lt;span class="mi">2020332&lt;/span> &lt;span class="nx">B&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">op&lt;/span> &lt;span class="mi">49&lt;/span> &lt;span class="nx">allocs&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="nx">op&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>
&lt;h4 id="greedy-algorithm-performance" class="anchor-link">&lt;a href="#greedy-algorithm-performance">Greedy algorithm performance&lt;/a>&lt;/h4>
&lt;p>After running the greedy algorithm 1,000,000 times, the speed of the algorithm was reliably measured to be 0.001619 milliseconds (translation: very fast). It required 2128 Bytes or 2-ish kilobytes of memory and 9 distinct memory allocations per iteration.&lt;/p>
&lt;h4 id="dynamic-programming-performance" class="anchor-link">&lt;a href="#dynamic-programming-performance">Dynamic programming performance&lt;/a>&lt;/h4>
&lt;p>The dynamic programming algorithm was run 1,000 times. Its speed was measured to be 1.545322 milliseconds or 0.001545322 seconds (translation: still pretty fast). It required 2,020,332 Bytes or 2-ish Megabytes, and 49 distinct memory allocations per iteration.&lt;/p>
&lt;h3 id="the-verdict" class="anchor-link">&lt;a href="#the-verdict">The verdict&lt;/a>&lt;/h3>
&lt;p>Part of choosing the right approach to solving any programming problem is taking into account the size of the input data set. In this case, it&amp;rsquo;s a small one. In this scenario, a one-pass greedy algorithm will always be faster and less resource-needy than dynamic programming, simply because it has fewer steps. Our greedy algorithm was almost two orders of magnitude faster and less memory-hungry than our dynamic programming algorithm.&lt;/p>
&lt;p>Not having those extra steps, however, means that getting the best possible solution from the greedy algorithm is unlikely.&lt;/p>
&lt;p>It&amp;rsquo;s clear that the dynamic programming algorithm gave us better numbers: a lower weight, and higher overall worth.&lt;/p>
&lt;table>
&lt;thead>
&lt;tr>
&lt;th>&lt;/th>
&lt;th>Greedy algorithm&lt;/th>
&lt;th>Dynamic programming&lt;/th>
&lt;/tr>
&lt;/thead>
&lt;tbody>
&lt;tr>
&lt;td>&lt;strong>Total weight:&lt;/strong>&lt;/td>
&lt;td>6987g&lt;/td>
&lt;td>6955g&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;strong>Total worth:&lt;/strong>&lt;/td>
&lt;td>716&lt;/td>
&lt;td>757&lt;/td>
&lt;/tr>
&lt;/tbody>
&lt;/table>
&lt;p>Where dynamic programming on small data sets lacks in performance, it makes up in optimization. The question then becomes whether that additional optimization is worth the performance cost.&lt;/p>
&lt;p>&amp;ldquo;Better,&amp;rdquo; of course, is a subjective judgement. If speed and low resource usage is our success metric, then the greedy algorithm is clearly better. If the total worth of items in the bag is our success metric, then dynamic programming is clearly better. However, our scenario is a practical one, and only one of these algorithm designs returned an answer I&amp;rsquo;d choose. In optimizing for the overall greatest possible total worth of the items in the bag, the dynamic programming algorithm left out my highest-worth, but also heaviest, item: my laptop. The chargers and cables, Roost stand, and keyboard that were included aren&amp;rsquo;t much use without it.&lt;/p>
&lt;h3 id="better-algorithm-design" class="anchor-link">&lt;a href="#better-algorithm-design">Better algorithm design&lt;/a>&lt;/h3>
&lt;p>There&amp;rsquo;s a simple way to alter the dynamic programming approach so that the laptop is always included: we can modify the data so that the worth of the laptop is greater than the sum of the worth of all the other items. (Try it out!)&lt;/p>
&lt;p>Perhaps in re-designing the dynamic programming algorithm to be more practical, we might choose another success metric that better reflects an item&amp;rsquo;s importance, instead of a subjective worth value. There are many possible metrics we can use to represent the value of an item. Here are a few examples of a good proxy:&lt;/p>
&lt;ul>
&lt;li>Amount of time spent using the item&lt;/li>
&lt;li>Initial cost of purchasing the item&lt;/li>
&lt;li>Cost of replacement if the item were lost today&lt;/li>
&lt;li>Dollar value of the product of using the item&lt;/li>
&lt;/ul>
&lt;p>By the same token, the greedy algorithm&amp;rsquo;s results might be improved with the use of one of these alternate metrics.&lt;/p>
&lt;p>On top of choosing an appropriate approach to solving the knapsack problem in general, it is helpful to design our algorithm in a way that translates the practicalities of a scenario into code.&lt;/p>
&lt;p>There are many considerations for better algorithm design beyond the scope of this introductory post. One of these is &lt;strong>time complexity&lt;/strong>, and I&amp;rsquo;ve &lt;a href="https://victoria.dev/blog/a-coffee-break-introduction-to-time-complexity-of-algorithms/">written about it here&lt;/a>. A future algorithm may very well decide my bag&amp;rsquo;s contents on the next trip, but we&amp;rsquo;re not quite there yet. Stay tuned!&lt;/p></content:encoded><enclosure url="https://victoria.dev/blog/knapsack-problem-algorithms-for-my-real-life-carry-on-knapsack/cover_knapsack-doodle_hu7070e09a25cc0b4f24775e27e4fe15a9_203336_640x0_resize_box_2.png" type="image/jpg"/></item><item><title>Why I'm automatically deleting my old tweets using AWS Lambda</title><link>https://victoria.dev/blog/why-im-automatically-deleting-my-old-tweets-using-aws-lambda/</link><pubDate>Thu, 12 Apr 2018 10:51:15 -0500</pubDate><author>hello@victoria.dev (Victoria Drake)</author><guid>https://victoria.dev/blog/why-im-automatically-deleting-my-old-tweets-using-aws-lambda/</guid><description>From now on, my tweets are ephemeral. Heres why Im deleting all my old tweets, and the AWS Lambda function Im using to do all this for free.</description><content:encoded>
&lt;img src="https://victoria.dev/blog/why-im-automatically-deleting-my-old-tweets-using-aws-lambda/ephemeral_hu7a60cd7f63e776114f0719c46b26bd2e_46291_640x0_resize_q75_box.jpg" width="640" height="320"/>
&lt;p>From now on, my tweets are ephemeral. Heres why Im deleting all my old tweets, and the AWS Lambda function Im using to do all this for free.&lt;/p>
&lt;p>&lt;a href="https://victoria.dev/blog/why-im-automatically-deleting-my-old-tweets-using-aws-lambda/#ephemeral-tweets">&lt;em>Click here to skip to the code part.&lt;/em>&lt;/a>&lt;/p>
&lt;h2 id="stuff-and-opinions" class="anchor-link">&lt;a href="#stuff-and-opinions">Stuff and opinions&lt;/a>&lt;/h2>
&lt;p>I&amp;rsquo;ve only been a one-bag nomad for a little over a year and a half. Before that, I lived as most people do in an apartment or a house. I owned furniture, more clothing than I strictly needed, and enough &amp;ldquo;stuff&amp;rdquo; to fill at least a few moving boxes. If I went to live somewhere else, moving for school or family or work, I packed up all my things and brought them with me. Over the years, I accumulated more and more stuff.&lt;/p>
&lt;p>Adopting what many would call a minimalist lifestyle has rapidly changed a lot of my longstanding views. Giving away all my stuff (an idea I once thought to be interesting in principle but practically a little bit ridiculous) has become normal. It&amp;rsquo;s normal for me, now, to not own things that I don&amp;rsquo;t use on a regular basis. I don&amp;rsquo;t keep wall shelves packed with old books or dishes or clothing or childhood toys because those items aren&amp;rsquo;t relevant to me anymore. I just keep fond memories, instead.&lt;/p>
&lt;p>Imagine, for a moment, that I still lived in a house. Imagine that in that house, on the fridge, is a drawing I made when I was six-years-old. In the bottom right corner of that drawing scribbled in green crayon are the words &amp;ldquo;broccoli is dumb - Victoria, Age 6.&amp;rdquo;&lt;/p>
&lt;p>If you were in my house and saw that drawing on the fridge, would you assume that the statement &amp;ldquo;broccoli is dumb&amp;rdquo; comprised an accurate and current account of my opinions on broccoli? Of course not. I was six when I wrote that. I&amp;rsquo;ve had plenty of time to change my mind.&lt;/p>
&lt;h2 id="social-media-isnt-social" class="anchor-link">&lt;a href="#social-media-isnt-social">Social media isn&amp;rsquo;t social&lt;/a>&lt;/h2>
&lt;p>I have a friend whom I&amp;rsquo;ve known since we were both in kindergarten. We went through grade school together, then spoke to and saw each other on infrequent occasions across the years. We&amp;rsquo;re both adults now. Sometimes when we chat, we&amp;rsquo;ll recall some amusing memory from when we were younger. The nature of memory being what it is, I have no illusion that what we recall is recounted with much accuracy. Our impressions of things that happened - mistakes we made and moments of victory alike - are coloured by the experiences we&amp;rsquo;ve had since then, and all the things we&amp;rsquo;ve learned. An awkward moment at a school colleague&amp;rsquo;s birthday party becomes an example of a child learning to socialize, instead of the world-ending moment of embarrassment it probably felt like at the time.&lt;/p>
&lt;p>This is how memory works. In a sense, it gets updated, as well it should. People living in small communities remember things that their neighbour did many years ago, but recall them in the context of who their neighbour is now, and what their current relationship is like. This re-colouring of history is an important part of how people &lt;a href="https://www.smithsonianmag.com/science-nature/how-our-brains-make-memories-14466850/">heal&lt;/a>, &lt;a href="http://news.feinberg.northwestern.edu/2014/02/memory_rewrite/">make good decisions&lt;/a>, and &lt;a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC3709095/">socialize&lt;/a>.&lt;/p>
&lt;p>Social media does not do this. Your perfectly preserved tweet from five days or five years ago can be recalled with absolute accuracy. For most people, this is not particularly worrying. We tend to tweet about pretty mundane things - things that pop into mind when we&amp;rsquo;re bored and want someone to notice us. Individually, usually, our old tweets are pretty insignificant. In aggregate, however, they paint a pretty complete picture of a person&amp;rsquo;s random, unintentionally telling thoughts. This is the problem.&lt;/p>
&lt;p>The assumption made of things written in social media and on Twitter specifically is a very different assumption than you might make about someone&amp;rsquo;s notepad scribble from last week. I&amp;rsquo;m not endeavoring to speculate why - I&amp;rsquo;ve just seen enough cases of someone getting publicly flogged for something they posted years ago to know that it does happen. This is weird. If you wouldn&amp;rsquo;t assume that a notepad scribble from last week or a crayon drawing from decades ago reflects the essence of who someone is &lt;em>now,&lt;/em> why would you assume that an old tweet does?&lt;/p>
&lt;p>You are not the same person you were last month - you&amp;rsquo;ve seen things, read things, understood and learned things that have, in some small way, changed you. While a person may have the same sense of self and identity through most of their life, even this grows and changes over the years. We change our opinions, our desires, our habits. We are not stagnant beings, and we should not let ourselves be represented as such, however unintentionally.&lt;/p>
&lt;h2 id="ephemeral-tweets" class="anchor-link">&lt;a href="#ephemeral-tweets">Ephemeral tweets&lt;/a>&lt;/h2>
&lt;p>If you look at my Twitter profile page today, you&amp;rsquo;ll see fewer tweets there than you have fingers (I hope). I&amp;rsquo;m using &lt;a href="https://github.com/victoriadrake/ephemeral">ephemeral&lt;/a> - a lightweight utility I wrote for use on &lt;a href="https://aws.amazon.com/lambda/">AWS Lambda&lt;/a> - to delete all my tweets older than a few days. I&amp;rsquo;m doing this for the same reason that I don&amp;rsquo;t hang on to stuff that I no longer use - that stuff isn&amp;rsquo;t relevant to me anymore. It doesn&amp;rsquo;t represent me, either.&lt;/p>
&lt;p>The code that makes up ephemeral is written in Go. AWS Lambda creates an environment for each Lambda function, so ephemeral utilizes environment variables for your private Twitter API keys and the maximum age of the tweets you want to keep, represented in hours, like &lt;code>72h&lt;/code>.&lt;/p>
&lt;div class="highlight">&lt;pre class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="kd">var&lt;/span> &lt;span class="p">(&lt;/span>
&lt;span class="nx">consumerKey&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="nf">getenv&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;TWITTER_CONSUMER_KEY&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="nx">consumerSecret&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="nf">getenv&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;TWITTER_CONSUMER_SECRET&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="nx">accessToken&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="nf">getenv&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;TWITTER_ACCESS_TOKEN&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="nx">accessTokenSecret&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="nf">getenv&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;TWITTER_ACCESS_TOKEN_SECRET&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="nx">maxTweetAge&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="nf">getenv&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;MAX_TWEET_AGE&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="nx">logger&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="nx">log&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">New&lt;/span>&lt;span class="p">()&lt;/span>
&lt;span class="p">)&lt;/span>
&lt;span class="kd">func&lt;/span> &lt;span class="nf">getenv&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">name&lt;/span> &lt;span class="kt">string&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="kt">string&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="nx">v&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="nx">os&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Getenv&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">name&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="k">if&lt;/span> &lt;span class="nx">v&lt;/span> &lt;span class="o">==&lt;/span> &lt;span class="s">&amp;#34;&amp;#34;&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="nb">panic&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;missing required environment variable &amp;#34;&lt;/span> &lt;span class="o">+&lt;/span> &lt;span class="nx">name&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="p">}&lt;/span>
&lt;span class="k">return&lt;/span> &lt;span class="nx">v&lt;/span>
&lt;span class="p">}&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>The program uses the &lt;a href="https://github.com/ChimeraCoder/anaconda">anaconda&lt;/a> library. It fetches your timeline up to the Twitter API&amp;rsquo;s limit of 200 tweets per request, then compares each tweet&amp;rsquo;s date of creation to your &lt;code>MAX_TWEET_AGE&lt;/code> variable to decide whether it&amp;rsquo;s old enough to be deleted. After deleting all the expired tweets, the Lambda function terminates.&lt;/p>
&lt;div class="highlight">&lt;pre class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="kd">func&lt;/span> &lt;span class="nf">deleteFromTimeline&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">api&lt;/span> &lt;span class="o">*&lt;/span>&lt;span class="nx">anaconda&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">TwitterApi&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">ageLimit&lt;/span> &lt;span class="nx">time&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">Duration&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="nx">timeline&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">err&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="nf">getTimeline&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">api&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="k">if&lt;/span> &lt;span class="nx">err&lt;/span> &lt;span class="o">!=&lt;/span> &lt;span class="kc">nil&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="nx">log&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Error&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;Could not get timeline&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="p">}&lt;/span>
&lt;span class="k">for&lt;/span> &lt;span class="nx">_&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">t&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="k">range&lt;/span> &lt;span class="nx">timeline&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="nx">createdTime&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">err&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="nx">t&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">CreatedAtTime&lt;/span>&lt;span class="p">()&lt;/span>
&lt;span class="k">if&lt;/span> &lt;span class="nx">err&lt;/span> &lt;span class="o">!=&lt;/span> &lt;span class="kc">nil&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="nx">log&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Error&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;Couldn&amp;#39;t parse time &amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">err&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="p">}&lt;/span> &lt;span class="k">else&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="k">if&lt;/span> &lt;span class="nx">time&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Since&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">createdTime&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">&amp;gt;&lt;/span> &lt;span class="nx">ageLimit&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="nx">_&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">err&lt;/span> &lt;span class="o">:=&lt;/span> &lt;span class="nx">api&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">DeleteTweet&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">t&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">Id&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="kc">true&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="nx">log&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Info&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;DELETED: Age - &amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">time&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Since&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">createdTime&lt;/span>&lt;span class="p">).&lt;/span>&lt;span class="nf">Round&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="o">*&lt;/span>&lt;span class="nx">time&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">Minute&lt;/span>&lt;span class="p">),&lt;/span> &lt;span class="s">&amp;#34; - &amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">t&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">Text&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="k">if&lt;/span> &lt;span class="nx">err&lt;/span> &lt;span class="o">!=&lt;/span> &lt;span class="kc">nil&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="nx">log&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Error&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;Failed to delete! &amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">err&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="p">}&lt;/span>
&lt;span class="p">}&lt;/span>
&lt;span class="p">}&lt;/span>
&lt;span class="p">}&lt;/span>
&lt;span class="nx">log&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Info&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;No more tweets to delete.&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="p">}&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>Read the full code &lt;a href="https://github.com/victoriadrake/ephemeral/blob/master/main.go">here&lt;/a>.&lt;/p>
&lt;p>For a use case like this, AWS Lambda has a free tier that costs nothing. If you&amp;rsquo;re any level of developer, it&amp;rsquo;s an extremely useful tool to become familiar with. For a full walkthrough with screenshots of how to set up a Lambda function that tweets for you, you can read &lt;a href="https://victoria.dev/blog/running-a-free-twitter-bot-on-aws-lambda/">this article&lt;/a>. The set up for ephemeral is the same, it just has an opposite function. :)&lt;/p>
&lt;p>I forked ephemeral from Adam Drake&amp;rsquo;s &lt;a href="https://github.com/adamdrake/harold">Harold&lt;/a>, a Twitter tool that has many useful functions beyond keeping your timeline trimmed. If you have more than 200 tweets to delete at first pass, please use Harold to do that first. You can run Harold with the &lt;code>deletetimeline&lt;/code> flag from your terminal.&lt;/p>
&lt;p>You may like to first &lt;a href="https://twitter.com/settings/your_twitter_data">download all your tweets before deleting them&lt;/a> for sentimental value.&lt;/p>
&lt;h2 id="why-use-twitter-at-all" class="anchor-link">&lt;a href="#why-use-twitter-at-all">Why use Twitter at all&lt;/a>&lt;/h2>
&lt;p>In anticipation of the question, let me say that yes, I do use Twitter besides just as a bucket for my Lambda functions to fill and empty. It has its benefits, most related to what I perceive to be its original intended purpose: to be a means of near-instant communication for short, digestible pieces of information reaching a widespread pool of people.&lt;/p>
&lt;p>I use it as a way to keep tabs on what&amp;rsquo;s happening &lt;em>right now.&lt;/em> I use it to comment on, joke about, and commiserate with things tweeted by the people I follow &lt;em>right now.&lt;/em> By keeping my timeline restricted to only the most recent few days, I feel like I&amp;rsquo;m using Twitter more like it was meant to be used: a way to join the conversation and see what&amp;rsquo;s happening in the world &lt;em>right now&lt;/em> - instead of just another place to amass more &amp;ldquo;stuff.&amp;rdquo;&lt;/p></content:encoded><enclosure url="https://victoria.dev/blog/why-im-automatically-deleting-my-old-tweets-using-aws-lambda/ephemeral_hu7a60cd7f63e776114f0719c46b26bd2e_46291_640x0_resize_q75_box.jpg" type="image/jpg"/></item><item><title>Running a free Twitter bot on AWS Lambda</title><link>https://victoria.dev/blog/running-a-free-twitter-bot-on-aws-lambda/</link><pubDate>Mon, 05 Mar 2018 10:29:15 -0500</pubDate><author>hello@victoria.dev (Victoria Drake)</author><guid>https://victoria.dev/blog/running-a-free-twitter-bot-on-aws-lambda/</guid><description>How to save some time with automated link sharing on Twitter - for free!</description><content:encoded>
&lt;img src="https://victoria.dev/blog/running-a-free-twitter-bot-on-aws-lambda/cover_lambda-doodle_hucb9f83d1ec58f009806cb9ad01277199_85268_640x0_resize_box_2.png" width="640" height="320"/>
&lt;p>If you read &lt;a href="https://victoria.dev/blog/about-time/">About time&lt;/a>, you&amp;rsquo;ll know that I&amp;rsquo;m a big believer in spending time now on building things that save time in the future. To this end I built a simple Twitter bot in Go that would occasionally post links to my articles and keep my account interesting even when I&amp;rsquo;m too busy to use it. The tweets help drive traffic to my sites, and I don&amp;rsquo;t have to lift a finger.&lt;/p>
&lt;p>I ran the bot on an Amazon EC2 instance for about a month. My AWS usage has historically been pretty inexpensive (less than the price of a coffee in most of North America), so I was surprised when the little instance I was using racked up a bill 90% bigger than the month before. I don&amp;rsquo;t think AWS is expensive, to be clear, but still&amp;hellip; I&amp;rsquo;m cheap. I want my Twitter bot, and I want it for less.&lt;/p>
&lt;p>I&amp;rsquo;d been meaning to explore AWS Lamda, and figured this was a good opportunity. Unlike an EC2 instance that is constantly running (and charging you for it), Lambda charges you per request and according to the duration of time your function takes to run. There&amp;rsquo;s a free tier, too, and the first 1 million requests, plus a certain amount of compute time, are free. Roughly translated to running a Twitter bot that posts for you, say, twice a day, your monthly cost for using Lambda would total&amp;hellip; carry the one&amp;hellip; nothing. I&amp;rsquo;ve been running my Lambda function for a couple weeks now, completely free.&lt;/p>
&lt;p>When recently it came to me to take the reigns of the &lt;a href="https://twitter.com/freeCodeCampTO">@freeCodeCampTO&lt;/a> Twitter, I decided to employ a similar strategy, and also use this opportunity to document the process for you, dear reader.&lt;/p>
&lt;p>So if you&amp;rsquo;re currently using a full-time running instance for a task that could be served by a cron job, this is the article for you. I&amp;rsquo;ll cover how to write your function for Lambda, how to get it set up to run automatically, and as a sweet little bonus, a handy bash script that updates your function from the command line whenever you need to make a change. Let&amp;rsquo;s do it!&lt;/p>
&lt;h2 id="is-lambda-right-for-you" class="anchor-link">&lt;a href="#is-lambda-right-for-you">Is Lambda right for you&lt;/a>&lt;/h2>
&lt;p>When I wrote the code for my Twitter bot in Go, I intended to have it run on an AWS instance and borrowed heavily from &lt;a href="https://github.com/campoy/justforfunc/tree/master/14-twitterbot">Francesc&amp;rsquo;s awesome Just for Func episode&lt;/a>. Some time later I modified it to randomly choose an article from my RSS feeds and tweet the link, twice a day. I wanted to do something similar for the @freeCodeCampTO bot, and have it tweet an inspiring quote about programming every morning.&lt;/p>
&lt;p>This is a good use case for Lambda because:&lt;/p>
&lt;ul>
&lt;li>The program should execute once&lt;/li>
&lt;li>It runs on a regular schedule, using time as a trigger&lt;/li>
&lt;li>It doesn&amp;rsquo;t need to run constantly&lt;/li>
&lt;/ul>
&lt;p>The important thing to keep in mind is that Lambda runs a function once in response to an event that you define. The most widely applicable trigger is a simple cron expression, but there are many other trigger events you can hook up. You can get an overview &lt;a href="https://aws.amazon.com/lambda/">here&lt;/a>.&lt;/p>
&lt;h2 id="write-a-lambda-function" class="anchor-link">&lt;a href="#write-a-lambda-function">Write a Lambda function&lt;/a>&lt;/h2>
&lt;p>I found this really straightforward to do in Go. First, grab the &lt;a href="https://github.com/aws/aws-lambda-go">aws-lambda-go&lt;/a> library:&lt;/p>
&lt;div class="highlight">&lt;pre class="chroma">&lt;code class="language-bash" data-lang="bash">go get github.com/aws/aws-lambda-go/lambda
&lt;/code>&lt;/pre>&lt;/div>&lt;p>Then make this your &lt;code>func main()&lt;/code>:&lt;/p>
&lt;div class="highlight">&lt;pre class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="kd">func&lt;/span> &lt;span class="nf">main&lt;/span>&lt;span class="p">()&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="nx">lambda&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">Start&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">tweetFeed&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="p">}&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>Where &lt;code>tweetFeed&lt;/code> is the name of the function that makes everything happen. While I won&amp;rsquo;t go into writing the whole Twitter bot here, you can view my code &lt;a href="https://gist.github.com/victoriadrake/7859dab68df87e28f40d6715d08383c7">on GitHub&lt;/a>.&lt;/p>
&lt;h2 id="setting-up-aws-lambda" class="anchor-link">&lt;a href="#setting-up-aws-lambda">Setting up AWS Lambda&lt;/a>&lt;/h2>
&lt;p>I&amp;rsquo;m assuming you already have an AWS account. If not, first things first here: &lt;a href="https://aws.amazon.com/free">https://aws.amazon.com/free&lt;/a>&lt;/p>
&lt;h3 id="1-create-your-function" class="anchor-link">&lt;a href="#1-create-your-function">1. Create your function&lt;/a>&lt;/h3>
&lt;p>Find AWS Lambda in the list of services, then look for this shiny button:&lt;/p>
&lt;p>
&lt;img src="https://victoria.dev/blog/running-a-free-twitter-bot-on-aws-lambda/lambda-01.png#screenshot" alt="Create function" />
&lt;/p>
&lt;p>We&amp;rsquo;re going to author a function from scratch. Name your function, then under &lt;strong>Runtime&lt;/strong> choose &amp;ldquo;Go 1.x&amp;rdquo;.&lt;/p>
&lt;p>Under &lt;strong>Role name&lt;/strong> write any name you like. It&amp;rsquo;s a required field but irrelevant for this use case.&lt;/p>
&lt;p>Click &lt;strong>Create function.&lt;/strong>&lt;/p>
&lt;p>
&lt;img src="https://victoria.dev/blog/running-a-free-twitter-bot-on-aws-lambda/lambda-02.png#screenshot" alt="Author from scratch" />
&lt;/p>
&lt;h3 id="2-configure-your-function" class="anchor-link">&lt;a href="#2-configure-your-function">2. Configure your function&lt;/a>&lt;/h3>
&lt;p>You&amp;rsquo;ll see a screen for configuring your new function. Under &lt;strong>Handler&lt;/strong> enter the name of your Go program.&lt;/p>
&lt;p>
&lt;img src="https://victoria.dev/blog/running-a-free-twitter-bot-on-aws-lambda/lambda-03.png#screenshot" alt="Configure your function" />
&lt;/p>
&lt;p>If you scroll down, you&amp;rsquo;ll see a spot to enter environment variables. This is a great place to enter the Twitter API tokens and secrets, using the variable names that your program expects. The AWS Lambda function will create the environment for you using the variables you provide here.&lt;/p>
&lt;p>
&lt;img src="https://victoria.dev/blog/running-a-free-twitter-bot-on-aws-lambda/lambda-04.png#screenshot" alt="Environment variables" />
&lt;/p>
&lt;p>No further settings are necessary for this use case. Click &lt;strong>Save&lt;/strong> at the top of the page.&lt;/p>
&lt;h3 id="3-upload-your-code" class="anchor-link">&lt;a href="#3-upload-your-code">3. Upload your code&lt;/a>&lt;/h3>
&lt;p>You can upload your function code as a zip file on the configuration screen. Since we&amp;rsquo;re using Go, you&amp;rsquo;ll want to &lt;code>go build&lt;/code> first, then zip the resulting executable before uploading that to Lambda.&lt;/p>
&lt;p>&amp;hellip;Of course I&amp;rsquo;m not going to do that manually every time I want to tweak my function. That&amp;rsquo;s what &lt;code>awscli&lt;/code> and this bash script is for!&lt;/p>
&lt;p>&lt;code>update.sh&lt;/code>&lt;/p>
&lt;div class="highlight">&lt;pre class="chroma">&lt;code class="language-sh" data-lang="sh">go build &lt;span class="o">&amp;amp;&amp;amp;&lt;/span> &lt;span class="se">\
&lt;/span>&lt;span class="se">&lt;/span>zip fcc-tweet.zip fcc-tweet &lt;span class="o">&amp;amp;&amp;amp;&lt;/span> &lt;span class="se">\
&lt;/span>&lt;span class="se">&lt;/span>rm fcc-tweet &lt;span class="o">&amp;amp;&amp;amp;&lt;/span> &lt;span class="se">\
&lt;/span>&lt;span class="se">&lt;/span>aws lambda update-function-code --function-name fcc-tweet --zip-file fileb://fcc-tweet.zip &lt;span class="o">&amp;amp;&amp;amp;&lt;/span> &lt;span class="se">\
&lt;/span>&lt;span class="se">&lt;/span>rm fcc-tweet.zip
&lt;/code>&lt;/pre>&lt;/div>&lt;p>Now whenever I make a tweak, I just run &lt;code>bash update.sh&lt;/code>.&lt;/p>
&lt;p>If you&amp;rsquo;re not already using &lt;a href="https://aws.amazon.com/cli/">AWS Command Line Interface&lt;/a>, do &lt;code>pip install awscli&lt;/code> and thank me later. Find instructions for getting set up and configured in a few minutes &lt;a href="https://docs.aws.amazon.com/cli/latest/userguide/cli-chap-getting-started.html">here&lt;/a> under &lt;strong>Quick Configuration&lt;/strong>.&lt;/p>
&lt;h3 id="4-test-your-function" class="anchor-link">&lt;a href="#4-test-your-function">4. Test your function&lt;/a>&lt;/h3>
&lt;p>Wanna see it go? Of course you do! Click &amp;ldquo;Configure test events&amp;rdquo; in the dropdown at the top.&lt;/p>
&lt;p>
&lt;img src="https://victoria.dev/blog/running-a-free-twitter-bot-on-aws-lambda/lambda-05.png#screenshot" alt="Configure test events" />
&lt;/p>
&lt;p>Since you&amp;rsquo;ll use a time-based trigger for this function, you don&amp;rsquo;t need to enter any code to define test events in the popup window. Simply write any name under &lt;strong>Event name&lt;/strong> and empty the JSON in the field below. Then click &lt;strong>Create&lt;/strong>.&lt;/p>
&lt;p>
&lt;img src="https://victoria.dev/blog/running-a-free-twitter-bot-on-aws-lambda/lambda-06.png#screenshot" alt="Configuring an empty test event" />
&lt;/p>
&lt;p>Click &lt;strong>Test&lt;/strong> at the top of the page, and if everything is working correctly you should see&amp;hellip;&lt;/p>
&lt;p>
&lt;img src="https://victoria.dev/blog/running-a-free-twitter-bot-on-aws-lambda/lambda-07.png#screenshot" alt="Test success notification" />
&lt;/p>
&lt;h3 id="5-set-up-cloudwatch-events" class="anchor-link">&lt;a href="#5-set-up-cloudwatch-events">5. Set up CloudWatch Events&lt;/a>&lt;/h3>
&lt;p>To run our function as we would a cron job - as a regularly scheduled time-based event - we&amp;rsquo;ll use CloudWatch. Click &lt;strong>CloudWatch Events&lt;/strong> in the &lt;strong>Designer&lt;/strong> sidebar.&lt;/p>
&lt;p>
&lt;img src="https://victoria.dev/blog/running-a-free-twitter-bot-on-aws-lambda/lambda-08.png#screenshot" alt="CloudWatch Events trigger" />
&lt;/p>
&lt;p>Under &lt;strong>Configure triggers&lt;/strong>, you&amp;rsquo;ll create a new rule. Choose a descriptive name for your rule without spaces or punctuation, and ensure &lt;strong>Schedule expression&lt;/strong> is selected. Then input the time you want your program to run as a &lt;em>rate expression&lt;/em>, or cron expression.&lt;/p>
&lt;p>A cron expression looks like this: &lt;code>cron(0 12 * * ? *)&lt;/code>&lt;/p>
&lt;table>
&lt;thead>
&lt;tr>
&lt;th>Minutes&lt;/th>
&lt;th>Hours&lt;/th>
&lt;th>Month&lt;/th>
&lt;th>Day of week&lt;/th>
&lt;th>Year&lt;/th>
&lt;th>In English&lt;/th>
&lt;/tr>
&lt;/thead>
&lt;tbody>
&lt;tr>
&lt;td>0&lt;/td>
&lt;td>12&lt;/td>
&lt;td>&lt;code>*&lt;/code>&lt;/td>
&lt;td>?&lt;/td>
&lt;td>&lt;code>*&lt;/code>&lt;/td>
&lt;td>Run at noon (UTC) every day&lt;/td>
&lt;/tr>
&lt;/tbody>
&lt;/table>
&lt;p>For more on how to write your cron expressions, read &lt;a href="https://docs.aws.amazon.com/AmazonCloudWatch/latest/events/ScheduledEvents.html">this.&lt;/a>&lt;/p>
&lt;p>To find out what the current time in UTC is, click &lt;a href="https://codepen.io/victoriadrake/full/OQabar/">here.&lt;/a>&lt;/p>
&lt;p>If you want your program to run twice a day, say once at 10am and again at 3pm, you&amp;rsquo;ll need to set two separate CloudWatch Events triggers and cron expression rules.&lt;/p>
&lt;p>Click &lt;strong>Add&lt;/strong>.&lt;/p>
&lt;p>
&lt;img src="https://victoria.dev/blog/running-a-free-twitter-bot-on-aws-lambda/lambda-09.png#screenshot" alt="Set cron expression rule" />
&lt;/p>
&lt;h2 id="watch-it-go" class="anchor-link">&lt;a href="#watch-it-go">Watch it go&lt;/a>&lt;/h2>
&lt;p>That&amp;rsquo;s all you need to get your Lambda function up and running! Now you can sit back, relax, and do more important things than share your RSS links on Twitter.&lt;/p></content:encoded><enclosure url="https://victoria.dev/blog/running-a-free-twitter-bot-on-aws-lambda/cover_lambda-doodle_hucb9f83d1ec58f009806cb9ad01277199_85268_640x0_resize_box_2.png" type="image/jpg"/></item><item><title>Moving to a new domain without breaking old links with AWS &amp; Disqus</title><link>https://victoria.dev/blog/moving-to-a-new-domain-without-breaking-old-links-with-aws-disqus/</link><pubDate>Wed, 10 Jan 2018 08:56:20 -0500</pubDate><author>hello@victoria.dev (Victoria Drake)</author><guid>https://victoria.dev/blog/moving-to-a-new-domain-without-breaking-old-links-with-aws-disqus/</guid><description>I moved my site's blog to its own domain without breaking old links or losing comments. Here's how.</description><content:encoded>
&lt;img src="https://victoria.dev/blog/moving-to-a-new-domain-without-breaking-old-links-with-aws-disqus/cover_aws-moving_hu21a1b010075379d4e5c1954a648363b3_119465_640x0_resize_box_2.png" width="640" height="320"/>
&lt;p>I started blogging about my nomadic travels last year, and so far the habit has stuck. Like all side projects, I won&amp;rsquo;t typically invest heavily in setting up web properties before I can be reasonably certain that such an investment is worth my time or enjoyment. In other words: don&amp;rsquo;t buy the domain until you&amp;rsquo;ve proven to yourself that you&amp;rsquo;ll stick with it!&lt;/p>
&lt;p>After some months of regular posting I felt I was ready to commit (short courtship, I know, but we&amp;rsquo;re all adults here) and I bought a dedicated domain, &lt;a href="https://heronebag.com">herOneBag.com&lt;/a>.&lt;/p>
&lt;p>Up until recently, my #NomadLyfe blog was just a subdirectory of my main personal site. Now it&amp;rsquo;s all grown up and ready to strike out into the world alone! Here&amp;rsquo;s the setup for the site:&lt;/p>
&lt;ul>
&lt;li>Static site in Amazon Web Services S3 bucket&lt;/li>
&lt;li>Route 53 handling the DNS&lt;/li>
&lt;li>CloudFront for distribution and a custom SSL certificate&lt;/li>
&lt;li>Disqus for comments&lt;/li>
&lt;/ul>
&lt;p>If you&amp;rsquo;d like a walk-through for how to set up a new domain with this structure, it&amp;rsquo;s over here: &lt;a href="https://victoria.dev/verbose/aws-static-site/">Hosting your static site with AWS S3, Route 53, and CloudFront&lt;/a>. In this post, I&amp;rsquo;ll just detail how I managed to move my blog to the new site without breaking the old links or losing any comments.&lt;/p>
&lt;h2 id="preserve-old-links-with-redirection-rules" class="anchor-link">&lt;a href="#preserve-old-links-with-redirection-rules">Preserve old links with redirection rules&lt;/a>&lt;/h2>
&lt;p>I wanted to avoid breaking links that have been posted around the web by forwarding visitors to the new URL. The change looks like this:&lt;/p>
&lt;p>Old URL: &lt;code>https://victoria.dev/meta/5-bag-lessons/&lt;/code>&lt;/p>
&lt;p>New URL: &lt;code>https://heronebag.com/blog/5-bag-lessons/&lt;/code>&lt;/p>
&lt;p>You can see that the domain name as well as the subdirectory have changed, but the slug for the blog post remains the same. (I love static sites.)&lt;/p>
&lt;p>To redirect links from the old site, we&amp;rsquo;ll need to set redirection rules in the old site&amp;rsquo;s S3 bucket. AWS provides a way to set up a conditional redirect. This is set in the &amp;ldquo;Redirection rules&amp;rdquo; section of your S3 bucket&amp;rsquo;s properties, under &amp;ldquo;Static website hosting.&amp;rdquo; You can &lt;a href="https://docs.aws.amazon.com/AmazonS3/latest/dev/how-to-page-redirect.html#advanced-conditional-redirects">find the documentation here.&lt;/a>&lt;/p>
&lt;p>
&lt;img src="https://victoria.dev/blog/moving-to-a-new-domain-without-breaking-old-links-with-aws-disqus/aws-redirect.png#screenshot" alt="Redirection rules placement" />
&lt;/p>
&lt;p>There are a few examples given, but none that represent the redirect I want. In addition to changing the prefix of the object key, we&amp;rsquo;re also changing the domain. The latter is achieved with the &lt;code>&amp;lt;HostName&amp;gt;&lt;/code> tag.&lt;/p>
&lt;p>To redirect requests for the old blog URL to the new top level domain, we&amp;rsquo;ll use the code below.&lt;/p>
&lt;div class="highlight">&lt;pre class="chroma">&lt;code class="language-xml" data-lang="xml">&lt;span class="nt">&amp;lt;RoutingRules&amp;gt;&lt;/span>
&lt;span class="nt">&amp;lt;RoutingRule&amp;gt;&lt;/span>
&lt;span class="nt">&amp;lt;Condition&amp;gt;&lt;/span>
&lt;span class="nt">&amp;lt;KeyPrefixEquals&amp;gt;&lt;/span>oldblog/&lt;span class="nt">&amp;lt;/KeyPrefixEquals&amp;gt;&lt;/span>
&lt;span class="nt">&amp;lt;/Condition&amp;gt;&lt;/span>
&lt;span class="nt">&amp;lt;Redirect&amp;gt;&lt;/span>
&lt;span class="nt">&amp;lt;HostName&amp;gt;&lt;/span>newdomain.com&lt;span class="nt">&amp;lt;/HostName&amp;gt;&lt;/span>
&lt;span class="nt">&amp;lt;ReplaceKeyPrefixWith&amp;gt;&lt;/span>newblog/&lt;span class="nt">&amp;lt;/ReplaceKeyPrefixWith&amp;gt;&lt;/span>
&lt;span class="nt">&amp;lt;/Redirect&amp;gt;&lt;/span>
&lt;span class="nt">&amp;lt;/RoutingRule&amp;gt;&lt;/span>
&lt;span class="nt">&amp;lt;/RoutingRules&amp;gt;&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>This rule ensures that requests for &lt;code>olddomain.com/oldblog/specific-blog-post&lt;/code> will redirect to &lt;code>newdomain.com/newblog/specific-blog-post&lt;/code>.&lt;/p>
&lt;h2 id="migrate-disqus-comments" class="anchor-link">&lt;a href="#migrate-disqus-comments">Migrate Disqus comments&lt;/a>&lt;/h2>
&lt;p>Disqus provides a tool for migrating the comment threads from your old blog site to the new one. You can find it in your Disqus admin tools at &lt;code>your-short-name.disqus.com/admin/discussions/migrate/&lt;/code>.&lt;/p>
&lt;p>To migrate posts from the old blog address to the new one, we&amp;rsquo;ll use the URL mapper tool. Click &amp;ldquo;Start URL mapper,&amp;rdquo; then &amp;ldquo;you can download a CSV here.&amp;rdquo;&lt;/p>
&lt;p>
&lt;img src="https://victoria.dev/blog/moving-to-a-new-domain-without-breaking-old-links-with-aws-disqus/aws-disqus.png#screenshot" alt="URL mapping for Disqus." />
&lt;/p>
&lt;p>Disqus has decent instructions for how this tool works, and you can &lt;a href="https://help.disqus.com/customer/en/portal/articles/912757-url-mapper">read them here.&lt;/a> Basically, you&amp;rsquo;ll input the new blog URLs into the second column of the CSV file you downloaded, then pass it back to Disqus to process. If you&amp;rsquo;re using a program to edit the CSV, be sure to save the resulting file in CSV format.&lt;/p>
&lt;p>Unless you have a bazillion URLs, the tool works pretty quickly, and you&amp;rsquo;ll get an email when it&amp;rsquo;s finished. Don&amp;rsquo;t forget to update the name of your site in the Disqus admin, too.&lt;/p>
&lt;h2 id="transfer-other-settings" class="anchor-link">&lt;a href="#transfer-other-settings">Transfer other settings&lt;/a>&lt;/h2>
&lt;p>Update links in your social profiles and any other sites you may have around the web. If you&amp;rsquo;re using other services attached to your website like Google Analytics or IFTTT, don&amp;rsquo;t forget to update those details too!&lt;/p></content:encoded><enclosure url="https://victoria.dev/blog/moving-to-a-new-domain-without-breaking-old-links-with-aws-disqus/cover_aws-moving_hu21a1b010075379d4e5c1954a648363b3_119465_640x0_resize_box_2.png" type="image/jpg"/></item><item><title>A Unicode substitution cipher algorithm</title><link>https://victoria.dev/blog/a-unicode-substitution-cipher-algorithm/</link><pubDate>Sat, 06 Jan 2018 20:00:28 -0500</pubDate><author>hello@victoria.dev (Victoria Drake)</author><guid>https://victoria.dev/blog/a-unicode-substitution-cipher-algorithm/</guid><description>How a fun but useless project turned into a Unicode substitution cipher algorithm.</description><content:encoded>
&lt;img src="https://victoria.dev/blog/a-unicode-substitution-cipher-algorithm/cover_unicode-secret_hud7459b7c7802730207ef6a14526fccb5_97492_640x0_resize_box_2.png" width="640" height="320"/>
&lt;p>Full transparency: I occasionally waste time messing around on Twitter. &lt;em>(Gasp! Shock!)&lt;/em> One of the ways I waste time messing around on Twitter is by writing my name in my profile with different Unicode character &amp;ldquo;fonts,&amp;rdquo;   . I previously did this by searching for different Unicode characters on Google, then one-by-one copying and pasting them into the &amp;ldquo;Name&amp;rdquo; field on my Twitter profile. Since this method of wasting time was a bit of a time waster, I decided (in true programmer fashion) to write a tool that would help me save some time while wasting it.&lt;/p>
&lt;p>I originally dubbed the tool &amp;ldquo;uni-pretty,&amp;rdquo; (based on LEGO&amp;rsquo;s Unikitty from a movie &amp;ndash; a pun that absolutely no one got) but have since renamed it &lt;a href="https://fancyunicode.com">fancy unicode&lt;/a>. It builds from &lt;a href="https://github.com/victoriadrake/fancy-unicode">this GitHub repo&lt;/a>. It lets you type any characters into a field and then converts them into Unicode characters that also represent letters, giving you fancy &amp;ldquo;fonts&amp;rdquo; that override a website&amp;rsquo;s CSS, like in your Twitter profile. (Sorry, Internet.)&lt;/p>
&lt;p>
&lt;img src="https://victoria.dev/blog/a-unicode-substitution-cipher-algorithm/screenshot.png#screenshot" alt="fancy-unicode screenshot" />
&lt;/p>
&lt;p>The tool&amp;rsquo;s first naive iteration existed for about twenty minutes while I copy-pasted Unicode characters into a data structure. This approach of storing the characters in the JavaScript file, called hard-coding, is fraught with issues. Besides having to store every character from every font style, it&amp;rsquo;s painstaking to build, hard to update, and more code means it&amp;rsquo;s susceptible to more possible errors.&lt;/p>
&lt;p>Fortunately, working with Unicode means that there&amp;rsquo;s a way to avoid the whole mess of having to store all the font characters: Unicode numbers are sequential. More importantly, the special characters in Unicode that could be used as fonts (meaning that there&amp;rsquo;s a matching character for most or all of the letters of the alphabet) are always in the following sequence: capital A-Z, lowercase a-z.&lt;/p>
&lt;p>For example, in the fancy Unicode above, the lowercase letter &amp;ldquo;L&amp;rdquo; character has the Unicode number &lt;code>U+1D591&lt;/code> and HTML code &lt;code>&amp;amp;#120209;&lt;/code>. The next letter in the sequence, a lowercase letter &amp;ldquo;M,&amp;rdquo; has the Unicode number &lt;code>U+1D592&lt;/code> and HTML code &lt;code>&amp;amp;#120210;&lt;/code>. Notice how the numbers in those codes increment by one.&lt;/p>
&lt;p>Why&amp;rsquo;s this relevant? Since each special character can be referenced by a number, and we know that the order of the sequence is always the same (capital A-Z, lowercase a-z), we&amp;rsquo;re able to produce any character simply by knowing the first number of its font sequence (the capital &amp;ldquo;A&amp;rdquo;). If this reminds you of anything, you can borrow my decoder pin.&lt;/p>
&lt;p>In cryptography, the Caesar cipher (or shift cipher) is a simple method of encryption that utilizes substitution of one character for another in order to encode a message. This is typically done using the alphabet and a shift &amp;ldquo;key&amp;rdquo; that tells you which letter to substitute for the original one. For example, if I were trying to encode the word &amp;ldquo;cat&amp;rdquo; with a right shift of 3, it would look like this:&lt;/p>
&lt;div class="highlight">&lt;pre class="chroma">&lt;code class="language-bash" data-lang="bash">c a t
f d w
&lt;/code>&lt;/pre>&lt;/div>&lt;p>With this concept, encoding our plain text letters as a Unicode &amp;ldquo;font&amp;rdquo; is a simple process. All we need is an array to reference our plain text letters with, and the first index of our Unicode capital &amp;ldquo;A&amp;rdquo; representation. Since some Unicode numbers also include letters (which are sequential, but an unnecessary complication) and since the intent is to display the page in HTML, we&amp;rsquo;ll use the HTML code number &lt;code>&amp;amp;#120172;&lt;/code>, with the extra bits removed for brevity.&lt;/p>
&lt;div class="highlight">&lt;pre class="chroma">&lt;code class="language-js" data-lang="js">&lt;span class="kd">var&lt;/span> &lt;span class="nx">plain&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="p">[&lt;/span>&lt;span class="s1">&amp;#39;A&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s1">&amp;#39;B&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s1">&amp;#39;C&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s1">&amp;#39;D&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s1">&amp;#39;E&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s1">&amp;#39;F&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s1">&amp;#39;G&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s1">&amp;#39;H&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s1">&amp;#39;I&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s1">&amp;#39;J&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s1">&amp;#39;K&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s1">&amp;#39;L&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s1">&amp;#39;M&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s1">&amp;#39;N&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s1">&amp;#39;O&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s1">&amp;#39;P&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s1">&amp;#39;Q&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s1">&amp;#39;R&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s1">&amp;#39;S&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s1">&amp;#39;T&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s1">&amp;#39;U&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s1">&amp;#39;V&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s1">&amp;#39;W&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s1">&amp;#39;X&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s1">&amp;#39;Y&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s1">&amp;#39;Z&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s1">&amp;#39;a&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s1">&amp;#39;b&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s1">&amp;#39;c&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s1">&amp;#39;d&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s1">&amp;#39;e&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s1">&amp;#39;f&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s1">&amp;#39;g&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s1">&amp;#39;h&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s1">&amp;#39;i&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s1">&amp;#39;j&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s1">&amp;#39;k&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s1">&amp;#39;l&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s1">&amp;#39;m&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s1">&amp;#39;n&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s1">&amp;#39;o&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s1">&amp;#39;p&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s1">&amp;#39;q&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s1">&amp;#39;r&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s1">&amp;#39;s&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s1">&amp;#39;t&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s1">&amp;#39;u&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s1">&amp;#39;v&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s1">&amp;#39;w&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s1">&amp;#39;x&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s1">&amp;#39;y&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s1">&amp;#39;z&amp;#39;&lt;/span>&lt;span class="p">];&lt;/span>
&lt;span class="kd">var&lt;/span> &lt;span class="nx">fancyA&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="mi">120172&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>Since we know that the letter sequence of the fancy Unicode is the same as our plain text array, any letter can be found by using its index in the plain text array as an offset from the fancy capital &amp;ldquo;A&amp;rdquo; number. For example, capital &amp;ldquo;B&amp;rdquo; in fancy Unicode is the capital &amp;ldquo;A&amp;rdquo; number, &lt;code>120172&lt;/code> plus B&amp;rsquo;s index, which is &lt;code>1&lt;/code>: &lt;code>120173&lt;/code>.&lt;/p>
&lt;p>Here&amp;rsquo;s our conversion function:&lt;/p>
&lt;div class="highlight">&lt;pre class="chroma">&lt;code class="language-js" data-lang="js">&lt;span class="kd">function&lt;/span> &lt;span class="nx">convert&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">string&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="c1">// Create a variable to store our converted letters
&lt;/span>&lt;span class="c1">&lt;/span> &lt;span class="kd">let&lt;/span> &lt;span class="nx">converted&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="p">[];&lt;/span>
&lt;span class="c1">// Break string into substrings (letters)
&lt;/span>&lt;span class="c1">&lt;/span> &lt;span class="kd">let&lt;/span> &lt;span class="nx">arr&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="nx">string&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">split&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s1">&amp;#39;&amp;#39;&lt;/span>&lt;span class="p">);&lt;/span>
&lt;span class="c1">// Search plain array for indexes of letters
&lt;/span>&lt;span class="c1">&lt;/span> &lt;span class="nx">arr&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">forEach&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">element&lt;/span> &lt;span class="p">=&amp;gt;&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="kd">let&lt;/span> &lt;span class="nx">i&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="nx">plain&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">indexOf&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">element&lt;/span>&lt;span class="p">);&lt;/span>
&lt;span class="c1">// If the letter isn&amp;#39;t a letter (not found in the plain array)
&lt;/span>&lt;span class="c1">&lt;/span> &lt;span class="k">if&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="nx">i&lt;/span> &lt;span class="o">==&lt;/span> &lt;span class="o">-&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="c1">// Return as a whitespace
&lt;/span>&lt;span class="c1">&lt;/span> &lt;span class="nx">converted&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">push&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s1">&amp;#39; &amp;#39;&lt;/span>&lt;span class="p">);&lt;/span>
&lt;span class="p">}&lt;/span> &lt;span class="k">else&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="c1">// Get relevant character from fancy number + index
&lt;/span>&lt;span class="c1">&lt;/span> &lt;span class="kd">let&lt;/span> &lt;span class="nx">unicode&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="nx">fancyA&lt;/span> &lt;span class="o">+&lt;/span> &lt;span class="nx">i&lt;/span>&lt;span class="p">;&lt;/span>
&lt;span class="c1">// Return as HTML code
&lt;/span>&lt;span class="c1">&lt;/span> &lt;span class="nx">converted&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">push&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s1">&amp;#39;&amp;amp;#&amp;#39;&lt;/span> &lt;span class="o">+&lt;/span> &lt;span class="nx">unicode&lt;/span> &lt;span class="o">+&lt;/span> &lt;span class="s1">&amp;#39;;&amp;#39;&lt;/span>&lt;span class="p">);&lt;/span>
&lt;span class="p">}&lt;/span>
&lt;span class="p">});&lt;/span>
&lt;span class="c1">// Print the converted letters as a string
&lt;/span>&lt;span class="c1">&lt;/span> &lt;span class="nx">console&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">log&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">converted&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">join&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s1">&amp;#39;&amp;#39;&lt;/span>&lt;span class="p">));&lt;/span>
&lt;span class="p">}&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>A neat possibility for this method of encoding requires a departure from my original purpose, which was to create a human-readable representation of the original string. If the purpose was instead to produce a cipher, this could be done by using any Unicode index in place of &lt;code>fancyA&lt;/code> as long as the character indexed isn&amp;rsquo;t a representation of a capital &amp;ldquo;A.&amp;rdquo;&lt;/p>
&lt;p>Here&amp;rsquo;s the same code set up with a simplified plain text array, and a non-letter-representation Unicode key:&lt;/p>
&lt;div class="highlight">&lt;pre class="chroma">&lt;code class="language-js" data-lang="js">&lt;span class="kd">var&lt;/span> &lt;span class="nx">plain&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="p">[&lt;/span>&lt;span class="s1">&amp;#39;a&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s1">&amp;#39;b&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s1">&amp;#39;c&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s1">&amp;#39;d&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s1">&amp;#39;e&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s1">&amp;#39;f&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s1">&amp;#39;g&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s1">&amp;#39;h&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s1">&amp;#39;i&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s1">&amp;#39;j&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s1">&amp;#39;k&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s1">&amp;#39;l&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s1">&amp;#39;m&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s1">&amp;#39;n&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s1">&amp;#39;o&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s1">&amp;#39;p&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s1">&amp;#39;q&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s1">&amp;#39;r&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s1">&amp;#39;s&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s1">&amp;#39;t&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s1">&amp;#39;u&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s1">&amp;#39;v&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s1">&amp;#39;w&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s1">&amp;#39;x&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s1">&amp;#39;y&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s1">&amp;#39;z&amp;#39;&lt;/span>&lt;span class="p">];&lt;/span>
&lt;span class="kd">var&lt;/span> &lt;span class="nx">key&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="mi">9016&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>You might be able to imagine that decoding a cipher produced by this method would be relatively straightforward, once you knew the encoding secret. You&amp;rsquo;d simply need to subtract the key from the HTML code numbers of the encoded characters, then find the relevant plain text letters at the remaining indexes.&lt;/p>
&lt;p>Well, that&amp;rsquo;s it for today. Be sure to drink your Ovaltine and we&amp;rsquo;ll see you right here next Monday at 5:45!&lt;/p>
&lt;p>Oh, and&amp;hellip;         &lt;/p>
&lt;p>:)&lt;/p></content:encoded><enclosure url="https://victoria.dev/blog/a-unicode-substitution-cipher-algorithm/cover_unicode-secret_hud7459b7c7802730207ef6a14526fccb5_97492_640x0_resize_box_2.png" type="image/jpg"/></item><item><title>Hosting your static site with AWS S3, Route 53, and CloudFront</title><link>https://victoria.dev/blog/hosting-your-static-site-with-aws-s3-route-53-and-cloudfront/</link><pubDate>Wed, 13 Dec 2017 20:46:12 -0500</pubDate><author>hello@victoria.dev (Victoria Drake)</author><guid>https://victoria.dev/blog/hosting-your-static-site-with-aws-s3-route-53-and-cloudfront/</guid><description>A guide to using Amazon Web Services to serve your site with HTTPS. For (almost) free.</description><content:encoded>
&lt;img src="https://victoria.dev/blog/hosting-your-static-site-with-aws-s3-route-53-and-cloudfront/cover_aws-questions_hua0b9a94223402b1678baf2512b6d4b77_78246_640x0_resize_box_2.png" width="640" height="320"/>
&lt;p>Some time ago I decided to stop freeloading on GitHub pages and move one of my sites to Amazon Web Services (AWS). It turns out that I&amp;rsquo;m still mostly freeloading (yay free tier) so it amounted to a learning experience. Here are the components that let me host and serve the site at my custom domain with HTTPS.&lt;/p>
&lt;ul>
&lt;li>Static site in Amazon Web Services S3 bucket&lt;/li>
&lt;li>Route 53 handling the DNS&lt;/li>
&lt;li>CloudFront for distribution and a custom SSL certificate&lt;/li>
&lt;/ul>
&lt;p>I set all that up most of a year ago. At the time, I found the AWS documentation to be rather fragmented and inconvenient to follow - it was hard to find what you were looking for without knowing what a specific setting might be called, or where it was, or if it existed at all. When I recently set up a new site and stumbled through this process again, I didn&amp;rsquo;t find it any easier. Hopefully this post can help to collect the relevant information into a more easily followed process and serve as an accompanying guide to save future me (and you) some time.&lt;/p>
&lt;p>Rather than replace existing documentation, this post is meant to supplement it. Think of me as your cool tech-savvy friend on the phone with you at 4am, troubleshooting your website. (Please don&amp;rsquo;t actually call me at 4am.) I&amp;rsquo;ll walk through the set up while providing links for the documentation that was ultimately helpful (mostly so I can find it again later&amp;hellip;).&lt;/p>
&lt;h2 id="hosting-a-static-site-with-amazon-s3-and-a-custom-domain" class="anchor-link">&lt;a href="#hosting-a-static-site-with-amazon-s3-and-a-custom-domain">Hosting a static site with Amazon S3 and a custom domain&lt;/a>&lt;/h2>
&lt;p>If you&amp;rsquo;re starting from scratch, you&amp;rsquo;ll need an AWS account. It behooves you to get one, even if you don&amp;rsquo;t like paying for services - there&amp;rsquo;s a free tier that will cover most of the experimental stuff you&amp;rsquo;re going to want to do in the first year, and even the things I do pay for cost me less than a dollar a month. You can sign up at &lt;a href="https://aws.amazon.com/free">https://aws.amazon.com/free&lt;/a>.&lt;/p>
&lt;p>Getting your static site hosted and available at your custom domain is your first mission, should you choose to accept it. &lt;a href="http://docs.aws.amazon.com/AmazonS3/latest/dev/website-hosting-custom-domain-walkthrough.html">Your instructions are here.&lt;/a>&lt;/p>
&lt;p>Creating the buckets for site hosting on S3 is the most straightforward part of this process in my opinion, and the AWS documentation walkthrough covers what you&amp;rsquo;ll need to do quite well. It gets a little unclear around &lt;em>Step 3: Create and Configure Amazon Route 53 Hosted Zone&lt;/em>, so come back and read on once you&amp;rsquo;ve reached that point. I&amp;rsquo;ll make some tea in the meantime.&lt;/p>
&lt;p>&amp;hellip;  &lt;/p>
&lt;p>Ready? Cool. See, I&amp;rsquo;m here for you.&lt;/p>
&lt;h2 id="set-up-route-53" class="anchor-link">&lt;a href="#set-up-route-53">Set up Route 53&lt;/a>&lt;/h2>
&lt;p>The majority of the work in this section amounts to creating the correct record sets for your custom domain. If you&amp;rsquo;re already familiar with how record sets work, the documentation is a bit of a slog. Here&amp;rsquo;s how it should look when you&amp;rsquo;re finished:&lt;/p>
&lt;p>
&lt;img src="https://victoria.dev/blog/hosting-your-static-site-with-aws-s3-route-53-and-cloudfront/aws-recordsets.png#screenshot" alt="Route 53 record sets." />
&lt;/p>
&lt;p>The &amp;ldquo;NS&amp;rdquo; and &amp;ldquo;SOA&amp;rdquo; records are created automatically for you. The only records you need to create are the &amp;ldquo;A&amp;rdquo; records.&lt;/p>
&lt;p>Hop over to &lt;a href="https://console.aws.amazon.com/route53/home">Route 53&lt;/a> and follow &lt;a href="http://docs.aws.amazon.com/Route53/latest/DeveloperGuide/MigratingDNS.html">this walkthrough&lt;/a> to create a &amp;ldquo;hosted zone.&amp;rdquo; The value of the &lt;strong>NS&lt;/strong> (Name Servers) records are what you&amp;rsquo;ll have to provide to your domain name registrar (wherever you bought your custom domain, such as this super subtle &lt;a href="https://affiliate.namecheap.com/?affId=109417">Namecheap.com affiliate link&lt;/a> right here.)&lt;/p>
&lt;p>If you created two buckets in the first section (one for &lt;code>yourdomain.com&lt;/code> and one for &lt;code>www.yourdomain.com&lt;/code>), you&amp;rsquo;ll need two separate A records in Route 53. Initially, these have the value of the endpoints for your matching S3 buckets (looks like &lt;code>s3-website.us-east-2.amazonaws.com&lt;/code>). Later, you&amp;rsquo;ll change them to your CloudFront domain name.&lt;/p>
&lt;p>If you went with Namecheap as your registrar, &lt;a href="http://docs.aws.amazon.com/AmazonS3/latest/dev/website-hosting-custom-domain-walkthrough.html#root-domain-walkthrough-update-ns-record">Step 4&lt;/a> looks like this:&lt;/p>
&lt;p>
&lt;img src="https://victoria.dev/blog/hosting-your-static-site-with-aws-s3-route-53-and-cloudfront/aws-namecheapdns.png#screenshot" alt="Namecheap&amp;amp;rsquo;s Custom DNS settings." />
&lt;/p>
&lt;p>Waiting is the hardest part&amp;hellip; I&amp;rsquo;ve gotten into the habit of working on another project or setting up the DNS change before going to bed so that changes have time to propagate without me feeling like I need to fiddle with it. ^^;&lt;/p>
&lt;p>When the transfer&amp;rsquo;s ready, you&amp;rsquo;ll see your site at &lt;code>http://yourdomain.com&lt;/code>. Next, you&amp;rsquo;ll want to set up CloudFront so that becomes &lt;code>https://yourdomain.com&lt;/code>.&lt;/p>
&lt;h2 id="set-up-cloudfront-and-ssl" class="anchor-link">&lt;a href="#set-up-cloudfront-and-ssl">Set up CloudFront and SSL&lt;/a>&lt;/h2>
&lt;p>&lt;a href="http://docs.aws.amazon.com/AmazonS3/latest/dev/website-hosting-cloudfront-walkthrough.html">Here are the instructions for setting up CloudFront.&lt;/a> There are a few important points to make sure you don&amp;rsquo;t miss on the &amp;ldquo;Create Distribution&amp;rdquo; page:&lt;/p>
&lt;ul>
&lt;li>&lt;strong>Origin Domain Name:&lt;/strong> Make sure to use your S3 bucket endpoint, and not select the bucket from the dropdown menu that appears.&lt;/li>
&lt;li>&lt;strong>Viewer Protocol Policy:&lt;/strong> If you want requests for &lt;code>http://yourdomain.com&lt;/code> to always result in &lt;code>https://yourdomain.com&lt;/code>, choose &amp;ldquo;Redirect HTTP to HTTPS.&amp;rdquo;&lt;/li>
&lt;li>&lt;strong>Alternate Domain Names:&lt;/strong> Enter &lt;code>yourdomain.com&lt;/code> and &lt;code>www.yourdomain.com&lt;/code> on separate lines.&lt;/li>
&lt;li>&lt;strong>SSL Certificate:&lt;/strong> See below.&lt;/li>
&lt;li>&lt;strong>Default Root Object:&lt;/strong> Enter the name of the html file that should be returned when your users go to &lt;code>https://yourdomain.com&lt;/code>. This is usually &amp;ldquo;index.html&amp;rdquo;.&lt;/li>
&lt;/ul>
&lt;h3 id="ssl-certificate" class="anchor-link">&lt;a href="#ssl-certificate">SSL Certificate&lt;/a>&lt;/h3>
&lt;p>To show your content with HTTPS at your custom domain, you&amp;rsquo;ll need to choose &amp;ldquo;Custom SSL Certificate.&amp;rdquo; You can easily get an SSL Certificate with AWS Certificate Manager. Click on &amp;ldquo;Request or Import a Certificate with ACM&amp;rdquo; to get started in a new window.&lt;/p>
&lt;p>&lt;a href="http://docs.aws.amazon.com/acm/latest/userguide/gs-acm-request.html">Here are instructions for setting up a certificate.&lt;/a> I don&amp;rsquo;t think they&amp;rsquo;re very good, personally. Don&amp;rsquo;t worry, I got you.&lt;/p>
&lt;p>To account for &amp;ldquo;&lt;a href="http://www.yourdomain.com">www.yourdomain.com&lt;/a>&amp;rdquo; as well as any subdomains, you&amp;rsquo;ll want to add two domain names to the certificate, like so:&lt;/p>
&lt;p>
&lt;img src="https://victoria.dev/blog/hosting-your-static-site-with-aws-s3-route-53-and-cloudfront/aws-acmdomains.png#screenshot" alt="Adding domain names to ACM." />
&lt;/p>
&lt;p>Click &amp;ldquo;Next.&amp;rdquo; You&amp;rsquo;ll be asked to choose a validation method. Choose &amp;ldquo;DNS validation&amp;rdquo; and click &amp;ldquo;Review.&amp;rdquo; If everything is as it should be, click &amp;ldquo;Confirm and request.&amp;rdquo;&lt;/p>
&lt;p>You&amp;rsquo;ll see a page, &amp;ldquo;Validation&amp;rdquo; that looks like this. You&amp;rsquo;ll have to click the little arrow next to both domain names to get the important information to show:&lt;/p>
&lt;p>
&lt;img src="https://victoria.dev/blog/hosting-your-static-site-with-aws-s3-route-53-and-cloudfront/aws-acmvalidation.png#screenshot" alt="Validation instructions for ACM." />
&lt;/p>
&lt;p>Under both domain names, click the button for &amp;ldquo;Create record in Route 53.&amp;rdquo; This will automatically create a CNAME record set in Route 53 with the given values, which ACM will then check in order to validate that you own those domains. You could create the records manually, if you wanted to for some reason. I don&amp;rsquo;t know, maybe you&amp;rsquo;re killing time. \_()_/&lt;/p>
&lt;p>Click &amp;ldquo;Continue.&amp;rdquo; You&amp;rsquo;ll see a console that looks like this:&lt;/p>
&lt;p>
&lt;img src="https://victoria.dev/blog/hosting-your-static-site-with-aws-s3-route-53-and-cloudfront/aws-acmcertificates.png#screenshot" alt="List of certificates you own." />
&lt;/p>
&lt;p>It may take some time for the validation to complete, at which point the &amp;ldquo;Pending validation&amp;rdquo; status will change to &amp;ldquo;Issued.&amp;rdquo; Again with the waiting. You can close this window to return to the CloudFront set up. Once the certificate is validated, you&amp;rsquo;ll see it in the dropdown menu under &amp;ldquo;Custom SSL Certificate.&amp;rdquo; You can click &amp;ldquo;Create Distribution&amp;rdquo; to finish setting up CloudFront.&lt;/p>
&lt;p>In your CloudFront Distributions console, you&amp;rsquo;ll see &amp;ldquo;In Progress&amp;rdquo; until AWS has done its thing. Once it&amp;rsquo;s done, it&amp;rsquo;ll change to &amp;ldquo;Deployed.&amp;rdquo;&lt;/p>
&lt;h3 id="one-last-thing" class="anchor-link">&lt;a href="#one-last-thing">One last thing&lt;/a>&lt;/h3>
&lt;p>Return to your &lt;a href="https://console.aws.amazon.com/route53/">Route 53 console&lt;/a> and click on &amp;ldquo;Hosted zones&amp;rdquo; in the sidebar, then your domain name from the list. For both A records, change the &amp;ldquo;Alias Target&amp;rdquo; from the S3 endpoint to your CloudFront distribution domain, which should look something like &lt;code>dj4p1rv6mvubz.cloudfront.net&lt;/code>. It appears in the dropdown after you clear the field.&lt;/p>
&lt;h2 id="youre-done" class="anchor-link">&lt;a href="#youre-done">You&amp;rsquo;re done&lt;/a>&lt;/h2>
&lt;p>Well, usually. If you navigate to your new HTTPS domain and don&amp;rsquo;t see your beautiful new site where it should be, here are some things you can do:&lt;/p>
&lt;ol>
&lt;li>Check S3 bucket policy - ensure that the bucket for &lt;code>yourdomain.com&lt;/code> in the &lt;a href="https://s3.console.aws.amazon.com/s3/home">S3 console&lt;/a> shows &amp;ldquo;Public&amp;rdquo; in the &amp;ldquo;Access&amp;rdquo; column.&lt;/li>
&lt;li>Check S3 bucket index document - In the &amp;ldquo;Properties&amp;rdquo; tab for the bucket, then &amp;ldquo;Static website hosting&amp;rdquo;. Usually &amp;ldquo;index.html&amp;rdquo;.&lt;/li>
&lt;li>Check CloudFront Origin - the &amp;ldquo;Origin&amp;rdquo; column in the &lt;a href="https://console.aws.amazon.com/cloudfront/home">CloudFront Console&lt;/a> should show the S3 bucket&amp;rsquo;s endpoint (&lt;code>s3-website.us-east-2.amazonaws.com&lt;/code>), not the bucket name (&lt;code>yourdomain.com.s3.amazonaws.com&lt;/code>).&lt;/li>
&lt;li>Check CloudFront Default Root Object - clicking on the distribution name should take you to a details page that shows &amp;ldquo;Default Root Object&amp;rdquo; in the list with the value that you set, usually &amp;ldquo;index.html&amp;rdquo;.&lt;/li>
&lt;li>Wait. Sometimes changes take up to 48hrs to propagate. \_()_/&lt;/li>
&lt;/ol>
&lt;p>I hope that helps you get set up with your new static site on AWS!&lt;/p></content:encoded><enclosure url="https://victoria.dev/blog/hosting-your-static-site-with-aws-s3-route-53-and-cloudfront/cover_aws-questions_hua0b9a94223402b1678baf2512b6d4b77_78246_640x0_resize_box_2.png" type="image/jpg"/></item><item><title>About time</title><link>https://victoria.dev/blog/about-time/</link><pubDate>Wed, 22 Nov 2017 14:05:14 -0500</pubDate><author>hello@victoria.dev (Victoria Drake)</author><guid>https://victoria.dev/blog/about-time/</guid><description>Some thoughts and concrete suggestions on saving society through programming.</description><content:encoded>
&lt;img src="https://victoria.dev/blog/about-time/fuji-fog_hu5bbdcd117dda8ab85f4f59d2d655385a_178478_640x0_resize_q75_box.jpeg" width="640" height="320"/>
&lt;p>This morning I read an article that&amp;rsquo;s been making the rounds lately: &lt;a href="http://nautil.us/issue/52/the-hive/modern-media-is-a-dos-attack-on-your-free-will">Modern Media Is a DoS Attack on Your Free Will&lt;/a>.&lt;/p>
&lt;p>It&amp;rsquo;s made me think, which I must admit, I at first didn&amp;rsquo;t like. See, when I wake up in the morning (and subsequently wake up my computer) the first thing I do is go on Twitter to catch up on everything I missed while I was asleep. All this before my first coffee, mind you. Links on Twitter usually lead to stories on Medium, newly released apps on ProductHunt, and enticing sales on a new gadget or two on Amazon. Wherever it goes, in those blissfully half-awake mental recesses, the last thing I&amp;rsquo;m trying to do is think.&lt;/p>
&lt;p>However, yesterday, I also happened to listen to a podcast from freeCodeCamp. It was &lt;a href="https://twitter.com/ossia/status/932698783863001089">#7: The code I&amp;rsquo;m still ashamed of&lt;/a>. This lead to thoughts on the responsibilities of programmers - the people tasked with designing and building apps and systems meant to steer the very course of your life.&lt;/p>
&lt;p>This morning, the combined swirling mess of notions brought on by these two sources of information had, even before my first coffee, the unfortunate effect of making me think.&lt;/p>
&lt;p>Mostly, I thought about intention, and time.&lt;/p>
&lt;p>I don&amp;rsquo;t believe it&amp;rsquo;s wildly inaccurate to say that when you go about doing something in your daily life, you have a general awareness of your reason for doing it. If you leave your building and go down the street to Starbucks and buy a coffee, more often than not, it&amp;rsquo;s because you wanted a coffee. If you go to the corner store and buy a litre of milk, you probably intend to drink it. If you find yourself nicely dressed on a Friday night waiting at a well-decorated restaurant to meet another human being with whom you share an apparent mutual attraction, I can risk a guess that you&amp;rsquo;re after some form of pleasant human interaction.&lt;/p>
&lt;p>In each of these, and many more examples you can think up, the end goal is clearly defined. There is an expected final step to the process; an expected response; a return value.&lt;/p>
&lt;p>What is the return value of opening up the Twitter app? Browsing Facebook? Instagram? In fact, any social media?&lt;/p>
&lt;p>The concrete answer is that there isn&amp;rsquo;t one. Perhaps in those of us with resilient self-discipline, there may at least be some sort of time limitation. That&amp;rsquo;s the most we can hope for, however, and no wonder - that&amp;rsquo;s what these and other similar services have been &lt;em>designed&lt;/em> for. They&amp;rsquo;re built to be open-ended black-holes for our most precious resource&amp;hellip; time.&lt;/p>
&lt;blockquote>
&lt;p>In the case of the Analytical Engine we have undoubtedly to lay out a certain capital of analytical labour in one particular line; but this is in order that the engine may bring us in a much larger return in another line.&lt;/p>
&lt;p>&lt;em>Ada Augusta (Ada Lovelace)&lt;/em> - &lt;a href="https://www.fourmilab.ch/babbage/sketch.html">Notes on &lt;em>Sketch of The Analytical Engine&lt;/em>&lt;/a>&lt;/p>
&lt;/blockquote>
&lt;p>Okay, so I did some more reading. Specifically, #ThrowbackThursday to the mid 1800&amp;rsquo;s and something my good friend Ada Lovelace once scribbled in a book. Widely considered one of the first computer programmers, she and Charles Babbage pioneered many concepts that programmers today take for granted. The one I&amp;rsquo;m going to hang my point on is, I think, nicely encapsulated in the above quote: the things programmers make are supposed to save you time.&lt;/p>
&lt;p>Save it. Not lose it.&lt;/p>
&lt;p>I think Ada and Charles would agree that, observing the effects of social media apps, clickbait news sites, and many other forms of attention-hogging interactivity that we haven&amp;rsquo;t even classified yet - something&amp;rsquo;s gone horribly wrong.&lt;/p>
&lt;p>What if, as programmers, we actually did something about it?&lt;/p>
&lt;p>Consider that collectively - no, even individually - we who design and build the workings of modern technology have an &lt;em>incredible&lt;/em> amount of power. The next indie app that goes viral on ProductHunt will consume hundreds of hours of time from its users. Where is all that untapped, pure potential going to? Some open-ended, inoffensive amusement? Another advertising platform thinly veiled as a game? Perhaps another drop of oil to smooth the machinery of The Great Engine of Commerce?&lt;/p>
&lt;p>I get it - programmers will build what they&amp;rsquo;re paid to build. That&amp;rsquo;s capitalism, that&amp;rsquo;s feeding your family, survival - life. I&amp;rsquo;m not trying to suggest we all quit our jobs, go live in the woods, and volunteer as humanitarians. That would be nice, but it&amp;rsquo;s impractical.&lt;/p>
&lt;p>But we all have side projects. Free time. What are you doing with yours?&lt;/p>
&lt;hr>
&lt;p>Before I&amp;rsquo;m accused of being too hand-wavy and idealistic, I want to offer a concrete suggestion. Build things that save time. Not in the &amp;ldquo;I&amp;rsquo;ve made yet another to-do list app for you to download,&amp;rdquo; kind of way, but in the &amp;ldquo;Here&amp;rsquo;s a one-liner to automate this mundane thing that would have taken you hours,&amp;rdquo; kind of way. Here, have a &lt;a href="https://victoria.dev/blog/batch-renaming-images-including-image-resolution-with-awk/">shameless plug&lt;/a>.&lt;/p>
&lt;p>I also really like this idea from the first article I mentioned, so hang on tight while I bring this full circle:&lt;/p>
&lt;blockquote>
&lt;p>&lt;strong>Whats one concrete thing companies could do now to stop subverting our attention?&lt;/strong>&lt;/p>
&lt;p>I would just like to know what is the ultimate design goal of that site or that system thats shaping my behavior or thinking. What are they really designing my experience for? Companies will say that their goal is to make the world open and connected or whatever. These are lofty marketing claims. But if you were to actually look at the dashboards that theyre designing, the high-level metrics theyre designing for, you probably wouldnt see those things. Youd see other things, like frequency of use, time on site, this type of thing. If there was some way for the app to say, to the user, Heres generally what this app wants from you, from an attentional point of view, that would be huge. It would probably be the primary way I would decide which apps I download and use.&lt;/p>
&lt;/blockquote>
&lt;p>There are so many ways I&amp;rsquo;d love to see this put into practice, from the obvious to the subversive. A little &lt;code>position: sticky;&lt;/code> banner? A custom meta tag in the header? Maybe a call to action like this takes more introspection and honesty than a lot of app makers are ready for&amp;hellip; but maybe it just takes a little of our time.&lt;/p></content:encoded><enclosure url="https://victoria.dev/blog/about-time/fuji-fog_hu5bbdcd117dda8ab85f4f59d2d655385a_178478_640x0_resize_q75_box.jpeg" type="image/jpg"/></item><item><title>Batch renaming images, including image resolution, with awk</title><link>https://victoria.dev/blog/batch-renaming-images-including-image-resolution-with-awk/</link><pubDate>Mon, 20 Nov 2017 13:59:30 -0500</pubDate><author>hello@victoria.dev (Victoria Drake)</author><guid>https://victoria.dev/blog/batch-renaming-images-including-image-resolution-with-awk/</guid><description>How to batch rename images with custom values using file, awk, and rename - in rainbow colors!</description><content:encoded>
&lt;img src="https://victoria.dev/blog/batch-renaming-images-including-image-resolution-with-awk/renaming-rainbow_hua6bda34c4dd82ff49a9f97483b0665f2_159523_640x0_resize_box_2.png" width="640" height="317"/>
&lt;p>The most recent item on my list of &amp;ldquo;Geeky things I did that made me feel pretty awesome&amp;rdquo; is an hour&amp;rsquo;s adventure that culminated in this code:&lt;/p>
&lt;div class="highlight">&lt;pre class="chroma">&lt;code class="language-bash" data-lang="bash">$ file IMG* &lt;span class="p">|&lt;/span> awk &lt;span class="s1">&amp;#39;BEGIN{a=0} {print substr($1, 1, length($1)-5),a++&amp;#34;_&amp;#34;substr($8,1, length($8)-1)}&amp;#39;&lt;/span> &lt;span class="p">|&lt;/span> &lt;span class="k">while&lt;/span> &lt;span class="nb">read&lt;/span> fn fr&lt;span class="p">;&lt;/span> &lt;span class="k">do&lt;/span> &lt;span class="nb">echo&lt;/span> &lt;span class="k">$(&lt;/span>rename -v &lt;span class="s2">&amp;#34;s/&lt;/span>&lt;span class="nv">$fn&lt;/span>&lt;span class="s2">/img_&lt;/span>&lt;span class="nv">$fr&lt;/span>&lt;span class="s2">/g&amp;#34;&lt;/span> *&lt;span class="k">)&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="k">done&lt;/span>
IMG_20170808_172653_425.jpg renamed as img_0_4032x3024.jpg
IMG_20170808_173020_267.jpg renamed as img_1_3024x3506.jpg
IMG_20170808_173130_616.jpg renamed as img_2_3024x3779.jpg
IMG_20170808_173221_425.jpg renamed as img_3_3024x3780.jpg
IMG_20170808_173417_059.jpg renamed as img_4_2956x2980.jpg
IMG_20170808_173450_971.jpg renamed as img_5_3024x3024.jpg
IMG_20170808_173536_034.jpg renamed as img_6_4032x3024.jpg
IMG_20170808_173602_732.jpg renamed as img_7_1617x1617.jpg
IMG_20170808_173645_339.jpg renamed as img_8_3024x3780.jpg
IMG_20170909_170146_585.jpg renamed as img_9_3036x3036.jpg
IMG_20170911_211522_543.jpg renamed as img_10_3036x3036.jpg
IMG_20170913_071608_288.jpg renamed as img_11_2760x2760.jpg
IMG_20170913_073205_522.jpg renamed as img_12_2738x2738.jpg
// ... etc etc
&lt;/code>&lt;/pre>&lt;/div>&lt;p>The last item on the aforementioned list is &amp;ldquo;TODO: come up with a shorter title for this list.&amp;rdquo;&lt;/p>
&lt;p>I previously wrote about the power of command line tools like &lt;a href="https://victoria.dev/blog/how-to-replace-a-string-in-a-dozen-old-blog-posts-with-one-sed-terminal-command/">sed&lt;/a>. This post expands on how to string all this magical functionality into one big, long, rainbow-coloured, viscous stream of awesome.&lt;/p>
&lt;h2 id="rename-files" class="anchor-link">&lt;a href="#rename-files">Rename files&lt;/a>&lt;/h2>
&lt;p>The tool that actually handles the renaming of our files is, appropriately enough, &lt;code>rename&lt;/code>. The syntax is: &lt;code>rename -n &amp;quot;s/original_filename/new_filename/g&amp;quot; *&lt;/code> where &lt;code>-n&lt;/code> does a dry-run, and substituting &lt;code>-v&lt;/code> would rename the files. The &lt;code>s&lt;/code> indicates our substitution string, and &lt;code>g&lt;/code> for &amp;ldquo;global&amp;rdquo; finds all occurrences of the string. The &lt;code>*&lt;/code> matches zero or more occurrences of our search-and-replace parameters.&lt;/p>
&lt;p>We&amp;rsquo;ll come back to this later.&lt;/p>
&lt;h2 id="get-file-information" class="anchor-link">&lt;a href="#get-file-information">Get file information&lt;/a>&lt;/h2>
&lt;p>When I run &lt;code>$ file IMG_20170808_172653_425.jpg&lt;/code> in the image directory, I get this output:&lt;/p>
&lt;div class="highlight">&lt;pre class="chroma">&lt;code class="language-bash" data-lang="bash">IMG_20170808_172653_425.jpg: JPEG image data, baseline, precision 8, 4032x3024, frames &lt;span class="m">3&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>Since we can get the image resolution (&amp;ldquo;4032x3024&amp;rdquo; above), we know that we&amp;rsquo;ll be able to use it in our new filename.&lt;/p>
&lt;h2 id="isolate-the-information-we-want" class="anchor-link">&lt;a href="#isolate-the-information-we-want">Isolate the information we want&lt;/a>&lt;/h2>
&lt;p>I love &lt;code>awk&lt;/code> for its simplicity. It takes lines of text and makes individual bits of information available to us with built in variables that we can then refer to as column numbers denoted by &lt;code>$1&lt;/code>, &lt;code>$2&lt;/code>, etc. By default, &lt;code>awk&lt;/code> splits up columns on whitespace. To take the example above:&lt;/p>
&lt;div class="highlight">&lt;pre class="chroma">&lt;code class="language-text" data-lang="text">| 1 | 2 | 3 | 4 | 5 | 6 | 7 | 8 | 9 | 10 |
-------------------------------------------------------------------------------------------------------------
| IMG_20170808_172653_425.jpg: | JPEG | image | data, | baseline, | precision | 8, | 4032x3024, | frames | 3 |
&lt;/code>&lt;/pre>&lt;/div>&lt;p>We can denote different values to use as a splitter with, for example, &lt;code>-F','&lt;/code> if we wanted to use commas as the column divisions. For our current project, spaces are fine.&lt;/p>
&lt;p>There are a couple issues we need to solve before we can plug the information into our new filenames. Column &lt;code>$1&lt;/code> has the original filename we want, but there&amp;rsquo;s an extra &amp;ldquo;:&amp;rdquo; character on the end. We don&amp;rsquo;t need the &amp;ldquo;.jpg&amp;rdquo; either. Column &lt;code>$8&lt;/code> has an extra &amp;ldquo;,&amp;rdquo; that we don&amp;rsquo;t want as well. To get just to information we need, we&amp;rsquo;ll take a substring of the column with &lt;code>substr()&lt;/code>:&lt;/p>
&lt;p>&lt;code>substr($1, 1, length($1)-5)&lt;/code> - This gives us the file name from the beginning of the string to the end of the string, minus 5 characters (&amp;ldquo;length minus 5&amp;rdquo;).
&lt;code>substr($8,1, length($8)-1)&lt;/code> - This gives us the image size, without the extra comma (&amp;ldquo;length minus 1&amp;rdquo;).&lt;/p>
&lt;h2 id="avoid-duplicate-file-names" class="anchor-link">&lt;a href="#avoid-duplicate-file-names">Avoid duplicate file names&lt;/a>&lt;/h2>
&lt;p>To ensure that two images with the same resolutions don&amp;rsquo;t create identical, competing file names, we&amp;rsquo;ll append a unique incrementing number to the filename.&lt;/p>
&lt;p>&lt;code>BEGIN{a=0}&lt;/code> - Using &lt;code>BEGIN&lt;/code> tells &lt;code>awk&lt;/code> to run the following code only once, at the (drumroll) beginning. Here, we&amp;rsquo;re declaring the variable &lt;code>a&lt;/code> to be &lt;code>0&lt;/code>.
&lt;code>a++&lt;/code> - Later in our code, at the appropriate spot for our file name, we call &lt;code>a&lt;/code> and increment it.&lt;/p>
&lt;p>When &lt;code>awk&lt;/code> prints a string, it concatenates everything that isn&amp;rsquo;t separated by a comma. &lt;code>{print a b c}&lt;/code> would create &amp;ldquo;abc&amp;rdquo; and &lt;code>{print a,b,c}&lt;/code> would create &amp;ldquo;a b c&amp;rdquo;, for example.&lt;/p>
&lt;p>We can add additional characters to our file name, such as an underscore, by inserting it in quotations: &lt;code>&amp;quot;_&amp;quot;&lt;/code>.&lt;/p>
&lt;h2 id="string-it-all-together" class="anchor-link">&lt;a href="#string-it-all-together">String it all together&lt;/a>&lt;/h2>
&lt;p>To feed the output of one command into another command, we use &amp;ldquo;pipe,&amp;rdquo; written as &lt;code>|&lt;/code>.&lt;/p>
&lt;p>If we only used pipe in this instance, all our data from &lt;code>file&lt;/code> and &lt;code>awk&lt;/code> would get fed into &lt;code>rename&lt;/code> all at once, making for one very, very long and probably non-compiling file name. To run the &lt;code>rename&lt;/code> command line by line, we can use &lt;code>while&lt;/code> and &lt;code>read&lt;/code>. Similarly to &lt;code>awk&lt;/code>, &lt;code>read&lt;/code> takes input and splits it into variables we can assign and use. In our code, it takes the first bit of output from &lt;code>awk&lt;/code> (the original file name) and assigns that the variable name &lt;code>$fn&lt;/code>. It takes the second output (our incrementing number and the image resolution) and assigns that to &lt;code>$fr&lt;/code>. The variable names are arbitrary; you can call them whatever you want.&lt;/p>
&lt;p>To run our &lt;code>rename&lt;/code> commands as if we&amp;rsquo;d manually entered them in the terminal one by one, we can use &lt;code>echo $(some command)&lt;/code>. Finally, &lt;code>done&lt;/code> ends our &lt;code>while&lt;/code> loop.&lt;/p>
&lt;h2 id="bonus-round-rainbow-output" class="anchor-link">&lt;a href="#bonus-round-rainbow-output">Bonus round: rainbow output&lt;/a>&lt;/h2>
&lt;p>I wasn&amp;rsquo;t kidding with that &lt;a href="https://github.com/tehmaze/lolcat">&amp;ldquo;rainbow-coloured&amp;rdquo; bit&amp;hellip;&lt;/a>&lt;/p>
&lt;div class="highlight">&lt;pre class="chroma">&lt;code class="language-bash" data-lang="bash">p install lolcat
&lt;/code>&lt;/pre>&lt;/div>&lt;p>Here&amp;rsquo;s our full code:&lt;/p>
&lt;div class="highlight">&lt;pre class="chroma">&lt;code class="language-bash" data-lang="bash">le IMG* &lt;span class="p">|&lt;/span> awk &lt;span class="s1">&amp;#39;BEGIN{a=0} {print substr($1, 1, length($1)-5),a++&amp;#34;_&amp;#34;substr($8,1, length($8)-1)}&amp;#39;&lt;/span> &lt;span class="p">|&lt;/span> &lt;span class="k">while&lt;/span> &lt;span class="nb">read&lt;/span> fn fs&lt;span class="p">;&lt;/span> &lt;span class="k">do&lt;/span> &lt;span class="nb">echo&lt;/span> &lt;span class="k">$(&lt;/span>rename -v &lt;span class="s2">&amp;#34;s/&lt;/span>&lt;span class="nv">$fn&lt;/span>&lt;span class="s2">/img_&lt;/span>&lt;span class="nv">$fs&lt;/span>&lt;span class="s2">/g&amp;#34;&lt;/span> *&lt;span class="k">)&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="k">done&lt;/span> &lt;span class="p">|&lt;/span> lolcat
&lt;/code>&lt;/pre>&lt;/div>&lt;p>Enjoy!&lt;/p></content:encoded><enclosure url="https://victoria.dev/blog/batch-renaming-images-including-image-resolution-with-awk/renaming-rainbow_hua6bda34c4dd82ff49a9f97483b0665f2_159523_640x0_resize_box_2.png" type="image/jpg"/></item><item><title>How to code a satellite algorithm and cook paella fromscratch</title><link>https://victoria.dev/blog/how-to-code-a-satellite-algorithm-and-cook-paella-from-scratch/</link><pubDate>Fri, 08 Sep 2017 16:50:24 -0400</pubDate><author>hello@victoria.dev (Victoria Drake)</author><guid>https://victoria.dev/blog/how-to-code-a-satellite-algorithm-and-cook-paella-from-scratch/</guid><description>A guide to expertly tackling seemingly complicated problems that you'd rather never tackle in the first place.</description><content:encoded>
&lt;img src="https://victoria.dev/blog/how-to-code-a-satellite-algorithm-and-cook-paella-from-scratch/cover_solve-paella_hu7c9f995cc962a3f8b743096a43864b63_232134_640x0_resize_q75_box.jpg" width="640" height="320"/>
&lt;p>What if I told you that by the end of this article, you&amp;rsquo;ll be able to calculate the orbital period of satellites around Earth using their average altitudes and&amp;hellip; You tuned out already, didn&amp;rsquo;t you?&lt;/p>
&lt;p>Okay, how about this: I&amp;rsquo;m going to teach you how to make paella!&lt;/p>
&lt;p>&lt;em>And&lt;/em> you&amp;rsquo;ll have written a function that does &lt;em>the stuff I mentioned above&lt;/em>, just like I did for a freeCodeCamp challenge.&lt;/p>
&lt;p>I promise there&amp;rsquo;s an overarching moral lesson that will benefit you every day for the rest of your life. Or at least, feed you for one night. Let&amp;rsquo;s get started.&lt;/p>
&lt;h2 id="the-only-thing-i-know-about-paella-is-that-its-an-emoticon" class="anchor-link">&lt;a href="#the-only-thing-i-know-about-paella-is-that-its-an-emoticon">The only thing I know about paella is that it&amp;rsquo;s an emoticon&lt;/a>&lt;/h2>
&lt;figure>
&lt;img src="solve-unicode-paella.jpg"
alt="Unicode paella emoji."/> &lt;figcaption>
&lt;p>Unless you&amp;rsquo;re reading this on a Samsung phone, in which case you&amp;rsquo;re looking at a Korean hotpot.&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;p>One of my favorite things about living in the world today is that it&amp;rsquo;s &lt;em>totally fine&lt;/em> to know next-to-nothing about something. A hundred years ago you might have gone your whole life not knowing anything more about paella other than that it&amp;rsquo;s an emoticon.* But today? You can simply &lt;a href="https://en.wikipedia.org/wiki/Paella">look it up&lt;/a>.&lt;/p>
&lt;p>*That was a joke.&lt;/p>
&lt;p>As with all things in life, when we are unsure, we turn to the internet - in this case, the entry for &lt;em>paella&lt;/em> on Wikipedia, which reads:&lt;/p>
&lt;blockquote>
&lt;p>Paella &amp;hellip;is a Valencian rice dish. Paella has ancient roots, but its modern form originated in the mid-19th century near the Albufera lagoon on the east coast of Spain adjacent to the city of Valencia. Many non-Spaniards view paella as Spain&amp;rsquo;s national dish, but most Spaniards consider it to be a regional Valencian dish. Valencians, in turn, regard paella as one of their identifying symbols.&lt;/p>
&lt;/blockquote>
&lt;p>At this point, you&amp;rsquo;re probably full of questions. Do I need to talk to a Valencian? Should I take an online course on the history of Spain? What type of paella should I try to make? What is the common opinion of modern chefs when it comes to paella types?&lt;/p>
&lt;p>If you set out with the intention of answering all these questions, one thing is certain: you&amp;rsquo;ll never end up actually making paella. You&amp;rsquo;ll spend hours upon hours typing questions into search engines and years later wake up with a Masters in Valencian Cuisine.&lt;/p>
&lt;h2 id="the-most-important-question-method" class="anchor-link">&lt;a href="#the-most-important-question-method">The &amp;ldquo;Most Important Question&amp;rdquo; method&lt;/a>&lt;/h2>
&lt;p>When I talk to myself out loud in public (doesn&amp;rsquo;t everyone?) I refer to this as &amp;ldquo;MIQ&amp;rdquo; (rhymes with &amp;ldquo;Nick&amp;rdquo;). I also imagine MIQ to be a rather crunchy and quite adorable anthropomorphized tortilla chip. Couldn&amp;rsquo;t tell you why.&lt;/p>
&lt;p>
&lt;img src="https://victoria.dev/blog/how-to-code-a-satellite-algorithm-and-cook-paella-from-scratch/solve-miq.png#center" alt="MIQ the chip." />
&lt;/p>
&lt;p>MIQ swings his crunchy triangular body around to point me in the right direction, and the right direction always takes the form of the most important question that you need to ask yourself at any stage of problem solving. The first most important question is always this:&lt;/p>
&lt;p>&lt;strong>What is the scope of the objective I want to achieve?&lt;/strong>&lt;/p>
&lt;p>Well, you want to make paella.&lt;/p>
&lt;p>The next MIQ then becomes: how much do I actually need to know about paella in order to start making it?&lt;/p>
&lt;p>You&amp;rsquo;ve heard this advice before: any big problem can be broken down into multiple, but more manageable, bite-size problems. In this little constellation of bite-size problems, there&amp;rsquo;s only &lt;em>one&lt;/em> that you need to solve in order to get &lt;em>most of the way&lt;/em> to a complete solution.&lt;/p>
&lt;p>In the case of making paella, we need a recipe. That&amp;rsquo;s a bite-size problem that a search engine can solve for us:&lt;/p>
&lt;blockquote>
&lt;p>&lt;strong>Simple Paella Recipe&lt;/strong>&lt;/p>
&lt;ol>
&lt;li>In a medium bowl, mix together 2 tablespoons olive oil, paprika, oregano, and salt and pepper. Stir in chicken pieces to coat. Cover, and refrigerate.&lt;/li>
&lt;li>Heat 2 tablespoons olive oil in a large skillet or paella pan over medium heat. Stir in garlic, red pepper flakes, and rice. Cook, stirring, to coat rice with oil, about 3 minutes. Stir in saffron threads, bay leaf, parsley, chicken stock, and lemon zest. Bring to a boil, cover, and reduce heat to medium low. Simmer 20 minutes.&lt;/li>
&lt;li>Meanwhile, heat 2 tablespoons olive oil in a separate skillet over medium heat. Stir in marinated chicken and onion; cook 5 minutes. Stir in bell pepper and sausage; cook 5 minutes. Stir in shrimp; cook, turning the shrimp, until both sides are pink.&lt;/li>
&lt;li>Spread rice mixture onto a serving tray. Top with meat and seafood mixture. (&lt;a href="https://www.allrecipes.com/recipe/84137/easy-paella/">allrecipes.com&lt;/a>)&lt;/li>
&lt;/ol>
&lt;/blockquote>
&lt;p>And &lt;em>voila&lt;/em>! Believe it or not, we&amp;rsquo;re &lt;em>most of the way&lt;/em> there already.&lt;/p>
&lt;p>Having a set of step-by-step instructions that are easy to understand is really most of the work done. All that&amp;rsquo;s left is to go through the motions of gathering the ingredients and then making paella. From this point on, your MIQs may become fewer and far between, and they may slowly decrease in importance in relation to the overall problem. (Where do I buy paprika? How do I know when sausage is cooked? How do I set the timer on my phone for 20 minutes? How do I stop thinking about this delicious smell? Which Instagram filter best captures the ecstasy of this paella right now?)&lt;/p>
&lt;figure>
&lt;img src="solve-insta-paella.jpg"
alt="The answer to that last one is Nashville"/> &lt;figcaption>
&lt;p>The answer to that last one is Nashville&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;h2 id="i-still-know-nothing-about-calculating-the-orbital-periods-of-satellites" class="anchor-link">&lt;a href="#i-still-know-nothing-about-calculating-the-orbital-periods-of-satellites">I still know nothing about calculating the orbital periods of satellites&lt;/a>&lt;/h2>
&lt;p>Okay. Let&amp;rsquo;s examine the problem:&lt;/p>
&lt;blockquote>
&lt;p>Return a new array that transforms the element&amp;rsquo;s average altitude into their orbital periods.&lt;/p>
&lt;p>The array will contain objects in the format {name: &amp;lsquo;name&amp;rsquo;, avgAlt: avgAlt}.&lt;/p>
&lt;p>You can read about orbital periods on wikipedia.&lt;/p>
&lt;p>The values should be rounded to the nearest whole number. The body being orbited is Earth.&lt;/p>
&lt;p>The radius of the earth is 6367.4447 kilometers, and the GM value of earth is 398600.4418 km3s-2.&lt;/p>
&lt;p>&lt;code>orbitalPeriod([{name : &amp;quot;sputnik&amp;quot;, avgAlt : 35873.5553}])&lt;/code> should return &lt;code>[{name: &amp;quot;sputnik&amp;quot;, orbitalPeriod: 86400}].&lt;/code>&lt;/p>
&lt;/blockquote>
&lt;p>Well, as it turns out, in order to calculate the orbital period of satellites, we also need a recipe. Amazing, the things you can find on the internet these days.&lt;/p>
&lt;p>Courtesy of &lt;a href="http://www.dummies.com/education/science/physics/how-to-calculate-the-period-and-orbiting-radius-of-a-geosynchronous-satellite/">dummies.com&lt;/a> (yup! #noshame), here&amp;rsquo;s our recipe:&lt;/p>
&lt;figure>
&lt;img src="solve-orbital-period.png"
alt="Orbital period formula"/> &lt;figcaption>
&lt;p>It&amp;rsquo;s kind of cute, in a way.&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;p>That might look pretty complicated, but as we&amp;rsquo;ve already seen, we just need to answer the next MIQ: how much do I actually need to know about this formula in order to start using it?&lt;/p>
&lt;p>In the case of this challenge, not too much. We&amp;rsquo;re already given &lt;code>earthRadius&lt;/code>, and &lt;code>avgAlt&lt;/code> is part of our arguments object. Together, they form the radius, &lt;em>r&lt;/em>. With a couple search queries and some mental time-travel to your elementary math class, we can describe this formula in a smattering of English:&lt;/p>
&lt;p>&lt;strong>&lt;em>T&lt;/em>, the orbital period, equals 2 multiplied by Pi, in turn multiplied by the square root of the radius, &lt;em>r&lt;/em> cubed, divided by the gravitational mass, &lt;em>GM&lt;/em>.&lt;/strong>&lt;/p>
&lt;p>JavaScript has a &lt;code>Math.PI&lt;/code> property, as well as &lt;code>Math.sqrt()&lt;/code> function and &lt;code>Math.pow()&lt;/code> function. Using those combined with simple calculation, we can represent this equation in a single line assigned to a variable:&lt;/p>
&lt;div class="highlight">&lt;pre class="chroma">&lt;code class="language-js" data-lang="js">&lt;span class="kd">var&lt;/span> &lt;span class="nx">orbitalPeriod&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="mi">2&lt;/span> &lt;span class="o">*&lt;/span> &lt;span class="nb">Math&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">PI&lt;/span> &lt;span class="o">*&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="nb">Math&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">sqrt&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nb">Math&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">pow&lt;/span>&lt;span class="p">((&lt;/span>&lt;span class="nx">earthRadius&lt;/span> &lt;span class="o">+&lt;/span> &lt;span class="nx">avgAlt&lt;/span>&lt;span class="p">),&lt;/span> &lt;span class="mi">3&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="o">/&lt;/span> &lt;span class="nx">GM&lt;/span>&lt;span class="p">));&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>From the inside out:&lt;/p>
&lt;ol>
&lt;li>Add &lt;code>earthRadius&lt;/code> and &lt;code>avgAlt&lt;/code>&lt;/li>
&lt;li>Cube the result of step 1&lt;/li>
&lt;li>Divide the result of step 2 by GM&lt;/li>
&lt;li>Take the square root of the result of step 3&lt;/li>
&lt;li>Multiply 2 times Pi times the result of step 4&lt;/li>
&lt;li>Assign the returned value to &lt;code>orbitalPeriod&lt;/code>&lt;/li>
&lt;/ol>
&lt;p>Believe it or not, we&amp;rsquo;re already most of the way there.&lt;/p>
&lt;p>The next MIQ for this challenge is to take the arguments object, extract the information we need, and return the result of our equation in the required format. There are a multitude of ways to do this, but I&amp;rsquo;m happy with a straightforward &lt;code>for&lt;/code> loop:&lt;/p>
&lt;div class="highlight">&lt;pre class="chroma">&lt;code class="language-js" data-lang="js">&lt;span class="kd">function&lt;/span> &lt;span class="nx">orbitalPeriod&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">arr&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="kd">var&lt;/span> &lt;span class="nx">resultArr&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="p">[];&lt;/span>
&lt;span class="k">for&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="kd">var&lt;/span> &lt;span class="nx">teapot&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="nx">teapot&lt;/span> &lt;span class="o">&amp;lt;&lt;/span> &lt;span class="nx">arguments&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="mi">0&lt;/span>&lt;span class="p">].&lt;/span>&lt;span class="nx">length&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="nx">teapot&lt;/span>&lt;span class="o">++&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="kd">var&lt;/span> &lt;span class="nx">GM&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="mf">398600.4418&lt;/span>&lt;span class="p">;&lt;/span>
&lt;span class="kd">var&lt;/span> &lt;span class="nx">earthRadius&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="mf">6367.4447&lt;/span>&lt;span class="p">;&lt;/span>
&lt;span class="kd">var&lt;/span> &lt;span class="nx">avgAlt&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="nx">arguments&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="mi">0&lt;/span>&lt;span class="p">][&lt;/span>&lt;span class="nx">teapot&lt;/span>&lt;span class="p">][&lt;/span>&lt;span class="s1">&amp;#39;avgAlt&amp;#39;&lt;/span>&lt;span class="p">];&lt;/span>
&lt;span class="kd">var&lt;/span> &lt;span class="nx">name&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="nx">arguments&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="mi">0&lt;/span>&lt;span class="p">][&lt;/span>&lt;span class="nx">teapot&lt;/span>&lt;span class="p">][&lt;/span>&lt;span class="s1">&amp;#39;name&amp;#39;&lt;/span>&lt;span class="p">];&lt;/span>
&lt;span class="kd">var&lt;/span> &lt;span class="nx">orbitalPeriod&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="mi">2&lt;/span> &lt;span class="o">*&lt;/span> &lt;span class="nb">Math&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">PI&lt;/span> &lt;span class="o">*&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="nb">Math&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">sqrt&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nb">Math&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">pow&lt;/span>&lt;span class="p">((&lt;/span>&lt;span class="nx">earthRadius&lt;/span> &lt;span class="o">+&lt;/span> &lt;span class="nx">avgAlt&lt;/span>&lt;span class="p">),&lt;/span> &lt;span class="mi">3&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="o">/&lt;/span> &lt;span class="nx">GM&lt;/span>&lt;span class="p">));&lt;/span>
&lt;span class="kd">var&lt;/span> &lt;span class="nx">result&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="nx">name&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="nx">name&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="nx">orbitalPeriod&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="nb">Math&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">round&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">orbitalPeriod&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="p">}&lt;/span>
&lt;span class="nx">resultArr&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">push&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">result&lt;/span>&lt;span class="p">);&lt;/span>
&lt;span class="p">}&lt;/span>
&lt;span class="k">return&lt;/span> &lt;span class="nx">resultArr&lt;/span>&lt;span class="p">;&lt;/span>
&lt;span class="p">}&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>If you need a refresher on iterating through arrays, have a look at my &lt;a href="https://victoria.dev/blog/iterating-over-objects-and-arrays-frequent-errors/">article on iterating, featuring breakfast arrays&lt;/a>! (5 minutes read)&lt;/p>
&lt;p>Don&amp;rsquo;t look now, but you just gained the ability to calculate the orbital period of satellites. You could even do it &lt;em>while&lt;/em> making paella, if you wanted to. Seriously. Put it on your resume.&lt;/p>
&lt;h2 id="tldr-the-overarching-moral-lesson" class="anchor-link">&lt;a href="#tldr-the-overarching-moral-lesson">Tl;dr: the overarching moral lesson&lt;/a>&lt;/h2>
&lt;p>Whether it&amp;rsquo;s cooking, coding, or anything else, problems may at first seem confusing, insurmountable, or downright boring. If you&amp;rsquo;re faced with such a challenge, just remember: they&amp;rsquo;re a lot more digestible with a side of bite-sized MIQ chips.&lt;/p>
&lt;p>
&lt;img src="https://victoria.dev/blog/how-to-code-a-satellite-algorithm-and-cook-paella-from-scratch/solve-miq-bowl.png#center" alt="Bowl of MIQs." />
&lt;/p></content:encoded><enclosure url="https://victoria.dev/blog/how-to-code-a-satellite-algorithm-and-cook-paella-from-scratch/cover_solve-paella_hu7c9f995cc962a3f8b743096a43864b63_232134_640x0_resize_q75_box.jpg" type="image/jpg"/></item><item><title>Making sandwiches with closures in JavaScript</title><link>https://victoria.dev/blog/making-sandwiches-with-closures-in-javascript/</link><pubDate>Sun, 28 May 2017 09:16:35 +0700</pubDate><author>hello@victoria.dev (Victoria Drake)</author><guid>https://victoria.dev/blog/making-sandwiches-with-closures-in-javascript/</guid><description>An explanation of closures and how they can emulate private methods in JavaScript.</description><content:encoded>
&lt;img src="https://victoria.dev/blog/making-sandwiches-with-closures-in-javascript/cover_closures-sandwich_hud81d1fec4fb76eb8b9cdb31f41b7a4aa_32752_640x0_resize_q75_box.jpg" width="640" height="320"/>
&lt;p>Say you&amp;rsquo;re having a little coding get-together, and you need some sandwiches. You happen to know that everyone prefers a different type of sandwich, like chicken, ham, or peanut butter and mayo. You could make all these sandwiches yourself, but that would be tedious and boring.&lt;/p>
&lt;p>Luckily, you know of a nearby sandwich shop that delivers. They have the ability and ingredients to make any kind of sandwich in the world, and all you have to do is order through their app.&lt;/p>
&lt;p>The sandwich shop looks like this:&lt;/p>
&lt;div class="highlight">&lt;pre class="chroma">&lt;code class="language-js" data-lang="js">&lt;span class="kd">function&lt;/span> &lt;span class="nx">makeMeASandwich&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">x&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="kd">var&lt;/span> &lt;span class="nx">ingredients&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="nx">x&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">join&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s1">&amp;#39; &amp;#39;&lt;/span>&lt;span class="p">);&lt;/span>
&lt;span class="k">return&lt;/span> &lt;span class="kd">function&lt;/span> &lt;span class="nx">barry&lt;/span>&lt;span class="p">()&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="k">return&lt;/span> &lt;span class="nx">ingredients&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">concat&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s1">&amp;#39; sandwich&amp;#39;&lt;/span>&lt;span class="p">);&lt;/span>
&lt;span class="p">}&lt;/span>
&lt;span class="p">}&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>Notice that we have an outer function, &lt;code>makeMeASandwich()&lt;/code> that takes an argument, &lt;code>x&lt;/code>. This outer function has the local variable &lt;code>ingredients&lt;/code>, which is just &lt;code>x&lt;/code> mushed together.&lt;/p>
&lt;p>Barry? Who&amp;rsquo;s Barry? He&amp;rsquo;s the guy who works at the sandwich shop. You&amp;rsquo;ll never talk with Barry directly, but he&amp;rsquo;s the reason your sandwiches are made, and why they&amp;rsquo;re so delicious. Barry takes &lt;code>ingredients&lt;/code> and mushes them together with &amp;quot; sandwich&amp;quot;.&lt;/p>
&lt;p>The reason Barry is able to access the &lt;code>ingredients&lt;/code> is because they&amp;rsquo;re in his outer scope. If you were to take Barry out of the sandwich shop, he&amp;rsquo;d no longer be able to access them. This is an example of &lt;em>lexical scoping&lt;/em>: &amp;ldquo;Nested functions have access to variables declared in their outer scope.&amp;rdquo; (&lt;a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Closures#Lexical_scoping">MDN&lt;/a>)&lt;/p>
&lt;p>Barry, happily at work in the sandwich shop, is an example of a closure.&lt;/p>
&lt;blockquote>
&lt;p>&lt;strong>Closures&lt;/strong> are functions that refer to independent (free) variables (variables that are used locally, but defined in an enclosing scope). In other words, these functions &amp;lsquo;remember&amp;rsquo; the environment in which they were created. (&lt;a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Closures">MDN&lt;/a>)&lt;/p>
&lt;/blockquote>
&lt;p>When you order, the app submits your sandwich request like so:&lt;/p>
&lt;div class="highlight">&lt;pre class="chroma">&lt;code class="language-js" data-lang="js">&lt;span class="kd">var&lt;/span> &lt;span class="nx">pbm&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="nx">makeMeASandwich&lt;/span>&lt;span class="p">([&lt;/span>&lt;span class="s1">&amp;#39;peanut butter&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s1">&amp;#39;mayo&amp;#39;&lt;/span>&lt;span class="p">]);&lt;/span>
&lt;span class="nx">pbm&lt;/span>&lt;span class="p">();&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>And in thirty-minutes-or-it&amp;rsquo;s-free, you get: &lt;code>peanut butter mayo sandwich&lt;/code>.&lt;/p>
&lt;p>The nice thing about the sandwich shop app is that it remembers the sandwiches you&amp;rsquo;ve ordered before. Your peanut butter and mayo sandwich is now available to you as &lt;code>pbm()&lt;/code> for you to order anytime. It&amp;rsquo;s pretty convenient since, each time you order, there&amp;rsquo;s no need to specify that the sandwich you want is the same one you got before with peanut butter and mayo and it&amp;rsquo;s a sandwich. Using &lt;code>pbm()&lt;/code> is much more concise.&lt;/p>
&lt;p>Let&amp;rsquo;s order the sandwiches you need for the party:&lt;/p>
&lt;div class="highlight">&lt;pre class="chroma">&lt;code class="language-js" data-lang="js">&lt;span class="kd">var&lt;/span> &lt;span class="nx">pmrp&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="nx">makeMeASandwich&lt;/span>&lt;span class="p">([&lt;/span>&lt;span class="s1">&amp;#39;prosciutto&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s1">&amp;#39;mozzarella&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s1">&amp;#39;red pepper&amp;#39;&lt;/span>&lt;span class="p">]);&lt;/span>
&lt;span class="kd">var&lt;/span> &lt;span class="nx">pbt&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="nx">makeMeASandwich&lt;/span>&lt;span class="p">([&lt;/span>&lt;span class="s1">&amp;#39;peanut butter&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s1">&amp;#39;tuna&amp;#39;&lt;/span>&lt;span class="p">]);&lt;/span>
&lt;span class="kd">var&lt;/span> &lt;span class="nx">hm&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="nx">makeMeASandwich&lt;/span>&lt;span class="p">([&lt;/span>&lt;span class="s1">&amp;#39;ham&amp;#39;&lt;/span>&lt;span class="p">]);&lt;/span>
&lt;span class="kd">var&lt;/span> &lt;span class="nx">pbm&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="nx">makeMeASandwich&lt;/span>&lt;span class="p">([&lt;/span>&lt;span class="s1">&amp;#39;peanut butter&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s1">&amp;#39;mayo&amp;#39;&lt;/span>&lt;span class="p">]);&lt;/span>
&lt;span class="nx">pmrp&lt;/span>&lt;span class="p">();&lt;/span>
&lt;span class="nx">pbt&lt;/span>&lt;span class="p">();&lt;/span>
&lt;span class="nx">hm&lt;/span>&lt;span class="p">();&lt;/span>
&lt;span class="nx">pbm&lt;/span>&lt;span class="p">();&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>Your order confirmation reads:&lt;/p>
&lt;div class="highlight">&lt;pre class="chroma">&lt;code class="language-sh" data-lang="sh">prosciutto mozzarella red pepper sandwich
peanut butter tuna sandwich
ham sandwich
peanut butter mayo sandwich
&lt;/code>&lt;/pre>&lt;/div>&lt;p>Plot twist! The guy who wanted a ham sandwich now wants a ham &lt;em>and cheese&lt;/em> sandwich. Luckily, the sandwich shop just released a new version of their app that will let you add cheese to any sandwich.&lt;/p>
&lt;p>With this added feature, the sandwich shop now looks like this:&lt;/p>
&lt;div class="highlight">&lt;pre class="chroma">&lt;code class="language-js" data-lang="js">&lt;span class="kd">function&lt;/span> &lt;span class="nx">makeMeASandwich&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">x&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="kd">var&lt;/span> &lt;span class="nx">ingredients&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="nx">x&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">join&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s1">&amp;#39; &amp;#39;&lt;/span>&lt;span class="p">);&lt;/span>
&lt;span class="kd">var&lt;/span> &lt;span class="nx">slices&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">;&lt;/span>
&lt;span class="kd">function&lt;/span> &lt;span class="nx">barry&lt;/span>&lt;span class="p">()&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="k">return&lt;/span> &lt;span class="nx">ingredients&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">concat&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s1">&amp;#39; sandwich&amp;#39;&lt;/span>&lt;span class="p">);&lt;/span>
&lt;span class="p">}&lt;/span>
&lt;span class="kd">function&lt;/span> &lt;span class="nx">barryAddCheese&lt;/span>&lt;span class="p">()&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="nx">slices&lt;/span> &lt;span class="o">+=&lt;/span> &lt;span class="mi">2&lt;/span>&lt;span class="p">;&lt;/span>
&lt;span class="k">return&lt;/span> &lt;span class="nx">ingredients&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">concat&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s1">&amp;#39; sandwich with &amp;#39;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">slices&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s1">&amp;#39; slices of cheese&amp;#39;&lt;/span>&lt;span class="p">);&lt;/span>
&lt;span class="p">}&lt;/span>
&lt;span class="k">return&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="nx">noCheese&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="kd">function&lt;/span>&lt;span class="p">()&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="k">return&lt;/span> &lt;span class="nx">barry&lt;/span>&lt;span class="p">();&lt;/span>
&lt;span class="p">},&lt;/span>
&lt;span class="nx">addCheese&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="kd">function&lt;/span>&lt;span class="p">()&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="k">return&lt;/span> &lt;span class="nx">barryAddCheese&lt;/span>&lt;span class="p">();&lt;/span>
&lt;span class="p">}&lt;/span>
&lt;span class="p">}&lt;/span>
&lt;span class="p">}&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>You amend the order to look like this:&lt;/p>
&lt;div class="highlight">&lt;pre class="chroma">&lt;code class="language-js" data-lang="js">&lt;span class="nx">pmrp&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">noCheese&lt;/span>&lt;span class="p">();&lt;/span>
&lt;span class="nx">pbt&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">noCheese&lt;/span>&lt;span class="p">();&lt;/span>
&lt;span class="nx">hm&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">addCheese&lt;/span>&lt;span class="p">();&lt;/span>
&lt;span class="nx">pbm&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">noCheese&lt;/span>&lt;span class="p">();&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>And your order confirmation reads:&lt;/p>
&lt;div class="highlight">&lt;pre class="chroma">&lt;code class="language-sh" data-lang="sh">prosciutto mozzarella red pepper sandwich
peanut butter tuna sandwich
ham sandwich with &lt;span class="m">2&lt;/span> slices of cheese
peanut butter mayo sandwich
&lt;/code>&lt;/pre>&lt;/div>&lt;p>You&amp;rsquo;ll notice that when you order a sandwich with cheese, Barry puts 2 slices of cheese on it. In this way, the sandwich shop controls how much cheese you get. You can&amp;rsquo;t get to Barry to tell him you want more than 2 slices at a time. That&amp;rsquo;s because your only access to the sandwich shop is through the public functions &lt;code>noCheese&lt;/code> or &lt;code>addCheese&lt;/code>.&lt;/p>
&lt;p>Of course, there&amp;rsquo;s a way to cheat the system&amp;hellip;&lt;/p>
&lt;div class="highlight">&lt;pre class="chroma">&lt;code class="language-js" data-lang="js">&lt;span class="nx">hm&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">addCheese&lt;/span>&lt;span class="p">();&lt;/span>
&lt;span class="nx">hm&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">addCheese&lt;/span>&lt;span class="p">();&lt;/span>
&lt;span class="nx">hm&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">addCheese&lt;/span>&lt;span class="p">();&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>By ordering the same ham sandwich with cheese three times, you get: &lt;code>ham sandwich with 6 slices of cheese&lt;/code>.&lt;/p>
&lt;p>This happens because the sandwich shop app recognizes the variable &lt;code>hm&lt;/code> as the same sandwich each time, and increases the number of cheese slices it tells Barry to add.&lt;/p>
&lt;p>The app could prevent you from adding lots of cheese to the same sandwich, either by adding a maximum or by appending unique order numbers to the variable names&amp;hellip; but this is our fantasy sandwich shop, and we get to pile on as much cheese as we want.&lt;/p>
&lt;p>
&lt;img src="https://victoria.dev/blog/making-sandwiches-with-closures-in-javascript/closures-cheesestack.jpg#center" alt="All the cheese." />
&lt;/p>
&lt;p>By using closures, we can have JavaScript emulate private methods found in languages like Ruby and Java. Closures are a useful way to extend the functionality of JavaScript, and also order sandwiches.&lt;/p></content:encoded><enclosure url="https://victoria.dev/blog/making-sandwiches-with-closures-in-javascript/cover_closures-sandwich_hud81d1fec4fb76eb8b9cdb31f41b7a4aa_32752_640x0_resize_q75_box.jpg" type="image/jpg"/></item><item><title>Understanding Array.prototype.reduce() and recursion using apple pie</title><link>https://victoria.dev/blog/understanding-array.prototype.reduce-and-recursion-using-apple-pie/</link><pubDate>Thu, 18 May 2017 11:40:06 +0700</pubDate><author>hello@victoria.dev (Victoria Drake)</author><guid>https://victoria.dev/blog/understanding-array.prototype.reduce-and-recursion-using-apple-pie/</guid><description>An explanation of JavaScript reduce() method and recursive functions using delicious, attention-retaining apples.</description><content:encoded>
&lt;img src="https://victoria.dev/blog/understanding-array.prototype.reduce-and-recursion-using-apple-pie/cover_recursion-pie_hu8ebe63016922b8d03a55fee198b3157a_116172_640x0_resize_q75_box.jpg" width="640" height="341"/>
&lt;p>I was having trouble understanding &lt;code>reduce()&lt;/code> and recursion in JavaScript, so I wrote this article to explain it to myself (hey, look, recursion!). I hope you find my examples both helpful and delicious.&lt;/p>
&lt;p>Given an array with nested arrays:&lt;/p>
&lt;div class="highlight">&lt;pre class="chroma">&lt;code class="language-js" data-lang="js">&lt;span class="kd">var&lt;/span> &lt;span class="nx">arr&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="p">[&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="p">[&lt;/span>&lt;span class="mi">2&lt;/span>&lt;span class="p">],&lt;/span> &lt;span class="p">[&lt;/span>&lt;span class="mi">3&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="p">[[&lt;/span>&lt;span class="mi">4&lt;/span>&lt;span class="p">]]]]&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>We want to produce this:&lt;/p>
&lt;div class="highlight">&lt;pre class="chroma">&lt;code class="language-js" data-lang="js">&lt;span class="kd">var&lt;/span> &lt;span class="nx">flat&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="p">[&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">2&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">3&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">4&lt;/span>&lt;span class="p">]&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>
&lt;h2 id="using-for-loops-and-if-statements" class="anchor-link">&lt;a href="#using-for-loops-and-if-statements">Using for loops and if statements&lt;/a>&lt;/h2>
&lt;p>Naively, if we know the maximum number of nested arrays we&amp;rsquo;ll encounter (there are 4 in this example), we can use &lt;code>for&lt;/code> loops to iterate through each array item, then &lt;code>if&lt;/code> statements to check if each item is in itself an array, and so on&amp;hellip;&lt;/p>
&lt;div class="highlight">&lt;pre class="chroma">&lt;code class="language-js" data-lang="js">&lt;span class="kd">function&lt;/span> &lt;span class="nx">flatten&lt;/span>&lt;span class="p">()&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="kd">var&lt;/span> &lt;span class="nx">flat&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="p">[];&lt;/span>
&lt;span class="k">for&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="kd">var&lt;/span> &lt;span class="nx">i&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="mi">0&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="nx">i&lt;/span>&lt;span class="o">&amp;lt;&lt;/span>&lt;span class="nx">arr&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">length&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="nx">i&lt;/span>&lt;span class="o">++&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="k">if&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="nb">Array&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">isArray&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">arr&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="nx">i&lt;/span>&lt;span class="p">]))&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="k">for&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="kd">var&lt;/span> &lt;span class="nx">ii&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="mi">0&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="nx">ii&lt;/span>&lt;span class="o">&amp;lt;&lt;/span>&lt;span class="nx">arr&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="nx">i&lt;/span>&lt;span class="p">].&lt;/span>&lt;span class="nx">length&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="nx">ii&lt;/span>&lt;span class="o">++&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="k">if&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="nb">Array&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">isArray&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">arr&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="nx">i&lt;/span>&lt;span class="p">][&lt;/span>&lt;span class="nx">ii&lt;/span>&lt;span class="p">]))&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="k">for&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="kd">var&lt;/span> &lt;span class="nx">iii&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="mi">0&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="nx">iii&lt;/span>&lt;span class="o">&amp;lt;&lt;/span>&lt;span class="nx">arr&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="nx">i&lt;/span>&lt;span class="p">][&lt;/span>&lt;span class="nx">ii&lt;/span>&lt;span class="p">].&lt;/span>&lt;span class="nx">length&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="nx">iii&lt;/span>&lt;span class="o">++&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="k">for&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="kd">var&lt;/span> &lt;span class="nx">iiii&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="mi">0&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="nx">iiii&lt;/span>&lt;span class="o">&amp;lt;&lt;/span>&lt;span class="nx">arr&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="nx">i&lt;/span>&lt;span class="p">][&lt;/span>&lt;span class="nx">ii&lt;/span>&lt;span class="p">][&lt;/span>&lt;span class="nx">iii&lt;/span>&lt;span class="p">].&lt;/span>&lt;span class="nx">length&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="nx">iiii&lt;/span>&lt;span class="o">++&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="k">if&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="nb">Array&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">isArray&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">arr&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="nx">i&lt;/span>&lt;span class="p">][&lt;/span>&lt;span class="nx">ii&lt;/span>&lt;span class="p">][&lt;/span>&lt;span class="nx">iii&lt;/span>&lt;span class="p">]))&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="nx">flat&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">push&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">arr&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="nx">i&lt;/span>&lt;span class="p">][&lt;/span>&lt;span class="nx">ii&lt;/span>&lt;span class="p">][&lt;/span>&lt;span class="nx">iii&lt;/span>&lt;span class="p">][&lt;/span>&lt;span class="nx">iiii&lt;/span>&lt;span class="p">]);&lt;/span>
&lt;span class="p">}&lt;/span> &lt;span class="k">else&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="nx">flat&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">push&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">arr&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="nx">i&lt;/span>&lt;span class="p">][&lt;/span>&lt;span class="nx">ii&lt;/span>&lt;span class="p">][&lt;/span>&lt;span class="nx">iii&lt;/span>&lt;span class="p">]);&lt;/span>
&lt;span class="p">}&lt;/span>
&lt;span class="p">}&lt;/span>
&lt;span class="p">}&lt;/span>
&lt;span class="p">}&lt;/span> &lt;span class="k">else&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="nx">flat&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">push&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">arr&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="nx">i&lt;/span>&lt;span class="p">][&lt;/span>&lt;span class="nx">ii&lt;/span>&lt;span class="p">]);&lt;/span>
&lt;span class="p">}&lt;/span>
&lt;span class="p">}&lt;/span>
&lt;span class="p">}&lt;/span> &lt;span class="k">else&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="nx">flat&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">push&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">arr&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="nx">i&lt;/span>&lt;span class="p">]);&lt;/span>
&lt;span class="p">}&lt;/span>
&lt;span class="p">}&lt;/span>
&lt;span class="p">}&lt;/span>
&lt;span class="c1">// [1, 2, 3, 4]
&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>&amp;hellip;Which works, but of course looks ridiculous. Besides looking ridiculous, a) it only works if we know how many nested arrays we&amp;rsquo;ll process, b) it&amp;rsquo;s hard to read and harder to understand, and c) can you imagine having to debug this mess?! (Gee, I think there&amp;rsquo;s an extra &lt;code>i&lt;/code> somewhere.)&lt;/p>
&lt;h2 id="using-reduce" class="anchor-link">&lt;a href="#using-reduce">Using reduce&lt;/a>&lt;/h2>
&lt;p>JavaScript has a couple methods we can use to make our code a little less ridiculous. One of these is &lt;code>reduce()&lt;/code> and it looks like this:&lt;/p>
&lt;div class="highlight">&lt;pre class="chroma">&lt;code class="language-js" data-lang="js">&lt;span class="kd">var&lt;/span> &lt;span class="nx">flat&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="nx">arr&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">reduce&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="kd">function&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">done&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="nx">curr&lt;/span>&lt;span class="p">){&lt;/span>
&lt;span class="k">return&lt;/span> &lt;span class="nx">done&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">concat&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">curr&lt;/span>&lt;span class="p">);&lt;/span>
&lt;span class="p">},&lt;/span> &lt;span class="p">[]);&lt;/span>
&lt;span class="c1">// [ 1, 2, 3, [ [ 4 ] ] ]
&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>It&amp;rsquo;s a lot less code, but we haven&amp;rsquo;t taken care of some of the nested arrays. Let&amp;rsquo;s first walk through &lt;code>reduce()&lt;/code> together and examine what it does to see how we&amp;rsquo;ll correct this.&lt;/p>
&lt;blockquote>
&lt;p>&lt;strong>Array.prototype.reduce()&lt;/strong>
The reduce() method applies a function against an accumulator and each element in the array (from left to right) to reduce it to a single value. (&lt;a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/Reduce?v=example">MDN&lt;/a>)&lt;/p>
&lt;/blockquote>
&lt;p>It&amp;rsquo;s not quite as complicated as it seems. Let&amp;rsquo;s think of &lt;code>reduce()&lt;/code> as an out-of-work developer (AI took all the dev jobs) with an empty basket. We&amp;rsquo;ll call him Adam. Adam&amp;rsquo;s main function (ba-dum ching) is now to take apples from a pile, shine them up, and put them one-by-one into the basket. This basket of shiny apples is destined to become delicious apple pies. It&amp;rsquo;s a very important job.&lt;/p>
&lt;figure>
&lt;img src="recursion-apple-formula.jpg"
alt="Pile of apples &amp;#43; Adam: apple pie"/> &lt;figcaption>
&lt;p>Apples plus human effort equals pie. Not to be confused with apple-human-pie, which is less appetizing.&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;p>In our above example, the pile of apples is our array, &lt;code>arr&lt;/code>. Our basket is &lt;code>done&lt;/code>, the accumulator. The initial value of &lt;code>done&lt;/code> is an empty array, which we see as &lt;code>[]&lt;/code> at the end of our reduce function. The apple that our out-of-work dev is currently shining, you guessed it, is &lt;code>curr&lt;/code>. Once Adam processes the current apple, he places it into the basket (&lt;code>.concat()&lt;/code>). When there are no more apples in the pile, he returns the basket of polished apples to us, and then probably goes home to his cat, or something.&lt;/p>
&lt;h2 id="using-reduce-recursively-to-address-nested-arrays" class="anchor-link">&lt;a href="#using-reduce-recursively-to-address-nested-arrays">Using reduce recursively to address nested arrays&lt;/a>&lt;/h2>
&lt;p>So that&amp;rsquo;s all well and good, and now we have a basket of polished apples. But we still have some nested arrays to deal with. Going back to our analogy, let&amp;rsquo;s say that some of the apples in the pile are in boxes. Within each box there could be more apples, and/or more boxes containing smaller, cuter apples.&lt;/p>
&lt;figure>
&lt;img src="recursion-nested-apples.jpg"
alt="Box within a box within a box with apples"/> &lt;figcaption>
&lt;p>Adorable, slightly skewed apples just want to be loved/eaten.&lt;/p>
&lt;/figcaption>
&lt;/figure>
&lt;p>Here&amp;rsquo;s what we want our apple-processing-function/Adam to do:&lt;/p>
&lt;ol>
&lt;li>If the pile of apples is a pile of apples, take an apple from the pile.&lt;/li>
&lt;li>If the apple is an apple, polish it, put it in the basket.&lt;/li>
&lt;li>If the apple is a box, open the box. If the box contains an apple, go to step 2.&lt;/li>
&lt;li>If the box contains another box, open this box, and go to step 3.&lt;/li>
&lt;li>When the pile is no more, give us the basket of shiny apples.&lt;/li>
&lt;li>If the pile of apples is not a pile of apples, give back whatever it is.&lt;/li>
&lt;/ol>
&lt;p>A recursive reduce function that accomplishes this is:&lt;/p>
&lt;div class="highlight">&lt;pre class="chroma">&lt;code class="language-js" data-lang="js">&lt;span class="kd">function&lt;/span> &lt;span class="nx">flatten&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">arr&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="k">if&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="nb">Array&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">isArray&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">arr&lt;/span>&lt;span class="p">))&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="k">return&lt;/span> &lt;span class="nx">arr&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">reduce&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="kd">function&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">done&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="nx">curr&lt;/span>&lt;span class="p">){&lt;/span>
&lt;span class="k">return&lt;/span> &lt;span class="nx">done&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">concat&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">flatten&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">curr&lt;/span>&lt;span class="p">));&lt;/span>
&lt;span class="p">},&lt;/span> &lt;span class="p">[]);&lt;/span>
&lt;span class="p">}&lt;/span> &lt;span class="k">else&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="k">return&lt;/span> &lt;span class="nx">arr&lt;/span>&lt;span class="p">;&lt;/span>
&lt;span class="p">}&lt;/span>
&lt;span class="p">}&lt;/span>
&lt;span class="c1">// [ 1, 2, 3, 4 ]
&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>Bear with me and I&amp;rsquo;ll explain.&lt;/p>
&lt;blockquote>
&lt;p>An act of a function calling itself. Recursion is used to solve problems that contain smaller sub-problems. A recursive function can receive two inputs: a base case (ends recursion) or a recursive case (continues recursion). (&lt;a href="https://developer.mozilla.org/en-US/docs/Glossary/Recursion">MDN&lt;/a>)&lt;/p>
&lt;/blockquote>
&lt;p>If you examine our code above, you&amp;rsquo;ll see that &lt;code>flatten()&lt;/code> appears twice. The first time it appears, it tells Adam what to do with the pile of apples. The second time, it tells him what to do with the thing he&amp;rsquo;s currently holding, providing instructions in the case it&amp;rsquo;s an apple, and in the case it&amp;rsquo;s not an apple. The thing to note is that these instructions are a &lt;em>repeat of the original instructions we started with&lt;/em> - and that&amp;rsquo;s recursion.&lt;/p>
&lt;p>We&amp;rsquo;ll break it down line-by-line for clarity:&lt;/p>
&lt;ol>
&lt;li>&lt;code>function flatten(arr) {&lt;/code> - we name our overall function and specify that it will take an argument, &lt;code>arr&lt;/code>.&lt;/li>
&lt;li>`if (Array.isArray(arr)) {we examine the provided &amp;ldquo;arrgument&amp;rdquo; (I know, I&amp;rsquo;m very funny) to determine if it is an array.&lt;/li>
&lt;li>`return arr.reduce(function(done,curr){if the previous line is true and the argument is an array, we want to reduce it. This is our recursive case. We&amp;rsquo;ll apply the following function to each array item&amp;hellip;&lt;/li>
&lt;li>`return done.concat(flatten(curr));nexpected plot twist appears! The function we want to apply is the very function we&amp;rsquo;re in. Colloquially: take it from the top.&lt;/li>
&lt;li>&lt;code>}, []);ell our reduce function to start with an empty accumulator (&lt;/code>done`), and wrap it up.&lt;/li>
&lt;li>`} else {this resolves our if statement at line 2. If the provided argument isn&amp;rsquo;t an array&amp;hellip;&lt;/li>
&lt;li>&lt;code>return arr;rn whatever the&lt;/code>arr` is. (Hopefully a cute apple.) This is our base case that breaks us out of recursion.&lt;/li>
&lt;li>`}end the else statement.&lt;/li>
&lt;li>&lt;code>}&lt;/code> - end the overall function.&lt;/li>
&lt;/ol>
&lt;p>And we&amp;rsquo;re done! We&amp;rsquo;ve gone from our 24 line, 4-layers-deep nested &lt;code>for&lt;/code> loop solution to a much more concise, 9 line recursive reduce solution. Reduce and recursion can seem a little impenetrable at first, but they&amp;rsquo;re valuable tools that will save you lots of future effort once you grasp them.&lt;/p>
&lt;p>And don&amp;rsquo;t worry about Adam, our out-of-work developer. He got so much press after being featured in this article that he opened up his very own AI-managed apple pie factory. He&amp;rsquo;s very happy.&lt;/p>
&lt;figure>
&lt;img src="recursion-adams-apples.jpg"
alt="Adam&amp;#39;s apple pie factory, Adam&amp;#39;s Apples"/> &lt;figcaption>
&lt;p>+1 for you if you saw that one coming.&lt;/p>
&lt;/figcaption>
&lt;/figure></content:encoded><enclosure url="https://victoria.dev/blog/understanding-array.prototype.reduce-and-recursion-using-apple-pie/cover_recursion-pie_hu8ebe63016922b8d03a55fee198b3157a_116172_640x0_resize_q75_box.jpg" type="image/jpg"/></item><item><title>Iterating over objects and arrays: frequent errors</title><link>https://victoria.dev/blog/iterating-over-objects-and-arrays-frequent-errors/</link><pubDate>Tue, 16 May 2017 10:46:46 +0700</pubDate><author>hello@victoria.dev (Victoria Drake)</author><guid>https://victoria.dev/blog/iterating-over-objects-and-arrays-frequent-errors/</guid><description>A quick reference to why your code isn't working, or some errors I frequently make with iteration when the coffee wears off.</description><content:encoded>
&lt;img src="https://victoria.dev/blog/iterating-over-objects-and-arrays-frequent-errors/cover_hu6a5c216625002e6991fcf24fc0deba26_1321860_640x0_resize_box_2.png" width="640" height="374"/>
&lt;p>Here&amp;rsquo;s &lt;del>some complaining&lt;/del> a quick overview of some code that has confounded me more than once. I&amp;rsquo;m told even very experienced developers encounter these situations regularly, so if you find yourself on your third cup of coffee scratching your head over why your code is doing exactly what you told it to do (and not what you &lt;em>want&lt;/em> it to do), maybe this post can help you.&lt;/p>
&lt;p>The example code is JavaScript, since that&amp;rsquo;s what I&amp;rsquo;ve been working in lately, but I believe the concepts to be pretty universal.&lt;/p>
&lt;h2 id="quick-reference-for-equivalent-statements" class="anchor-link">&lt;a href="#quick-reference-for-equivalent-statements">Quick reference for equivalent statements&lt;/a>&lt;/h2>
&lt;table>
&lt;thead>
&lt;tr>
&lt;th>This&amp;hellip;&lt;/th>
&lt;th>&amp;hellip;is the same as this&lt;/th>
&lt;/tr>
&lt;/thead>
&lt;tbody>
&lt;tr>
&lt;td>&lt;code>i++;&lt;/code>&lt;/td>
&lt;td>&lt;code>i = i + 1;&lt;/code>&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;code>i--;&lt;/code>&lt;/td>
&lt;td>&lt;code>i = i - 1;&lt;/code>&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;code>apples += 5&lt;/code>&lt;/td>
&lt;td>&lt;code>apples = apples + 5;&lt;/code>&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;code>apples -= 5&lt;/code>&lt;/td>
&lt;td>&lt;code>apples = apples - 5;&lt;/code>&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;code>apples *= 5&lt;/code>&lt;/td>
&lt;td>&lt;code>apples = apples * 5;&lt;/code>&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;code>apples /= 5&lt;/code>&lt;/td>
&lt;td>&lt;code>apples = apples / 5;&lt;/code>&lt;/td>
&lt;/tr>
&lt;/tbody>
&lt;/table>
&lt;h2 id="quick-reference-for-logical-statements" class="anchor-link">&lt;a href="#quick-reference-for-logical-statements">Quick reference for logical statements&lt;/a>&lt;/h2>
&lt;table>
&lt;thead>
&lt;tr>
&lt;th>This&amp;hellip;&lt;/th>
&lt;th>&amp;hellip;gives this&lt;/th>
&lt;/tr>
&lt;/thead>
&lt;tbody>
&lt;tr>
&lt;td>&lt;code>3 == '3'&lt;/code>&lt;/td>
&lt;td>&lt;code>true&lt;/code> (type converted)&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;code>3 === '3'&lt;/code>&lt;/td>
&lt;td>&lt;code>false&lt;/code> (type matters; integer is not a string)&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;code>3 != '3'&lt;/code>&lt;/td>
&lt;td>&lt;code>false&lt;/code> (type converted, 3: 3)&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;code>3 !== '3'&lt;/code>&lt;/td>
&lt;td>&lt;code>true&lt;/code> (type matters; integer is not a string)&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>||&lt;/td>
&lt;td>logical &amp;ldquo;or&amp;rdquo;: either side evaluated&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;code>&amp;amp;&amp;amp;&lt;/code>&lt;/td>
&lt;td>logical &amp;ldquo;and&amp;rdquo;: both sides evaluated&lt;/td>
&lt;/tr>
&lt;/tbody>
&lt;/table>
&lt;h2 id="objects" class="anchor-link">&lt;a href="#objects">Objects&lt;/a>&lt;/h2>
&lt;p>Given a breakfast object that looks like this:&lt;/p>
&lt;div class="highlight">&lt;pre class="chroma">&lt;code class="language-js" data-lang="js">&lt;span class="kd">var&lt;/span> &lt;span class="nx">breakfast&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="s1">&amp;#39;eggs&amp;#39;&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="mi">2&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="s1">&amp;#39;waffles&amp;#39;&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="mi">2&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="s1">&amp;#39;fruit&amp;#39;&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="s1">&amp;#39;blueberries&amp;#39;&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="mi">5&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="s1">&amp;#39;strawberries&amp;#39;&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="mi">1&lt;/span>&lt;span class="p">,&lt;/span>
&lt;span class="p">},&lt;/span>
&lt;span class="s1">&amp;#39;coffee&amp;#39;&lt;/span>&lt;span class="o">:&lt;/span> &lt;span class="mi">1&lt;/span>
&lt;span class="p">}&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>Or like this:&lt;/p>
&lt;p>
&lt;img src="https://victoria.dev/blog/iterating-over-objects-and-arrays-frequent-errors/cover.png#center" alt="Breakfast object." />
&lt;/p>
&lt;h3 id="iterate-over-object-properties" class="anchor-link">&lt;a href="#iterate-over-object-properties">Iterate over object properties&lt;/a>&lt;/h3>
&lt;p>We can iterate through each breakfast item using a for loop as follows:&lt;/p>
&lt;div class="highlight">&lt;pre class="chroma">&lt;code class="language-js" data-lang="js">&lt;span class="k">for&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="nx">item&lt;/span> &lt;span class="k">in&lt;/span> &lt;span class="nx">breakfast&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="nx">console&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">log&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s1">&amp;#39;item: &amp;#39;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">item&lt;/span>&lt;span class="p">);&lt;/span>
&lt;span class="p">}&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>This produces:&lt;/p>
&lt;div class="highlight">&lt;pre class="chroma">&lt;code class="language-sh" data-lang="sh">item: eggs
item: waffles
item: fruit
item: coffee
&lt;/code>&lt;/pre>&lt;/div>
&lt;h3 id="get-object-property-value" class="anchor-link">&lt;a href="#get-object-property-value">Get object property value&lt;/a>&lt;/h3>
&lt;p>We can access the value of the property or nested properties (in this example, the number of items) like this:&lt;/p>
&lt;div class="highlight">&lt;pre class="chroma">&lt;code class="language-js" data-lang="js">&lt;span class="nx">console&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">log&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s1">&amp;#39;How many waffles? &amp;#39;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">breakfast&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="s1">&amp;#39;waffles&amp;#39;&lt;/span>&lt;span class="p">])&lt;/span>
&lt;span class="nx">console&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">log&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s1">&amp;#39;How many strawberries? &amp;#39;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">breakfast&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="s1">&amp;#39;fruit&amp;#39;&lt;/span>&lt;span class="p">][&lt;/span>&lt;span class="s1">&amp;#39;strawberries&amp;#39;&lt;/span>&lt;span class="p">])&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>Or equivalent syntax:&lt;/p>
&lt;div class="highlight">&lt;pre class="chroma">&lt;code class="language-js" data-lang="js">&lt;span class="nx">console&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">log&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s1">&amp;#39;How many waffles? &amp;#39;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">breakfast&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">waffles&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="nx">console&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">log&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s1">&amp;#39;How many strawberries? &amp;#39;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">breakfast&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">fruit&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">strawberries&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>This produces:&lt;/p>
&lt;div class="highlight">&lt;pre class="chroma">&lt;code class="language-sh" data-lang="sh">How many waffles? &lt;span class="m">2&lt;/span>
How many strawberries? &lt;span class="m">1&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>
&lt;h3 id="get-object-property-from-the-value" class="anchor-link">&lt;a href="#get-object-property-from-the-value">Get object property from the value&lt;/a>&lt;/h3>
&lt;p>If instead I want to access the property via the value, for example, to find out which items are served in twos, I can do so by iterating like this:&lt;/p>
&lt;div class="highlight">&lt;pre class="chroma">&lt;code class="language-js" data-lang="js">&lt;span class="k">for&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="nx">item&lt;/span> &lt;span class="k">in&lt;/span> &lt;span class="nx">breakfast&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="k">if&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="nx">breakfast&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="nx">item&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="o">==&lt;/span> &lt;span class="mi">2&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="nx">console&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">log&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s1">&amp;#39;Two of: &amp;#39;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">item&lt;/span>&lt;span class="p">);&lt;/span>
&lt;span class="p">}&lt;/span>
&lt;span class="p">}&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>Which gives us:&lt;/p>
&lt;div class="highlight">&lt;pre class="chroma">&lt;code class="language-sh" data-lang="sh">Two of: eggs
Two of: waffles
&lt;/code>&lt;/pre>&lt;/div>
&lt;h3 id="alter-nested-property-values" class="anchor-link">&lt;a href="#alter-nested-property-values">Alter nested property values&lt;/a>&lt;/h3>
&lt;p>Say I want to increase the number of fruits in breakfast, because sugar is bad for me and I like things that are bad for me. I can do that like this:&lt;/p>
&lt;div class="highlight">&lt;pre class="chroma">&lt;code class="language-js" data-lang="js">&lt;span class="kd">var&lt;/span> &lt;span class="nx">fruits&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="nx">breakfast&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="s1">&amp;#39;fruit&amp;#39;&lt;/span>&lt;span class="p">];&lt;/span>
&lt;span class="k">for&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="nx">f&lt;/span> &lt;span class="k">in&lt;/span> &lt;span class="nx">fruits&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="nx">fruits&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="nx">f&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="o">+=&lt;/span> &lt;span class="mi">1&lt;/span>&lt;span class="p">;&lt;/span>
&lt;span class="p">}&lt;/span>
&lt;span class="nx">console&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">log&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nx">fruits&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>Which gives us:&lt;/p>
&lt;div class="highlight">&lt;pre class="chroma">&lt;code class="language-sh" data-lang="sh">&lt;span class="o">{&lt;/span> blueberries: 6, strawberries: &lt;span class="m">2&lt;/span> &lt;span class="o">}&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>
&lt;h2 id="arrays" class="anchor-link">&lt;a href="#arrays">Arrays&lt;/a>&lt;/h2>
&lt;p>Given an array of waffles that looks like this:&lt;/p>
&lt;div class="highlight">&lt;pre class="chroma">&lt;code class="language-js" data-lang="js">&lt;span class="kd">var&lt;/span> &lt;span class="nx">wafflesIAte&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="p">[&lt;/span> &lt;span class="mi">1&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">3&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">2&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">5&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">2&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">11&lt;/span> &lt;span class="p">];&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>Or like this:&lt;/p>
&lt;p>
&lt;img src="https://victoria.dev/blog/iterating-over-objects-and-arrays-frequent-errors/iteration-waffles.png" alt="Waffle array." />
&lt;/p>
&lt;h3 id="iterate-through-array-items" class="anchor-link">&lt;a href="#iterate-through-array-items">Iterate through array items&lt;/a>&lt;/h3>
&lt;p>We can iterate through each item in the array using a for loop:&lt;/p>
&lt;div class="highlight">&lt;pre class="chroma">&lt;code class="language-js" data-lang="js">&lt;span class="k">for&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="kd">var&lt;/span> &lt;span class="nx">i&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="nx">i&lt;/span> &lt;span class="o">&amp;lt;&lt;/span> &lt;span class="nx">wafflesIAte&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">length&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="nx">i&lt;/span>&lt;span class="o">++&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="nx">console&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">log&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s1">&amp;#39;array index: &amp;#39;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">i&lt;/span>&lt;span class="p">);&lt;/span>
&lt;span class="nx">console&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">log&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s1">&amp;#39;item from array: &amp;#39;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">wafflesIAte&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="nx">i&lt;/span>&lt;span class="p">]);&lt;/span>
&lt;span class="p">}&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>This produces:&lt;/p>
&lt;div class="highlight">&lt;pre class="chroma">&lt;code class="language-sh" data-lang="sh">array index: &lt;span class="m">0&lt;/span>
item from array: &lt;span class="m">1&lt;/span>
array index: &lt;span class="m">1&lt;/span>
item from array: &lt;span class="m">3&lt;/span>
array index: &lt;span class="m">2&lt;/span>
item from array: &lt;span class="m">2&lt;/span>
array index: &lt;span class="m">3&lt;/span>
item from array: &lt;span class="m">0&lt;/span>
array index: &lt;span class="m">4&lt;/span>
item from array: &lt;span class="m">5&lt;/span>
array index: &lt;span class="m">5&lt;/span>
item from array: &lt;span class="m">2&lt;/span>
array index: &lt;span class="m">6&lt;/span>
item from array: &lt;span class="m">11&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>Some things to remember:
&lt;code>i&lt;/code> in the above context is a placeholder; we could substitute anything we like (&lt;code>x&lt;/code>, &lt;code>n&lt;/code>, &lt;code>underpants&lt;/code>, etc). It simply denotes each instance of the iteration.&lt;/p>
&lt;p>&lt;code>i &amp;lt; wafflesIAte.length&lt;/code> tells our for loop to continue as long as &lt;code>i&lt;/code> is less than the array&amp;rsquo;s length (in this case, 7).&lt;/p>
&lt;p>&lt;code>i++&lt;/code> is equivalent to &lt;code>i+1&lt;/code> and means we&amp;rsquo;re incrementing through our array by one each time. We could also use &lt;code>i+2&lt;/code> to proceed with every other item in the array, for example.&lt;/p>
&lt;h3 id="access-array-item-by-index" class="anchor-link">&lt;a href="#access-array-item-by-index">Access array item by index&lt;/a>&lt;/h3>
&lt;p>We can specify an item in the array using the array index, written as &lt;code>wafflesIAte[i]&lt;/code> where &lt;code>i&lt;/code> is any index of the array. This gives the item at that location.&lt;/p>
&lt;p>Array index always starts with &lt;code>0&lt;/code>, which is accessed with &lt;code>wafflesIAte[0]&lt;/code>. Using &lt;code>wafflesIAte[1]&lt;/code> gives us the second item in the array, which is &amp;ldquo;3&amp;rdquo;.&lt;/p>
&lt;h3 id="ways-to-get-mixed-up-over-arrays" class="anchor-link">&lt;a href="#ways-to-get-mixed-up-over-arrays">Ways to get mixed up over arrays&lt;/a>&lt;/h3>
&lt;p>Remember that &lt;code>wafflesIAte.length&lt;/code> and the index of the last item in the array are different. The former is 7, the latter is &lt;code>6&lt;/code>.&lt;/p>
&lt;p>When incrementing &lt;code>i&lt;/code>, remember that &lt;code>[i+1]&lt;/code> and &lt;code>[i]+1&lt;/code> are different:&lt;/p>
&lt;div class="highlight">&lt;pre class="chroma">&lt;code class="language-js" data-lang="js">&lt;span class="nx">console&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">log&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s1">&amp;#39;[i+1] gives next array index: &amp;#39;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">wafflesIAte&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="mi">0&lt;/span>&lt;span class="o">+&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">]);&lt;/span>
&lt;span class="nx">console&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">log&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s1">&amp;#39;[i]+1 gives index value + 1: &amp;#39;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nx">wafflesIAte&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="mi">0&lt;/span>&lt;span class="p">]&lt;/span>&lt;span class="o">+&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>Produces:&lt;/p>
&lt;div class="highlight">&lt;pre class="chroma">&lt;code class="language-sh" data-lang="sh">&lt;span class="o">[&lt;/span>i+1&lt;span class="o">]&lt;/span> gives next array index: &lt;span class="m">3&lt;/span>
&lt;span class="o">[&lt;/span>i&lt;span class="o">]&lt;/span>+1 gives index value + 1: &lt;span class="m">2&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>
&lt;h2 id="practice-makes-better" class="anchor-link">&lt;a href="#practice-makes-better">Practice makes&amp;hellip; better&lt;/a>&lt;/h2>
&lt;p>The more often you code and correct your errors, the better you&amp;rsquo;ll remember it next time!&lt;/p>
&lt;p>That&amp;rsquo;s all for now. If you have a correction, best practice, or another common error for me to add, please let me know!&lt;/p></content:encoded><enclosure url="https://victoria.dev/blog/iterating-over-objects-and-arrays-frequent-errors/cover_hu6a5c216625002e6991fcf24fc0deba26_1321860_640x0_resize_box_2.png" type="image/jpg"/></item><item><title>How to replace a string in a dozen old blog posts with one sed terminal command</title><link>https://victoria.dev/blog/how-to-replace-a-string-in-a-dozen-old-blog-posts-with-one-sed-terminal-command/</link><pubDate>Sat, 06 May 2017 20:04:53 +0800</pubDate><author>hello@victoria.dev (Victoria Drake)</author><guid>https://victoria.dev/blog/how-to-replace-a-string-in-a-dozen-old-blog-posts-with-one-sed-terminal-command/</guid><description>How to use sed to update a URL in all your old blog posts with simple find and replace.</description><content:encoded>
&lt;img src="https://victoria.dev/blog/how-to-replace-a-string-in-a-dozen-old-blog-posts-with-one-sed-terminal-command/cover_sed_hu0a982320f6b8be4e2c17737e58dbed29_189790_640x0_resize_box_2.png" width="640" height="320"/>
&lt;p>&lt;em>June 1, 2018: This post was previously titled &amp;ldquo;That time 30 seconds, StackOverflow, and sed saved me 30 minutes&amp;rdquo; and has since been revised and updated with more examples and a couple new doodles. It&amp;rsquo;s better now.&lt;/em>&lt;/p>
&lt;p>I&amp;rsquo;ve had more than a few usernames, URLs, and Twitter handles over the years. Whether it was changing to something that better reflected my current interests or briefly getting caught up in the &amp;ldquo;.io&amp;rdquo; domain craze, there always seemed to be a great reason for an Internet presence refresh. The downside to all this fresh rebranding is that it often means needing to update a lot of links. (If you want to redirect an old blog post URL, check out &lt;a href="https://victoria.dev/blog/moving-to-a-new-domain-without-breaking-old-links-with-aws-disqus/">this article&lt;/a> too!)&lt;/p>
&lt;p>This week, I launched my new website and changed my Twitter username to match. I was about to spend time manually going through all my old blog posts to find and update the URLs when this very future blog post popped up on my screen like &lt;a href="http://knowyourmeme.com/memes/clippy">Clippy&lt;/a> and shook its pixelated head disapprovingly.&lt;/p>
&lt;p>Here&amp;rsquo;s a worthwhile new habit for you: anytime you find yourself going &amp;ldquo;Ughhh I have to do &lt;em>that?&lt;/em> It&amp;rsquo;ll take forever!&amp;rdquo; head on over to &lt;a href="https://duckduckgo.com/">DuckDuckGo&lt;/a> and search for &amp;ldquo;terminal command (the thing you&amp;rsquo;re trying to do)&amp;rdquo;.&lt;/p>
&lt;p>
&lt;img src="https://victoria.dev/blog/how-to-replace-a-string-in-a-dozen-old-blog-posts-with-one-sed-terminal-command/sed-duck.png" alt="Superhero DuckDuckGo doodle" />
&lt;/p>
&lt;p class="img-caption">Superhero Duck is here to save your future hours!&lt;/p>
&lt;p>Here&amp;rsquo;s what I found to save myself a whole bunch of mindless tedium.&lt;/p>
&lt;h2 id="update-a-string-in-dozens-of-blog-posts-using-sed" class="anchor-link">&lt;a href="#update-a-string-in-dozens-of-blog-posts-using-sed">Update a string in dozens of blog posts using &lt;code>sed&lt;/code>&lt;/a>&lt;/h2>
&lt;p>Meet your new friend &lt;code>sed&lt;/code>. This amazingly powerful tool lives in your terminal and is available to be totally underused for things like finding and replacing strings in files. (I seem to have a habit of suggesting ways to totally underuse powerful tools, as in my exploration of how to &lt;a href="https://victoria.dev/blog/how-i-created-custom-desktop-notifications-using-terminal-and-cron/">use cron to create desktop notifications&lt;/a>, but I digress.)&lt;/p>
&lt;h3 id="current-directory-non-recursive" class="anchor-link">&lt;a href="#current-directory-non-recursive">Current directory, non-recursive&lt;/a>&lt;/h3>
&lt;p>&lt;strong>Non-recursive&lt;/strong> means sed won&amp;rsquo;t change files in any subdirectories of the current folder.&lt;/p>
&lt;p>Run this command to search all the files in your current directory and replace a given string.&lt;/p>
&lt;div class="highlight">&lt;pre class="chroma">&lt;code class="language-sh" data-lang="sh">// to replace &lt;span class="s1">&amp;#39;foo&amp;#39;&lt;/span> with &lt;span class="s1">&amp;#39;bar&amp;#39;&lt;/span>
$ sed -i -- &lt;span class="s1">&amp;#39;s/foo/bar/g&amp;#39;&lt;/span> *
&lt;/code>&lt;/pre>&lt;/div>&lt;p>Here&amp;rsquo;s what each component of the command does:&lt;/p>
&lt;ul>
&lt;li>&lt;code>-i&lt;/code> will change the original, and stands for &amp;ldquo;in-place.&amp;rdquo;&lt;/li>
&lt;li>&lt;code>s&lt;/code> is for substitute, so we can find and replace.&lt;/li>
&lt;li>&lt;code>foo&lt;/code> is the string we&amp;rsquo;ll be taking away,&lt;/li>
&lt;li>&lt;code>bar&lt;/code> is the string we&amp;rsquo;ll use instead today.&lt;/li>
&lt;li>&lt;code>g&lt;/code> as in &amp;ldquo;global&amp;rdquo; means &amp;ldquo;all occurrences, please.&amp;rdquo;&lt;/li>
&lt;li>&lt;code>*&lt;/code> denotes all file types. (No more rhymes. What a tease.)&lt;/li>
&lt;/ul>
&lt;p>You can limit the operation to one file type, such as &lt;code>txt&lt;/code>, by using:&lt;/p>
&lt;div class="highlight">&lt;pre class="chroma">&lt;code class="language-sh" data-lang="sh">sed -i -- &lt;span class="s1">&amp;#39;s/foo/bar/g&amp;#39;&lt;/span> *.txt
&lt;/code>&lt;/pre>&lt;/div>
&lt;h3 id="current-directory-and-subdirectories-recursive" class="anchor-link">&lt;a href="#current-directory-and-subdirectories-recursive">Current directory and subdirectories, recursive&lt;/a>&lt;/h3>
&lt;p>We can supplement &lt;code>sed&lt;/code> with &lt;code>find&lt;/code> to expand our scope to all the current folder&amp;rsquo;s subdirectories. This will include any hidden files.&lt;/p>
&lt;div class="highlight">&lt;pre class="chroma">&lt;code class="language-sh" data-lang="sh">find . -type f -exec sed -i &lt;span class="s1">&amp;#39;s/foo/bar/g&amp;#39;&lt;/span> &lt;span class="o">{}&lt;/span> +
&lt;/code>&lt;/pre>&lt;/div>&lt;p>To ignore hidden files (such as &lt;code>.git&lt;/code>) you can pass the negation modifier &lt;code>-not -path '*/\.*'&lt;/code>.&lt;/p>
&lt;div class="highlight">&lt;pre class="chroma">&lt;code class="language-sh" data-lang="sh">find . -type f -not -path &lt;span class="s1">&amp;#39;*/\.*&amp;#39;&lt;/span> -exec sed -i &lt;span class="s1">&amp;#39;s/foo/bar/g&amp;#39;&lt;/span> &lt;span class="o">{}&lt;/span> +
&lt;/code>&lt;/pre>&lt;/div>&lt;p>This will exclude any file that has the string &lt;code>/.&lt;/code> in its path.&lt;/p>
&lt;p>Alternatively, you can limit the operation to file names that end in a certain extension, like Markdown:&lt;/p>
&lt;div class="highlight">&lt;pre class="chroma">&lt;code class="language-sh" data-lang="sh">find . -type f -name &lt;span class="s2">&amp;#34;*.md&amp;#34;&lt;/span> -exec sed -i &lt;span class="s1">&amp;#39;s/foo/bar/g&amp;#39;&lt;/span> &lt;span class="o">{}&lt;/span> +
&lt;/code>&lt;/pre>&lt;/div>
&lt;h3 id="working-with-urls-change-the-separator" class="anchor-link">&lt;a href="#working-with-urls-change-the-separator">Working with URLs: change the separator&lt;/a>&lt;/h3>
&lt;p>In the case of needing to update a URL, the &lt;code>/&lt;/code> separator in your strings will need escaping. It ends up looking like this&amp;hellip;&lt;/p>
&lt;div class="highlight">&lt;pre class="chroma">&lt;code class="language-sh" data-lang="sh">find . -type f -exec sed -i &lt;span class="s1">&amp;#39;s/https:\/\/www.oldurl.com\/blog/https:\/\/www.newurl.com\/blog/g&amp;#39;&lt;/span> &lt;span class="o">{}&lt;/span> +
&lt;/code>&lt;/pre>&lt;/div>&lt;p>You can avoid some confusion and mistakes by changing the separator to any non-conflicting character. The character that follows the &lt;code>s&lt;/code> will be treated as the separator. In our case, using a &lt;code>,&lt;/code> or &lt;code>_&lt;/code> would do. This doesn&amp;rsquo;t require escaping and is much more readable:&lt;/p>
&lt;div class="highlight">&lt;pre class="chroma">&lt;code class="language-sh" data-lang="sh">find . -type f -exec sed -i &lt;span class="s1">&amp;#39;s_https://www.oldurl.com/blog_https://www.newurl.com/blog_g&amp;#39;&lt;/span> &lt;span class="o">{}&lt;/span> +
&lt;/code>&lt;/pre>&lt;/div>
&lt;h2 id="maybe-endless-possibilities" class="anchor-link">&lt;a href="#maybe-endless-possibilities">(Maybe) endless possibilities&lt;/a>&lt;/h2>
&lt;p>There&amp;rsquo;s a lot more that &lt;code>sed&lt;/code> can do. I&amp;rsquo;ll be adding to this living post as I find more examples that are useful. For now, &lt;a href="http://www.folkstalk.com/2012/01/sed-command-in-unix-examples.html">here are some other use cases&lt;/a> that you may find handy.&lt;/p></content:encoded><enclosure url="https://victoria.dev/blog/how-to-replace-a-string-in-a-dozen-old-blog-posts-with-one-sed-terminal-command/cover_sed_hu0a982320f6b8be4e2c17737e58dbed29_189790_640x0_resize_box_2.png" type="image/jpg"/></item><item><title>Top free resources for developing coding superpowers</title><link>https://victoria.dev/blog/top-free-resources-for-developing-coding-superpowers/</link><pubDate>Thu, 27 Apr 2017 08:14:09 +0800</pubDate><author>hello@victoria.dev (Victoria Drake)</author><guid>https://victoria.dev/blog/top-free-resources-for-developing-coding-superpowers/</guid><description>The go-to resources from my bookmarks folder for anyone who wants to learn to code.</description><content:encoded>
&lt;img src="https://victoria.dev/blog/top-free-resources-for-developing-coding-superpowers/cover_hudc938a2f2e7f34b767138d2a861f3561_1530866_640x0_resize_box_2.png" width="640" height="256"/>
&lt;p>I&amp;rsquo;m frequently asked for my opinion on how to get started with being a freelance developer. If you&amp;rsquo;re hoping to live the life of a remote working digital nomad, whichever career you choose, having a little coding expertise in your back pocket will be a big benefit.&lt;/p>
&lt;p>Here&amp;rsquo;s a quick list of resources that you should definitely look at first if you&amp;rsquo;re hoping to gain some coding superpowers for free.&lt;/p>
&lt;h2 id="freecodecamp-hahahugoshortcode-s0-hbhb" class="anchor-link">&lt;a href="#freecodecamp-hahahugoshortcode-s0-hbhb">freeCodeCamp (&lt;a href="https://freecodecamp.org/" target="_blank" rel="noopener noreferrer">freecodecamp.org&lt;/a>
)&lt;/a>&lt;/h2>
&lt;p>&lt;strong>An amazingly high value curriculum that can take you from zero to full-stack.&lt;/strong> This is always my top recommendation for someone looking to test the waters and see if a development career is interesting enough to pursue. The toughest part about learning to code on your own is getting stuck and not having quick help - this is the problem that I think freeCodeCamp (fCC) solves best by allowing you to immerse yourself in a hugely supportive social community. Through their forum, you can get quick advice if you get stuck on a challenge, and even team up with someone to tackle projects in-depth. The fCC community is lively and diverse with people from all over the world, and many local chapters even host regular meetups.&lt;/p>
&lt;h2 id="hackerrank-hahahugoshortcode-s1-hbhb" class="anchor-link">&lt;a href="#hackerrank-hahahugoshortcode-s1-hbhb">HackerRank (&lt;a href="https://www.hackerrank.com/" target="_blank" rel="noopener noreferrer">hackerrank.com&lt;/a>
)&lt;/a>&lt;/h2>
&lt;p>&lt;strong>Solve challenges tailored for every level of coder over a variety of relevant topics. Enter competitions and increase your chances of getting hired.&lt;/strong> I love HackerRank especially for its algorithm and statistics challenges - if you&amp;rsquo;re hoping to get into data science, this is an area that you&amp;rsquo;ll need to be especially sharp in. Seasoned developers return to HackerRank to hone their skills and enter competitions that can win you swag and get you noticed for jobs.&lt;/p>
&lt;h2 id="stack-overflow-hahahugoshortcode-s2-hbhb" class="anchor-link">&lt;a href="#stack-overflow-hahahugoshortcode-s2-hbhb">Stack Overflow (&lt;a href="https://stackoverflow.com/" target="_blank" rel="noopener noreferrer">stackoverflow.com/&lt;/a>
)&lt;/a>&lt;/h2>
&lt;p>&lt;strong>Even seasoned developers have questions.&lt;/strong> This is the top search hit that comes up when you Google that error message you thought only you were getting. If you&amp;rsquo;re shy about asking a question you can&amp;rsquo;t find the answer to - don&amp;rsquo;t be! Simply asking it will be of help to the next person who comes looking for the exact same solution.&lt;/p>
&lt;h2 id="the-odin-project-hahahugoshortcode-s3-hbhb" class="anchor-link">&lt;a href="#the-odin-project-hahahugoshortcode-s3-hbhb">The Odin Project (&lt;a href="http://www.theodinproject.com/" target="_blank" rel="noopener noreferrer">theodinproject.com/&lt;/a>
)&lt;/a>&lt;/h2>
&lt;p>&lt;strong>A curriculum for web developers built on a collection of resources designed to take you from &amp;ldquo;What&amp;rsquo;s the Internet?&amp;rdquo; to web dev hire.&lt;/strong> For those specifically interested in web development, there&amp;rsquo;s a community here for you. The Odin Project (TOP) has plenty of tutorials and practice projects to flesh out your knowledge of web dev essentials.&lt;/p>
&lt;h2 id="a-coding-glossary-for-kids---and-for-the-rest-of-us-too" class="anchor-link">&lt;a href="#a-coding-glossary-for-kids---and-for-the-rest-of-us-too">A coding glossary for kids - and for the rest of us, too&lt;/a>&lt;/h2>
&lt;p>&lt;em>March 4, 2020 update:&lt;/em> I recently received a nice email on behalf of Amelia and her class, from Ms. Lincoln. Amelia was kind enough to suggest adding the below resource for young people like her who want to learn how to program!&lt;/p>
&lt;p>Here&amp;rsquo;s a handy glossary and list of games and resources for kids who want to have some fun while learning how to code: &lt;a href="https://www.smartadvocate.com/News/Blog/software-programming-and-coding-glossary-for-kids" target="_blank" rel="noopener noreferrer">Software Programming and Coding Glossary for Kids&lt;/a>
. Thanks for paying it forward, Amelia, and helping others find resources like these!&lt;/p>
&lt;h3 id="what-are-you-waiting-for" class="anchor-link">&lt;a href="#what-are-you-waiting-for">What are you waiting for&lt;/a>&lt;/h3>
&lt;p>Dive in - it&amp;rsquo;s free! Good luck on your journey to coding superpowers!&lt;/p>
&lt;p>Have one I missed? Let me know!&lt;/p></content:encoded><enclosure url="https://victoria.dev/blog/top-free-resources-for-developing-coding-superpowers/cover_hudc938a2f2e7f34b767138d2a861f3561_1530866_640x0_resize_box_2.png" type="image/jpg"/></item><item><title>Things you need to know about becoming a Data Scientist</title><link>https://victoria.dev/blog/things-you-need-to-know-about-becoming-a-data-scientist/</link><pubDate>Fri, 31 Mar 2017 13:19:19 +0900</pubDate><author>hello@victoria.dev (Victoria Drake)</author><guid>https://victoria.dev/blog/things-you-need-to-know-about-becoming-a-data-scientist/</guid><description>Five Data Scientists discuss a day in the life and what it takes to be a successful Data Scientist.</description><content:encoded>
&lt;img src="https://victoria.dev/blog/things-you-need-to-know-about-becoming-a-data-scientist/cover_datasci-panelists_hud75b6aee53166895e543034fff84f78c_103732_640x0_resize_q75_box.jpg" width="640" height="427"/>
&lt;p>I recently attended a panel discussion hosted by General Assembly in Singapore entitled, &amp;ldquo;So you want to be a Data Scientist/Analyst&amp;rdquo;. The panel featured professionals in different stages of their careers and offered a wealth of information to an audience of hopefuls, including tips on how to land a job as a data scientist, and stories debunking myths that color this field.&lt;/p>
&lt;h2 id="the-panelists" class="anchor-link">&lt;a href="#the-panelists">The panelists&lt;/a>&lt;/h2>
&lt;ul>
&lt;li>&lt;strong>Misrab Faizullah-Khan&lt;/strong> - VP of Data Science, &lt;em>GO_JEK&lt;/em>&lt;/li>
&lt;li>&lt;strong>Anthony Ta&lt;/strong> - Data Scientist, &lt;em>Tech in Asia&lt;/em>&lt;/li>
&lt;li>&lt;strong>Leow Guo Jun&lt;/strong> - Data Scientist, &lt;em>GO_JEK&lt;/em>&lt;/li>
&lt;li>&lt;strong>Gabriel Jiang&lt;/strong> - Data Scientist&lt;/li>
&lt;li>&lt;strong>Adam Drake&lt;/strong> - Chief Data Officer, &lt;em>Atazzo&lt;/em>&lt;/li>
&lt;/ul>
&lt;p>Here&amp;rsquo;s a rundown of the major points discussed, paraphrased for brevity.&lt;/p>
&lt;h3 id="whats-a-day-in-the-life-like" class="anchor-link">&lt;a href="#whats-a-day-in-the-life-like">What&amp;rsquo;s a day-in-the-life like&lt;/a>&lt;/h3>
&lt;p>We&amp;rsquo;re mostly &amp;ldquo;data janitors.&amp;rdquo; A large part of working with data begins with and consists of data sanitation. Without quality data, you won&amp;rsquo;t get accurate results. Understanding how data should be sanitized largely encompasses skills that aren&amp;rsquo;t directly related to data analytics. To fully understand the problem you&amp;rsquo;re hoping to solve, you need to talk with the people involved. It&amp;rsquo;s important that everyone understands all the elements of a project, and exactly what those elements are being called. &amp;ldquo;Sales,&amp;rdquo; as an example, may be calculated differently depending on who you&amp;rsquo;re talking to.&lt;/p>
&lt;h3 id="whats-a-data-scientist-vs-data-analyst" class="anchor-link">&lt;a href="#whats-a-data-scientist-vs-data-analyst">What&amp;rsquo;s a data &amp;ldquo;scientist&amp;rdquo; vs. data &amp;ldquo;analyst&amp;rdquo;&lt;/a>&lt;/h3>
&lt;p>It largely depends on the company you work for. &amp;ldquo;Data [insert modifier]&amp;rdquo; is only a recent distinction for a job field that has historically been called &amp;ldquo;Business Analytics.&amp;rdquo; In a smaller company, as with any other position, one person may handle a variety of data-related tasks under the title of &amp;ldquo;Data Scientist.&amp;rdquo; In a larger company with more staff and finer grain specialization, you may have a &amp;ldquo;Data Analyst&amp;rdquo; that handles less technical aspects, and a &amp;ldquo;Data Scientist&amp;rdquo; whose work is very technical and involves quantitative learning or machine learning.&lt;/p>
&lt;p>The field of data science/analytics is fresh enough that standard definitions for job titles really haven&amp;rsquo;t been agreed upon yet. When considering a position, focus on the company rather than the title.&lt;/p>
&lt;h3 id="should-i-join-a-startup-or-large-company" class="anchor-link">&lt;a href="#should-i-join-a-startup-or-large-company">Should I join a startup or large company&lt;/a>&lt;/h3>
&lt;p>There&amp;rsquo;s no wrong answer. Being aware of your own working style and preferences will help guide your decision.&lt;/p>
&lt;p>Startups generally offer more freedom and less micromanaging. This also means that you&amp;rsquo;ll necessarily receive less guidance, and will need to be able to figure stuff out, learn, and make progress under your own power.&lt;/p>
&lt;p>In a big company, you&amp;rsquo;re likely to experience more structure, and be expected to follow very clearly defined pre-existing processes. Your job scope will likely be more focused than it would be at a startup. You&amp;rsquo;ll experience less freedom in general, but also more certainty in what&amp;rsquo;s expected of you.&lt;/p>
&lt;p>In the end, especially at the beginning of your career, don&amp;rsquo;t put too much stock in choosing one or the other. If you like the company, big or small, give it a try. If you&amp;rsquo;re not happy there after a few months, then try another one. No career decision is ever permanent.&lt;/p>
&lt;p>It&amp;rsquo;s also worthwhile to note that even if you find a company you like the first time around, it&amp;rsquo;s in your best interest to change companies after one or two years. The majority of the salary raises you&amp;rsquo;ll earn in your lifetime will occur in the first ten years of your career. Say you&amp;rsquo;re hired by Company A as a junior data scientist for two years - after two years, you&amp;rsquo;re no longer a junior. You can now earn, say, a 30% higher salary in a data scientist position, but it&amp;rsquo;s unlikely that Company A will give you a 30% raise after two years. At that point it&amp;rsquo;s time to find Company B and put a few more years of experience on your resume, then probably change companies again. You don&amp;rsquo;t earn the big bucks sticking with one company for decades - you&amp;rsquo;ll always be the junior developer.&lt;/p>
&lt;p>
&lt;img src="https://victoria.dev/blog/things-you-need-to-know-about-becoming-a-data-scientist/datasci-offstage.jpg" alt="Talking offstage." />
&lt;/p>
&lt;h3 id="what-do-you-look-for-when-hiring-a-candidate" class="anchor-link">&lt;a href="#what-do-you-look-for-when-hiring-a-candidate">What do you look for when hiring a candidate&lt;/a>&lt;/h3>
&lt;p>Overall, the most important skills for a data science candidate are soft skills. Curiosity, tenacity, and good communication skills are vital. Persistence, especially when it comes to adapting to a quickly changing industry, is important. The most promising candidates are passionate enough about the field to be learning everything they can, even outside of their work scope. Hard skills like coding and algorithms can be taught - it&amp;rsquo;s the soft skills that set good candidates apart.&lt;/p>
&lt;p>Hacking skills are also vital. This doesn&amp;rsquo;t necessarily mean you can write code. Someone who has a grasp of overall concepts, knows algorithms, and has curiosity enough to continuously learn is going to go farther than someone who can just write code. It takes creativity to build hacking skills on top of being familiar with the basic navigation points. Having the ability to come up with solutions that use available tools in new ways - that&amp;rsquo;s hacking skill.&lt;/p>
&lt;p>Design thinking is another important asset. Being able to understand how systems integrate on both technical and business levels is very valuable. If you&amp;rsquo;re able to see the big picture, you&amp;rsquo;re more likely to find different ways to accomplish the overall objective.&lt;/p>
&lt;p>You might think that seeing buzzwords on resumes makes you look more attractive as a candidate - more often, it stands out as a red flag. Putting &amp;ldquo;advanced machine learning&amp;rdquo; on your CV and then demonstrating that you don&amp;rsquo;t know basic algorithms doesn&amp;rsquo;t look good. It&amp;rsquo;s your projects and your interests outside of the job you&amp;rsquo;re applying for that say the most about you. Popular topics in this industry change fast - you&amp;rsquo;re better off having a solid grasp of basic fundamentals as well as a broad array of experience than name-dropping whatever&amp;rsquo;s trending.&lt;/p>
&lt;h3 id="is-there-a-future-for-humans-in-the-data-science-field-when-will-the-machines-replace-us" class="anchor-link">&lt;a href="#is-there-a-future-for-humans-in-the-data-science-field-when-will-the-machines-replace-us">Is there a future for humans in the data science field? When will the machines replace us&lt;/a>&lt;/h3>
&lt;p>This isn&amp;rsquo;t a question unique to data science, and many historical examples already exist. Financial investment is a good example - where you used to have a human do calculations and make predictions, computers now do a lot of that automatically, making decisions about risk and possible payoff every day.&lt;/p>
&lt;p>Where humans won&amp;rsquo;t be replaced, just as in other industries that have embraced automation, is in the human element. You&amp;rsquo;ll still need people to handle communication, be creative, be curious, make interpretations and understand problems&amp;hellip; all those things are fundamentally human aspects of enterprise.&lt;/p>
&lt;p>Ultimately, machines and more automation will make human work less of a grind. By automating the mundane stuff, like data sanitization for example, human minds are freed up to develop more interesting things.&lt;/p>
&lt;h3 id="what-are-the-future-applications-for-data-driven-automation" class="anchor-link">&lt;a href="#what-are-the-future-applications-for-data-driven-automation">What are the future applications for data-driven automation&lt;/a>&lt;/h3>
&lt;p>Legal is a good next candidate for automation. There&amp;rsquo;s a lot there that can be handled by programs using data to assess risk.&lt;/p>
&lt;p>Medicine is another field ripe for advances through data. Radiologists, your days are numbered: image detection is coming for you. The whole field of diagnostics is about to drastically change.&lt;/p>
&lt;p>A particularly interesting recent application for data science is in language translation. By looking at similarities in sentence structure and colloquial speech across different languages, we&amp;rsquo;re able to sort similar words based on the &amp;ldquo;space&amp;rdquo; they occupy within the language structure.&lt;/p>
&lt;p>Insurance - the original data science industry - already is and will continue to become very automated. With increased ability to use data to assess risk, we&amp;rsquo;re beginning to see new creative insurance products being introduced. E-commerce companies can now buy insurance on the risk a customer will return a product - hard to do without the accessibility of data that we have today.&lt;/p>
&lt;h3 id="how-do-i-push-data-driven-decisions-and-get-my-boss-to-agree-with-me" class="anchor-link">&lt;a href="#how-do-i-push-data-driven-decisions-and-get-my-boss-to-agree-with-me">How do I push data-driven decisions and get my boss to agree with me&lt;/a>&lt;/h3>
&lt;p>It&amp;rsquo;s a loaded question. The bottom line is that it depends on the company&amp;rsquo;s data culture and decision path. We&amp;rsquo;ve experienced working for management who say, &amp;ldquo;We&amp;rsquo;ve already made the decisions, we just need the data to prove it.&amp;rdquo; Obviously, that&amp;rsquo;s a tough position to work from.&lt;/p>
&lt;p>Generally, ask yourself, &amp;ldquo;Am I making my boss look good?&amp;rdquo; You might hear that and think, &amp;ldquo;Why would I let my boss get all the credit?&amp;rdquo; - but who cares? Let them take the credit. If you&amp;rsquo;re producing good work, you&amp;rsquo;re making your team look good. If you make your team look good, you&amp;rsquo;re indispensible to your team and your boss. People who are indispensible are listened to.&lt;/p>
&lt;h3 id="whats-your-best-advice-for-a-budding-data-scientist" class="anchor-link">&lt;a href="#whats-your-best-advice-for-a-budding-data-scientist">What&amp;rsquo;s your best advice for a budding data scientist&lt;/a>&lt;/h3>
&lt;p>Don&amp;rsquo;t be too keen to define yourself too quickly. If you narrow your focus too much, especially when you&amp;rsquo;re learning, you can get stuck in a situation of having become an expert in &amp;ldquo;Technology A, version 3&amp;rdquo; when companies are looking to hire for experts in version 4. It happens.&lt;/p>
&lt;p>A broad understanding of fundamentals will be far more valuable to you on the whole. Maybe you start out writing code, and decide you don&amp;rsquo;t like it, but discover that you&amp;rsquo;re really good at designing big picture stuff and leading teams, and you end up as a technical lead. It could even vary depending on the company you work for - so stay flexible.&lt;/p>
&lt;p>Your best bet is to follow what you&amp;rsquo;re passionate about, and try to understand a wide range of overall concepts. Spend the majority of your efforts learning things that are timeless, like the base technologies under hot-topic items like TensorFlow. Arm yourself with a broad understanding of the terrain, different companies, and the products that are out there.&lt;/p>
&lt;p>If you focus on learning code specifically, learning one language well makes it easier to learn others. Make sure you understand the basics.&lt;/p>
&lt;h3 id="tldr-it" class="anchor-link">&lt;a href="#tldr-it">TL;dr it&lt;/a>&lt;/h3>
&lt;ul>
&lt;li>&lt;strong>Adam:&lt;/strong> Talk more and don&amp;rsquo;t give up.&lt;/li>
&lt;li>&lt;strong>Anthony:&lt;/strong> [Be] courageous, and hands-on.&lt;/li>
&lt;li>&lt;strong>Gabriel:&lt;/strong> Be creative.&lt;/li>
&lt;li>&lt;strong>Guo Jun:&lt;/strong> It&amp;rsquo;s worth the pain.&lt;/li>
&lt;li>&lt;strong>Misrab:&lt;/strong> Evaluate yourself and maintain a feedback loop.&lt;/li>
&lt;/ul>
&lt;p>
&lt;img src="https://victoria.dev/blog/things-you-need-to-know-about-becoming-a-data-scientist/datasci-crowd.jpg" alt="The crowd at GA Singapore" />
&lt;/p>
&lt;p>&lt;a href="https://twitter.com/GA_Singapore">General Assembly&lt;/a> is one of many schools and resources available to those interested in a career in data science. I&amp;rsquo;ve listed a few others in &lt;a href="https://victoria.dev/blog/top-free-resources-for-developing-coding-superpowers/">this post&lt;/a> if you&amp;rsquo;re looking for more. Good luck!&lt;/p></content:encoded><enclosure url="https://victoria.dev/blog/things-you-need-to-know-about-becoming-a-data-scientist/cover_datasci-panelists_hud75b6aee53166895e543034fff84f78c_103732_640x0_resize_q75_box.jpg" type="image/jpg"/></item><item><title>How I created custom desktop notifications using terminal and cron</title><link>https://victoria.dev/blog/how-i-created-custom-desktop-notifications-using-terminal-and-cron/</link><pubDate>Tue, 21 Feb 2017 10:48:38 +0700</pubDate><author>hello@victoria.dev (Victoria Drake)</author><guid>https://victoria.dev/blog/how-i-created-custom-desktop-notifications-using-terminal-and-cron/</guid><description>How you can use tools your Linux system already has to create custom desktop notifications.</description><content:encoded>
&lt;img src="https://victoria.dev/blog/how-i-created-custom-desktop-notifications-using-terminal-and-cron/dunstnotif_hu2db72365279baf699eed9b7492972369_54170_640x0_resize_box_2.png" width="640" height="320"/>
&lt;p>In my last post I talked about moving from Windows 10 to running i3 on Linux, built up from Debian Base System. Among other things, this change has taught me about the benefits of using basic tools and running a minimal, lightweight system. You can achieve a lot of functionality with just command line tools and simple utilities. One example I&amp;rsquo;d like to illustrate in this post is setting up desktop notifications.&lt;/p>
&lt;p>I use &lt;a href="https://dunst-project.org/">dunst&lt;/a> for desktop notifications. It&amp;rsquo;s a simple, lightweight tool that is easy to configure, doesn&amp;rsquo;t have many dependencies, and can be used across various distributions.&lt;/p>
&lt;h2 id="battery-statuslow-battery-notification" class="anchor-link">&lt;a href="#battery-statuslow-battery-notification">Battery status/low battery notification&lt;/a>&lt;/h2>
&lt;p>I was looking for a simple, versatile set up to create notifications for my battery status without having to rely on separate, standalone GUI apps or services. In my search I came across a simple one-line cron task that seemed to be the perfect fit. I adapted it to my purpose and it looks like this:&lt;/p>
&lt;pre>&lt;code class="language-conf" data-lang="conf"># m h dom mon dow command
*/5 * * * * acpi --battery | awk -F, '/Discharging/ { if (int($2) &amp;lt; 20) print }' | xargs -ri env DISPLAY=:0 notify-send -u critical -i &amp;quot;/usr/share/icons/Paper/16x16/status/xfce-battery-critical.png&amp;quot; -t 3000 &amp;quot;{}\nBattery low!&amp;quot;
&lt;/code>&lt;/pre>&lt;blockquote>
&lt;p>&lt;em>Psst&amp;hellip; &lt;a href="https://crontab.guru/">here&amp;rsquo;s a great tool&lt;/a> for formatting your crontab times.&lt;/em>&lt;/p>
&lt;/blockquote>
&lt;p>There&amp;rsquo;s a lot going on here, so let&amp;rsquo;s break it down:
&lt;code>*/5 * * * *&lt;/code>
Every five minutes, do the following.&lt;/p>
&lt;p>&lt;code>acpi --battery&lt;/code>
Execute &lt;code>acpi&lt;/code> and show battery information, which on its own returns something akin to:
&lt;code>Battery 0: Discharging, 65%, 03:01:27 remaining&lt;/code>&lt;/p>
&lt;p>Pretty straightforward so far. At any point you could input &lt;code>acpi --battery&lt;/code> in a terminal and receive the status output. Today&amp;rsquo;s post, however, is about receiving this information passively in a desktop notification. So, moving on:&lt;/p>
&lt;p>&lt;code>| awk -F, '/Discharging/ { if (int($2) &amp;lt; 20) print }'&lt;/code>
Pipe (&lt;code>|&lt;/code>) the result of the previous command to &lt;code>awk&lt;/code>. (If you don&amp;rsquo;t know what pipe does, here&amp;rsquo;s &lt;a href="http://superuser.com/questions/756158/what-does-the-linux-pipe-symbol-do">an answer from superuser.com&lt;/a> that explains it pretty well, I think.) &lt;code>awk&lt;/code> can do a lot of things, but in this case, we&amp;rsquo;re using it to examine the status of our battery. Let&amp;rsquo;s zoom in on the &lt;code>awk&lt;/code> command:&lt;/p>
&lt;p>&lt;code>awk -F, '/Discharging/ { if (int($2) &amp;lt; 20) print }'&lt;/code>
Basically, we&amp;rsquo;re saying, &amp;ldquo;Hey, awk, look at that input you just got and try to find the word &amp;ldquo;discharging,&amp;rdquo; then look to see if the number after the first comma is less than 20. If so, print the whole input.&amp;rdquo;&lt;/p>
&lt;p>&lt;code>| xargs -ri&lt;/code>
Pipe the result of the previous command to &lt;code>xargs&lt;/code>, which takes it as its input and does more stuff with it. &lt;code>-ri&lt;/code> is equivalent to &lt;code>-r&lt;/code> (run the next command only if it receives arguments) and &lt;code>-i&lt;/code> (look for &amp;ldquo;{}&amp;rdquo; and replace it with the input). So in this example, xargs serves as our gatekeeper and messenger for the next command.&lt;/p>
&lt;p>&lt;code>env DISPLAY=:0&lt;/code>
Run the following utility in the specified display, in this case, the first display of the local machine.&lt;/p>
&lt;p>&lt;code>notify-send -u critical -i &amp;quot;/usr/share/icons/Paper/16x16/status/xfce-battery-critical.png&amp;quot; -t 3000 &amp;quot;{}\nLow battery!&amp;quot;&lt;/code>
Shows a desktop notification with &lt;code>-u critical&lt;/code> (critical urgency), &lt;code>-i&lt;/code> (the specified icon), &lt;code>-t 3000&lt;/code> (display time/expires after 3000 milliseconds), and finally &lt;code>{}&lt;/code> (the output of awk, replaced by xargs).&lt;/p>
&lt;p>Not bad for a one-liner! I made a few modifications for different states of my battery. Here they all are in my crontab:&lt;/p>
&lt;pre>&lt;code class="language-conf" data-lang="conf"># m h dom mon dow command
*/5 * * * * acpi --battery | awk -F, '/Discharging/ { if ( (int($2) &amp;lt; 30) &amp;amp;&amp;amp; (int($2) &amp;gt; 15) ) print }' | xargs -ri env DISPLAY=:0 notify-send -a &amp;quot;Battery status&amp;quot; -u normal -i &amp;quot;/usr/share/icons/Paper/16x16/status/xfce-battery-low.png&amp;quot; -t 3000 &amp;quot;{}\nBattery low!&amp;quot;
*/5 * * * * acpi --battery | awk -F, '/Discharging/ { if (int($2) &amp;lt; 15) print }' | xargs -ri env DISPLAY=:0 notify-send -a &amp;quot;Battery status&amp;quot; -u critical -i &amp;quot;/usr/share/icons/Paper/16x16/status/xfce-battery-critical.png&amp;quot; -t 3000 &amp;quot;{}\nSeriously, plug me in.&amp;quot;
*/60 * * * * acpi --battery | awk -F, '/Discharging/ { if (int($2) &amp;gt; 30) print }' | xargs -ri env DISPLAY=:0 notify-send -a &amp;quot;Battery status&amp;quot; -u normal -i &amp;quot;/usr/share/icons/Paper/16x16/status/xfce-battery-ok.png&amp;quot; &amp;quot;{}&amp;quot;
*/60 * * * * acpi --battery | awk -F, '/Charging/ { print }' | xargs -ri env DISPLAY=:0 notify-send -a &amp;quot;Battery status&amp;quot; -u normal -i &amp;quot;/usr/share/icons/Paper/16x16/status/xfce-battery-ok-charging.png&amp;quot; &amp;quot;{}&amp;quot;
*/60 * * * * acpi --battery | awk -F, '/Charging/ { if (int($2) == 100) print }' | xargs -ri env DISPLAY=:0 notify-send -a &amp;quot;Battery status&amp;quot; -u normal -i &amp;quot;/usr/share/icons/Paper/16x16/status/xfce-battery-full-charging.png&amp;quot; &amp;quot;Fully charged.&amp;quot;
&lt;/code>&lt;/pre>&lt;p>By the way, you can open your crontab in the editor of your choice by accessing it as root from the &lt;code>/var/spool/cron/crontabs/&lt;/code> directory. It&amp;rsquo;s generally best practice however to make changes to your crontab with the command &lt;code>crontab -e&lt;/code>.&lt;/p>
&lt;p>You can see that each notification makes use of the &lt;code>{}&lt;/code> placeholder that tells xargs to put its input there - except for the last one. This is interesting because in this case, we&amp;rsquo;re only using &lt;code>xargs -ri&lt;/code> as a kind of switch to present the notification. The actual information that was the input for xargs is not needed in the output in order to create a notification.&lt;/p>
&lt;h2 id="additional-notifications-with-command-line-tools" class="anchor-link">&lt;a href="#additional-notifications-with-command-line-tools">Additional notifications with command line tools&lt;/a>&lt;/h2>
&lt;p>With cron and just a few combinations of simple command line tools, you can create interesting and useful notifications. Consider the following:&lt;/p>
&lt;h3 id="periodically-check-your-dhcp-address" class="anchor-link">&lt;a href="#periodically-check-your-dhcp-address">Periodically check your dhcp address&lt;/a>&lt;/h3>
&lt;div class="highlight">&lt;pre class="chroma">&lt;code class="language-sh" data-lang="sh">*/60 * * * * journalctl &lt;span class="p">|&lt;/span> awk -F: &lt;span class="s1">&amp;#39;/dhcp/ &amp;amp;&amp;amp; /address/ { print $5 }&amp;#39;&lt;/span> &lt;span class="p">|&lt;/span> tail -1 &lt;span class="p">|&lt;/span> xargs -ri env &lt;span class="nv">DISPLAY&lt;/span>&lt;span class="o">=&lt;/span>:0 notify-send -a &lt;span class="s2">&amp;#34;dhcp address&amp;#34;&lt;/span> -u normal &lt;span class="s2">&amp;#34;{}&amp;#34;&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>Which does the following:
&lt;code>*/60 * * * *&lt;/code>
Every 60 minutes.&lt;/p>
&lt;p>&lt;code>journalctl&lt;/code>
Take the contents of your system log.&lt;/p>
&lt;p>&lt;code>| tail -1'/dhcp/ &amp;amp;&amp;amp; /address/ { print $5 }'&lt;/code>
Find logs containing both &amp;ldquo;dhcp&amp;rdquo; and &amp;ldquo;address&amp;rdquo; and output the 5th portion as separated by &amp;ldquo;:&amp;rdquo; (the time field counts).&lt;/p>
&lt;p>&lt;code>| tail -1&lt;/code>
Take the last line of the output.&lt;/p>
&lt;p>&lt;code>| xargs -ri env DISPLAY=:0 notify-send -a &amp;quot;dhcp address&amp;quot; -u normal &amp;quot;{}&amp;quot;&lt;/code>
Create the desktop notification including the output.&lt;/p>
&lt;h3 id="periodically-display-the-time-and-date" class="anchor-link">&lt;a href="#periodically-display-the-time-and-date">Periodically display the time and date&lt;/a>&lt;/h3>
&lt;div class="highlight">&lt;pre class="chroma">&lt;code class="language-sh" data-lang="sh">*/60 * * * * timedatectl status &lt;span class="p">|&lt;/span> awk -F&lt;span class="se">\n&lt;/span> &lt;span class="s1">&amp;#39;/Local time/ { print }&amp;#39;&lt;/span> &lt;span class="p">|&lt;/span> xargs -ri env &lt;span class="nv">DISPLAY&lt;/span>&lt;span class="o">=&lt;/span>:0 notify-send -a &lt;span class="s2">&amp;#34;Current Time&amp;#34;&lt;/span> -u normal &lt;span class="s2">&amp;#34;{}&amp;#34;&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>
&lt;h3 id="system-log-activity" class="anchor-link">&lt;a href="#system-log-activity">System log activity&lt;/a>&lt;/h3>
&lt;p>You can also search your system logs (try &lt;code>journalctl&lt;/code>) for any number of things using awk, enabling you to get periodic notifications of virtually any logged events.&lt;/p>
&lt;h2 id="experiment" class="anchor-link">&lt;a href="#experiment">Experiment&lt;/a>&lt;/h2>
&lt;p>As with all things, you are only limited by your imagination! I hope this post has given you some idea about the endless possibilities of these simple utilities. Thanks for reading!&lt;/p></content:encoded><enclosure url="https://victoria.dev/blog/how-i-created-custom-desktop-notifications-using-terminal-and-cron/dunstnotif_hu2db72365279baf699eed9b7492972369_54170_640x0_resize_box_2.png" type="image/jpg"/></item><item><title>How I ditched WordPress and set up my custom domain HTTPS site for (almost) free</title><link>https://victoria.dev/blog/how-i-ditched-wordpress-and-set-up-my-custom-domain-https-site-for-almost-free/</link><pubDate>Sat, 28 Jan 2017 13:16:17 +0700</pubDate><author>hello@victoria.dev (Victoria Drake)</author><guid>https://victoria.dev/blog/how-i-ditched-wordpress-and-set-up-my-custom-domain-https-site-for-almost-free/</guid><description>A guide (for the minimally tech-savvy) to setting up a website with HTTPS using Hugo, Cloudflare and GitHub Pages.</description><content:encoded>
&lt;img src="https://victoria.dev/blog/how-i-ditched-wordpress-and-set-up-my-custom-domain-https-site-for-almost-free/cover_free-https_hu8673880aabf7986b54167d322ecde323_1104421_640x0_resize_box_2.png" width="640" height="402"/>
&lt;p>I got annoyed with WordPress.com. While using the service has its pros (like https and a mobile responsive website, and being very visual and beginner-friendly) it&amp;rsquo;s limiting. For someone who&amp;rsquo;s comfortable enough to be tweaking CSS but who&amp;rsquo;s not interested in creating their own theme (or paying upwards of $50 for one), I felt I wasn&amp;rsquo;t really the type of consumer WordPress.com was suited to.&lt;/p>
&lt;p>To start with, if you want to remove WordPress advertising and use a custom domain name, it&amp;rsquo;s a minimum of $3 per month. If, like me, the free themes provided aren&amp;rsquo;t just what you&amp;rsquo;re looking for, you&amp;rsquo;re stuck with two choices: buy a theme for $50+, or pay $8.25 per month to do &lt;em>some&lt;/em> css customization. I don&amp;rsquo;t know about you, but I feel like there should be a hack for this.&lt;/p>
&lt;h2 id="how-i-ditched-wordpress-and-got-everything-i-wanted-for-free" class="anchor-link">&lt;a href="#how-i-ditched-wordpress-and-got-everything-i-wanted-for-free">How I ditched WordPress and got everything I wanted for free&lt;/a>&lt;/h2>
&lt;p>Okay, &lt;em>almost&lt;/em> free. You still have to pay &lt;a href="https://www.namecheap.com/promos/2016/crazy-88.aspx?aff=109417">at least $0.88&lt;/a> for a domain name.&lt;/p>
&lt;p>For those of you technical enough to skip reading a long post, the recipe is this:&lt;/p>
&lt;ol>
&lt;li>&lt;a href="https://www.namecheap.com/?aff=109417">Buy a custom domain via this Namecheap affiliate link&lt;/a> (Thanks! :))&lt;/li>
&lt;li>Install &lt;a href="https://www.gohugo.io/">Hugo&lt;/a>, my favorite static site generator&lt;/li>
&lt;li>Host with &lt;a href="https://pages.github.com/">GitHub Pages&lt;/a>&lt;/li>
&lt;li>Put your &lt;a href="https://help.github.com/articles/setting-up-an-apex-domain/#configuring-an-alias-or-aname-record-with-your-dns-provider">custom domain to work with GitHub Pages&lt;/a>&lt;/li>
&lt;li>&lt;del>Use Cloudflare&amp;rsquo;s free plan&lt;/del> &lt;a href="#5-enforce-https-for-github-pages">Enforce HTTPS for GitHub Pages&lt;/a>&lt;/li>
&lt;/ol>
&lt;p>Let&amp;rsquo;s do the nitty gritty:&lt;/p>
&lt;h3 id="1-buy-a-custom-domain" class="anchor-link">&lt;a href="#1-buy-a-custom-domain">1. Buy a custom domain&lt;/a>&lt;/h3>
&lt;p>This one&amp;rsquo;s pretty simple. Head on over to &lt;a href="https://www.namecheap.com/?aff=109417">Namecheap&lt;/a>, &lt;a href="https://www.gandi.net">Gandi&lt;/a>, or if you&amp;rsquo;re rolling in dough, &lt;a href="https://www.godaddy.com/">GoDaddy&lt;/a>. Find your perfect web address and buy it up.&lt;/p>
&lt;p>If it&amp;rsquo;s a &lt;a href="https://www.namecheap.com/domains/personal.aspx?aff=109417">personal domain&lt;/a> like &lt;em>yourname.com,&lt;/em> it&amp;rsquo;s a pretty good idea to pay upfront for five years or even ten years, if you&amp;rsquo;ve got the cash. It&amp;rsquo;ll save you the trouble of remembering to renew, allow you to build your personal brand, and prevent someone else from buying up your URL.&lt;/p>
&lt;p>If you&amp;rsquo;re just trying out an idea, you can go with a one-year &lt;a href="https://www.namecheap.com/promos/2016/crazy-88.aspx?aff=109417">$0.88 domain&lt;/a>. After the ICANN fee, it&amp;rsquo;ll cost you a whopping $1.06. Namecheap also gives you WhoisGuard (domain registration privacy) free for one year.&lt;/p>
&lt;h3 id="2-install-hugo" class="anchor-link">&lt;a href="#2-install-hugo">2. Install Hugo&lt;/a>&lt;/h3>
&lt;p>I&amp;rsquo;m a big fan of &lt;a href="https://www.gohugo.io/">Hugo&lt;/a> so far. Admittedly, those who feel more comfortable with a visual, WYSIWYG editor may feel like a fish out of water at first. As long as you&amp;rsquo;re not afraid of using command line, though, using Hugo is pretty straightforward. The fact that I have access to all my code is my favorite part. It&amp;rsquo;s only as simple or complicated as I want it to be.&lt;/p>
&lt;p>Hugo is open source and free. They&amp;rsquo;ve got great documentation, and following their &lt;a href="https://gohugo.io/overview/quickstart/">Quickstart guide&lt;/a> line-by-line will get you set up with your new site in minutes.&lt;/p>
&lt;p>If you&amp;rsquo;re not used to the idea of your site existing as files and folders, the basic premise is this: Hugo, along with the themes available, helps you to create all the pages and files that your site needs to run. Blog posts can be written in Markdown and saved in your &lt;code>/content/blog/&lt;/code> folder; preferences for your site and theme can be set in the &lt;code>config.toml&lt;/code> file. After that, generating all your site&amp;rsquo;s pages is as quick and easy as typing the command &lt;code>hugo --theme=&amp;lt;your theme&amp;gt;&lt;/code>. You&amp;rsquo;ll be able to see a live version of your site in your browser as you&amp;rsquo;re editing it (go to &lt;code>http://localhost:1313/&lt;/code> in your browser, as described in Step 5) so you&amp;rsquo;re not flying blind.&lt;/p>
&lt;p>Confused? Ask me on Twitter &lt;a href="https://twitter.com/victoriadotdev">@victoriadotdev&lt;/a> and I&amp;rsquo;ll help you out!&lt;/p>
&lt;h3 id="3-host-with-github-pages" class="anchor-link">&lt;a href="#3-host-with-github-pages">3. Host with GitHub Pages&lt;/a>&lt;/h3>
&lt;p>If you read to Step 12 of Hugo&amp;rsquo;s Quickstart Guide, you&amp;rsquo;ll see that they even provided instructions for hosting your files on GitHub pages. If you&amp;rsquo;re new to Git, you&amp;rsquo;ll first need to &lt;a href="https://github.com/">sign up at GitHub&lt;/a> and then &lt;a href="https://help.github.com/articles/set-up-git/">set up Git&lt;/a>. GitHub is a very friendly resource, and you can find a multitude of code examples and guides in connection with it. The &lt;a href="https://guides.github.com/activities/hello-world/">Hello World Guide&lt;/a> will take you through all you need to know to use GitHub.com.&lt;/p>
&lt;p>Once you&amp;rsquo;re comfortable with the way GitHub works generally, setting up a site by following &lt;a href="https://pages.github.com/">the guide on GitHub Pages&lt;/a> is no big deal. If you followed the Hugo Quickstart Guide up to Step 11, you&amp;rsquo;ll want to jump to Step 12 after creating the repository on GitHub.&lt;/p>
&lt;p>In case it&amp;rsquo;s not clear, once you set up your new repository on GitHub called &lt;em>yourusername&lt;/em>.github.io, grab the HTTPS link at the top. From there it&amp;rsquo;s just a few simple commands to create the git repository for your site and push it to your new web address:&lt;/p>
&lt;div class="highlight">&lt;pre class="chroma">&lt;code class="language-sh" data-lang="sh">&lt;span class="c1">## from yoursite/public folder:&lt;/span>
$ git init
$ git remote add origin &amp;lt;paste that https url here!&amp;gt;
$ git add --all
$ git commit -m &lt;span class="s2">&amp;#34;Initial commit.&amp;#34;&lt;/span>
$ git push origin master
&lt;/code>&lt;/pre>&lt;/div>&lt;p>Have a little celebration - your site is already up at &lt;code>https://yourusername.github.io&lt;/code>! Now for the pizza-de-resilience: the custom domain.&lt;/p>
&lt;h3 id="4-point-your-custom-domain-to-github-pages" class="anchor-link">&lt;a href="#4-point-your-custom-domain-to-github-pages">4. Point your custom domain to GitHub Pages&lt;/a>&lt;/h3>
&lt;p>To set up your site at apex (meaning &lt;code>yourname.com&lt;/code> will replace &lt;code>yourusername.github.io&lt;/code>), there&amp;rsquo;s just four steps:&lt;/p>
&lt;ol>
&lt;li>&lt;a href="https://help.github.com/articles/adding-or-removing-a-custom-domain-for-your-github-pages-site/">Add your domain to your GitHub Pages site repository&lt;/a>&lt;/li>
&lt;li>In your domain registrar&amp;rsquo;s DNS settings, &lt;a href="https://help.github.com/articles/setting-up-an-apex-domain/#configuring-a-records-with-your-dns-provider">create A records pointing to GitHub&amp;rsquo;s IP addresses&lt;/a>&lt;/li>
&lt;li>In your domain registrar&amp;rsquo;s DNS settings, create a CNAME record pointing to &lt;code>yourusername.github.io&lt;/code>&lt;/li>
&lt;li>Make sure there&amp;rsquo;s a CNAME file in the root directory of your GitHub repository containing &lt;code>yourname.com&lt;/code> (your custom domain)&lt;/li>
&lt;/ol>
&lt;h3 id="5-enforce-https-for-github-pages" class="anchor-link">&lt;a href="#5-enforce-https-for-github-pages">5. Enforce HTTPS for GitHub Pages&lt;/a>&lt;/h3>
&lt;p>&lt;em>May 15, 2018 edit:&lt;/em> &lt;a href="https://blog.github.com/2018-05-01-github-pages-custom-domains-https/">GitHub Pages now support HTTPS&lt;/a> through a partnership with &lt;a href="https://letsencrypt.org/">Let&amp;rsquo;s Encrypt&lt;/a>! This is welcome news and greatly simplifies the process of serving your site securely. Just look for this clever checkbox in the Settings of your site&amp;rsquo;s GitHub repository.&lt;/p>
&lt;p>
&lt;img src="https://victoria.dev/blog/how-i-ditched-wordpress-and-set-up-my-custom-domain-https-site-for-almost-free/custom-domain-https.png#screenshot" alt="Enforce HTTPS checkbox" />
&lt;/p>
&lt;p>The below section is left here to show how far we&amp;rsquo;ve come. :)&lt;/p>
&lt;h3 id="5-get-https-with-cloudflare" class="anchor-link">&lt;a href="#5-get-https-with-cloudflare">&lt;del>5. Get HTTPS with Cloudflare&lt;/del>&lt;/a>&lt;/h3>
&lt;p>&lt;em>Why do I need a SSL certificate anyway?&lt;/em> For one, it&amp;rsquo;ll &lt;a href="http://searchengineland.com/google-starts-giving-ranking-boost-secure-httpsssl-sites-199446/">give your site a little boost on Google&lt;/a>.&lt;/p>
&lt;p>&lt;a href="https://www.cloudflare.com/">Sign up with Cloudflare&lt;/a> and follow their set up guide. The site will collect your custom domain&amp;rsquo;s DNS settings and set everything up automagically. Once the set up is complete, Cloudflare provides you with two new nameserver addresses. Go to your domain registrar&amp;rsquo;s DNS settings and change the Domain Name Servers to the ones Cloudflare gives you.&lt;/p>
&lt;p>In your &lt;code>config.toml&lt;/code>, &lt;code>config.yaml&lt;/code>, or &lt;code>config.json&lt;/code> file, ensure these lines are present:&lt;/p>
&lt;div class="highlight">&lt;pre class="chroma">&lt;code class="language-toml" data-lang="toml">&lt;span class="nx">baseURL&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="s2">&amp;#34;https://yourname.com/&amp;#34;&lt;/span>
&lt;span class="nx">canonifyURLs&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="kc">true&lt;/span>
&lt;span class="nx">enforce_ssl&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="nx">www&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">yoursite&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">com&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>To redirect users to HTTPS, add this script to the top of your &lt;code>&amp;lt;head&amp;gt;&lt;/code> file:&lt;/p>
&lt;div class="highlight">&lt;pre class="chroma">&lt;code class="language-html" data-lang="html">&lt;span class="p">&amp;lt;&lt;/span>&lt;span class="nt">script&lt;/span> &lt;span class="na">type&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s">&amp;#34;text/javascript&amp;#34;&lt;/span>&lt;span class="p">&amp;gt;&lt;/span>
&lt;span class="kd">var&lt;/span> &lt;span class="nx">host&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="s2">&amp;#34;yourname.com&amp;#34;&lt;/span>&lt;span class="p">;&lt;/span>
&lt;span class="k">if&lt;/span> &lt;span class="p">((&lt;/span>&lt;span class="nx">host&lt;/span> &lt;span class="o">==&lt;/span> &lt;span class="nb">window&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">location&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">host&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="o">&amp;amp;&amp;amp;&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="nb">window&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">location&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">protocol&lt;/span> &lt;span class="o">!=&lt;/span> &lt;span class="s2">&amp;#34;https:&amp;#34;&lt;/span>&lt;span class="p">))&lt;/span>
&lt;span class="nb">window&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">location&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nx">protocol&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="s2">&amp;#34;https&amp;#34;&lt;/span>&lt;span class="p">;&lt;/span>
&lt;span class="p">&amp;lt;/&lt;/span>&lt;span class="nt">script&lt;/span>&lt;span class="p">&amp;gt;&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>That&amp;rsquo;s pretty much it! In a couple hours or so, your site will be up and running at &lt;code>https://yourname.com&lt;/code>.&lt;/p>
&lt;p>Thanks for reading!&lt;/p></content:encoded><enclosure url="https://victoria.dev/blog/how-i-ditched-wordpress-and-set-up-my-custom-domain-https-site-for-almost-free/cover_free-https_hu8673880aabf7986b54167d322ecde323_1104421_640x0_resize_box_2.png" type="image/jpg"/></item><item><title>Basics of Iteration in Python</title><link>https://victoria.dev/blog/basics-of-iteration-in-python/</link><pubDate>Wed, 18 Jan 2017 21:58:28 +0700</pubDate><author>hello@victoria.dev (Victoria Drake)</author><guid>https://victoria.dev/blog/basics-of-iteration-in-python/</guid><description>A basic overview of writing effective iterations in Python using for loops, list comprehensions, and map.</description><content:encoded>
&lt;img src="https://victoria.dev/blog/basics-of-iteration-in-python/python-iterations_hu18814168040f2eb301c45f95f3786638_57779_640x0_resize_box_2.png" width="640" height="320"/>
&lt;p>I&amp;rsquo;ve been working in Python 3 for about a week, and so far greatly enjoy it. To me, learning code syntax (and programming in general) is similar to an amalgamation of Lego blocks: once it&amp;rsquo;s understood what a certain color of block does, it&amp;rsquo;s straightforward to combine them to create the structure you&amp;rsquo;re looking for.&lt;/p>
&lt;p>That said, some blocks can be a little confusing at first. I found documentation relating to iteration in Python to be a little hard to digest, mostly because of subtle differences in terminology: iteration, iterator, iterating, iterable&amp;hellip; it&amp;rsquo;s enough to make your eyes glaze over. I found concrete examples to be most useful in learning these concepts; this post aims to summarize what I&amp;rsquo;ve learned.&lt;/p>
&lt;p>There are a few different ways to achieve iterations in Python. I&amp;rsquo;ll present some of these ways in this post and discuss appropriate situations for each.&lt;/p>
&lt;h2 id="for-loop" class="anchor-link">&lt;a href="#for-loop">For loop&lt;/a>&lt;/h2>
&lt;div class="highlight">&lt;pre class="chroma">&lt;code class="language-sh" data-lang="sh">&lt;span class="k">for&lt;/span> iterating_var in iterable:
statement/statements
&lt;/code>&lt;/pre>&lt;/div>&lt;p>For loops are handy things. They&amp;rsquo;re straightforward to understand, which is especially helpful if you&amp;rsquo;re reading someone else&amp;rsquo;s code and trying to follow their thought process. They can achieve as much or as little as you need, and each operation can be clearly written out.&lt;/p>
&lt;p>An &lt;code>iterating_var&lt;/code> can be any of Python&amp;rsquo;s data types: a letter in a string, an item from a list, an index from a list, integers, etc. An &lt;code>iterable&lt;/code> can also take different forms: a string of word(s), a range of numbers, a list, and so on. A &lt;code>statement&lt;/code> or multiple &lt;code>statements&lt;/code> indicates &lt;em>doing something:&lt;/em> anything from mathematical expressions to simply printing a result. Check out the following examples, which simply print each &lt;code>iterating_var&lt;/code> of an &lt;code>iterable&lt;/code> on a new line:&lt;/p>
&lt;div class="highlight">&lt;pre class="chroma">&lt;code class="language-python" data-lang="python">&lt;span class="k">for&lt;/span> &lt;span class="n">letter&lt;/span> &lt;span class="ow">in&lt;/span> &lt;span class="s2">&amp;#34;Hello world&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span>
&lt;span class="k">print&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">letter&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="k">for&lt;/span> &lt;span class="n">i&lt;/span> &lt;span class="ow">in&lt;/span> &lt;span class="nb">range&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="mi">10&lt;/span>&lt;span class="p">):&lt;/span>
&lt;span class="k">print&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">i&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="n">breakfastmenu&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="p">[&lt;/span>&lt;span class="s2">&amp;#34;toast&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s2">&amp;#34;eggs&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s2">&amp;#34;waffles&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s2">&amp;#34;coffee&amp;#34;&lt;/span>&lt;span class="p">]&lt;/span>
&lt;span class="k">for&lt;/span> &lt;span class="n">choice&lt;/span> &lt;span class="ow">in&lt;/span> &lt;span class="n">breakfastmenu&lt;/span>&lt;span class="p">:&lt;/span>
&lt;span class="k">print&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">choice&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>You can even use a for loop in a more compact situation, such as I did in &lt;a href="https://github.com/victoriadrake/30-days-of-code/blob/master/day7_arrays.py">my solution&lt;/a> to HackerRank&amp;rsquo;s &lt;a href="https://www.hackerrank.com/challenges/30-arrays">30 Days of Code - Day 7: Arrays&lt;/a> challenge:&lt;/p>
&lt;div class="highlight">&lt;pre class="chroma">&lt;code class="language-python" data-lang="python">&lt;span class="n">arrstring&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="s2">&amp;#34; &amp;#34;&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">join&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nb">str&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">e&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="k">for&lt;/span> &lt;span class="n">e&lt;/span> &lt;span class="ow">in&lt;/span> &lt;span class="n">arr&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>The downside to for loops is that they can be a bit verbose, depending on how much you&amp;rsquo;re trying to achieve. Still, for anyone learning Python or hoping to make their code as easily understood as possible, for loops are still the most straightforward choice for iterations.&lt;/p>
&lt;h2 id="list-comprehensions" class="anchor-link">&lt;a href="#list-comprehensions">List comprehensions&lt;/a>&lt;/h2>
&lt;div class="highlight">&lt;pre class="chroma">&lt;code class="language-python" data-lang="python">&lt;span class="n">newlist&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="p">[&lt;/span>&lt;span class="n">statement&lt;/span> &lt;span class="o">/&lt;/span> &lt;span class="n">statements&lt;/span> &lt;span class="k">for&lt;/span> &lt;span class="n">iterating_var&lt;/span> &lt;span class="ow">in&lt;/span> &lt;span class="n">iterable&lt;/span>&lt;span class="p">]&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>In my opinion, list comprehensions are the most elegant of the solutions discussed in this post. Once you have a grasp of how they work, you can perform concise and effective iterations with very little code.&lt;/p>
&lt;p>List comprehensions will always return a list, which may or may not be appropriate for your situation. If appropriate, however, simply defining the variable name of the list can often help you skip some steps.&lt;/p>
&lt;p>For example, I can use list comprehension to quickly calculate and print tip percentage on a few bar tabs at once:&lt;/p>
&lt;div class="highlight">&lt;pre class="chroma">&lt;code class="language-sh" data-lang="sh">&lt;span class="nv">tabs&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="o">[&lt;/span>23.60, 42.10, 17.50&lt;span class="o">]&lt;/span>
&lt;span class="nv">tabsplustips&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="o">[&lt;/span>round&lt;span class="o">(&lt;/span>tab*1.15, 2&lt;span class="o">)&lt;/span> &lt;span class="k">for&lt;/span> tab in tabs&lt;span class="o">]&lt;/span>
print&lt;span class="o">(&lt;/span>tabsplustips&lt;span class="o">)&lt;/span>
&amp;gt;&amp;gt;&amp;gt; &lt;span class="o">[&lt;/span>27.14, 48.41, 20.12&lt;span class="o">]&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>In one concise line, we&amp;rsquo;ve taken each tab amount, added 15% tip, rounded it to the nearest cent, and made a new list of the tabs plus the tip values.&lt;/p>
&lt;p>List comprehensions can be an elegant tool, depending on the variety of statements you want to iterate through, and whether or not output to a list is useful to you. The more statements you add, the more complicated your list comprehension begins to look, especially once you get into nested list comprehensions. If your code isn&amp;rsquo;t well annotated, it may become difficult for another reader to figure out.&lt;/p>
&lt;h2 id="map" class="anchor-link">&lt;a href="#map">Map&lt;/a>&lt;/h2>
&lt;div class="highlight">&lt;pre class="chroma">&lt;code class="language-python" data-lang="python">&lt;span class="nb">map&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">function&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">iterable&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>Map is, in many ways, a non-idiomatic function for iteration in Python. It&amp;rsquo;s pretty compact, which can make it easy to write improperly with a missing comma or parenthesis, and it&amp;rsquo;s more limited than for loops or list comprehensions in its usage. Basically, it applies your &lt;code>statement&lt;/code> (in this case, your &lt;code>function&lt;/code>) to every instance of your defined &lt;code>iterable&lt;/code>.&lt;/p>
&lt;p>I used the map function in &lt;a href="https://github.com/victoriadrake/simple-statistics/blob/master/weighted_mean.py">my solution&lt;/a> to HackerRank&amp;rsquo;s &lt;a href="https://www.hackerrank.com/challenges/s10-weighted-mean">10 Days of Statistics - Day 0: Weighted Mean&lt;/a> challenge. In this example, it&amp;rsquo;s casting each element of &lt;code>input()&lt;/code> (the iterable) from string representation to integer representation.&lt;/p>
&lt;div class="highlight">&lt;pre class="chroma">&lt;code class="language-python" data-lang="python">&lt;span class="n">values&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="nb">list&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nb">map&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nb">int&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nb">input&lt;/span>&lt;span class="p">()&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">split&lt;/span>&lt;span class="p">()))&lt;/span>
&lt;span class="n">weights&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="nb">list&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nb">map&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nb">int&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nb">input&lt;/span>&lt;span class="p">()&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">split&lt;/span>&lt;span class="p">()))&lt;/span>
&lt;span class="n">output&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="nb">sum&lt;/span>&lt;span class="p">([&lt;/span>&lt;span class="n">x&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="mi">0&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="o">*&lt;/span> &lt;span class="n">x&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="k">for&lt;/span> &lt;span class="n">x&lt;/span> &lt;span class="ow">in&lt;/span> &lt;span class="nb">zip&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">values&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">weights&lt;/span>&lt;span class="p">)])&lt;/span> &lt;span class="o">/&lt;/span> &lt;span class="nb">sum&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">weights&lt;/span>&lt;span class="p">)&lt;/span>
&lt;span class="k">print&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nb">round&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">output&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="mi">1&lt;/span>&lt;span class="p">))&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>It&amp;rsquo;s worthwhile to note that map by itself returns an iterator; if it&amp;rsquo;s a list you want, it&amp;rsquo;s an extra step to get the list representation, as in the example above.&lt;/p>
&lt;p>In truth, I&amp;rsquo;ve had a hard time coming up with appropriate situations for the use of map over simply using a list comprehension. Aside from situations similar to the above, it seems to me to be a rather un-Pythonic way to iterate. It can be advantageous as a concise method of doing simple, sort of &amp;lsquo;on-the-spot&amp;rsquo; iterations; otherwise, my preference would be to use a list comprehension instead.&lt;/p>
&lt;p>I hope these examples have been useful to you in your understanding of iterations with Python 3. Thanks for reading!&lt;/p></content:encoded><enclosure url="https://victoria.dev/blog/basics-of-iteration-in-python/python-iterations_hu18814168040f2eb301c45f95f3786638_57779_640x0_resize_box_2.png" type="image/jpg"/></item></channel></rss>